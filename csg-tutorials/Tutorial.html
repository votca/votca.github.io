<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>CSG Tutorial &mdash; VOTCA 2024-dev documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/custom.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/documentation_options.js?v=61889540"></script>
        <script src="../_static/doctools.js?v=888ff710"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="XTP Tutorials" href="../xtp-tutorials/XTP-TUTORIAL.html" />
    <link rel="prev" title="8. Bibliography" href="../xtp/bibliography.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html">
            
              <img src="../_static/customLogo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../INSTALL.html">Installation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Manuals</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tools/index.html">TOOLS Manual</a></li>
<li class="toctree-l1"><a class="reference internal" href="../csg/index.html">CSG Manual</a></li>
<li class="toctree-l1"><a class="reference internal" href="../xtp/XTP-MANUAL.html">XTP Manual</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">CSG Tutorial</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#installation">Installation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#building-votca">Building VOTCA</a></li>
<li class="toctree-l3"><a class="reference internal" href="#using-the-tutorials">Using the tutorials</a></li>
<li class="toctree-l3"><a class="reference internal" href="#the-manual">The manual</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#running-gromacs">Running GROMACS</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#input-files">Input files</a></li>
<li class="toctree-l3"><a class="reference internal" href="#md-simulations">MD simulations</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#running-other-md-programs">Running other MD programs</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#running-espresso">Running ESPResSo++</a></li>
<li class="toctree-l3"><a class="reference internal" href="#running-lammps">Running LAMMPS</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#mapping-an-atomistic-trajectory-onto-a-coarse-grained-trajectory">Mapping an atomistic trajectory onto a coarse-grained trajectory</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#spc-e-water">SPC/E Water</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#iterative-boltzmann-inversion-ibi-for-spc-e-water">Iterative Boltzmann inversion (IBI) for SPC/E water</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#atomistic-simulation">Atomistic simulation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#calculation-of-rdf">Calculation of RDF</a></li>
<li class="toctree-l3"><a class="reference internal" href="#running-ibi">Running IBI</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#inverse-monte-carlo-imc-for-spc-e-water">Inverse Monte Carlo (IMC) for SPC/E water</a></li>
<li class="toctree-l2"><a class="reference internal" href="#relative-entropy-re-minimization-for-spc-e-water">Relative entropy (RE) minimization for SPC/E water</a></li>
<li class="toctree-l2"><a class="reference internal" href="#force-matching-for-spc-e-water">Force matching for SPC/E water</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id3">Atomistic simulation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#force-matching-fm">Force matching (FM)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#running-of-cg-simulation">Running of CG simulation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#force-matching-for-spc-e-water-with-3body-sw-interactions">Force matching for SPC/E water with 3body SW interactions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id4">Force matching (FM)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#running-of-cg-simulation-with-lammps">Running of CG simulation with LAMMPS</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#visualization-of-ibi-updates">Visualization of IBI updates</a></li>
<li class="toctree-l2"><a class="reference internal" href="#coarse-graining-of-liquid-methanol">Coarse-graining of liquid methanol</a></li>
<li class="toctree-l2"><a class="reference internal" href="#coarse-graining-of-liquid-hexane">Coarse-graining of liquid hexane</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id6">Atomistic simulation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#ibi-for-all-interactions">IBI for all interactions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#ibi-for-non-bonded-interactions-only">IBI for non-bonded interactions only</a></li>
<li class="toctree-l3"><a class="reference internal" href="#fm-for-all-interactions-together">FM for all interactions together</a></li>
<li class="toctree-l3"><a class="reference internal" href="#fm-for-non-bonded-interactions-only">FM for non-bonded interactions only</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#regularization-of-the-inverse-monte-carlo-method">Regularization of the inverse Monte Carlo method</a></li>
<li class="toctree-l2"><a class="reference internal" href="#additional-tutorials">Additional tutorials</a></li>
<li class="toctree-l2"><a class="reference internal" href="#advanced-topics">Advanced topics</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#extending-the-scripting-framework">Extending the scripting framework</a></li>
<li class="toctree-l3"><a class="reference internal" href="#writing-an-analysis-tool">Writing an analysis tool</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../xtp-tutorials/XTP-TUTORIAL.html">XTP Tutorials</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Development</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../DEVELOPERS_GUIDE.html">Developer and Contributor Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../VOTCA_LANGUAGE_GUIDE.html">VOTCA Internal Contributor Language Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Architecture.html">The architecture of VOTCA</a></li>
<li class="toctree-l1"><a class="reference internal" href="../xtp/Architecture.html">Architecture of votca-xtp</a></li>
<li class="toctree-l1"><a class="reference internal" href="../CODE_OF_CONDUCT.html">Code of Conduct</a></li>
<li class="toctree-l1"><a class="reference internal" href="../websiteAndDocumentation.html">Website and Documentation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Community</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://github.com/votca">GitHub</a></li>
<li class="toctree-l1"><a class="reference external" href="https://twitter.com/votca_software">Twitter</a></li>
<li class="toctree-l1"><a class="reference external" href="https://groups.google.com/g/votca">Forum</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">VOTCA</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">CSG Tutorial</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/csg-tutorials/Tutorial.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="csg-tutorial">
<h1>CSG Tutorial<a class="headerlink" href="#csg-tutorial" title="Link to this heading">¶</a></h1>
<p>Please pick topics you are most interested in, since finishing the
tutorial might take longer than one afternoon.</p>
<section id="installation">
<h2>Installation<a class="headerlink" href="#installation" title="Link to this heading">¶</a></h2>
<section id="building-votca">
<h3>Building VOTCA<a class="headerlink" href="#building-votca" title="Link to this heading">¶</a></h3>
<p>Instructions how to build and install VOTCA can be found
<a class="reference internal" href="../INSTALL.html#install"><span class="std std-ref">here</span></a>.</p>
</section>
<section id="using-the-tutorials">
<h3>Using the tutorials<a class="headerlink" href="#using-the-tutorials" title="Link to this heading">¶</a></h3>
<p>All the tutorials are in the installation folder, i.e.
<code class="docutils literal notranslate"><span class="pre">${prefix}/share/votca/csg-tutorials</span></code>.</p>
</section>
<section id="the-manual">
<h3>The manual<a class="headerlink" href="#the-manual" title="Link to this heading">¶</a></h3>
<p>The CSG manual can be found <a class="reference internal" href="../csg/index.html#csg"><span class="std std-ref">here</span></a></p>
</section>
</section>
<section id="running-gromacs">
<h2>Running GROMACS<a class="headerlink" href="#running-gromacs" title="Link to this heading">¶</a></h2>
<p>The tutorial uses GROMACS, a molecular dynamics (MD) package, for
generating the reference data. If you are not familiar with GROMACS,
please read the following section for a brief overview on how to set up
and run MD simulations using GROMACS. You can find all the GROMACS input
files in the <code class="docutils literal notranslate"><span class="pre">atomistic</span></code> folder of each tutorial, e.g., for a box of
atomistic water see <code class="docutils literal notranslate"><span class="pre">csg-tutorials/spce/atomistic/</span></code>.</p>
<section id="input-files">
<h3>Input files<a class="headerlink" href="#input-files" title="Link to this heading">¶</a></h3>
<p>You will need four files to run MD simulations</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">conf.gro</span></code> - stores the coordinates of the molecule(s). It can be viewed with vmd. The default file name is <code class="docutils literal notranslate"><span class="pre">conf.gro</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">grompp.mdp</span></code> - stores all simulation options, such as time step, number of simulation steps, etc.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">topol.top</span></code> - topology of the molecule</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">forcefield.itp</span></code> - description of the atomistic force-field (not always needed)</p></li>
</ul>
<p>During this tutorial, you will need to modify</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">nsteps</span></code> - number of MD steps</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">nstxout</span></code> - output frequency of coordinates to the trajectory file traj.trr</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">nstfout</span></code> - output frequency of forces to traj.trr</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">nstxout-compressed</span></code> - output frequency to the traj.xtc file, often used by the iterative Boltzmann inversion method</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">nstlog</span></code> - output frequency of the md.log file</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">nstenergy</span></code> - output frequency to the ener.edr file containing all thermodynamic information</p></li>
</ul>
</section>
<section id="md-simulations">
<h3>MD simulations<a class="headerlink" href="#md-simulations" title="Link to this heading">¶</a></h3>
<p>To run MD simulations using GROMACS, first one must create a binary
topology file <code class="docutils literal notranslate"><span class="pre">topol.tpr</span></code> using the <code class="docutils literal notranslate"><span class="pre">gmx</span> <span class="pre">grompp</span></code> program. Then run
the MD integrator using the <code class="docutils literal notranslate"><span class="pre">gmx</span> <span class="pre">mdrun</span></code> program. <code class="docutils literal notranslate"><span class="pre">topol.tpr</span></code>
contains <code class="docutils literal notranslate"><span class="pre">conf.gro</span></code>, <code class="docutils literal notranslate"><span class="pre">grompp.mdp</span></code>, <code class="docutils literal notranslate"><span class="pre">topol.top</span></code>, and
<code class="docutils literal notranslate"><span class="pre">forcefield.itp</span></code>.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>gmx<span class="w"> </span>grompp<span class="w"> </span>-c<span class="w"> </span>conf.gro<span class="w"> </span><span class="c1"># -c is needed if other than conf.gro file is used</span>
gmx<span class="w"> </span>mdrun<span class="w"> </span>-v<span class="w"> </span><span class="c1"># -v (verbose) gives the estimate of the run time</span>
</pre></div>
</div>
</section>
</section>
<section id="running-other-md-programs">
<h2>Running other MD programs<a class="headerlink" href="#running-other-md-programs" title="Link to this heading">¶</a></h2>
<p>In addition to GROMACS, VOTCA supports <code class="docutils literal notranslate"><span class="pre">ESPResSo</span></code>, <code class="docutils literal notranslate"><span class="pre">Lammps</span></code>,
<code class="docutils literal notranslate"><span class="pre">dl_poly</span></code>, <code class="docutils literal notranslate"><span class="pre">HOOMD-blue</span></code>, and <code class="docutils literal notranslate"><span class="pre">ESPResSo++</span></code>. The interface to these
is a bit more advanced, meaning VOTCA will allow you to do more crazy
things and warn you less about settings, which might not make sense at
all. Let’s have a look at <code class="docutils literal notranslate"><span class="pre">csg-tutorials/spce/ibi_espressopp/</span></code>.
(<code class="docutils literal notranslate"><span class="pre">ibi_lammps</span></code>, <code class="docutils literal notranslate"><span class="pre">ibi_espresso</span></code>, <code class="docutils literal notranslate"><span class="pre">ibi_dlpoly</span></code>, and
<code class="docutils literal notranslate"><span class="pre">ibi_hoomd-blue</span></code> are pretty similar)</p>
<section id="running-espresso">
<h3>Running ESPResSo++<a class="headerlink" href="#running-espresso" title="Link to this heading">¶</a></h3>
<p>Let’s have a look at <code class="docutils literal notranslate"><span class="pre">csg-tutorials/spce/ibi_espressopp/</span></code>.
Here is an example of the ESPResSo++ input files to run the CG MD
simulations of the Iterative Boltzmann inversion procedure:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">conf.gro</span></code> - stores the coordinates of the molecule(s). It can be viewed with vmd. A pdb or xyz file would be okay, too.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">spce.py</span></code> - is the simulation script which will be called by csg_inverse. It stores the whole simulation procedure.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">topol.xml</span></code> - topology of the molecule, defined in the initial condition. This is needed as most gro/pdb/xyz files have no molecule definition in them.</p></li>
</ul>
</section>
<section id="running-lammps">
<h3>Running LAMMPS<a class="headerlink" href="#running-lammps" title="Link to this heading">¶</a></h3>
<p>Now, let’s have a look at <code class="docutils literal notranslate"><span class="pre">csg-tutorials/spce/ibi_lammps/</span></code>
containing an example of LAMMPS input files to run the CG
MD simulations of the Iterative Boltzmann inversion procedure:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">spce.data</span></code> - stores the coordinates of the molecule(s).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">spce.in</span></code> - is the simulation script which will be called by csg_inverse. It stores the whole simulation procedure.</p></li>
</ul>
</section>
</section>
<section id="mapping-an-atomistic-trajectory-onto-a-coarse-grained-trajectory">
<h2>Mapping an atomistic trajectory onto a coarse-grained trajectory<a class="headerlink" href="#mapping-an-atomistic-trajectory-onto-a-coarse-grained-trajectory" title="Link to this heading">¶</a></h2>
<section id="spc-e-water">
<h3>SPC/E Water<a class="headerlink" href="#spc-e-water" title="Link to this heading">¶</a></h3>
<p>Folder: <code class="docutils literal notranslate"><span class="pre">csg-tutorials/spce/atomistic/</span></code></p>
<p>Have a look at the center of mass mapping file <code class="docutils literal notranslate"><span class="pre">water.xml</span></code> in this
folder. Use <code class="docutils literal notranslate"><span class="pre">csg_map</span></code> to create a coarse-grained configuration (adjust
the corresponding command in the <code class="docutils literal notranslate"><span class="pre">run.sh</span></code> script to map <code class="docutils literal notranslate"><span class="pre">conf.gro</span></code>
instead of <code class="docutils literal notranslate"><span class="pre">confout.gro</span></code>). Visualize both configurations with vmd.
(execute <code class="docutils literal notranslate"><span class="pre">vmd</span> <span class="pre">conf.gro</span> <span class="pre">&amp;</span></code>)</p>
<p>Create a mapping file where the center of a coarse-grained water
molecule is not the center of mass, but a different one, e.g., the
charge center of the atomistic one.</p>
<p>Run a short MD simulation of a box of SPC/E water using GROMACS. (This
is needed later for the different coarse-graining (CG) methods.) The
input files are in the same folder (<code class="docutils literal notranslate"><span class="pre">csg-tutorials/spce/atomistic/</span></code>).
Due to limited time, decrease the number of steps (<code class="docutils literal notranslate"><span class="pre">nsteps</span></code>) in
<code class="docutils literal notranslate"><span class="pre">grompp.mdp</span></code> to a reasonable value (<code class="docutils literal notranslate"><span class="pre">5000-10000</span></code>) and adjust the
output frequency of the trajectory, .log, and .edr files to, e.g.,
50-100 (<code class="docutils literal notranslate"><span class="pre">nstxout</span></code>, <code class="docutils literal notranslate"><span class="pre">nstfout</span></code>, <code class="docutils literal notranslate"><span class="pre">nstlog</span></code>, nstenergy):</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>gmx<span class="w"> </span>grompp<span class="w"> </span><span class="c1"># combines conf.gro, topol.top, and grompp.mdp, and forcefield.itp (which is in the gromos43a1.ff folder of GROMACS) into topol.tpr</span>
gmx<span class="w"> </span>mdrun<span class="w"> </span>-v<span class="w"> </span><span class="c1"># runs MD integrator. The trajectory is saved to traj.trr</span>
</pre></div>
</div>
<p>Map this short atomistic trajectory to a CG trajectory using <code class="docutils literal notranslate"><span class="pre">csg_map</span></code>
(adjust the corresponding line in the <code class="docutils literal notranslate"><span class="pre">run.sh</span></code> script to map
<code class="docutils literal notranslate"><span class="pre">traj.trr</span></code> onto <code class="docutils literal notranslate"><span class="pre">traj_cg.trr</span></code> instead of <code class="docutils literal notranslate"><span class="pre">conf(out).gro</span></code> to
<code class="docutils literal notranslate"><span class="pre">conf_cg.gro</span></code>.)</p>
</section>
</section>
<section id="iterative-boltzmann-inversion-ibi-for-spc-e-water">
<h2>Iterative Boltzmann inversion (IBI) for SPC/E water<a class="headerlink" href="#iterative-boltzmann-inversion-ibi-for-spc-e-water" title="Link to this heading">¶</a></h2>
<p>Here, a one-site coarse-grained (CG) model of a rigid 3-site water
molecule (SPC/E model) is constructed (see the previous section of the
tutorial) using the iterative Boltzmann inversion (IBI) method. The
center of the CG bead is chosen to be the center of mass (COM) of a
molecule. The target radial distribution function (RDF) is calculated
from the CG bead coordinates obtained by mapping the reference atomistic
trajectory. In the last step, a coarse-grained potential is obtained by
matching the RDFs of the atomisitc and CG systems using the IBI method.
For a more detailed description, look at the following
publication: <a class="reference internal" href="../csg/bibliography.html#ruehle-2009-a" id="id1"><span>[Ruehle:2009.a]</span></a></p>
<section id="atomistic-simulation">
<h3>Atomistic simulation<a class="headerlink" href="#atomistic-simulation" title="Link to this heading">¶</a></h3>
<p>A short atomistic MD simulation has been already run in the last part of
the previous section (see folder: <code class="docutils literal notranslate"><span class="pre">csg-tutorials/spce/atomistic/</span></code>).
You can extract all thermodynamic information (total energy, kinetic
energy, pressure, etc.) from the binary <code class="docutils literal notranslate"><span class="pre">ener.edr</span></code> file using
<code class="docutils literal notranslate"><span class="pre">gmx</span> <span class="pre">energy</span></code>. Running the <code class="docutils literal notranslate"><span class="pre">Extract_Energies.sh</span></code> script does this for
you (see the corresponding command line in the <code class="docutils literal notranslate"><span class="pre">run.sh</span></code> script). It
creates an additional subfolder <code class="docutils literal notranslate"><span class="pre">energies</span></code> with all thermodynamic
information:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>./Extract_Energies.sh<span class="w"> </span><span class="nv">$equi</span><span class="w"> </span><span class="c1">#  The argument $equi is optional. If provided, analysis will start at the corresponding time frame (in GROMACS units, ps) (e.g. 1 to 5)</span>
</pre></div>
</div>
</section>
<section id="calculation-of-rdf">
<h3>Calculation of RDF<a class="headerlink" href="#calculation-of-rdf" title="Link to this heading">¶</a></h3>
<p>Once again, check the mapping file <code class="docutils literal notranslate"><span class="pre">water.xml</span></code>. Atom names listed in
the definition of the COM bead should correspond to those used in the
<code class="docutils literal notranslate"><span class="pre">conf.gro</span></code> file. You can use <code class="docutils literal notranslate"><span class="pre">csg_dump</span></code> to check this:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>csg_dump<span class="w"> </span>--top<span class="w"> </span>topol.tpr
</pre></div>
</div>
<p>Check the options file <code class="docutils literal notranslate"><span class="pre">settings.xml</span></code>. It contains the section of the
corresponding non-bonded interaction (<code class="docutils literal notranslate"><span class="pre">CG-CG</span></code>). After this, calculate
the center of mass RDF:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>csg_stat<span class="w"> </span>--top<span class="w"> </span>topol.tpr<span class="w"> </span>--trj<span class="w"> </span>traj.trr<span class="w"> </span>--cg<span class="w"> </span>water.xml<span class="w"> </span>--options<span class="w"> </span>settings.xml<span class="w"> </span><span class="o">(</span>--nt<span class="w"> </span><span class="m">3</span><span class="w"> </span>--begin<span class="w"> </span><span class="nv">$equi</span><span class="o">)</span><span class="w"> </span><span class="c1"># ( ) denotes additional options: --nt # number of threads to run calculation in parallel with more then one threads (e.g. 3), --begin # time frame in GROMACS units (ps) to start analysis (e.g. 1 to 5)</span>
</pre></div>
</div>
<p>Compare your RDF with <code class="docutils literal notranslate"><span class="pre">CG-CG.dist.tgt</span></code> in <code class="docutils literal notranslate"><span class="pre">csg-tutorials/spce/ibi/</span></code>
which has been calculated with a much longer atomistic simulation run.</p>
</section>
<section id="running-ibi">
<h3>Running IBI<a class="headerlink" href="#running-ibi" title="Link to this heading">¶</a></h3>
<p>Now switch to the folder: <code class="docutils literal notranslate"><span class="pre">csg-tutorials/spce/ibi/</span></code>. Reduce the number
of MD steps in <code class="docutils literal notranslate"><span class="pre">grompp.mdp</span></code> and adjust the equilibration time in the
settings.xml file (<code class="docutils literal notranslate"><span class="pre">cg.gromacs.equi_time</span></code>) to a lower value (time
frame in GROMACS units (ps) at which the analysis of the CG trajectory
is started in each IBI step). Finally, start the IBI iterations:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>csg_inverse<span class="w"> </span>--options<span class="w"> </span>settings.xml
</pre></div>
</div>
<p>At each iteration step, the current CG potential is <code class="docutils literal notranslate"><span class="pre">CG-CG.pot.cur</span></code>.
Then, the CG-MD simulation is performed and the CG-CG RDF
(<code class="docutils literal notranslate"><span class="pre">CG-CG.dist.new</span></code>) is determined. Finally, the CG potential is
updated: <code class="docutils literal notranslate"><span class="pre">CG-CG.pot.new</span></code>.</p>
<p>Calculate the pressure after several iterations using <code class="docutils literal notranslate"><span class="pre">gmx</span> <span class="pre">energy</span></code>.
You can do this by copying the <code class="docutils literal notranslate"><span class="pre">Extract_Energies.sh</span></code> script from the
main folder (<code class="docutils literal notranslate"><span class="pre">csg-tutorials/spce/ibi/</span></code>) to the appropriate step folder
(<code class="docutils literal notranslate"><span class="pre">step_xxx</span></code>) and executing it (type <code class="docutils literal notranslate"><span class="pre">./Extract_Energies.sh</span></code>). Again,
it will create a subfolder energies. You may notice that the pressure of
the CG simulation is significantly too high. This can be adjusted by
applying a pressure correction. To do so, add an appropriate post update
option to the settings file, so that a (simple) pressure correction is
applied. You can check the corresponding section of the manual.</p>
</section>
</section>
<section id="inverse-monte-carlo-imc-for-spc-e-water">
<h2>Inverse Monte Carlo (IMC) for SPC/E water<a class="headerlink" href="#inverse-monte-carlo-imc-for-spc-e-water" title="Link to this heading">¶</a></h2>
<p>Developing a CG potential with the inverse Monte Carlo (IMC) method
works in a similar way as in the IBI example. The IMC procedure, again,
requires the coarse-grained RDF of the single bead mapping based on the
atomistic simulation as input. Therefore, in <code class="docutils literal notranslate"><span class="pre">csg-tutorials/spce/imc</span></code>,
again, the RDF of a long atomistic simulation run is proveded:
<code class="docutils literal notranslate"><span class="pre">CG-CG.dist.tgt</span></code>.</p>
<p>It is required to reduce the number of MD steps in <code class="docutils literal notranslate"><span class="pre">grompp.mdp</span></code> and to
adjust the equilibration time in the <code class="docutils literal notranslate"><span class="pre">settings.xml</span></code> file
(<code class="docutils literal notranslate"><span class="pre">cg.gromacs.equi_time</span></code>) to a lower value. IMC converges faster than
IBI, but needs a better statistical sampling in each CG step. Therefore,
the number of MD steps should be larger than in the IBI tutorial. Start
the IMC iterations:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>csg_inverse<span class="w"> </span>--options<span class="w"> </span>settings.xml
</pre></div>
</div>
<p>Again, the current CG potential is <code class="docutils literal notranslate"><span class="pre">CG-CG.pot.cur</span></code>, the CG-CG RDF is
<code class="docutils literal notranslate"><span class="pre">CG-CG.dist.new</span></code> and the updated CG potential is: <code class="docutils literal notranslate"><span class="pre">CG-CG.pot.new</span></code>.</p>
<p>Calculate the pressure after several iterations using <code class="docutils literal notranslate"><span class="pre">gmx</span> <span class="pre">energy</span></code> and
compare it with the IBI tutorial. You can do this by copying the
<code class="docutils literal notranslate"><span class="pre">Extract_Energies.sh</span></code> script from the main folder
(<code class="docutils literal notranslate"><span class="pre">csg-tutorials/spce/ibi/</span></code>) to the appropriate step folder
(<code class="docutils literal notranslate"><span class="pre">step_xxx</span></code>) and executing it.</p>
</section>
<section id="relative-entropy-re-minimization-for-spc-e-water">
<h2>Relative entropy (RE) minimization for SPC/E water<a class="headerlink" href="#relative-entropy-re-minimization-for-spc-e-water" title="Link to this heading">¶</a></h2>
<p>Relative entropy (RE) minimization based coarse-graining of SPC/E water
works similar to the IBI and the IMC example above. The reference
atomistic simulation and the CG mapping are the same as in the IBI
example. Again, in <code class="docutils literal notranslate"><span class="pre">csg-tutorials/spce/re/</span></code>, the RDF of a long
atomistic simulation run is provided: <code class="docutils literal notranslate"><span class="pre">CG-CG.dist.tgt</span></code>. In this
tutorial, the water-water CG potential is modeled using a cubic B-spline
functional form. An initial guess for the cubic B-spline knot values is
provided in CG-CG.param.init. At each iteration step, the CG potential
table is computed from the current CG parameters (<code class="docutils literal notranslate"><span class="pre">CG-CG.param.cur</span></code>),
the CG-MD simulation is performed, and the CG-CG RDF
(<code class="docutils literal notranslate"><span class="pre">CG-CG.dist.new</span></code>) is determined. Finally, the new CG potential
parameters (<code class="docutils literal notranslate"><span class="pre">CG-CG.param.new</span></code>) are computed using the relative entropy
minimization algorithm. Reduce the number of MD steps in <code class="docutils literal notranslate"><span class="pre">grompp.mdp</span></code>,
adjust the equilibration time in the <code class="docutils literal notranslate"><span class="pre">settings.xml</span></code> file
(<code class="docutils literal notranslate"><span class="pre">cg.gromacs.equi_time</span></code>) and start the RE iterations:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>csg_inverse<span class="w"> </span>--options<span class="w"> </span>settings.xml
</pre></div>
</div>
<p>Again, the current CG potential is <code class="docutils literal notranslate"><span class="pre">CG-CG.pot.cur</span></code>, the CG-CG RDF is
<code class="docutils literal notranslate"><span class="pre">CG-CG.dist.new</span></code> and the updated CG potential is: <code class="docutils literal notranslate"><span class="pre">CG-CG.pot.new</span></code>.</p>
<p>Calculate the pressure after several iterations using <code class="docutils literal notranslate"><span class="pre">gmx</span> <span class="pre">energy</span></code> and
compare it with the IBI tutorial. Again, you can do this by copying the
<code class="docutils literal notranslate"><span class="pre">Extract_Energies.sh</span></code> script from the main folder
(<code class="docutils literal notranslate"><span class="pre">csg-tutorials/spce/ibi/</span></code>) to the appropriate step folder
(<code class="docutils literal notranslate"><span class="pre">step_xxx</span></code>) and executing it. For a more detailed description of the
RE method, look at the following publication: <a class="reference internal" href="../csg/bibliography.html#mashayakrelative" id="id2"><span>[mashayakrelative]</span></a></p>
</section>
<section id="force-matching-for-spc-e-water">
<h2>Force matching for SPC/E water<a class="headerlink" href="#force-matching-for-spc-e-water" title="Link to this heading">¶</a></h2>
<p>We will now derive a non-bonded CG potential for SPC/E using the force
matching method.</p>
<section id="id3">
<h3>Atomistic simulation<a class="headerlink" href="#id3" title="Link to this heading">¶</a></h3>
<p>Basis for the force matching procedure is an atomistic MD simulation.
All files are found in the atomistic folder
(<code class="docutils literal notranslate"><span class="pre">csg-tutorials/spce/atomistic/</span></code>). If you have done the above
tutorials, you have already generated the files of the atomistic md run.
If not, then do so. Adjust the number of time steps to a reasonable
value (<code class="docutils literal notranslate"><span class="pre">5000-10000</span></code>) and also choose an appropriate output frequency
of the trajectory. Make sure, both, coordinates and forces are written
to the trajectory file (<code class="docutils literal notranslate"><span class="pre">nstxout</span></code> and <code class="docutils literal notranslate"><span class="pre">nstfout</span></code> should have the same
value in <code class="docutils literal notranslate"><span class="pre">grompp.mdp</span></code>).</p>
</section>
<section id="force-matching-fm">
<h3>Force matching (FM)<a class="headerlink" href="#force-matching-fm" title="Link to this heading">¶</a></h3>
<p>All files for running the actual force matching calculation can be found
in <code class="docutils literal notranslate"><span class="pre">csg-tutorials/spce/force_matching/</span></code>. Have a look at the settings
file (<code class="docutils literal notranslate"><span class="pre">fmatch.xml</span></code>). In the general force matching section
(<code class="docutils literal notranslate"><span class="pre">cg.fmatch</span></code>), the number of frames to read in simultaneously
(<code class="docutils literal notranslate"><span class="pre">frames_per_block</span></code>) and the type of LS solver (constrainedLS) are
fixed (it is preferred to use constrained LS). The fmatch block of the
interaction (<code class="docutils literal notranslate"><span class="pre">cg.non-bonded.fmatch</span></code>) contains the interaction range
(<code class="docutils literal notranslate"><span class="pre">min</span></code> and <code class="docutils literal notranslate"><span class="pre">max</span></code>), the step size for the internal spline
representation (<code class="docutils literal notranslate"><span class="pre">step</span></code>) and the output step (<code class="docutils literal notranslate"><span class="pre">out_step</span></code>). <code class="docutils literal notranslate"><span class="pre">min</span></code>
and <code class="docutils literal notranslate"><span class="pre">max</span></code> have to be adjusted to be within the range of the RDF (see
the calculation of RDF section of the IBI tutorial). Run the FM
calculation (see also the corresponding line of the <code class="docutils literal notranslate"><span class="pre">run.sh</span></code> script):</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>csg_fmatch<span class="w"> </span>--top<span class="w"> </span>../atomistic/topol.tpr<span class="w"> </span>--trj<span class="w"> </span>../atomistic/traj.trr<span class="w"> </span>--options<span class="w"> </span>fmatch.xml<span class="w"> </span>--cg<span class="w"> </span>water.xml<span class="w"> </span><span class="o">(</span>--begin<span class="w"> </span><span class="nv">$equi</span><span class="w"> </span><span class="o">)</span><span class="w"> </span><span class="c1"># ( ) denotes additional option: , --begin # time frame in GROMACS units (ps) to start analysis (e.g. 1 to 5)</span>
</pre></div>
</div>
<p>To obtain the CG potential, the CG force has to be integrated. (see the
appropriate lines in the <code class="docutils literal notranslate"><span class="pre">run.sh</span></code> script):</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>csg_call<span class="w"> </span>table<span class="w"> </span>integrate<span class="w"> </span>CG-CG.force<span class="w"> </span>CG-CG.pot<span class="w"> </span><span class="c1"># integrates the table</span>
csg_call<span class="w"> </span>table<span class="w"> </span>linearop<span class="w"> </span>CG-CG.pot<span class="w"> </span>CG-CG.pot<span class="w"> </span>-1<span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="c1"># multiplication of all table values by -1 (potential)</span>
</pre></div>
</div>
<p>Change the spline grid (<code class="docutils literal notranslate"><span class="pre">step</span></code>), blocksize, and parameter
constrainedLS. This should provide an overview of the whole procedure.</p>
</section>
<section id="running-of-cg-simulation">
<h3>Running of CG simulation<a class="headerlink" href="#running-of-cg-simulation" title="Link to this heading">¶</a></h3>
<p>To run a CG simulation with GROMACS, the potential has to be converted
to a potential table, GROMACS can read (<code class="docutils literal notranslate"><span class="pre">table_CG_CG.xvg</span></code>). (Check the
inverse section in the <code class="docutils literal notranslate"><span class="pre">fmatch.xml</span></code> for the corresponding options):</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>csg_call<span class="w"> </span>--options<span class="w"> </span>fmatch.xml<span class="w"> </span>--ia-name<span class="w"> </span>CG-CG<span class="w"> </span>--ia-type<span class="w"> </span>non-bonded<span class="w"> </span>convert_potential<span class="w"> </span>gromacs<span class="w"> </span>--clean<span class="w"> </span>input.pot<span class="w"> </span>table_CG_CG.xvg<span class="w"> </span><span class="c1"># calls convert_potential gromacs. Unsampled regions for distances smaller than the min value are extrapolated.</span>
</pre></div>
</div>
<p>To run a CG simulation, you will need the <code class="docutils literal notranslate"><span class="pre">conf.gro</span></code>, <code class="docutils literal notranslate"><span class="pre">topol.top</span></code>,
<code class="docutils literal notranslate"><span class="pre">index.ndx</span></code> and <code class="docutils literal notranslate"><span class="pre">grompp.mdp</span></code> files. You can use the ones of the ibi
tutorial, and adjust the number of timesteps and output settings. Then
run the simulation. Afterwards, you can calculate the RDF and
thermodynamic data as explained in the IBI tutorial. You can also use
the <code class="docutils literal notranslate"><span class="pre">Extract_Energies.sh</span></code> script of the IBI tutorial. When calculating
the RDF from the CG simulation, you don’t need a mapping file and the
<code class="docutils literal notranslate"><span class="pre">--cg</span></code> option can be omitted.</p>
<p>Compare the CG potential, the RDF and thermodynamics with the ones of
the IBI, IMC or RE method (or any other method) and with the atomistic
simulation. You will see that different methods lead to significantly
different interaction potentials and a single site water model with a
pair interaction potential is not capable of reproducing the RDF and
thermodynamics at the same time. (Reason: three-body contributions are
important but cannot be projected onto a two-body coarse-grained force-field.
To see how to calculate analytic non-bonded three-body interactions with VOTCA,
look at the tutorial below).</p>
</section>
</section>
<section id="force-matching-for-spc-e-water-with-3body-sw-interactions">
<span id="csg-tutorials-fm-3body-sw"></span><h2>Force matching for SPC/E water with 3body SW interactions<a class="headerlink" href="#force-matching-for-spc-e-water-with-3body-sw-interactions" title="Link to this heading">¶</a></h2>
<section id="id4">
<h3>Force matching (FM)<a class="headerlink" href="#id4" title="Link to this heading">¶</a></h3>
<p>All files for running the actual force matching calculation can be found in
<code class="docutils literal notranslate"><span class="pre">csg-tutorials/spce/3body_sw/</span></code>. Have a look at the settings file (<code class="docutils literal notranslate"><span class="pre">fmatch.xml</span></code>).
As for the force matching of two-body forces, in the general force matching section
(<code class="docutils literal notranslate"><span class="pre">cg.fmatch</span></code>), the number of frames to read in simultaneously (<code class="docutils literal notranslate"><span class="pre">frames_per_block</span></code>)
and the type of LS solver (constrainedLS) are fixed (it is preferred to use constrained LS).
There are now two non-bonded interaction sections in <code class="docutils literal notranslate"><span class="pre">fmatch.xml</span></code>, one for the
two-body and one for the three-body force indicated with the additional option <code class="docutils literal notranslate"><span class="pre">threebody</span></code>.</p>
<p>The fmatch block of each interaction (<code class="docutils literal notranslate"><span class="pre">cg.non-bonded.fmatch</span></code>) contains
the interaction range (<code class="docutils literal notranslate"><span class="pre">min</span></code> and <code class="docutils literal notranslate"><span class="pre">max</span></code>), the step size for the internal
spline representation (<code class="docutils literal notranslate"><span class="pre">step</span></code>) and the output step (<code class="docutils literal notranslate"><span class="pre">out_step</span></code>). Again, the
<code class="docutils literal notranslate"><span class="pre">min</span></code> and <code class="docutils literal notranslate"><span class="pre">max</span></code> of the two-body force have to be adjusted to be within
the range of the RDF (see the calculation of RDF section of the IBI tutorial).</p>
<p>The three-body force is of the Stillinger-Weber type consisting of a tabulated
angular potential between three water molecules multiplied by two analytical
exponential decay terms as prefactors (see equation (4) of
publication <a class="reference internal" href="../csg/bibliography.html#scherer-understanding-2018" id="id5"><span>[scherer_understanding_2018]</span></a>) The interaction range of the angular
potential has to be adjusted with (<code class="docutils literal notranslate"><span class="pre">min</span></code> and <code class="docutils literal notranslate"><span class="pre">max</span></code>) in units of radians in the fmatch
block (<cite>cg.non-bonded.fmatch</cite>). The parameters <code class="docutils literal notranslate"><span class="pre">fmatch.a</span></code> determine the cutoff and
<code class="docutils literal notranslate"><span class="pre">fmatch.gamma</span></code> the steepness of the two exponential terms. They have to be
adjusted empirically. The values of a=0.37 nm and gamma=0.08 mean that the
three-body potential gets fully switched on in the first interaction shell of
the RDF over a range of 0.08 nm.</p>
<p>Run the FM calculation (see also the corresponding line of the <code class="docutils literal notranslate"><span class="pre">run.sh</span></code> script):</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>csg_fmatch<span class="w"> </span>--top<span class="w"> </span>../atomistic/topol.tpr<span class="w"> </span>--trj<span class="w"> </span>../atomistic/traj.trr<span class="w"> </span>--options<span class="w"> </span>fmatch.xml<span class="w"> </span>--cg<span class="w"> </span>water.xml<span class="w"> </span><span class="o">(</span>--begin<span class="w"> </span><span class="nv">$equi</span><span class="w"> </span><span class="o">)</span><span class="w"> </span><span class="c1"># ( ) denotes additional option: , --begin # time frame in GROMACS units (ps) to start analysis (e.g. 1 to 5)</span>
</pre></div>
</div>
<p>To obtain the two-body CG potential, the CG force has to be integrated.
Before, it is multiplied by a switching function to guarantee a smooth decay to
zero at the pair cutoff. (see the appropriate lines in the <code class="docutils literal notranslate"><span class="pre">run.sh</span></code> script):</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>csg_call<span class="w"> </span>table<span class="w"> </span>switch_border<span class="w"> </span>CG-CG.force<span class="w"> </span>CG-CG.force_switched<span class="w"> </span><span class="m">1</span>.0<span class="w"> </span><span class="c1"># multiplication of all table values at distance &gt; 1.0 with switching function</span>
csg_call<span class="w"> </span>table<span class="w"> </span>integrate<span class="w"> </span>CG-CG.force_switched<span class="w"> </span>CG-CG.pot<span class="w"> </span><span class="c1"># integrates the table</span>
csg_call<span class="w"> </span>table<span class="w"> </span>linearop<span class="w"> </span>CG-CG.pot<span class="w"> </span>CG-CG.pot<span class="w"> </span>-1<span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="c1"># multiplication of all table values by -1 (potential)</span>
</pre></div>
</div>
<p>Due to the functional form ot the SW potential, VOTCA outputs the three-body force
in angular direction, CG-CG-CG.force, as well as the angular potential, CG-CG-CG.pot.
Therefore, the three-body force does not have to be numerically integrated.</p>
<p>Have a look at the two-body potential and compare it to the FM result from above
without three-body interactions. You will see that the resulting two-body force
is significantly more attractive. The reason is that part of the short-range attraction
is compensated by the three-body term as it also has a non-negligible radial force
component.</p>
</section>
<section id="running-of-cg-simulation-with-lammps">
<h3>Running of CG simulation with LAMMPS<a class="headerlink" href="#running-of-cg-simulation-with-lammps" title="Link to this heading">¶</a></h3>
<p>To run a CG simulation with LAMMPS, the potential files have to be converted to
potential tables, LAMMPS can read. For pair forces this is a table format according
to the LAMMPS pair_style table. Have a look at the settings file (<code class="docutils literal notranslate"><span class="pre">convert_tables.xml</span></code>).
The entry (<code class="docutils literal notranslate"><span class="pre">cg.non-bonded.step</span></code>) should be set to the size of the output step of the
pair force table (in this case 0.001 nm). The block (<code class="docutils literal notranslate"><span class="pre">cg.non-bonded.inverse.lammps</span></code>)
contains the table settings of the LAMMPS potential table. The distance units have to be changed
from nm to Ang (<code class="docutils literal notranslate"><span class="pre">scale</span></code>) and the energy units from kJ/mol to kcal/mol (<code class="docutils literal notranslate"><span class="pre">y_scale</span></code>). The setting
of <code class="docutils literal notranslate"><span class="pre">avg_points</span></code> to 1 allows for a smoother extrapolation of the potential to unsampled
regions. Now convert the two-body potential:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>csg_call<span class="w"> </span>--options<span class="w"> </span>convert_tables.xml<span class="w"> </span>--ia-name<span class="w"> </span>CG-CG-CG<span class="w"> </span>--ia-type<span class="w"> </span>angle<span class="w"> </span>convert_potential<span class="w"> </span>lammps<span class="w"> </span>--clean<span class="w"> </span>--no-shift<span class="w"> </span>input_angular.pot<span class="w"> </span>table_CG_CG_CG.txt<span class="w"> </span><span class="c1"># calls convert_potential lammps. Unsampled regions for distances smaller than the min value are extrapolated. The --ia-type angle implies a unit conversion from radiants to degrees and the option --no-shift prevents a shifting of the potential.</span>
</pre></div>
</div>
<p>To run a CG simulation, one needs a LAMMPS data file (<code class="docutils literal notranslate"><span class="pre">spce.data</span></code>) with the CG starting
configuration, an input file (<code class="docutils literal notranslate"><span class="pre">spce.in</span></code>) and a Stillinger-Weber file (<code class="docutils literal notranslate"><span class="pre">spce.sw</span></code>).
You can use the data file of the LAMMPS IBI tutorial (<code class="docutils literal notranslate"><span class="pre">csg-tutorials/spce/atomistic/ibi_lammps</span></code>)
or the one in this folder containing 1000 CG water molecules. (You can check how the converted
2-body and 3-body tables should look like in: <code class="docutils literal notranslate"><span class="pre">csg-tutorials/ml/3body_reference</span></code>).
The LAMMPS input file has to be adjusted to include the tabulated two-body (<em>pair_style table</em>),
as well as, three-body SW (<em>pair_style sw/angle/table</em>) interactions. Therefore it contains the
additional lines:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">pair_style</span>&#160;&#160;&#160;&#160;&#160; <span class="pre">hybrid/overlay</span> <span class="pre">table</span> <span class="pre">linear</span> <span class="pre">1200</span> <span class="pre">sw/angle/table</span></code> - use a combination of <em>pair_style table</em> with 1200 linear table entries and the <em>pair_style sw/angle/table</em></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pair_coeff</span>&#160;&#160;&#160;&#160;&#160; <span class="pre">1</span> <span class="pre">1</span> <span class="pre">table</span> <span class="pre">table_CG_CG.txt</span> <span class="pre">VOTCA</span></code> - set the table name and keyword for the <em>pair_style table</em></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pair_coeff</span>&#160;&#160;&#160;&#160;&#160; <span class="pre">*</span> <span class="pre">*</span> <span class="pre">sw/angle/table</span> <span class="pre">spce.sw</span> <span class="pre">type</span></code> - set the name of the Stillinger-Weber file for the <em>pair_style sw/angle/table</em></p></li>
</ul>
<p>The Stillinger-Weber file is a file containing the parameters of the SW potential.
For a detailed description, have a look at the LAMMPS documentation. Additional lines
link to the tabulated angular potential:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">table_CG_CG_CG.txt</span></code> - file name of tabulated angular potential</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">VOTCA</span></code> - keyword for tabulated angular potential</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">linear</span></code> - angular table is of linear style</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">1001</span></code> - 1001 table entries</p></li>
</ul>
<p>The <em>pair_style sw/angle/table</em> is included in the MANYBODY package of the LAMMPS
stable release from the 23rd of June 2022. Therefore, you have to compile a recent LAMMPS
version &lt;<a class="reference external" href="https://github.com/lammps/lammps">https://github.com/lammps/lammps</a>&gt; with the MANYBODY package to run the simulation. The additional source
files (<code class="docutils literal notranslate"><span class="pre">pair_sw_angle_table.cpp</span></code>) and header (<code class="docutils literal notranslate"><span class="pre">pair_sw_angle_table.h</span></code>)
are also available at &lt;<a class="reference external" href="https://gitlab.mpcdf.mpg.de/votca/lammps">https://gitlab.mpcdf.mpg.de/votca/lammps</a>&gt;.</p>
<p>Once compiled LAMMPS, you can run the simulation with the following command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>lmp<span class="w"> </span>&lt;<span class="w"> </span>spce.in<span class="w"> </span>&gt;<span class="w"> </span>spce.out<span class="w"> </span><span class="c1"># runs LAMMPS and store log file with thermodynamic output in spce.out.</span>
</pre></div>
</div>
<p>If you have installed and want to run LAMMPS with MPI parallelization, use the
command <code class="docutils literal notranslate"><span class="pre">mpirun</span> <span class="pre">-np</span> <span class="pre">n_proc</span> <span class="pre">lmp_mpi</span></code> where <code class="docutils literal notranslate"><span class="pre">n_proc</span></code> stands for the number of processors.
Adjust the appropriate line in the <code class="docutils literal notranslate"><span class="pre">run.sh</span></code> script. You can calculate the RDF and the angular
distribution with:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>csg_stat<span class="w"> </span>--options<span class="w"> </span>calculate_distributions.xml<span class="w"> </span>--top<span class="w"> </span>traj.dump<span class="w"> </span>--trj<span class="w"> </span>traj.dump<span class="w"> </span><span class="c1"># call csg_stat with different settings.xml file</span>
</pre></div>
</div>
<p>Now have a look at <code class="docutils literal notranslate"><span class="pre">calculate_distributions.xml</span></code>. It has two <code class="docutils literal notranslate"><span class="pre">cg.non-bonded</span></code> blocks for
the calculating the RDF and the angular distribution function between three CG sites.
Have in mind that the distance units of the LAMMPS simulation are Ang and the beadtype in
the LAMMPS trajectory file is now <code class="docutils literal notranslate"><span class="pre">1</span></code> instead of <code class="docutils literal notranslate"><span class="pre">CG</span></code> in the mapped atomistic GROMACS
trajectory. The option <code class="docutils literal notranslate"><span class="pre">cg.non-bonded.threebody</span></code> has to be set to <code class="docutils literal notranslate"><span class="pre">true</span></code> to calculate
an angular distribution function between all beads within a cutoff of <code class="docutils literal notranslate"><span class="pre">cg.non-bonded.cut</span></code>.
Change the value of <code class="docutils literal notranslate"><span class="pre">cg.non-bonded.cut</span></code> and see, how the angular distribution function changes.
Now, calculate the angular distribution also for the atomistic and the coarse-grained two-body
FM and IBI, IMC or RE models. To do so adjust the <code class="docutils literal notranslate"><span class="pre">calculate_distributions.xml</span></code> file
(<code class="docutils literal notranslate"><span class="pre">min</span></code>, <code class="docutils literal notranslate"><span class="pre">max</span></code>, and <code class="docutils literal notranslate"><span class="pre">step</span></code> to either nm or Ang) and bead types
(<code class="docutils literal notranslate"><span class="pre">type1</span></code>, <code class="docutils literal notranslate"><span class="pre">type2</span></code>, and <code class="docutils literal notranslate"><span class="pre">type3</span></code>). Now, compare the RDF, the angular distribution and
thermodynamics with the ones of the two-body FM, IBI, IMC or RE method (or any other method)
and with the atomistic simulation. You will see that the RDF, angular distribution and
thermodynamics (e.g. pressure in spce.out) are in much better agreement with the atomistic
simulation than e.g. for two-body FM.</p>
</section>
</section>
<section id="visualization-of-ibi-updates">
<h2>Visualization of IBI updates<a class="headerlink" href="#visualization-of-ibi-updates" title="Link to this heading">¶</a></h2>
<p>Go to the folder <code class="docutils literal notranslate"><span class="pre">csg-tutorials/spce/realtime</span></code>. Execute the <code class="docutils literal notranslate"><span class="pre">run.sh</span></code>
script.</p>
</section>
<section id="coarse-graining-of-liquid-methanol">
<h2>Coarse-graining of liquid methanol<a class="headerlink" href="#coarse-graining-of-liquid-methanol" title="Link to this heading">¶</a></h2>
<p>In the folder <code class="docutils literal notranslate"><span class="pre">csg-tutorials/methanol/</span></code>, you will find all relevant
files to run an atomistic simulation of liquid methanol and obtain CG
potentials with the IBI, IMC and FM method. Look at the SPC/E water
tutorial to learn how to do this. You can compare the differences of the
CG potentials, RDFs and thermodynamics between the different CG schemes
and the atomistic simulation to the differences of the SPC/E water
simulations. You will see that in the case of methanol, a pair potential
is a better approximation to an ideal CG potential as in the SPC/E water
case. The reason is that non-bonded 3-body effects are less important.</p>
</section>
<section id="coarse-graining-of-liquid-hexane">
<h2>Coarse-graining of liquid hexane<a class="headerlink" href="#coarse-graining-of-liquid-hexane" title="Link to this heading">¶</a></h2>
<p>Go to the folder <code class="docutils literal notranslate"><span class="pre">csg-tutorials/hexane/</span></code>. So far, we only considered
single bead mappings. Hexane is a small alkane molecule. In this
tutorial, a 3 bead CG mapping with one bond type and one angle type is
chosen.</p>
<section id="id6">
<h3>Atomistic simulation<a class="headerlink" href="#id6" title="Link to this heading">¶</a></h3>
<p>Go into the <code class="docutils literal notranslate"><span class="pre">csg-tutorials/hexane/atomistic/</span></code> folder. Have a look at
the mapping file <code class="docutils literal notranslate"><span class="pre">hexane.xml</span></code>. The hexane molecule is mapped to 3
beads with two different bead types with two bonds (of the same type)
and one angle. You will find all relevant GROMACS input files in the
folder. Have a look at the <code class="docutils literal notranslate"><span class="pre">run.sh</span></code> script. Again, adjust the number
of time steps and the output frequencies in grompp.mdp and run an
atomistic simulation. Extract the thermodynamic information
(<code class="docutils literal notranslate"><span class="pre">./Extract_Energies.sh</span></code>) and calculate the 3 different RDFs (A-A,
B-B, A-B) and the bond and angle distributions with <code class="docutils literal notranslate"><span class="pre">csg_stat</span></code>. In
addition, you can compute the bond and angle distributions with
<code class="docutils literal notranslate"><span class="pre">csg_boltzmann</span></code> (see <code class="docutils literal notranslate"><span class="pre">run_boltzmann.sh</span></code>) Compare the distributions
to those in <code class="docutils literal notranslate"><span class="pre">csg-tutorials/hexane/ibi_all</span></code> obtained by a significantly
longer atomistic MD run. You can map the (final) .gro file of the
atomistic simuation to the CG one to get all necessary information for
running the IBI procedure.</p>
</section>
<section id="ibi-for-all-interactions">
<h3>IBI for all interactions<a class="headerlink" href="#ibi-for-all-interactions" title="Link to this heading">¶</a></h3>
<p>Go to the folder <code class="docutils literal notranslate"><span class="pre">csg-tutorials/hexane/ibi_all</span></code>. The folder contains
target RDFs and bond and angle distributions from a longer atomistic MD
run. Have a look at the <code class="docutils literal notranslate"><span class="pre">settings.xml</span></code> file. It contains the sections
for the non-bonded and bonded interactions. The three non-bonded
interactions are updated every 3rd iteration step (first A-A, then B-B
and then A-B, etc., see the <code class="docutils literal notranslate"><span class="pre">cg.non-bonded.inverse.do_potential</span></code>
section). The bonded interactions are updated every iteration step.
Adjust the number of time steps and output frequency in the
<code class="docutils literal notranslate"><span class="pre">grompp.mdp</span></code> file and the equilibration time in the <code class="docutils literal notranslate"><span class="pre">settings.xml</span></code>
file (<code class="docutils literal notranslate"><span class="pre">cg.inverse.gromacs.equi_time</span></code>) and start the IBI iterations.
Calculate the pressure after several iterations using <code class="docutils literal notranslate"><span class="pre">gmx</span> <span class="pre">energy</span></code>.
You can do this by copying the <code class="docutils literal notranslate"><span class="pre">Extract_Energies.sh</span></code> script from the
main folder (<code class="docutils literal notranslate"><span class="pre">csg-tutorials/spce/ibi/</span></code>) to the appropriate step folder
(<code class="docutils literal notranslate"><span class="pre">step_xxx</span></code>) and executing it.</p>
</section>
<section id="ibi-for-non-bonded-interactions-only">
<h3>IBI for non-bonded interactions only<a class="headerlink" href="#ibi-for-non-bonded-interactions-only" title="Link to this heading">¶</a></h3>
<p>Go to the folder <code class="docutils literal notranslate"><span class="pre">csg-tutorials/hexane/ibi_nonbonded</span></code>. The folder
contains the same target RDFs as the <code class="docutils literal notranslate"><span class="pre">csg-tutorials/hexane/ibi_all</span></code>
folder. In addition, it contains the tabulated bond and angle potentials
(<code class="docutils literal notranslate"><span class="pre">table_b1.xvg</span></code> and <code class="docutils literal notranslate"><span class="pre">table_a1.xvg</span></code>). They are obtained by
(non-iterative) Boltzmann inversion of the bond and angle target
distribution functions of a longer MD simulation run. You can compute
them with <code class="docutils literal notranslate"><span class="pre">csg_boltzmann</span></code> (see the <code class="docutils literal notranslate"><span class="pre">run_boltzmann.sh</span></code> script). A
lack of statistics will become most apparent at lower values of the
angle. In this case you might want to adjust the min value in the
<code class="docutils literal notranslate"><span class="pre">boltzmann_cmds</span></code> file. Compare your results with the pre-computed ones
(<code class="docutils literal notranslate"><span class="pre">table_b1.xvg</span></code> and <code class="docutils literal notranslate"><span class="pre">table_a1.xvg</span></code>) and with the ones in the
subfolder <code class="docutils literal notranslate"><span class="pre">step_001</span></code> in <code class="docutils literal notranslate"><span class="pre">csg-tutorials/hexane/ibi_all</span></code> Again, adjust
the number of time steps and equilibration time and start the iteration
process. Calculate the pressure and compare the thermodynamic properties
as well as the obtained non-bonded potentials with the ones of the
<code class="docutils literal notranslate"><span class="pre">csg-tutorials/hexane/ibi_all</span> <span class="pre">tutorial</span></code>. Calculate the bond and angle
distributions (This can be done with <code class="docutils literal notranslate"><span class="pre">csg_stat</span></code>, using the
<code class="docutils literal notranslate"><span class="pre">settings.xml</span></code> file and the <code class="docutils literal notranslate"><span class="pre">hexane_cg.xml</span></code> mapping file of the
<code class="docutils literal notranslate"><span class="pre">csg-tutorials/hexane/ibi_all</span></code> folder.)</p>
</section>
<section id="fm-for-all-interactions-together">
<h3>FM for all interactions together<a class="headerlink" href="#fm-for-all-interactions-together" title="Link to this heading">¶</a></h3>
<p>Go to the folder <code class="docutils literal notranslate"><span class="pre">csg-tutorials/hexane/force_matching</span></code>. The folder
contains the hexane mapping file with bond and angle interactions
(<code class="docutils literal notranslate"><span class="pre">hexane.xml</span></code>) and the force matching options file (<code class="docutils literal notranslate"><span class="pre">fmatch.xml</span></code>).
Have a look at both files and the <code class="docutils literal notranslate"><span class="pre">run.sh</span></code> script and start the force
matching procedure. Basis is the atomistic trajectory with force output
in <code class="docutils literal notranslate"><span class="pre">csg-tutorials/hexane/atomistic</span></code>. Integrate the force output to
obtain the potentials and convert them to GROMACS tables. (see the
<code class="docutils literal notranslate"><span class="pre">run.sh</span></code> script). Compare the obtained potentials to the IBI
potentials. You can run CG simulations with the CG potentials, again,
using the <code class="docutils literal notranslate"><span class="pre">conf.gro</span></code>, <code class="docutils literal notranslate"><span class="pre">topol.top</span></code>, <code class="docutils literal notranslate"><span class="pre">index.ndx</span></code> and <code class="docutils literal notranslate"><span class="pre">grompp.mdp</span></code>
files from the <code class="docutils literal notranslate"><span class="pre">csg-tutorials/hexane/ibi_all</span></code> folder. Calculate the
RDFs, bond and angle distributions. When comparing the results to the
IBI potentials, you will see that in some cases, force matching can have
problems with bonded interactions, especially if the functional form of
the coarse-grained force field lacks essential interactions such as
bond-angle or 3-body correlations. In such cases it can help to perform
force matching only on the non-bonded contributions as was shown
here: <a class="reference internal" href="../csg/bibliography.html#ruhle2011hybrid" id="id7"><span>[ruhle2011hybrid]</span></a>.</p>
</section>
<section id="fm-for-non-bonded-interactions-only">
<h3>FM for non-bonded interactions only<a class="headerlink" href="#fm-for-non-bonded-interactions-only" title="Link to this heading">¶</a></h3>
<p>The files for the tutorial can be found in
<code class="docutils literal notranslate"><span class="pre">csg-tutorials/hexane/hybrid_force_matching/</span></code>. The folder should
contain all necessary files to reproduce the plots from the
publication <a class="reference internal" href="../csg/bibliography.html#ruhle2011hybrid" id="id8"><span>[ruhle2011hybrid]</span></a>. To be able
to parametrize only the non-bonded interactions via force matching, an
atomistic trajectory has to be generated containing only forces
contributing to the non-bonded interactions, meaning all other
contributions need to be excluded. This is achieved by generating a
second atomistic topoly file. Have a look at the topol.top file and
compare it to the one in <code class="docutils literal notranslate"><span class="pre">csg-tutorials/hexane/atomistic/</span></code>. All bonded
interactions have been deleted. Furthermore, all intramolecular
interactions have been explicitly excluded. Generate the binary GROMACS
topology file using this <code class="docutils literal notranslate"><span class="pre">topol.top</span></code> file and the <code class="docutils literal notranslate"><span class="pre">conf.gro</span></code> and
<code class="docutils literal notranslate"><span class="pre">grommp.mdp</span></code> file of the reference atomistic trajectory
(<code class="docutils literal notranslate"><span class="pre">csg-tutorials/hexane/atomistic/</span></code>). Then, generate the trajectory
file with excluded bonded interactions using <code class="docutils literal notranslate"><span class="pre">gmx</span> <span class="pre">mdrun</span></code> with the
<code class="docutils literal notranslate"><span class="pre">-rerun</span></code> option. (Have a look at the corresponding lines of the
<code class="docutils literal notranslate"><span class="pre">run.sh</span></code> script). Have a look at the <code class="docutils literal notranslate"><span class="pre">fmatch.xml</span></code> file. It now only
contains the non-bonded interactions. Start the FM calculation.
Afterwards, intergrate the force output and convert the potentials to
GROMACS tables (see the <code class="docutils literal notranslate"><span class="pre">run.sh</span></code> script). You can run the CG
simulation, using the <code class="docutils literal notranslate"><span class="pre">conf.gro</span></code>, <code class="docutils literal notranslate"><span class="pre">topol.top</span></code>, <code class="docutils literal notranslate"><span class="pre">index.ndx</span></code> and
<code class="docutils literal notranslate"><span class="pre">grompp.mdp</span></code> files and the bond and angle potential (<code class="docutils literal notranslate"><span class="pre">table_b1.xvg</span></code>
and <code class="docutils literal notranslate"><span class="pre">table_a1.xvg</span></code>) from the <code class="docutils literal notranslate"><span class="pre">csg-tutorials/hexane/ibi_nonbonded/</span></code>
folder. Calculate the RDFs, bond and angle distributions and compare the
results to the IBI results and FM of all interactions together.</p>
</section>
</section>
<section id="regularization-of-the-inverse-monte-carlo-method">
<h2>Regularization of the inverse Monte Carlo method<a class="headerlink" href="#regularization-of-the-inverse-monte-carlo-method" title="Link to this heading">¶</a></h2>
<p>For this tutorial go to the folder <code class="docutils literal notranslate"><span class="pre">csg-tutorials/LJ1-LJ2/imc</span></code>.
Inverse Monte Carlo (IMC) needs a well defined cross-correlation matrix
for which enough sampling is needed. If there is not enough sampling the
algorithm might not converge to a stable solution. This might also
happen if the initial potential guess for the iterative scheme is too
far away from the real solution of the inverse problem. To overcome this
deficiency and to stabilize the algorithm one could apply the so called
Tikhonov regularization, which is a common technique to regularize
ill-posed inverse problems. For further information on the Tikhonov
regularization and/or ill-posed inverse problems in general don’t
hesitate to have a look at the manual at section
<a class="reference internal" href="../csg/theory.html#theory-inverse-monte-carlo-regularization"><span class="std std-ref">Regularization of Inverse Monte Carlo</span></a>
to get a short overview or for a more detailed description at this
publication <a class="reference internal" href="../csg/bibliography.html#rosenberger-2016" id="id9"><span>[Rosenberger:2016]</span></a>
or consult any book of choice on regularization of inverse problems.</p>
<p>This tutorial can be considered to be a proof of concept. It is based on
the above mentioned
publication: <a class="reference internal" href="../csg/bibliography.html#rosenberger-2016" id="id10"><span>[Rosenberger:2016]</span></a>.
Here the user should get familiar with the application of the Tikhonov
regularization and should see its benefit. The file <code class="docutils literal notranslate"><span class="pre">run.sh</span></code> will
execute a preliminary run of 10 steps of iterative Boltzmann inverson
(IBI) before the IMC method is applied. The users should figure out what
happens if the preliminary IBI steps are skipped and should test
different regularization parameters (e.g. 10,100.300,1000). The folder
also contains a short python script which performs a singular value
decomposition of the cross-correlation matrix (<code class="docutils literal notranslate"><span class="pre">svd.py</span></code>). Based on
this decomposition one could get an educated guess on the order of the
magnitude of the regularization parameter. It should be larger than the
smallest singular values squared and smaller compared to the larger
ones.</p>
</section>
<section id="additional-tutorials">
<h2>Additional tutorials<a class="headerlink" href="#additional-tutorials" title="Link to this heading">¶</a></h2>
<p>Have a look in the folder <code class="docutils literal notranslate"><span class="pre">csg-tutorials</span></code>. It contains additional
tutorials on propane, methanol-water and urea-water mixtures. To do the
tutorials, have a look at the corresponding <code class="docutils literal notranslate"><span class="pre">run.sh</span></code> scripts.</p>
</section>
<section id="advanced-topics">
<h2>Advanced topics<a class="headerlink" href="#advanced-topics" title="Link to this heading">¶</a></h2>
<section id="extending-the-scripting-framework">
<h3>Extending the scripting framework<a class="headerlink" href="#extending-the-scripting-framework" title="Link to this heading">¶</a></h3>
<p>Write a post update script, which smooths the tail of a potential by
transforming <code class="docutils literal notranslate"><span class="pre">dU(r)</span></code> to <code class="docutils literal notranslate"><span class="pre">s(r)dU(r)</span></code> with</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">s</span><span class="p">(</span><span class="n">r</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">for</span> <span class="n">r</span> <span class="o">&lt;</span> <span class="n">rt</span>
<span class="n">s</span><span class="p">(</span><span class="n">r</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span><span class="o">-</span><span class="p">(</span><span class="n">rc</span><span class="o">-</span><span class="n">rt</span><span class="p">)</span><span class="o">-</span><span class="mi">3</span><span class="p">(</span><span class="n">r</span> <span class="o">-</span> <span class="n">rt</span><span class="p">)</span><span class="mi">2</span><span class="p">(</span><span class="mi">3</span><span class="n">rc</span><span class="o">-</span><span class="n">rt</span><span class="o">-</span><span class="mi">2</span><span class="n">r</span><span class="p">)</span> <span class="k">for</span> <span class="n">rt</span> <span class="o">&lt;</span> <span class="n">r</span> <span class="o">&lt;</span> <span class="n">rc</span>
<span class="n">s</span><span class="p">(</span><span class="n">r</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">r</span> <span class="o">&gt;</span> <span class="n">rt</span>
</pre></div>
</div>
<p>Hints: Start from <code class="docutils literal notranslate"><span class="pre">skeleton.pl</span></code> and use <code class="docutils literal notranslate"><span class="pre">pressure_cor_simple.pl</span></code> as
a template.</p>
</section>
<section id="writing-an-analysis-tool">
<h3>Writing an analysis tool<a class="headerlink" href="#writing-an-analysis-tool" title="Link to this heading">¶</a></h3>
<p>VOTCA allows to write your own analysis code. There are many examples
and two templates for serial and threaded analysis. If you are willing
to learn how to write your own analysis in C++, ask for assistance.</p>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../xtp/bibliography.html" class="btn btn-neutral float-left" title="8. Bibliography" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../xtp-tutorials/XTP-TUTORIAL.html" class="btn btn-neutral float-right" title="XTP Tutorials" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, VOTCA Development Team.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>