<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>QMMM workflow using GROMACS and VOTCA-XTP &mdash; VOTCA 2025.1-dev documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/custom.css" type="text/css" />
      <link rel="stylesheet" href="../_static/nbsphinx-code-cells.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/documentation_options.js?v=ba612e73"></script>
        <script src="../_static/doctools.js?v=9bcbadda"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Developer and Contributor Guide" href="../DEVELOPERS_GUIDE.html" />
    <link rel="prev" title="Single Point Energy using pyxtp" href="single_point.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html">
            
              <img src="../_static/customLogo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../INSTALL.html">Installation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Manuals</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tools/index.html">TOOLS Manual</a></li>
<li class="toctree-l1"><a class="reference internal" href="../csg/index.html">CSG Manual</a></li>
<li class="toctree-l1"><a class="reference internal" href="../xtp/XTP-MANUAL.html">XTP Manual</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="XTP-TUTORIAL.html">XTP Tutorials</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="DFTGWBSE_ENERGY.html">DFT + GWBSE Energy Calculation Using CH4</a></li>
<li class="toctree-l2"><a class="reference internal" href="geometry_optimization.html">Atomic Forces and Geometry Optimizaiton</a></li>
<li class="toctree-l2"><a class="reference internal" href="single_point.html">Single Point Energy using <code class="docutils literal notranslate"><span class="pre">pyxtp</span></code></a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">QMMM workflow using GROMACS and VOTCA-XTP</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#What-is-this-tutorial-about">What is this tutorial about</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Requirements">Requirements</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Interacting-with-the-XTP-command-line-interface">Interacting with the XTP command line interface</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Note">Note</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#Setting-the-environment">Setting the environment</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Generate-the-topology-from-the-Gromacs-file">Generate the topology from the Gromacs file</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Check-the-mapping">Check the mapping</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Neighborlist-Calculation">Neighborlist Calculation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Read-reorganization-energies">Read reorganization energies</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Compute-site-energy">Compute site energy</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Site-energy-and-pair-energy-analysis">Site energy and pair energy analysis</a></li>
<li class="toctree-l3"><a class="reference internal" href="#QM-energy-calculation">QM energy calculation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#QM-calculation-for-pairs">QM calculation for pairs</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Coupling">Coupling</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Coupling-analysis">Coupling analysis</a></li>
<li class="toctree-l3"><a class="reference internal" href="#QMMM-calculations">QMMM calculations</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Development</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../DEVELOPERS_GUIDE.html">Developer and Contributor Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../VOTCA_LANGUAGE_GUIDE.html">VOTCA Internal Contributor Language Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Architecture.html">The architecture of VOTCA</a></li>
<li class="toctree-l1"><a class="reference internal" href="../xtp/Architecture.html">Architecture of votca-xtp</a></li>
<li class="toctree-l1"><a class="reference internal" href="../CODE_OF_CONDUCT.html">Code of Conduct</a></li>
<li class="toctree-l1"><a class="reference internal" href="../websiteAndDocumentation.html">Website and Documentation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Community</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://github.com/votca">GitHub</a></li>
<li class="toctree-l1"><a class="reference external" href="https://twitter.com/votca_software">Twitter</a></li>
<li class="toctree-l1"><a class="reference external" href="https://groups.google.com/g/votca">Forum</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">VOTCA</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="XTP-TUTORIAL.html">XTP Tutorials</a></li>
      <li class="breadcrumb-item active">QMMM workflow using GROMACS and VOTCA-XTP</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/xtp-tutorials/QMMM_GROMACS.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="QMMM-workflow-using-GROMACS-and-VOTCA-XTP">
<h1>QMMM workflow using GROMACS and VOTCA-XTP<a class="headerlink" href="#QMMM-workflow-using-GROMACS-and-VOTCA-XTP" title="Link to this heading">¶</a></h1>
<section id="What-is-this-tutorial-about">
<h2>What is this tutorial about<a class="headerlink" href="#What-is-this-tutorial-about" title="Link to this heading">¶</a></h2>
<p>In this tutorial, we will learn how to set and perform excited state calculation using the Votca XTP library. We will use methane as our QM region.</p>
</section>
<section id="Requirements">
<h2>Requirements<a class="headerlink" href="#Requirements" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p>You will need to install <strong>VOTCA</strong> using the instructions described <a class="reference external" href="https://github.com/votca/votca/blob/master/share/sphinx/INSTALL.rst">here</a></p></li>
<li><p>Once the installation is completed you need to activate the VOTCA enviroment by running the <code class="docutils literal notranslate"><span class="pre">VOTCARC.bash</span></code> script that has been installed at the bin subfolder for the path that you have provided for the installation step above</p></li>
</ul>
</section>
<section id="Interacting-with-the-XTP-command-line-interface">
<h2>Interacting with the XTP command line interface<a class="headerlink" href="#Interacting-with-the-XTP-command-line-interface" title="Link to this heading">¶</a></h2>
<p>The XTP package offers the following command line interface that the user can interact with:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://www.votca.org/xtp/xtp_map.html">xtp_map</a></p></li>
<li><p><a class="reference external" href="https://www.votca.org/xtp/xtp_parallel.html">xtp_parallel</a></p></li>
<li><p><a class="reference external" href="https://www.votca.org/xtp/xtp_run.html">xtp_run</a></p></li>
<li><p><a class="reference external" href="https://www.votca.org/xtp/xtp_tools.html">xtp_tools</a></p></li>
</ul>
<p>Run the following command to view the help message of <code class="docutils literal notranslate"><span class="pre">xtp_tools</span></code>:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>xtp_tools<span class="w"> </span>-h
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
==================================================
========   VOTCA (http://www.votca.org)   ========
==================================================

please read and cite: https://doi.org/10.21105/joss.06864
and submit bugs to https://github.com/votca/votca/issues

xtp_tools, version 2025.1-dev gitid: dca3e5a (compiled Nov  1 2025, 04:42:47)

Runs excitation/charge transport tools



Allowed options:
  -h [ --help ]                 display this help and exit
  --verbose                     be loud and noisy
  --verbose1                    be very loud and noisy
  -v [ --verbose2 ]             be extremly loud and noisy
  -o [ --options ] arg          Tool user options.
  -t [ --nthreads ] arg (=1)    number of threads to create
  -e [ --execute ] arg        Name of Tool to run
  -l [ --list ]               Lists all available Tools
  -d [ --description ] arg    Short description of a Tools
  -c [ --cmdoptions ] arg     Modify options via command line by e.g. &#39;-c
                              xmltag.subtag=value&#39;. Use whitespace to separate
                              multiple options
  -p [ --printoptions ] arg   Prints xml options of a Tool

</pre></div></div>
</div>
<section id="Note">
<h3>Note<a class="headerlink" href="#Note" title="Link to this heading">¶</a></h3>
<blockquote>
<div><ul class="simple">
<li><p>In Jupyter the <code class="docutils literal notranslate"><span class="pre">!</span></code> symbol means: <em>run the following command as a standard unix command</em></p></li>
<li><p>In Jupyter the command <code class="docutils literal notranslate"><span class="pre">%env</span></code> set an environmental variable</p></li>
</ul>
</div></blockquote>
</section>
</section>
<section id="Setting-the-environment">
<h2>Setting the environment<a class="headerlink" href="#Setting-the-environment" title="Link to this heading">¶</a></h2>
<p>Remove previous hdf5 file</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>rm<span class="w"> </span>-f<span class="w"> </span>state.hdf5
</pre></div>
</div>
</div>
</section>
<section id="Generate-the-topology-from-the-Gromacs-file">
<h2>Generate the topology from the Gromacs file<a class="headerlink" href="#Generate-the-topology-from-the-Gromacs-file" title="Link to this heading">¶</a></h2>
<p>runs the mapping from MD coordinates to segments and creates an <a class="reference external" href="https://www.hdfgroup.org/solutions/hdf5/">hdf5 file</a>. You can explore the generated <code class="docutils literal notranslate"><span class="pre">state.hdf5</span></code> file with e.g. hdf5itebrowser. In Python, you can use the <a class="reference external" href="https://www.h5py.org/">h5py library</a>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>xtp_map<span class="w"> </span>-t<span class="w"> </span>MD_FILES/topol.tpr<span class="w"> </span>-c<span class="w"> </span>MD_FILES/conf.gro<span class="w"> </span>-s<span class="w"> </span>system.xml<span class="w"> </span>-f<span class="w"> </span>state.hdf5
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
==================================================
========   VOTCA (http://www.votca.org)   ========
==================================================

please read and cite: https://doi.org/10.21105/joss.06864
and submit bugs to https://github.com/votca/votca/issues

xtp_map, version 2025.1-dev gitid: dca3e5a (compiled Nov  1 2025, 04:42:47)

an error occurred:
Error &#39;tpr&#39; file format of file &#39;MD_FILES/topol.tpr&#39; cannot be read or written
</pre></div></div>
</div>
</section>
<section id="Check-the-mapping">
<h2>Check the mapping<a class="headerlink" href="#Check-the-mapping" title="Link to this heading">¶</a></h2>
<p>Let us first output <code class="docutils literal notranslate"><span class="pre">.pdb</span></code> files for the segments, qmmolecules and classical segments in order to check the mapping. Use <code class="docutils literal notranslate"><span class="pre">xtp_run</span> <span class="pre">-d</span> <span class="pre">mapchecker</span></code> to see all options <code class="docutils literal notranslate"><span class="pre">mapchecker</span></code> calculator takes. We use the <code class="docutils literal notranslate"><span class="pre">-c</span></code> option to change one option on the commandline.</p>
<p>In the <a class="reference external" href="https://votca.github.io/xtp/mapchecker.html">mapchecker section of the manual</a> you can find a table with the <code class="docutils literal notranslate"><span class="pre">mapchecker</span></code> input variables and their corresponding defaults. Finally, the following command run the check</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>xtp_run<span class="w"> </span>-e<span class="w"> </span>mapchecker<span class="w"> </span>-c<span class="w"> </span><span class="nv">map_file</span><span class="o">=</span>system.xml<span class="w"> </span>-f<span class="w"> </span>state.hdf5
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
==================================================
========   VOTCA (http://www.votca.org)   ========
==================================================

please read and cite: https://doi.org/10.21105/joss.06864
and submit bugs to https://github.com/votca/votca/issues

xtp_run, version 2025.1-dev gitid: dca3e5a (compiled Nov  1 2025, 04:42:47)

an error occurred:
Could not access file state.hdf5 with permission to read.

</pre></div></div>
</div>
</section>
<section id="Neighborlist-Calculation">
<h2>Neighborlist Calculation<a class="headerlink" href="#Neighborlist-Calculation" title="Link to this heading">¶</a></h2>
<p>The following step is to determine the neighbouring pairs for exciton transport. See the <a class="reference external" href="https://www.votca.org/xtp/neighborlist.html">neighborlist options</a> for further information.</p>
<p>Finally, we can run the calculation using 4 threads</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>xtp_run<span class="w"> </span>-e<span class="w"> </span>neighborlist<span class="w"> </span>-c<span class="w"> </span><span class="nv">exciton_cutoff</span><span class="o">=</span><span class="m">0</span>.5<span class="w"> </span><span class="nv">constant</span><span class="o">=</span><span class="m">0</span>.6<span class="w"> </span>-f<span class="w"> </span>state.hdf5<span class="w"> </span>-t<span class="w"> </span><span class="m">4</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
==================================================
========   VOTCA (http://www.votca.org)   ========
==================================================

please read and cite: https://doi.org/10.21105/joss.06864
and submit bugs to https://github.com/votca/votca/issues

xtp_run, version 2025.1-dev gitid: dca3e5a (compiled Nov  1 2025, 04:42:47)

an error occurred:
Could not access file state.hdf5 with permission to read.

</pre></div></div>
</div>
</section>
<section id="Read-reorganization-energies">
<h2>Read reorganization energies<a class="headerlink" href="#Read-reorganization-energies" title="Link to this heading">¶</a></h2>
<p>In this step we will read the in site reorganization energies and store them in the <code class="docutils literal notranslate"><span class="pre">state.hdf5</span></code> file. We just need to copy the input file and execute the calculation. The side energies have to be calculated by the user beforehand and put into an xml file. We added them to <code class="docutils literal notranslate"><span class="pre">system.xml</span></code></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>xtp_run<span class="w"> </span>-e<span class="w"> </span>einternal<span class="w"> </span>-c<span class="w"> </span><span class="nv">energies_file</span><span class="o">=</span>system.xml<span class="w"> </span>-f<span class="w"> </span>state.hdf5
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
==================================================
========   VOTCA (http://www.votca.org)   ========
==================================================

please read and cite: https://doi.org/10.21105/joss.06864
and submit bugs to https://github.com/votca/votca/issues

xtp_run, version 2025.1-dev gitid: dca3e5a (compiled Nov  1 2025, 04:42:47)

an error occurred:
Could not access file state.hdf5 with permission to read.

</pre></div></div>
</div>
</section>
<section id="Compute-site-energy">
<h2>Compute site energy<a class="headerlink" href="#Compute-site-energy" title="Link to this heading">¶</a></h2>
<p>In this step we will perform some <em>QMMM</em> calculations to compute the site energies. The <code class="docutils literal notranslate"><span class="pre">qmmm_mm.xml</span></code> file contains some predefined settings to perform the <em>MM</em> calculations. Let us first copy these settings into the state file. Instead of using the <code class="docutils literal notranslate"><span class="pre">-c</span></code> option we now use the <code class="docutils literal notranslate"><span class="pre">-o</span></code> option to read in options from an xml file.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>xtp_parallel<span class="w"> </span>-e<span class="w"> </span>qmmm<span class="w"> </span>-o<span class="w"> </span>qmmm_mm.xml<span class="w"> </span>-f<span class="w"> </span>state.hdf5<span class="w"> </span>-j<span class="w"> </span><span class="s2">&quot;write&quot;</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
==================================================
========   VOTCA (http://www.votca.org)   ========
==================================================

please read and cite: https://doi.org/10.21105/joss.06864
and submit bugs to https://github.com/votca/votca/issues

xtp_parallel, version 2025.1-dev gitid: dca3e5a (compiled Nov  1 2025, 04:42:47)

an error occurred:
Could not access file state.hdf5 with permission to read.

</pre></div></div>
</div>
<p>The previous command generates a <code class="docutils literal notranslate"><span class="pre">qmmm_mm_jobs.xml</span></code> containing 4000 <em>MM</em> jobs to compute, if you examine that file, it should look something like</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;jobs&gt;</span>
<span class="w">  </span><span class="nt">&lt;job&gt;</span>
<span class="w">    </span><span class="nt">&lt;id&gt;</span>0<span class="nt">&lt;/id&gt;</span>
<span class="w">    </span><span class="nt">&lt;tag&gt;</span>Methane_0:n<span class="nt">&lt;/tag&gt;</span>
<span class="w">    </span><span class="nt">&lt;input&gt;</span>
<span class="w">      </span><span class="nt">&lt;site_energies&gt;</span>0:n<span class="nt">&lt;/site_energies&gt;</span>
<span class="w">      </span><span class="nt">&lt;regions&gt;</span>
<span class="w">        </span><span class="nt">&lt;region&gt;</span>
<span class="w">          </span><span class="nt">&lt;id&gt;</span>0<span class="nt">&lt;/id&gt;</span>
<span class="w">          </span><span class="nt">&lt;segments&gt;</span>0:n<span class="nt">&lt;/segments&gt;</span>
<span class="w">        </span><span class="nt">&lt;/region&gt;</span>
<span class="w">      </span><span class="nt">&lt;/regions&gt;</span>
<span class="w">    </span><span class="nt">&lt;/input&gt;</span>
<span class="w">    </span><span class="nt">&lt;status&gt;</span>AVAILABLE<span class="nt">&lt;/status&gt;</span>
<span class="w">  </span><span class="nt">&lt;/job&gt;</span>
...
</pre></div>
</div>
<p>Let us run just the first 4 jobs by settings all jobs <code class="docutils literal notranslate"><span class="pre">status</span></code> to <code class="docutils literal notranslate"><span class="pre">COMPLETE</span></code> except for the first four. This can be easily done with <a class="reference external" href="https://www.gnu.org/software/sed/manual/sed.html">sed</a> as follows,</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>sed<span class="w"> </span>-i<span class="w"> </span><span class="s2">&quot;s/AVAILABLE/COMPLETE/g&quot;</span><span class="w"> </span>qmmm_mm_jobs.xml
<span class="o">!</span>sed<span class="w"> </span>-i<span class="w"> </span><span class="s1">&#39;0,/COMPLETE/s/COMPLETE/AVAILABLE/&#39;</span><span class="w"> </span>qmmm_mm_jobs.xml
<span class="o">!</span>sed<span class="w"> </span>-i<span class="w"> </span><span class="s1">&#39;0,/COMPLETE/s/COMPLETE/AVAILABLE/&#39;</span><span class="w"> </span>qmmm_mm_jobs.xml
<span class="o">!</span>sed<span class="w"> </span>-i<span class="w"> </span><span class="s1">&#39;0,/COMPLETE/s/COMPLETE/AVAILABLE/&#39;</span><span class="w"> </span>qmmm_mm_jobs.xml
<span class="o">!</span>sed<span class="w"> </span>-i<span class="w"> </span><span class="s1">&#39;0,/COMPLETE/s/COMPLETE/AVAILABLE/&#39;</span><span class="w"> </span>qmmm_mm_jobs.xml
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
sed: can&#39;t read qmmm_mm_jobs.xml: No such file or directory
sed: can&#39;t read qmmm_mm_jobs.xml: No such file or directory
sed: can&#39;t read qmmm_mm_jobs.xml: No such file or directory
sed: can&#39;t read qmmm_mm_jobs.xml: No such file or directory
sed: can&#39;t read qmmm_mm_jobs.xml: No such file or directory
</pre></div></div>
</div>
<p>Now we can run the jobs and save the results in the state file</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>xtp_parallel<span class="w"> </span>-e<span class="w"> </span>qmmm<span class="w"> </span>-o<span class="w"> </span>qmmm_mm.xml<span class="w"> </span>-f<span class="w"> </span>state.hdf5<span class="w"> </span>-x<span class="w"> </span><span class="m">2</span><span class="w"> </span>-j<span class="w"> </span><span class="s2">&quot;run&quot;</span>
<span class="o">!</span>xtp_parallel<span class="w"> </span>-e<span class="w"> </span>qmmm<span class="w"> </span>-o<span class="w"> </span>qmmm_mm.xml<span class="w"> </span>-f<span class="w"> </span>state.hdf5<span class="w"> </span>-j<span class="w"> </span><span class="s2">&quot;read&quot;</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
==================================================
========   VOTCA (http://www.votca.org)   ========
==================================================

please read and cite: https://doi.org/10.21105/joss.06864
and submit bugs to https://github.com/votca/votca/issues

xtp_parallel, version 2025.1-dev gitid: dca3e5a (compiled Nov  1 2025, 04:42:47)

an error occurred:
Could not access file state.hdf5 with permission to read.

==================================================
========   VOTCA (http://www.votca.org)   ========
==================================================

please read and cite: https://doi.org/10.21105/joss.06864
and submit bugs to https://github.com/votca/votca/issues

xtp_parallel, version 2025.1-dev gitid: dca3e5a (compiled Nov  1 2025, 04:42:47)

an error occurred:
Could not access file state.hdf5 with permission to read.

</pre></div></div>
</div>
</section>
<section id="Site-energy-and-pair-energy-analysis">
<h2>Site energy and pair energy analysis<a class="headerlink" href="#Site-energy-and-pair-energy-analysis" title="Link to this heading">¶</a></h2>
<p>In this step we generate an histogram and compute the correlation function of site energies and pair energy differences.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>xtp_run<span class="w"> </span>-e<span class="w"> </span>eanalyze<span class="w"> </span>-f<span class="w"> </span>state.hdf5
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
==================================================
========   VOTCA (http://www.votca.org)   ========
==================================================

please read and cite: https://doi.org/10.21105/joss.06864
and submit bugs to https://github.com/votca/votca/issues

xtp_run, version 2025.1-dev gitid: dca3e5a (compiled Nov  1 2025, 04:42:47)

an error occurred:
Could not access file state.hdf5 with permission to read.

</pre></div></div>
</div>
<p>You should now see a set of files prefixed with <code class="docutils literal notranslate"><span class="pre">eanalyze</span></code> containing the histrogram and correlation functions.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>ls<span class="w"> </span>eanalyze*
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
ls: cannot access &#39;eanalyze*&#39;: No such file or directory
</pre></div></div>
</div>
</section>
<section id="QM-energy-calculation">
<h2>QM energy calculation<a class="headerlink" href="#QM-energy-calculation" title="Link to this heading">¶</a></h2>
<p>Our next task is to perform the qm calculations for each segment that we have stored in the hdf5 file. The calculations take place in 3 stages: write the jobs to a file, perform the computation and finally save the results to the state file. We provided a small options file to make the computation cheaper.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>cat<span class="w"> </span>eqm.xml
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;?xml version=&#34;1.0&#34;?&gt;
&lt;options&gt;
  &lt;eqm help=&#34;Executes qm calculations for individual molecules&#34; section=&#34;sec:eqm&#34;&gt;
    &lt;map_file&gt;system.xml&lt;/map_file&gt;
    &lt;gwbse&gt;
      &lt;gw&gt;
        &lt;mode&gt;G0W0&lt;/mode&gt;
      &lt;/gw&gt;
      &lt;bse&gt;
        &lt;exctotal&gt;10&lt;/exctotal&gt;
      &lt;/bse&gt;
      &lt;ranges&gt;full&lt;/ranges&gt;
    &lt;/gwbse&gt;
    &lt;dftpackage&gt;
      &lt;basisset&gt;3-21G&lt;/basisset&gt;
      &lt;auxbasisset&gt;aux-def2-svp&lt;/auxbasisset&gt;
    &lt;/dftpackage&gt;
  &lt;/eqm&gt;
&lt;/options&gt;
</pre></div></div>
</div>
<p>We set the GWBSE mode to <code class="docutils literal notranslate"><span class="pre">G0W0</span></code>, the <code class="docutils literal notranslate"><span class="pre">ranges</span></code> to <code class="docutils literal notranslate"><span class="pre">full</span></code> and the <code class="docutils literal notranslate"><span class="pre">basisset</span></code> and <code class="docutils literal notranslate"><span class="pre">auxbasisset</span></code> to <code class="docutils literal notranslate"><span class="pre">3-21G</span></code> and <code class="docutils literal notranslate"><span class="pre">aux-def2-svp</span></code>. For more information, check the <a class="reference external" href="https://votca.github.io/xtp/eqm.html">eqm calculator options</a>. For the sake of computational time let just compute the <code class="docutils literal notranslate"><span class="pre">gw</span></code> approximation and the <code class="docutils literal notranslate"><span class="pre">singlet</span></code>. You can also request the <code class="docutils literal notranslate"><span class="pre">triplet</span></code> or <code class="docutils literal notranslate"><span class="pre">all</span></code></p>
<p>First we will write the job in a file and enable only the first 2,</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>xtp_parallel<span class="w"> </span>-e<span class="w"> </span>eqm<span class="w"> </span>-o<span class="w"> </span>eqm.xml<span class="w"> </span>-f<span class="w"> </span>state.hdf5<span class="w"> </span>-s<span class="w"> </span><span class="m">0</span><span class="w"> </span>-j<span class="w"> </span><span class="s2">&quot;write&quot;</span>
<span class="o">!</span>sed<span class="w"> </span>-i<span class="w"> </span><span class="s2">&quot;s/AVAILABLE/COMPLETE/g&quot;</span><span class="w"> </span>eqm.jobs
<span class="o">!</span>sed<span class="w"> </span>-i<span class="w"> </span><span class="s1">&#39;0,/COMPLETE/s/COMPLETE/AVAILABLE/&#39;</span><span class="w"> </span>eqm.jobs
<span class="o">!</span>sed<span class="w"> </span>-i<span class="w"> </span><span class="s1">&#39;0,/COMPLETE/s/COMPLETE/AVAILABLE/&#39;</span><span class="w"> </span>eqm.jobs
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
==================================================
========   VOTCA (http://www.votca.org)   ========
==================================================

please read and cite: https://doi.org/10.21105/joss.06864
and submit bugs to https://github.com/votca/votca/issues

xtp_parallel, version 2025.1-dev gitid: dca3e5a (compiled Nov  1 2025, 04:42:47)

an error occurred:
Could not access file state.hdf5 with permission to read.

sed: can&#39;t read eqm.jobs: No such file or directory
sed: can&#39;t read eqm.jobs: No such file or directory
sed: can&#39;t read eqm.jobs: No such file or directory
</pre></div></div>
</div>
<p>Now, let run these 2 jobs</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>xtp_parallel<span class="w"> </span>-e<span class="w"> </span>eqm<span class="w"> </span>-o<span class="w"> </span>eqm.xml<span class="w"> </span>-f<span class="w"> </span>state.hdf5<span class="w"> </span>-x<span class="w"> </span><span class="m">2</span><span class="w"> </span>-s<span class="w"> </span><span class="m">0</span><span class="w"> </span>-j<span class="w"> </span>run<span class="w"> </span>-q<span class="w"> </span><span class="m">1</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
==================================================
========   VOTCA (http://www.votca.org)   ========
==================================================

please read and cite: https://doi.org/10.21105/joss.06864
and submit bugs to https://github.com/votca/votca/issues

xtp_parallel, version 2025.1-dev gitid: dca3e5a (compiled Nov  1 2025, 04:42:47)

an error occurred:
Could not access file state.hdf5 with permission to read.

</pre></div></div>
</div>
</section>
<section id="QM-calculation-for-pairs">
<h2>QM calculation for pairs<a class="headerlink" href="#QM-calculation-for-pairs" title="Link to this heading">¶</a></h2>
<p>In the following step we will run QM calculations for each pair in the hdf5 file. As the calculations on the previous step, we will first write the jobs in a file, then run them and finally store the results in the state file. First, we need to copy the input to our local folder</p>
<p>As in the previous section, we set the GWBSE mode to <code class="docutils literal notranslate"><span class="pre">G0W0</span></code>, the <code class="docutils literal notranslate"><span class="pre">ranges</span></code> to <code class="docutils literal notranslate"><span class="pre">full</span></code> and the <code class="docutils literal notranslate"><span class="pre">basisset</span></code> and <code class="docutils literal notranslate"><span class="pre">auxbasisset</span></code> to <code class="docutils literal notranslate"><span class="pre">3-21G</span></code> and <code class="docutils literal notranslate"><span class="pre">aux-def2-svp</span></code>. But we compute only the <code class="docutils literal notranslate"><span class="pre">gw</span></code> approximation, as the BSE is formed in the coupling step only once and we do not have to diagonalize it. For more information, check the <a class="reference external" href="https://www.votca.org/xtp/iqm.html">iqm calculator options</a>. We only compute the <code class="docutils literal notranslate"><span class="pre">singlet</span></code> couplings.</p>
<p>Before running the calculations, we need to specify in the <code class="docutils literal notranslate"><span class="pre">iqm</span></code> input which states to read into the jobfile for each segment type.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>cat<span class="w"> </span>iqm.xml
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;?xml version=&#34;1.0&#34;?&gt;
&lt;options&gt;
  &lt;iqm help=&#34;Executes qm calculations for individual molecules&#34; section=&#34;sec:eqm&#34;&gt;
    &lt;map_file&gt;system.xml&lt;/map_file&gt;
    &lt;gwbse&gt;
      &lt;tasks&gt;gw&lt;/tasks&gt;
      &lt;gw&gt;
        &lt;mode&gt;G0W0&lt;/mode&gt;
      &lt;/gw&gt;
      &lt;ranges&gt;full&lt;/ranges&gt;
    &lt;/gwbse&gt;
    &lt;dftpackage&gt;
      &lt;basisset&gt;3-21G&lt;/basisset&gt;
      &lt;auxbasisset&gt;aux-def2-svp&lt;/auxbasisset&gt;
    &lt;/dftpackage&gt;
    &lt;bsecoupling&gt;
      &lt;spin&gt;singlet&lt;/spin&gt;
    &lt;/bsecoupling&gt;
    &lt;readjobfile help=&#34;which states to read into the jobfile for each segment type&#34;&gt;
      &lt;singlet&gt;Methane:s1&lt;/singlet&gt;
      &lt;triplet&gt;Methane:t1&lt;/triplet&gt;
      &lt;electron&gt;Methane:e1&lt;/electron&gt;
      &lt;hole&gt;Methane:h1&lt;/hole&gt;
    &lt;/readjobfile&gt;
  &lt;/iqm&gt;
&lt;/options&gt;
</pre></div></div>
</div>
<p>Now, let’s write the jobs to the file</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>xtp_parallel<span class="w"> </span>-e<span class="w"> </span>iqm<span class="w"> </span>-o<span class="w"> </span>iqm.xml<span class="w"> </span>-f<span class="w"> </span>state.hdf5<span class="w"> </span>-s<span class="w"> </span><span class="m">0</span><span class="w"> </span>-j<span class="w"> </span><span class="s2">&quot;write&quot;</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
==================================================
========   VOTCA (http://www.votca.org)   ========
==================================================

please read and cite: https://doi.org/10.21105/joss.06864
and submit bugs to https://github.com/votca/votca/issues

xtp_parallel, version 2025.1-dev gitid: dca3e5a (compiled Nov  1 2025, 04:42:47)

an error occurred:
Could not access file state.hdf5 with permission to read.

</pre></div></div>
</div>
<p>From the jobs that we just write down, let’s make available only the first job</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>sed<span class="w"> </span>-i<span class="w"> </span><span class="s2">&quot;s/AVAILABLE/COMPLETE/g&quot;</span><span class="w"> </span>iqm.jobs
<span class="o">!</span>sed<span class="w"> </span>-i<span class="w"> </span><span class="s1">&#39;0,/COMPLETE/s/COMPLETE/AVAILABLE/&#39;</span><span class="w"> </span>iqm.jobs
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
sed: can&#39;t read iqm.jobs: No such file or directory
sed: can&#39;t read iqm.jobs: No such file or directory
</pre></div></div>
</div>
<p>Now we can run and store the jobs results</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>xtp_parallel<span class="w"> </span>-e<span class="w"> </span>iqm<span class="w"> </span>-o<span class="w"> </span>iqm.xml<span class="w"> </span>-f<span class="w"> </span>state.hdf5<span class="w"> </span>-x<span class="w"> </span><span class="m">2</span><span class="w"> </span>-s<span class="w"> </span><span class="m">0</span><span class="w"> </span>-j<span class="w"> </span>run<span class="w"> </span>-q<span class="w"> </span><span class="m">1</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
==================================================
========   VOTCA (http://www.votca.org)   ========
==================================================

please read and cite: https://doi.org/10.21105/joss.06864
and submit bugs to https://github.com/votca/votca/issues

xtp_parallel, version 2025.1-dev gitid: dca3e5a (compiled Nov  1 2025, 04:42:47)

an error occurred:
Could not access file state.hdf5 with permission to read.

</pre></div></div>
</div>
<p>Finally, we read the results into the state</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>xtp_parallel<span class="w"> </span>-e<span class="w"> </span>iqm<span class="w"> </span>-o<span class="w"> </span>iqm.xml<span class="w"> </span>-f<span class="w"> </span>state.hdf5<span class="w"> </span>-j<span class="w"> </span><span class="s2">&quot;read&quot;</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
==================================================
========   VOTCA (http://www.votca.org)   ========
==================================================

please read and cite: https://doi.org/10.21105/joss.06864
and submit bugs to https://github.com/votca/votca/issues

xtp_parallel, version 2025.1-dev gitid: dca3e5a (compiled Nov  1 2025, 04:42:47)

an error occurred:
Could not access file state.hdf5 with permission to read.

</pre></div></div>
</div>
</section>
<section id="Coupling">
<h2>Coupling<a class="headerlink" href="#Coupling" title="Link to this heading">¶</a></h2>
<p>We can now compute the classical coupling of transition in the aformentioned three stages,</p>
<p>We need to change in the <code class="docutils literal notranslate"><span class="pre">iexcitoncl</span></code> input the name <code class="docutils literal notranslate"><span class="pre">map_file</span></code> option and add the state. check all the available of the <a class="reference external" href="https://www.votca.org/xtp/iexcitoncl.html">iexcitoncl calculator</a>. We do this via the commandline using the <code class="docutils literal notranslate"><span class="pre">-c</span></code> option.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>xtp_parallel<span class="w"> </span>-e<span class="w"> </span>iexcitoncl<span class="w"> </span>-c<span class="w"> </span><span class="nv">map_file</span><span class="o">=</span>system.xml<span class="w"> </span><span class="nv">states</span><span class="o">=</span>Methane:n2s1<span class="w"> </span>-f<span class="w"> </span>state.hdf5<span class="w"> </span>-j<span class="w"> </span><span class="s2">&quot;write&quot;</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
==================================================
========   VOTCA (http://www.votca.org)   ========
==================================================

please read and cite: https://doi.org/10.21105/joss.06864
and submit bugs to https://github.com/votca/votca/issues

xtp_parallel, version 2025.1-dev gitid: dca3e5a (compiled Nov  1 2025, 04:42:47)

an error occurred:
Could not access file state.hdf5 with permission to read.

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>head<span class="w"> </span>-n<span class="w"> </span><span class="m">15</span><span class="w"> </span>exciton.jobs
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
head: cannot open &#39;exciton.jobs&#39; for reading: No such file or directory
</pre></div></div>
</div>
<p>Now we can run and save the jobs. For demo purposes we will run only the first job</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>sed<span class="w"> </span>-i<span class="w"> </span><span class="s2">&quot;s/AVAILABLE/COMPLETE/g&quot;</span><span class="w"> </span>exciton.jobs
<span class="o">!</span>sed<span class="w"> </span>-i<span class="w"> </span><span class="s1">&#39;0,/COMPLETE/s/COMPLETE/AVAILABLE/&#39;</span><span class="w"> </span>exciton.jobs
<span class="o">!</span>xtp_parallel<span class="w"> </span>-e<span class="w"> </span>iexcitoncl<span class="w"> </span>-c<span class="w"> </span><span class="nv">map_file</span><span class="o">=</span>system.xml<span class="w"> </span><span class="nv">states</span><span class="o">=</span>Methane:n2s1<span class="w"> </span>-f<span class="w"> </span>state.hdf5
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
sed: can&#39;t read exciton.jobs: No such file or directory
sed: can&#39;t read exciton.jobs: No such file or directory
==================================================
========   VOTCA (http://www.votca.org)   ========
==================================================

please read and cite: https://doi.org/10.21105/joss.06864
and submit bugs to https://github.com/votca/votca/issues

xtp_parallel, version 2025.1-dev gitid: dca3e5a (compiled Nov  1 2025, 04:42:47)

an error occurred:
Could not access file state.hdf5 with permission to read.

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>xtp_parallel<span class="w"> </span>-e<span class="w"> </span>iexcitoncl<span class="w"> </span>-c<span class="w"> </span><span class="nv">map_file</span><span class="o">=</span>system.xml<span class="w"> </span>-f<span class="w"> </span>state.hdf5<span class="w"> </span>-j<span class="w"> </span><span class="s2">&quot;read&quot;</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
==================================================
========   VOTCA (http://www.votca.org)   ========
==================================================

please read and cite: https://doi.org/10.21105/joss.06864
and submit bugs to https://github.com/votca/votca/issues

xtp_parallel, version 2025.1-dev gitid: dca3e5a (compiled Nov  1 2025, 04:42:47)

an error occurred:
Could not access file state.hdf5 with permission to read.

</pre></div></div>
</div>
</section>
<section id="Coupling-analysis">
<h2>Coupling analysis<a class="headerlink" href="#Coupling-analysis" title="Link to this heading">¶</a></h2>
<p>Using the coupling computed in the previous steps, we will generate an histogram for the squared couplings in logarithmic scale,</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>xtp_run<span class="w"> </span>-e<span class="w"> </span>ianalyze<span class="w"> </span>-c<span class="w"> </span><span class="nv">states</span><span class="o">=</span>e,h,s<span class="w"> </span>-f<span class="w"> </span>state.hdf5
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
==================================================
========   VOTCA (http://www.votca.org)   ========
==================================================

please read and cite: https://doi.org/10.21105/joss.06864
and submit bugs to https://github.com/votca/votca/issues

xtp_run, version 2025.1-dev gitid: dca3e5a (compiled Nov  1 2025, 04:42:47)

an error occurred:
Could not access file state.hdf5 with permission to read.

</pre></div></div>
</div>
</section>
<section id="QMMM-calculations">
<h2>QMMM calculations<a class="headerlink" href="#QMMM-calculations" title="Link to this heading">¶</a></h2>
<p>Finally let us run a proper qmmm calculation using the qmmm calculator</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>cat<span class="w"> </span>qmmm.xml
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;?xml version=&#34;1.0&#34;?&gt;
&lt;options&gt;
  &lt;qmmm help=&#34;Executes qmmm calculations for individual molecules and clusters&#34; section=&#34;sec:qmmm&#34;&gt;
    &lt;print_regions_pdb help=&#34;print the geometry of the regions to a pdb file&#34;&gt;true&lt;/print_regions_pdb&gt;
    &lt;max_iterations help=&#34;max iterations for qmmm scf loop&#34;&gt;50&lt;/max_iterations&gt;
    &lt;map_file help=&#34;xml file with segment definition&#34;&gt;system.xml&lt;/map_file&gt;
    &lt;job_file help=&#34;name of jobfile to which jobs are written&#34;&gt;qmmm_jobs.xml&lt;/job_file&gt;
    &lt;io_jobfile&gt;
    &lt;states&gt;n s1 t1&lt;/states&gt;
    &lt;/io_jobfile&gt;
    &lt;regions&gt;
      &lt;qmregion help=&#34;definition of a region&#34;&gt;
        &lt;id help=&#34;id of a region has to start from 0&#34;&gt;0&lt;/id&gt;
        &lt;gwbse&gt;
          &lt;gw&gt;
            &lt;mode&gt;G0W0&lt;/mode&gt;
          &lt;/gw&gt;
          &lt;bse&gt;
            &lt;exctotal&gt;10&lt;/exctotal&gt;
          &lt;/bse&gt;
          &lt;ranges&gt;full&lt;/ranges&gt;
        &lt;/gwbse&gt;
        &lt;dftpackage&gt;
          &lt;basisset&gt;3-21G&lt;/basisset&gt;
          &lt;auxbasisset&gt;aux-def2-svp&lt;/auxbasisset&gt;
        &lt;/dftpackage&gt;
        &lt;statetracker&gt;
          &lt;overlap&gt;0.8&lt;/overlap&gt;
        &lt;/statetracker&gt;
        &lt;state help=&#34;qmstate to calculate i.e. n or s1&#34;&gt;jobfile&lt;/state&gt;
        &lt;segments help=&#34;which segments to include in this region and which geometry they have&#34;&gt;jobfile&lt;/segments&gt;
      &lt;/qmregion&gt;
      &lt;polarregion&gt;
        &lt;id&gt;1&lt;/id&gt;
        &lt;cutoff&gt;
          &lt;geometry&gt;n&lt;/geometry&gt;
          &lt;radius&gt;1&lt;/radius&gt;
          &lt;region&gt;0&lt;/region&gt;
        &lt;/cutoff&gt;
      &lt;/polarregion&gt;
      &lt;staticregion&gt;
        &lt;id&gt;2&lt;/id&gt;
        &lt;cutoff&gt;
          &lt;geometry&gt;n&lt;/geometry&gt;
          &lt;radius&gt;1.4&lt;/radius&gt;
          &lt;region&gt;0&lt;/region&gt;
        &lt;/cutoff&gt;
      &lt;/staticregion&gt;
    &lt;/regions&gt;
  &lt;/qmmm&gt;
&lt;/options&gt;
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>xtp_parallel<span class="w"> </span>-e<span class="w"> </span>qmmm<span class="w"> </span>-o<span class="w"> </span>qmmm.xml<span class="w"> </span>-f<span class="w"> </span>state.hdf5<span class="w"> </span>-j<span class="w"> </span><span class="s2">&quot;write&quot;</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
==================================================
========   VOTCA (http://www.votca.org)   ========
==================================================

please read and cite: https://doi.org/10.21105/joss.06864
and submit bugs to https://github.com/votca/votca/issues

xtp_parallel, version 2025.1-dev gitid: dca3e5a (compiled Nov  1 2025, 04:42:47)

an error occurred:
Could not access file state.hdf5 with permission to read.

</pre></div></div>
</div>
<p>Lets run just the first job</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>sed<span class="w"> </span>-i<span class="w"> </span><span class="s2">&quot;s/AVAILABLE/COMPLETE/g&quot;</span><span class="w"> </span>qmmm_jobs.xml
<span class="o">!</span>sed<span class="w"> </span>-i<span class="w"> </span><span class="s1">&#39;0,/COMPLETE/s/COMPLETE/AVAILABLE/&#39;</span><span class="w"> </span>qmmm_jobs.xml
<span class="o">!</span>sed<span class="w"> </span>-i<span class="w"> </span><span class="s1">&#39;0,/COMPLETE/s/COMPLETE/AVAILABLE/&#39;</span><span class="w"> </span>qmmm_jobs.xml
<span class="o">!</span>xtp_parallel<span class="w"> </span>-e<span class="w"> </span>qmmm<span class="w"> </span>-o<span class="w"> </span>qmmm.xml<span class="w"> </span>-x<span class="w"> </span><span class="m">2</span><span class="w"> </span>-f<span class="w"> </span>state.hdf5<span class="w"> </span>-j<span class="w"> </span>run
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
sed: can&#39;t read qmmm_jobs.xml: No such file or directory
sed: can&#39;t read qmmm_jobs.xml: No such file or directory
sed: can&#39;t read qmmm_jobs.xml: No such file or directory
==================================================
========   VOTCA (http://www.votca.org)   ========
==================================================

please read and cite: https://doi.org/10.21105/joss.06864
and submit bugs to https://github.com/votca/votca/issues

xtp_parallel, version 2025.1-dev gitid: dca3e5a (compiled Nov  1 2025, 04:42:47)

an error occurred:
Could not access file state.hdf5 with permission to read.

</pre></div></div>
</div>
<p>Finally, save the results. We could read them in but that is a bit pointless. Maybe check out how to turn a checkpoint file into an or orbfile (look at the scripts) and visualise it with the <code class="docutils literal notranslate"><span class="pre">gencube</span></code> tool.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="ch">#!xtp_parallel -e qmmm -o OPTIONFILES/qmmm.xml -f state.hdf5 -j &quot;read&quot;</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="single_point.html" class="btn btn-neutral float-left" title="Single Point Energy using pyxtp" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../DEVELOPERS_GUIDE.html" class="btn btn-neutral float-right" title="Developer and Contributor Guide" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, VOTCA Development Team.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>