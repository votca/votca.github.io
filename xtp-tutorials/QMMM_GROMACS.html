

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>QMMM workflow using GROMACS and VOTCA-XTP &mdash; VOTCA 2022-dev documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/theme_overrides.css" type="text/css" />

  
  

  
  

  

  
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="QMMM workflow using LAMMPS and VOTCA-XTP" href="QMMM_LAMMPS.html" />
    <link rel="prev" title="DFT + GWBSE Optimization Using CO" href="DFTGWBSE_OPTIMIZATION.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html">
          

          
            
            <img src="../_static/customLogo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../INSTALL.html">Installation</a></li>
</ul>
<p class="caption"><span class="caption-text">Manuals</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tools/index.html">TOOLS Manual</a></li>
<li class="toctree-l1"><a class="reference internal" href="../csg/index.html">CSG Manual</a></li>
<li class="toctree-l1"><a class="reference internal" href="../xtp/XTP-MANUAL.html">XTP Manual</a></li>
</ul>
<p class="caption"><span class="caption-text">Tutorials</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../csg-tutorials/README.html">CSG Tutorial</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="XTP-TUTORIAL.html">XTP Tutorials</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="help.html">Support</a></li>
<li class="toctree-l2"><a class="reference internal" href="DFTGWBSE_ENERGY.html">DFT + GWBSE Energy Calculation Using CH4</a></li>
<li class="toctree-l2"><a class="reference internal" href="DFTGWBSE_OPTIMIZATION.html">DFT + GWBSE Optimization Using CO</a></li>
<li class="toctree-l2"><a class="reference internal" href="DFTGWBSE_OPTIMIZATION.html#Introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="DFTGWBSE_OPTIMIZATION.html#Requirements">Requirements</a></li>
<li class="toctree-l2"><a class="reference internal" href="DFTGWBSE_OPTIMIZATION.html#Preparing-the-input">Preparing the input</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">QMMM workflow using GROMACS and VOTCA-XTP</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#What-is-this-tutorial-about">What is this tutorial about</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Requirements">Requirements</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Interacting-with-the-XTP-command-line-interface">Interacting with the XTP command line interface</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Note">Note</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#Setting-the-environment">Setting the environment</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Generate-the-topology-from-the-Gromacs-file">Generate the topology from the Gromacs file</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Check-the-mapping">Check the mapping</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Neighborlist-Calculation">Neighborlist Calculation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Read-reorganization-energies">Read reorganization energies</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Compute-site-energy">Compute site energy</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Site-energy-and-pair-energy-analysis">Site energy and pair energy analysis</a></li>
<li class="toctree-l3"><a class="reference internal" href="#QM-energy-calculation">QM energy calculation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#QM-calculation-for-pairs">QM calculation for pairs</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Coupling">Coupling</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Coupling-analysis">Coupling analysis</a></li>
<li class="toctree-l3"><a class="reference internal" href="#QMMM-calculations">QMMM calculations</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="QMMM_LAMMPS.html">QMMM workflow using LAMMPS and VOTCA-XTP</a></li>
<li class="toctree-l2"><a class="reference internal" href="LAMMPS_KMC.html">Kinect Monte Carlo Simulations Using LAMMPS</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Development</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../DEVELOPERS_GUIDE.html">Developer and Contributor Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../VOTCA_LANGUAGE_GUIDE.html">VOTCA Internal Contributor Language Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../CODE_OF_CONDUCT.html">Code of Conduct</a></li>
<li class="toctree-l1"><a class="reference internal" href="../websiteAndDocumentation.html">Website and Documentation</a></li>
</ul>
<p class="caption"><span class="caption-text">Community</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://github.com/votca">GitHub</a></li>
<li class="toctree-l1"><a class="reference external" href="https://twitter.com/votca_software">Twitter</a></li>
<li class="toctree-l1"><a class="reference external" href="https://groups.google.com/g/votca">Forum</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">VOTCA</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="XTP-TUTORIAL.html">XTP Tutorials</a> &raquo;</li>
        
      <li>QMMM workflow using GROMACS and VOTCA-XTP</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/xtp-tutorials/QMMM_GROMACS.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="QMMM-workflow-using-GROMACS-and-VOTCA-XTP">
<h1>QMMM workflow using GROMACS and VOTCA-XTP<a class="headerlink" href="#QMMM-workflow-using-GROMACS-and-VOTCA-XTP" title="Permalink to this headline">¶</a></h1>
<div class="section" id="What-is-this-tutorial-about">
<h2>What is this tutorial about<a class="headerlink" href="#What-is-this-tutorial-about" title="Permalink to this headline">¶</a></h2>
<p>In this tutorial, we will learn how to set and perform excited state calculation using the Votca XTP library. We will use methane as our QM region.</p>
</div>
<div class="section" id="Requirements">
<h2>Requirements<a class="headerlink" href="#Requirements" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>You will need to install <strong>VOTCA</strong> using the instructions described <a class="reference external" href="https://github.com/votca/votca/blob/master/share/doc/INSTALL.rst">here</a></p></li>
<li><p>Once the installation is completed you need to activate the VOTCA enviroment by running the <code class="docutils literal notranslate"><span class="pre">VOTCARC.bash</span></code> script that has been installed at the bin subfolder for the path that you have provided for the installation step above</p></li>
</ul>
</div>
<div class="section" id="Interacting-with-the-XTP-command-line-interface">
<h2>Interacting with the XTP command line interface<a class="headerlink" href="#Interacting-with-the-XTP-command-line-interface" title="Permalink to this headline">¶</a></h2>
<p>The XTP package offers the following command line interface that the user can interact with: * <a class="reference external" href="https://www.votca.org/xtp/xtp_map.html">xtp_map</a> * <a class="reference external" href="https://www.votca.org/xtp/xtp_parallel.html">xtp_parallel</a> * <a class="reference external" href="https://www.votca.org/xtp/xtp_run.html">xtp_run</a> * <a class="reference external" href="https://www.votca.org/xtp/xtp_tools.html">xtp_tools</a></p>
<p>Run the following command to view the help message of <code class="docutils literal notranslate"><span class="pre">xtp_tools</span></code>:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">!</span>xtp_tools -h
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
==================================================
========   VOTCA (http://www.votca.org)   ========
==================================================

please submit bugs to https://github.com/votca/xtp/issues

xtp_tools, version 2022-dev gitid: abcf37d (compiled Jun  4 2021, 13:18:21)
votca_csg, version 2022-dev gitid: abcf37d (compiled Jun  4 2021, 13:04:58)
votca_tools, version 2022-dev gitid: abcf37d (compiled Jun  4 2021, 13:03:10)

Runs excitation/charge transport tools



Allowed options:
  -h [ --help ]                 display this help and exit
  --verbose                     be loud and noisy
  --verbose1                    be very loud and noisy
  -v [ --verbose2 ]             be extremly loud and noisy
  -o [ --options ] arg          Tool options
  -t [ --nthreads ] arg (=1)    number of threads to create
  -e [ --execute ] arg        Name of Tool to run
  -l [ --list ]               Lists all available Tools
  -d [ --description ] arg    Short description of a Tools
  -n [ --name ] arg           Name of the job to run

</pre></div></div>
</div>
<div class="section" id="Note">
<h3>Note<a class="headerlink" href="#Note" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><ul class="simple">
<li><p>In Jupyter the <code class="docutils literal notranslate"><span class="pre">!</span></code> symbol means: <em>run the following command as a standard unix command</em></p></li>
<li><p>In Jupyter the command <code class="docutils literal notranslate"><span class="pre">%env</span></code> set an environmental variable</p></li>
</ul>
</div></blockquote>
</div>
</div>
<div class="section" id="Setting-the-environment">
<h2>Setting the environment<a class="headerlink" href="#Setting-the-environment" title="Permalink to this headline">¶</a></h2>
<p>Create a folder to store the input <code class="docutils literal notranslate"><span class="pre">Options</span></code> for XTP</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">!</span>mkdir -p OPTIONFILES
</pre></div>
</div>
</div>
<p>Remove previous hdf5 file</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">!</span>rm -f state.hdf5
</pre></div>
</div>
</div>
<p>Import an small python module to edit xml files</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">xml_editor</span> <span class="kn">import</span> <span class="n">add_section</span><span class="p">,</span> <span class="n">edit_calculator</span>
<span class="kn">import</span> <span class="nn">os</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Generate-the-topology-from-the-Gromacs-file">
<h2>Generate the topology from the Gromacs file<a class="headerlink" href="#Generate-the-topology-from-the-Gromacs-file" title="Permalink to this headline">¶</a></h2>
<p>runs the mapping from MD coordinates to segments and creates an <a class="reference external" href="https://www.hdfgroup.org/solutions/hdf5/">hdf5 file</a>. You can explore the generated <code class="docutils literal notranslate"><span class="pre">state.hdf5</span></code> file with e.g. hdf5itebrowser. In Python, you can use the <a class="reference external" href="https://www.h5py.org/">h5py library</a>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">!</span>xtp_map -t MD_FILES/topol.tpr -c MD_FILES/conf.gro -s system.xml -f state.hdf5
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
==================================================
========   VOTCA (http://www.votca.org)   ========
==================================================

please submit bugs to https://github.com/votca/xtp/issues

xtp_map, version 2022-dev gitid: abcf37d (compiled Jun  4 2021, 13:18:21)
votca_csg, version 2022-dev gitid: abcf37d (compiled Jun  4 2021, 13:04:58)
votca_tools, version 2022-dev gitid: abcf37d (compiled Jun  4 2021, 13:03:10)

Reading file MD_FILES/topol.tpr, VERSION 5.1.1 (single precision)
Note: file tpx version 103, software tpx version 116
Creating statefile state.hdf5
Frame with id 0 was not in statefile state.hdf5 ,adding it now.
Wrote MD topology (step = 0, time = 0) to state.hdf5
... .
</pre></div></div>
</div>
</div>
<div class="section" id="Check-the-mapping">
<h2>Check the mapping<a class="headerlink" href="#Check-the-mapping" title="Permalink to this headline">¶</a></h2>
<p>Let us first output <code class="docutils literal notranslate"><span class="pre">.pdb</span></code> files for the segments, qmmolecules and classical segments in order to check the mapping. We will need to copy the input from the <code class="docutils literal notranslate"><span class="pre">VOTCA</span></code> installation path to our local copy.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">!</span>cp <span class="s2">&quot;</span><span class="nv">$VOTCASHARE</span><span class="s2">/xtp/xml/mapchecker.xml&quot;</span> OPTIONFILES/
</pre></div>
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">${VOTCASHARE}</span></code> environmental variable is set to the path that you provided during the <code class="docutils literal notranslate"><span class="pre">VOTCA</span></code> <a class="reference external" href="https://github.com/votca/votca/blob/master/share/doc/INSTALL.rst">installation</a>, by the default is set to <code class="docutils literal notranslate"><span class="pre">/usr/local/votca</span></code>.</p>
<p>We need to update the <code class="docutils literal notranslate"><span class="pre">mapchecker</span></code> options with the file containing the definition of the system. For doing, so we will use the python module <code class="docutils literal notranslate"><span class="pre">xml_editor</span></code> that we have imported above. The first argument is the name of the calculator (i.e. <code class="docutils literal notranslate"><span class="pre">mapchecker</span></code>), the seconds argument is the name of the option to change and the third one, the value to use.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">edit_calculator</span><span class="p">(</span><span class="s2">&quot;mapchecker&quot;</span><span class="p">,</span> <span class="s2">&quot;map_file&quot;</span><span class="p">,</span> <span class="s2">&quot;system.xml&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The option &#39;map_file&#39; on file &#39;OPTIONFILES/mapchecker.xml&#39; has been set to &#39;system.xml&#39;
</pre></div></div>
</div>
<p>In the <a class="reference external" href="https://votca.github.io/xtp/mapchecker.html">mapchecker section of the manual</a> you can find a table with the <code class="docutils literal notranslate"><span class="pre">mapchecker</span></code> input variables and their corresponding defaults. Finally, the following command run the check</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">!</span>xtp_run -e mapchecker -o OPTIONFILES/mapchecker.xml -f state.hdf5
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
==================================================
========   VOTCA (http://www.votca.org)   ========
==================================================

please submit bugs to https://github.com/votca/xtp/issues

xtp_run, version 2022-dev gitid: abcf37d (compiled Jun  4 2021, 13:18:21)
votca_csg, version 2022-dev gitid: abcf37d (compiled Jun  4 2021, 13:04:58)
votca_tools, version 2022-dev gitid: abcf37d (compiled Jun  4 2021, 13:03:10)

Initializing calculator
... mapchecker
1 frames in statefile, Ids are: 0
Starting at frame 0
Evaluating frame 0
Import MD Topology (i.e. frame 0) from state.hdf5
....
... mapchecker
 Using 1 threads
Writing segments to md_segments_step_0.pdb
Writing qmmolecules to qm_segments_n_step_0.pdb
Writing polarsegments to mp_segments_e_step_0.pdb
Writing polarsegments to mp_segments_h_step_0.pdb
Changes have not been written to state file.
</pre></div></div>
</div>
</div>
<div class="section" id="Neighborlist-Calculation">
<h2>Neighborlist Calculation<a class="headerlink" href="#Neighborlist-Calculation" title="Permalink to this headline">¶</a></h2>
<p>The following step is to determine the neighbouring pairs for exciton transport. We will need first to get a copy of the input</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">cp</span> <span class="s2">&quot;$VOTCASHARE/xtp/xml/neighborlist.xml&quot;</span> <span class="n">OPTIONFILES</span><span class="o">/</span>
</pre></div>
</div>
</div>
<p>Then we will use <code class="docutils literal notranslate"><span class="pre">segmentname</span></code> method to select the cutoff and set the <em>exciton_cutoff</em> for the pairs to 0.5 nanometers. See the <a class="reference external" href="https://www.votca.org/xtp/neighborlist.html">neighborlist options</a> for further information.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">exciton_cutoff</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">&lt;exciton_cutoff&gt;0.5&lt;/exciton_cutoff&gt;</span>
<span class="s2">&quot;&quot;&quot;</span>
<span class="n">segments</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">&lt;segments&gt;</span>
<span class="s2">  &lt;type&gt;Methane Methane&lt;/type&gt;</span>
<span class="s2">  &lt;cutoff&gt;1&lt;/cutoff&gt;</span>
<span class="s2">&lt;/segments&gt;</span>
<span class="s2">&quot;&quot;&quot;</span>
<span class="n">constant</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;&lt;constant help=&quot;cutoff for all other types of pairs&quot;&gt;0.6&lt;/constant&gt;&quot;&quot;&quot;</span>
<span class="n">cutoff_type</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;&lt;cutoff_type&gt;segmentname&lt;/cutoff_type&gt;&quot;&quot;&quot;</span>

<span class="n">add_section</span><span class="p">(</span><span class="s2">&quot;neighborlist&quot;</span><span class="p">,</span> <span class="n">cutoff_type</span><span class="p">)</span>
<span class="n">add_section</span><span class="p">(</span><span class="s2">&quot;neighborlist&quot;</span><span class="p">,</span> <span class="n">exciton_cutoff</span><span class="p">)</span>
<span class="n">add_section</span><span class="p">(</span><span class="s2">&quot;neighborlist&quot;</span><span class="p">,</span> <span class="n">segments</span><span class="p">)</span>
<span class="n">add_section</span><span class="p">(</span><span class="s2">&quot;neighborlist&quot;</span><span class="p">,</span> <span class="n">constant</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Finally, we can run the calculation using 4 threads</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">!</span>xtp_run -e neighborlist -o OPTIONFILES/neighborlist.xml -f state.hdf5
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
==================================================
========   VOTCA (http://www.votca.org)   ========
==================================================

please submit bugs to https://github.com/votca/xtp/issues

xtp_run, version 2022-dev gitid: abcf37d (compiled Jun  4 2021, 13:18:21)
votca_csg, version 2022-dev gitid: abcf37d (compiled Jun  4 2021, 13:04:58)
votca_tools, version 2022-dev gitid: abcf37d (compiled Jun  4 2021, 13:03:10)

Initializing calculator
... neighborlist
1 frames in statefile, Ids are: 0
Starting at frame 0
Evaluating frame 0
Import MD Topology (i.e. frame 0) from state.hdf5
....
... neighborlist
 Using 1 threads
Evaluating 1000 segments for neighborlist.
The following segments are used in the neigborlist creation
         Methane
 ... ... Evaluating
0%   10   20   30   40   50   60   70   80   90   100%
|----|----|----|----|----|----|----|----|----|----|
***************************************************

 ... ... Created 76140 direct pairs.Wrote MD topology (step = 0, time = 0) to state.hdf5
... .
</pre></div></div>
</div>
</div>
<div class="section" id="Read-reorganization-energies">
<h2>Read reorganization energies<a class="headerlink" href="#Read-reorganization-energies" title="Permalink to this headline">¶</a></h2>
<p>In this step we will read the in site reorganization energies and store them in the <code class="docutils literal notranslate"><span class="pre">state.hdf5</span></code> file. We just need to copy the input file and execute the calculation</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">!</span>cp <span class="s2">&quot;</span><span class="nv">$VOTCASHARE</span><span class="s2">/xtp/xml/einternal.xml&quot;</span> OPTIONFILES/
<span class="o">!</span>xtp_run -e einternal -o OPTIONFILES/einternal.xml -f state.hdf5
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
==================================================
========   VOTCA (http://www.votca.org)   ========
==================================================

please submit bugs to https://github.com/votca/xtp/issues

xtp_run, version 2022-dev gitid: abcf37d (compiled Jun  4 2021, 13:18:21)
votca_csg, version 2022-dev gitid: abcf37d (compiled Jun  4 2021, 13:04:58)
votca_tools, version 2022-dev gitid: abcf37d (compiled Jun  4 2021, 13:03:10)

Initializing calculator
... einternal
1 frames in statefile, Ids are: 0
Starting at frame 0
Evaluating frame 0
Import MD Topology (i.e. frame 0) from state.hdf5
....
... einternal
 Using 1 threads
... ... Site, reorg. energies from system.xml.

... ... Read in site, reorg. energies for 1000 segments. Wrote MD topology (step = 0, time = 0) to state.hdf5
... .
</pre></div></div>
</div>
</div>
<div class="section" id="Compute-site-energy">
<h2>Compute site energy<a class="headerlink" href="#Compute-site-energy" title="Permalink to this headline">¶</a></h2>
<p>In this step we will perform some <em>QMMM</em> calculations to compute the site energies. The <code class="docutils literal notranslate"><span class="pre">qmmm_mm.xml</span></code> file contains some predefined settings to perform the <em>MM</em> calculations. Let us first copy these settings into the state file,</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">!</span>cp qmmm_mm.xml OPTIONFILES
<span class="o">!</span>xtp_parallel -e qmmm -o OPTIONFILES/qmmm_mm.xml -f state.hdf5 -j <span class="s2">&quot;write&quot;</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
==================================================
========   VOTCA (http://www.votca.org)   ========
==================================================

please submit bugs to https://github.com/votca/xtp/issues

xtp_parallel, version 2022-dev gitid: abcf37d (compiled Jun  4 2021, 13:18:21)
votca_csg, version 2022-dev gitid: abcf37d (compiled Jun  4 2021, 13:04:58)
votca_tools, version 2022-dev gitid: abcf37d (compiled Jun  4 2021, 13:03:10)

Initializing calculator
... qmmm

... ... Initialized with 1 threads.

... ... Using 1 openmp threads for 1x1=1 total threads.
1 frames in statefile, Ids are: 0
Starting at frame 0
Evaluating frame 0
Import MD Topology (i.e. frame 0) from state.hdf5
....
... qmmm
... ... Writing job file qmmm_mm_jobs.xml
... ... In total 4001 jobs
Changes have not been written to state file.
</pre></div></div>
</div>
<p>The previous command generates a <code class="docutils literal notranslate"><span class="pre">qmmm_mm_jobs.xml</span></code> containing 4000 <em>MM</em> jobs to compute, if you examine that file, it should look something like</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;jobs&gt;</span>
  <span class="nt">&lt;job&gt;</span>
    <span class="nt">&lt;id&gt;</span>0<span class="nt">&lt;/id&gt;</span>
    <span class="nt">&lt;tag&gt;</span>Methane_0:n<span class="nt">&lt;/tag&gt;</span>
    <span class="nt">&lt;input&gt;</span>
      <span class="nt">&lt;site_energies&gt;</span>0:n<span class="nt">&lt;/site_energies&gt;</span>
      <span class="nt">&lt;regions&gt;</span>
        <span class="nt">&lt;region&gt;</span>
          <span class="nt">&lt;id&gt;</span>0<span class="nt">&lt;/id&gt;</span>
          <span class="nt">&lt;segments&gt;</span>0:n<span class="nt">&lt;/segments&gt;</span>
        <span class="nt">&lt;/region&gt;</span>
      <span class="nt">&lt;/regions&gt;</span>
    <span class="nt">&lt;/input&gt;</span>
    <span class="nt">&lt;status&gt;</span>AVAILABLE<span class="nt">&lt;/status&gt;</span>
  <span class="nt">&lt;/job&gt;</span>
...
</pre></div>
</div>
<p>Let us run just the first 4 jobs by settings all jobs <code class="docutils literal notranslate"><span class="pre">status</span></code> to <code class="docutils literal notranslate"><span class="pre">COMPLETE</span></code> except for the first four. This can be easily done with <a class="reference external" href="https://www.gnu.org/software/sed/manual/sed.html">sed</a> as follows,</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">!</span>sed -i <span class="s2">&quot;s/AVAILABLE/COMPLETE/g&quot;</span> qmmm_mm_jobs.xml
<span class="o">!</span>sed -i <span class="s1">&#39;0,/COMPLETE/s/COMPLETE/AVAILABLE/&#39;</span> qmmm_mm_jobs.xml
<span class="o">!</span>sed -i <span class="s1">&#39;0,/COMPLETE/s/COMPLETE/AVAILABLE/&#39;</span> qmmm_mm_jobs.xml
<span class="o">!</span>sed -i <span class="s1">&#39;0,/COMPLETE/s/COMPLETE/AVAILABLE/&#39;</span> qmmm_mm_jobs.xml
<span class="o">!</span>sed -i <span class="s1">&#39;0,/COMPLETE/s/COMPLETE/AVAILABLE/&#39;</span> qmmm_mm_jobs.xml
</pre></div>
</div>
</div>
<p>Now we can run the jobs and save the results in the state file</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">!</span>xtp_parallel -e qmmm -o OPTIONFILES/qmmm_mm.xml -f state.hdf5 -p <span class="m">2</span> -j <span class="s2">&quot;run&quot;</span>
<span class="o">!</span>xtp_parallel -e qmmm -o OPTIONFILES/qmmm_mm.xml -f state.hdf5 -j <span class="s2">&quot;read&quot;</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
==================================================
========   VOTCA (http://www.votca.org)   ========
==================================================

please submit bugs to https://github.com/votca/xtp/issues

xtp_parallel, version 2022-dev gitid: abcf37d (compiled Jun  4 2021, 13:18:21)
votca_csg, version 2022-dev gitid: abcf37d (compiled Jun  4 2021, 13:04:58)
votca_tools, version 2022-dev gitid: abcf37d (compiled Jun  4 2021, 13:03:10)

Initializing calculator
... qmmm

... ... Initialized with 1 threads.

... ... Using 2 openmp threads for 1x2=2 total threads.
1 frames in statefile, Ids are: 0
Starting at frame 0
Evaluating frame 0
Import MD Topology (i.e. frame 0) from state.hdf5
....
... qmmm
MST ERR Job file = &#39;qmmm_mm_jobs.xml&#39;, cache size =  8
MST ERR Initialize jobs from qmmm_mm_jobs.xml
MST ERR Registered 4000 jobs.
T00 ERR ... Requesting next job
T00 ERR ... Assign jobs from stack
T00 ERR ... Next job: ID = 0=&gt; [ 0%]
T00 ERR ...  Regions created
T00 ERR ... Id: 0 type: polar size: 17 charge[e]= -9.29812e-16
T00 ERR ... Id: 1 type: static size: 254 charge[e]= -1.4086e-14
T00 ERR ... 2021-6-4 13:27:48 Writing jobtopology to MMMM/frame_0/job_0_Methane_0:n/regions.pdb
T00 ERR ... 2021-6-4 13:27:48 Only 1 scf region is used. The remaining regions are static. So no inter regions scf is required.
T00 ERR ... 2021-6-4 13:27:48 --Inter Region SCF Iteration 1 of 1
T00 ERR ... 2021-6-4 13:27:48 Evaluating polar 0
T00 ERR ... 2021-6-4 13:27:48 Evaluating interaction between polar 0 and static 1
T00 ERR ... 2021-6-4 13:27:48 Starting Solving for classical polarization with 255 degrees of freedom.
T00 ERR ... 2021-6-4 13:27:48 CG: #iterations: 7, estimated error: 4.15528e-06
T00 ERR ...   Total static energy [hrt]= 8.121948104e-05
T00 ERR ...   Total polar energy [hrt]= -0.0001235439304
T00 ERR ...  Total energy [hrt]= -4.232444937e-05
T00 ERR ... 2021-6-4 13:27:48 Evaluating static 1
T00 ERR ... 2021-6-4 13:27:48 Writing checkpoint to checkpoint_iter_1.hdf5
T00 ERR ... Reporting job results

T00 ERR ... Requesting next job
T00 ERR ... Next job: ID = 1
T00 ERR ...  Regions created
T00 ERR ... Id: 0 type: polar size: 17 charge[e]= -1
T00 ERR ... Id: 1 type: static size: 254 charge[e]= -1.408595462e-14
T00 ERR ... 2021-6-4 13:27:48 Writing jobtopology to MMMM/frame_0/job_1_Methane_0:e/regions.pdb
T00 ERR ... 2021-6-4 13:27:48 Only 1 scf region is used. The remaining regions are static. So no inter regions scf is required.
T00 ERR ... 2021-6-4 13:27:48 --Inter Region SCF Iteration 1 of 1
T00 ERR ... 2021-6-4 13:27:48 Evaluating polar 0
T00 ERR ... 2021-6-4 13:27:48 Evaluating interaction between polar 0 and static 1
T00 ERR ... 2021-6-4 13:27:48 Starting Solving for classical polarization with 255 degrees of freedom.
T00 ERR ... 2021-6-4 13:27:48 CG: #iterations: 27, estimated error: 5.918122652e-06
T00 ERR ...   Total static energy [hrt]= -0.0009055590147
T00 ERR ...   Total polar energy [hrt]= -0.03058901395
T00 ERR ...  Total energy [hrt]= -0.03149457297
T00 ERR ... 2021-6-4 13:27:48 Evaluating static 1
T00 ERR ... 2021-6-4 13:27:48 Writing checkpoint to checkpoint_iter_1.hdf5
T00 ERR ... Reporting job results

T00 ERR ... Requesting next job
T00 ERR ... Next job: ID = 2
T00 ERR ...  Regions created
T00 ERR ... Id: 0 type: polar size: 17 charge[e]= 1
T00 ERR ... Id: 1 type: static size: 254 charge[e]= -1.408595462e-14
T00 ERR ... 2021-6-4 13:27:48 Writing jobtopology to MMMM/frame_0/job_2_Methane_0:h/regions.pdb
T00 ERR ... 2021-6-4 13:27:48 Only 1 scf region is used. The remaining regions are static. So no inter regions scf is required.
T00 ERR ... 2021-6-4 13:27:48 --Inter Region SCF Iteration 1 of 1
T00 ERR ... 2021-6-4 13:27:48 Evaluating polar 0
T00 ERR ... 2021-6-4 13:27:48 Evaluating interaction between polar 0 and static 1
T00 ERR ... 2021-6-4 13:27:48 Starting Solving for classical polarization with 255 degrees of freedom.
T00 ERR ... 2021-6-4 13:27:48 CG: #iterations: 7, estimated error: 3.581023691e-06
T00 ERR ...   Total static energy [hrt]= 0.001994038371
T00 ERR ...   Total polar energy [hrt]= -0.02768723938
T00 ERR ...  Total energy [hrt]= -0.02569320101
T00 ERR ... 2021-6-4 13:27:48 Evaluating static 1
T00 ERR ... 2021-6-4 13:27:48 Writing checkpoint to checkpoint_iter_1.hdf5
T00 ERR ... Reporting job results

T00 ERR ... Requesting next job
T00 ERR ... Next job: ID = 3
T00 ERR ...  Regions created
T00 ERR ... Id: 0 type: polar size: 17 charge[e]= -7.632783294e-16
T00 ERR ... Id: 1 type: static size: 254 charge[e]= -1.408595462e-14
T00 ERR ... 2021-6-4 13:27:48 Writing jobtopology to MMMM/frame_0/job_3_Methane_0:s1/regions.pdb
T00 ERR ... 2021-6-4 13:27:48 Only 1 scf region is used. The remaining regions are static. So no inter regions scf is required.
T00 ERR ... 2021-6-4 13:27:48 --Inter Region SCF Iteration 1 of 1
T00 ERR ... 2021-6-4 13:27:48 Evaluating polar 0
T00 ERR ... 2021-6-4 13:27:48 Evaluating interaction between polar 0 and static 1
T00 ERR ... 2021-6-4 13:27:48 Starting Solving for classical polarization with 255 degrees of freedom.
T00 ERR ... 2021-6-4 13:27:48 CG: #iterations: 7, estimated error: 5.171454294e-06
T00 ERR ...   Total static energy [hrt]= 0.0002401293715
T00 ERR ...   Total polar energy [hrt]= -0.0004782854375
T00 ERR ...  Total energy [hrt]= -0.000238156066
T00 ERR ... 2021-6-4 13:27:48 Evaluating static 1
T00 ERR ... 2021-6-4 13:27:48 Writing checkpoint to checkpoint_iter_1.hdf5
T00 ERR ... Reporting job results

T00 ERR ... Requesting next job
T00 ERR ... Assign jobs from stack
T00 ERR ... Sync did not yield any new jobs.
T00 ERR ... Next job: ID = - (none available)
MST ERR Assign jobs from stack
Changes have not been written to state file.
==================================================
========   VOTCA (http://www.votca.org)   ========
==================================================

please submit bugs to https://github.com/votca/xtp/issues

xtp_parallel, version 2022-dev gitid: abcf37d (compiled Jun  4 2021, 13:18:21)
votca_csg, version 2022-dev gitid: abcf37d (compiled Jun  4 2021, 13:04:58)
votca_tools, version 2022-dev gitid: abcf37d (compiled Jun  4 2021, 13:03:10)

Initializing calculator
... qmmm

... ... Initialized with 1 threads.

... ... Using 1 openmp threads for 1x1=1 total threads.
1 frames in statefile, Ids are: 0
Starting at frame 0
Evaluating frame 0
Import MD Topology (i.e. frame 0) from state.hdf5
....
... qmmm
Found 1 states of type e
Found 1 states of type h
Found 1 states of type s
Found 1 states of type n
3996 incomplete jobs found.

Wrote MD topology (step = 0, time = 0) to state.hdf5
... .
</pre></div></div>
</div>
</div>
<div class="section" id="Site-energy-and-pair-energy-analysis">
<h2>Site energy and pair energy analysis<a class="headerlink" href="#Site-energy-and-pair-energy-analysis" title="Permalink to this headline">¶</a></h2>
<p>In this step we generate an histogram and compute the correlation function of site energies and pair energy differences.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">!</span>cp <span class="s2">&quot;</span><span class="nv">$VOTCASHARE</span><span class="s2">/xtp/xml/eanalyze.xml&quot;</span> OPTIONFILES/
<span class="o">!</span>xtp_run -e eanalyze -o OPTIONFILES/eanalyze.xml -f state.hdf5
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
==================================================
========   VOTCA (http://www.votca.org)   ========
==================================================

please submit bugs to https://github.com/votca/xtp/issues

xtp_run, version 2022-dev gitid: abcf37d (compiled Jun  4 2021, 13:18:21)
votca_csg, version 2022-dev gitid: abcf37d (compiled Jun  4 2021, 13:04:58)
votca_tools, version 2022-dev gitid: abcf37d (compiled Jun  4 2021, 13:03:10)

Initializing calculator
... eanalyze
1 frames in statefile, Ids are: 0
Starting at frame 0
Evaluating frame 0
Import MD Topology (i.e. frame 0) from state.hdf5
....
... eanalyze
 Using 1 threads
... ... Short-listed 1000 segments (pattern=&#39;*&#39;)
... ... ... NOTE Statistics of site energies and spatial correlations thereof are based on the short-listed segments only.
... ... ...      Statistics of site-energy differences operate on the full list.
... ... excited state e
... ... excited state h
... ... excited state s
... ... excited state tChanges have not been written to state file.
</pre></div></div>
</div>
<p>You should now see a set of files prefixed with <code class="docutils literal notranslate"><span class="pre">eanalyze</span></code> containing the histrogram and correlation functions.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">!</span>ls eanalyze*
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
eanalyze.pairhist_e.out  eanalyze.pairlist_s.out  eanalyze.sitehist_e.out
eanalyze.pairhist_h.out  eanalyze.pairlist_t.out  eanalyze.sitehist_h.out
eanalyze.pairhist_s.out  eanalyze.sitecorr_e.out  eanalyze.sitehist_s.out
eanalyze.pairhist_t.out  eanalyze.sitecorr_h.out  eanalyze.sitehist_t.out
eanalyze.pairlist_e.out  eanalyze.sitecorr_s.out
eanalyze.pairlist_h.out  eanalyze.sitecorr_t.out
</pre></div></div>
</div>
</div>
<div class="section" id="QM-energy-calculation">
<h2>QM energy calculation<a class="headerlink" href="#QM-energy-calculation" title="Permalink to this headline">¶</a></h2>
<p>Our next task is to perform the qm calculations for each segment that we have stored in the hdf5 file. The calculations take place in 3 stages: write the jobs to a file, perform the computation and finally save the results to the state file. We will first copy the input into our local folder</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">!</span>cp <span class="s2">&quot;</span><span class="nv">$VOTCASHARE</span><span class="s2">/xtp/xml/eqm.xml&quot;</span> OPTIONFILES/
</pre></div>
</div>
</div>
<p>Now we set the GWBSE mode to <code class="docutils literal notranslate"><span class="pre">G0W0</span></code>, the <code class="docutils literal notranslate"><span class="pre">ranges</span></code> to <code class="docutils literal notranslate"><span class="pre">full</span></code> and the <code class="docutils literal notranslate"><span class="pre">basisset</span></code> and <code class="docutils literal notranslate"><span class="pre">auxbasisset</span></code> to <code class="docutils literal notranslate"><span class="pre">3-21G</span></code> and <code class="docutils literal notranslate"><span class="pre">aux-def2-svp</span></code>. For more information, check the <a class="reference external" href="https://votca.github.io/xtp/eqm.html">eqm calculator options</a>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">edit_calculator</span><span class="p">(</span><span class="s2">&quot;eqm&quot;</span><span class="p">,</span> <span class="s2">&quot;gwbse_options.gwbse.ranges&quot;</span><span class="p">,</span> <span class="s2">&quot;full&quot;</span><span class="p">)</span>
<span class="n">edit_calculator</span><span class="p">(</span><span class="s2">&quot;eqm&quot;</span><span class="p">,</span> <span class="s2">&quot;gwbse_options.gwbse.mode&quot;</span><span class="p">,</span> <span class="s2">&quot;G0W0&quot;</span><span class="p">)</span>
<span class="n">edit_calculator</span><span class="p">(</span><span class="s2">&quot;eqm&quot;</span><span class="p">,</span> <span class="s2">&quot;gwbse_options.gwbse.qp_solver&quot;</span><span class="p">,</span> <span class="s2">&quot;fixedpoint&quot;</span><span class="p">)</span>
<span class="n">edit_calculator</span><span class="p">(</span><span class="s2">&quot;eqm&quot;</span><span class="p">,</span> <span class="s2">&quot;gwbse_options.gwbse.qp_grid_steps&quot;</span><span class="p">,</span> <span class="s2">&quot;100&quot;</span><span class="p">)</span>
<span class="n">edit_calculator</span><span class="p">(</span><span class="s2">&quot;eqm&quot;</span><span class="p">,</span> <span class="s2">&quot;gwbse_options.gwbse.qp_grid_spacing&quot;</span><span class="p">,</span> <span class="s2">&quot;0.01&quot;</span><span class="p">)</span>
<span class="n">edit_calculator</span><span class="p">(</span><span class="s2">&quot;eqm&quot;</span><span class="p">,</span> <span class="s2">&quot;gwbse_options.gwbse.exctotal&quot;</span><span class="p">,</span> <span class="s2">&quot;10&quot;</span><span class="p">)</span>
<span class="n">edit_calculator</span><span class="p">(</span><span class="s2">&quot;eqm&quot;</span><span class="p">,</span> <span class="s2">&quot;map_file&quot;</span><span class="p">,</span> <span class="s2">&quot;system.xml&quot;</span><span class="p">)</span>
<span class="n">edit_calculator</span><span class="p">(</span><span class="s2">&quot;eqm&quot;</span><span class="p">,</span> <span class="s2">&quot;basisset&quot;</span><span class="p">,</span> <span class="s2">&quot;3-21G&quot;</span><span class="p">)</span>
<span class="n">edit_calculator</span><span class="p">(</span><span class="s2">&quot;eqm&quot;</span><span class="p">,</span> <span class="s2">&quot;auxbasisset&quot;</span><span class="p">,</span> <span class="s2">&quot;aux-def2-svp&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The option &#39;gwbse_options.gwbse.ranges&#39; on file &#39;OPTIONFILES/eqm.xml&#39; has been set to &#39;full&#39;
The option &#39;gwbse_options.gwbse.mode&#39; on file &#39;OPTIONFILES/eqm.xml&#39; has been set to &#39;G0W0&#39;
The option &#39;gwbse_options.gwbse.qp_solver&#39; on file &#39;OPTIONFILES/eqm.xml&#39; has been set to &#39;fixedpoint&#39;
The option &#39;gwbse_options.gwbse.qp_grid_steps&#39; on file &#39;OPTIONFILES/eqm.xml&#39; has been set to &#39;100&#39;
The option &#39;gwbse_options.gwbse.qp_grid_spacing&#39; on file &#39;OPTIONFILES/eqm.xml&#39; has been set to &#39;0.01&#39;
The option &#39;gwbse_options.gwbse.exctotal&#39; on file &#39;OPTIONFILES/eqm.xml&#39; has been set to &#39;10&#39;
The option &#39;map_file&#39; on file &#39;OPTIONFILES/eqm.xml&#39; has been set to &#39;system.xml&#39;
The option &#39;basisset&#39; on file &#39;OPTIONFILES/eqm.xml&#39; has been set to &#39;3-21G&#39;
The option &#39;auxbasisset&#39; on file &#39;OPTIONFILES/eqm.xml&#39; has been set to &#39;aux-def2-svp&#39;
</pre></div></div>
</div>
<p>For the sake of computational time let just compute the <code class="docutils literal notranslate"><span class="pre">gw</span></code> approximation and the <code class="docutils literal notranslate"><span class="pre">singlet</span></code>. You can also request the <code class="docutils literal notranslate"><span class="pre">triplet</span></code> or <code class="docutils literal notranslate"><span class="pre">all</span></code>, see the <a class="reference external" href="https://www.votca.org/xtp/eqm.html">gwbse sectionfor the eqm calculator</a>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">edit_calculator</span><span class="p">(</span><span class="s2">&quot;eqm&quot;</span><span class="p">,</span> <span class="s2">&quot;gwbse_options.gwbse.tasks&quot;</span><span class="p">,</span> <span class="s2">&quot;gw,singlets&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The option &#39;gwbse_options.gwbse.tasks&#39; on file &#39;OPTIONFILES/eqm.xml&#39; has been set to &#39;gw,singlets&#39;
</pre></div></div>
</div>
<p>First we will write the job in a file and enable only the first 2,</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">!</span>xtp_parallel -e eqm -o OPTIONFILES/eqm.xml -f state.hdf5 -s <span class="m">0</span> -j <span class="s2">&quot;write&quot;</span>
<span class="o">!</span>sed -i <span class="s2">&quot;s/AVAILABLE/COMPLETE/g&quot;</span> eqm.jobs
<span class="o">!</span>sed -i <span class="s1">&#39;0,/COMPLETE/s/COMPLETE/AVAILABLE/&#39;</span> eqm.jobs
<span class="o">!</span>sed -i <span class="s1">&#39;0,/COMPLETE/s/COMPLETE/AVAILABLE/&#39;</span> eqm.jobs

</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
==================================================
========   VOTCA (http://www.votca.org)   ========
==================================================

please submit bugs to https://github.com/votca/xtp/issues

xtp_parallel, version 2022-dev gitid: abcf37d (compiled Jun  4 2021, 13:18:21)
votca_csg, version 2022-dev gitid: abcf37d (compiled Jun  4 2021, 13:04:58)
votca_tools, version 2022-dev gitid: abcf37d (compiled Jun  4 2021, 13:03:10)

Initializing calculator
... eqm

... ... Initialized with 1 threads.

... ... Using 1 openmp threads for 1x1=1 total threads.
1 frames in statefile, Ids are: 0
Starting at frame 0
Evaluating frame 0
Import MD Topology (i.e. frame 0) from state.hdf5
....
... eqm
... ... Writing job file: eqm.jobs with 1000 jobs
Changes have not been written to state file.
</pre></div></div>
</div>
<p>Now, let run these 2 jobs</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">!</span>xtp_parallel -e eqm -o OPTIONFILES/eqm.xml -f state.hdf5 -p <span class="m">2</span> -s <span class="m">0</span> -j run -c <span class="m">1</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
==================================================
========   VOTCA (http://www.votca.org)   ========
==================================================

please submit bugs to https://github.com/votca/xtp/issues

xtp_parallel, version 2022-dev gitid: abcf37d (compiled Jun  4 2021, 13:18:21)
votca_csg, version 2022-dev gitid: abcf37d (compiled Jun  4 2021, 13:04:58)
votca_tools, version 2022-dev gitid: abcf37d (compiled Jun  4 2021, 13:03:10)

Initializing calculator
... eqm

... ... Initialized with 1 threads.

... ... Using 2 openmp threads for 1x2=2 total threads.
1 frames in statefile, Ids are: 0
Starting at frame 0
Evaluating frame 0
Import MD Topology (i.e. frame 0) from state.hdf5
....
... eqm
MST ERR Job file = &#39;eqm.jobs&#39;, cache size =  1
MST ERR Initialize jobs from eqm.jobs
MST ERR Registered 1000 jobs.
T00 ERR ... Requesting next job
T00 ERR ... Assign jobs from stack
T00 ERR ... Next job: ID = 0=&gt; [ 0%]
T00 ERR ... 2021-6-4 13:28:1 Evaluating site 0
T00 ERR ... Running DFT
T00 ERR ... Running GWBSE
T00 ERR ... Running ESPFIT
T00 ERR ... ===== Running on 2 threads =====
T00 ERR ... 2021-6-4 13:28:3 Calculated Densities at Numerical Grid, Number of electrons is -2.98617e-08
T00 ERR ... 2021-6-4 13:28:3 Calculating ESP at CHELPG grid points
T00 ERR ... 2021-6-4 13:28:4 Netcharge constrained to 0
T00 ERR ...  Sum of fitted charges: -6.93889e-17
T00 ERR ...  RMSE of fit:  0.00115775
T00 ERR ...  RRMSE of fit: 0.0674742
T00 ERR ... El Dipole from fitted charges [e*bohr]:
                 dx = +0.4972 dy = -0.5156 dz = +0.4029 |d|^2 = +0.6755
T00 ERR ... El Dipole from exact qm density [e*bohr]:
                 dx = +0.5081 dy = -0.5279 dz = +0.4124 |d|^2 = +0.7070
T00 ERR ... Written charges to MP_FILES/frame_0/n2s1/Methane_0_n2s1.mps
T00 ERR ... 2021-6-4 13:28:4 Finished evaluating site 0
T00 ERR ... Saving data to molecule_0.orb
T00 ERR ... Reporting job results

T00 ERR ... Requesting next job
T00 ERR ... Assign jobs from stack
T00 ERR ... Next job: ID = 1
T00 ERR ... 2021-6-4 13:28:4 Evaluating site 1
T00 ERR ... Running DFT
T00 ERR ... Running GWBSE
T00 ERR ... Running ESPFIT
T00 ERR ... ===== Running on 2 threads =====
T00 ERR ... 2021-6-4 13:28:6 Calculated Densities at Numerical Grid, Number of electrons is 2.26321e-08
T00 ERR ... 2021-6-4 13:28:6 Calculating ESP at CHELPG grid points
T00 ERR ... 2021-6-4 13:28:7 Netcharge constrained to 0
T00 ERR ...  Sum of fitted charges: -2.22045e-16
T00 ERR ...  RMSE of fit:  0.00113805
T00 ERR ...  RRMSE of fit: 0.0638578
T00 ERR ... El Dipole from fitted charges [e*bohr]:
                 dx = -0.5616 dy = -0.1876 dz = -0.6117 |d|^2 = +0.7247
T00 ERR ... El Dipole from exact qm density [e*bohr]:
                 dx = -0.5744 dy = -0.1917 dz = -0.6258 |d|^2 = +0.7584
T00 ERR ... Written charges to MP_FILES/frame_0/n2s1/Methane_1_n2s1.mps
T00 ERR ... 2021-6-4 13:28:7 Finished evaluating site 1
T00 ERR ... Saving data to molecule_1.orb
T00 ERR ... Reporting job results

T00 ERR ... Requesting next job
T00 ERR ... Assign jobs from stack
T00 ERR ... Sync did not yield any new jobs.
T00 ERR ... Next job: ID = - (none available)
MST ERR Assign jobs from stack
Changes have not been written to state file.
</pre></div></div>
</div>
</div>
<div class="section" id="QM-calculation-for-pairs">
<h2>QM calculation for pairs<a class="headerlink" href="#QM-calculation-for-pairs" title="Permalink to this headline">¶</a></h2>
<p>In the following step we will run QM calculations for each pair in the hdf5 file. As the calculations on the previous step, we will first write the jobs in a file, then run them and finally store the results in the state file. First, we need to copy the input to our local folder</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">!</span>cp <span class="s2">&quot;</span><span class="nv">$VOTCASHARE</span><span class="s2">/xtp/xml/iqm.xml&quot;</span> OPTIONFILES/
</pre></div>
</div>
</div>
<p>As in the previous section, we set the GWBSE mode to <code class="docutils literal notranslate"><span class="pre">G0W0</span></code>, the <code class="docutils literal notranslate"><span class="pre">ranges</span></code> to <code class="docutils literal notranslate"><span class="pre">full</span></code> and the <code class="docutils literal notranslate"><span class="pre">basisset</span></code> and <code class="docutils literal notranslate"><span class="pre">auxbasisset</span></code> to <code class="docutils literal notranslate"><span class="pre">3-21G</span></code> and <code class="docutils literal notranslate"><span class="pre">aux-def2-svp</span></code>. But we compute only the <code class="docutils literal notranslate"><span class="pre">gw</span></code> approximation. We are also going to compute a single excited state. For more information, check the <a class="reference external" href="https://www.votca.org/xtp/iqm.html">iqm calculator options</a>. We also want to compute the <code class="docutils literal notranslate"><span class="pre">singlet</span></code> couplings.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">edit_calculator</span><span class="p">(</span><span class="s2">&quot;iqm&quot;</span><span class="p">,</span> <span class="s2">&quot;states&quot;</span><span class="p">,</span> <span class="s2">&quot;1&quot;</span><span class="p">)</span>
<span class="n">edit_calculator</span><span class="p">(</span><span class="s2">&quot;iqm&quot;</span><span class="p">,</span> <span class="s2">&quot;map_file&quot;</span><span class="p">,</span> <span class="s2">&quot;system.xml&quot;</span><span class="p">)</span>
<span class="n">edit_calculator</span><span class="p">(</span><span class="s2">&quot;iqm&quot;</span><span class="p">,</span> <span class="s2">&quot;gwbse_options.gwbse.ranges&quot;</span><span class="p">,</span> <span class="s2">&quot;full&quot;</span><span class="p">)</span>
<span class="n">edit_calculator</span><span class="p">(</span><span class="s2">&quot;iqm&quot;</span><span class="p">,</span> <span class="s2">&quot;gwbse_options.gwbse.tasks&quot;</span><span class="p">,</span> <span class="s2">&quot;gw&quot;</span><span class="p">)</span>
<span class="n">edit_calculator</span><span class="p">(</span><span class="s2">&quot;iqm&quot;</span><span class="p">,</span> <span class="s2">&quot;gwbse_options.gwbse.qp_solver&quot;</span><span class="p">,</span> <span class="s2">&quot;fixedpoint&quot;</span><span class="p">)</span>
<span class="n">edit_calculator</span><span class="p">(</span><span class="s2">&quot;iqm&quot;</span><span class="p">,</span> <span class="s2">&quot;gwbse_options.gwbse.qp_grid_steps&quot;</span><span class="p">,</span> <span class="s2">&quot;100&quot;</span><span class="p">)</span>
<span class="n">edit_calculator</span><span class="p">(</span><span class="s2">&quot;iqm&quot;</span><span class="p">,</span> <span class="s2">&quot;gwbse_options.gwbse.qp_grid_spacing&quot;</span><span class="p">,</span> <span class="s2">&quot;0.01&quot;</span><span class="p">)</span>
<span class="n">edit_calculator</span><span class="p">(</span><span class="s2">&quot;iqm&quot;</span><span class="p">,</span> <span class="s2">&quot;gwbse_options.gwbse.exctotal&quot;</span><span class="p">,</span> <span class="s2">&quot;10&quot;</span><span class="p">)</span>
<span class="n">edit_calculator</span><span class="p">(</span><span class="s2">&quot;iqm&quot;</span><span class="p">,</span> <span class="s2">&quot;bsecoupling.spin&quot;</span><span class="p">,</span> <span class="s2">&quot;singlet&quot;</span><span class="p">)</span>
<span class="n">edit_calculator</span><span class="p">(</span><span class="s2">&quot;iqm&quot;</span><span class="p">,</span> <span class="s2">&quot;basisset&quot;</span><span class="p">,</span> <span class="s2">&quot;3-21G&quot;</span><span class="p">)</span>
<span class="n">edit_calculator</span><span class="p">(</span><span class="s2">&quot;iqm&quot;</span><span class="p">,</span> <span class="s2">&quot;auxbasisset&quot;</span><span class="p">,</span> <span class="s2">&quot;aux-def2-svp&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The option &#39;states&#39; on file &#39;OPTIONFILES/iqm.xml&#39; has been set to &#39;1&#39;
The option &#39;map_file&#39; on file &#39;OPTIONFILES/iqm.xml&#39; has been set to &#39;system.xml&#39;
The option &#39;gwbse_options.gwbse.ranges&#39; on file &#39;OPTIONFILES/iqm.xml&#39; has been set to &#39;full&#39;
The option &#39;gwbse_options.gwbse.tasks&#39; on file &#39;OPTIONFILES/iqm.xml&#39; has been set to &#39;gw&#39;
The option &#39;gwbse_options.gwbse.qp_solver&#39; on file &#39;OPTIONFILES/iqm.xml&#39; has been set to &#39;fixedpoint&#39;
The option &#39;gwbse_options.gwbse.qp_grid_steps&#39; on file &#39;OPTIONFILES/iqm.xml&#39; has been set to &#39;100&#39;
The option &#39;gwbse_options.gwbse.qp_grid_spacing&#39; on file &#39;OPTIONFILES/iqm.xml&#39; has been set to &#39;0.01&#39;
The option &#39;gwbse_options.gwbse.exctotal&#39; on file &#39;OPTIONFILES/iqm.xml&#39; has been set to &#39;10&#39;
The option &#39;bsecoupling.spin&#39; on file &#39;OPTIONFILES/iqm.xml&#39; has been set to &#39;singlet&#39;
The option &#39;basisset&#39; on file &#39;OPTIONFILES/iqm.xml&#39; has been set to &#39;3-21G&#39;
The option &#39;auxbasisset&#39; on file &#39;OPTIONFILES/iqm.xml&#39; has been set to &#39;aux-def2-svp&#39;
</pre></div></div>
</div>
<p>Before running the calculations, we need to specify in the <code class="docutils literal notranslate"><span class="pre">iqm</span></code> input which states to read into the jobfile for each segment type. The following <em>XML</em> snippet needs to be added</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">readjobfile</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">&lt;readjobfile help=&quot;which states to read into the jobfile for each segment type&quot;&gt;</span>
<span class="s2">     &lt;singlet&gt;Methane:s1&lt;/singlet&gt;</span>
<span class="s2">     &lt;triplet&gt;Methane:t1&lt;/triplet&gt;</span>
<span class="s2">     &lt;electron&gt;Methane:e1&lt;/electron&gt;</span>
<span class="s2">     &lt;hole&gt;Methane:h1&lt;/hole&gt;</span>
<span class="s2">&lt;/readjobfile&gt;</span>
<span class="s2">&quot;&quot;&quot;</span>
</pre></div>
</div>
</div>
<p>The following code add the <code class="docutils literal notranslate"><span class="pre">readjobfile</span></code> section,</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">add_section</span><span class="p">(</span><span class="s2">&quot;iqm&quot;</span><span class="p">,</span> <span class="n">readjobfile</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Now, let’s write the jobs to the file</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">!</span>xtp_parallel -e iqm -o OPTIONFILES/iqm.xml -f state.hdf5 -s <span class="m">0</span> -j <span class="s2">&quot;write&quot;</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
==================================================
========   VOTCA (http://www.votca.org)   ========
==================================================

please submit bugs to https://github.com/votca/xtp/issues

xtp_parallel, version 2022-dev gitid: abcf37d (compiled Jun  4 2021, 13:18:21)
votca_csg, version 2022-dev gitid: abcf37d (compiled Jun  4 2021, 13:04:58)
votca_tools, version 2022-dev gitid: abcf37d (compiled Jun  4 2021, 13:03:10)

Initializing calculator
... iqm

... ... Initialized with 1 threads.

... ... Using 1 openmp threads for 1x1=1 total threads.
1 frames in statefile, Ids are: 0
Starting at frame 0
Evaluating frame 0
Import MD Topology (i.e. frame 0) from state.hdf5
....
... iqm
... ... Writing job file iqm.jobs
... ... In total 76140 jobs
Changes have not been written to state file.
</pre></div></div>
</div>
<p>From the jobs that we just write down, let’s make available only the first job</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">!</span>sed -i <span class="s2">&quot;s/AVAILABLE/COMPLETE/g&quot;</span> iqm.jobs
<span class="o">!</span>sed -i <span class="s1">&#39;0,/COMPLETE/s/COMPLETE/AVAILABLE/&#39;</span> iqm.jobs
</pre></div>
</div>
</div>
<p>Now we can run and store the jobs results</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">!</span>xtp_parallel -e iqm -o OPTIONFILES/iqm.xml -f state.hdf5 -p <span class="m">2</span> -s <span class="m">0</span> -j run -c <span class="m">1</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
==================================================
========   VOTCA (http://www.votca.org)   ========
==================================================

please submit bugs to https://github.com/votca/xtp/issues

xtp_parallel, version 2022-dev gitid: abcf37d (compiled Jun  4 2021, 13:18:21)
votca_csg, version 2022-dev gitid: abcf37d (compiled Jun  4 2021, 13:04:58)
votca_tools, version 2022-dev gitid: abcf37d (compiled Jun  4 2021, 13:03:10)

Initializing calculator
... iqm

... ... Initialized with 1 threads.

... ... Using 2 openmp threads for 1x2=2 total threads.
1 frames in statefile, Ids are: 0
Starting at frame 0
Evaluating frame 0
Import MD Topology (i.e. frame 0) from state.hdf5
....
... iqm
MST ERR Job file = &#39;iqm.jobs&#39;, cache size =  1
MST ERR Initialize jobs from iqm.jobs
MST ERR Registered 76140 jobs.
T00 ERR ... Requesting next job
T00 ERR ... Assign jobs from stack
T00 ERR ... Next job: ID = 0=&gt; [ 0%]
T00 ERR ... 2021-6-4 13:28:20 Evaluating pair 0 [0:1] out of 76140
T00 ERR ... Guess requested, reading molecular orbitals
T00 ERR ... Reading MoleculeA from OR_FILES/molecules/frame_0/molecule_0.orb
T00 ERR ... Reading MoleculeB from OR_FILES/molecules/frame_0/molecule_1.orb
T00 ERR ... Running DFT
T00 ERR ... Calculating electronic couplings
T00 ERR ... ======WARNING=======
 Coordinates of monomer and dimer atoms do not agree
T00 ERR ... Levels:Basis A[2:17] B[2:17]
T00 ERR ... Done with electronic couplings
T00 ERR ... Running GWBSE
T00 ERR ... Running BSECoupling
T00 ERR ... 2021-6-4 13:28:22 Finished evaluating pair 0:1
T00 ERR ... Orb file is not saved according to options
T00 ERR ... Reporting job results

T00 ERR ... Requesting next job
T00 ERR ... Assign jobs from stack
T00 ERR ... Sync did not yield any new jobs.
T00 ERR ... Next job: ID = - (none available)
MST ERR Assign jobs from stack
Changes have not been written to state file.
</pre></div></div>
</div>
<p>Finally, we read the results into the state</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">!</span>xtp_parallel -e iqm -o OPTIONFILES/iqm.xml -f state.hdf5 -j <span class="s2">&quot;read&quot;</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
==================================================
========   VOTCA (http://www.votca.org)   ========
==================================================

please submit bugs to https://github.com/votca/xtp/issues

xtp_parallel, version 2022-dev gitid: abcf37d (compiled Jun  4 2021, 13:18:21)
votca_csg, version 2022-dev gitid: abcf37d (compiled Jun  4 2021, 13:04:58)
votca_tools, version 2022-dev gitid: abcf37d (compiled Jun  4 2021, 13:03:10)

Initializing calculator
... iqm

... ... Initialized with 1 threads.

... ... Using 1 openmp threads for 1x1=1 total threads.
1 frames in statefile, Ids are: 0
Starting at frame 0
Evaluating frame 0
Import MD Topology (i.e. frame 0) from state.hdf5
....
... iqm
Wrote MD topology (step = 0, time = 0) to state.hdf5
... .
</pre></div></div>
</div>
</div>
<div class="section" id="Coupling">
<h2>Coupling<a class="headerlink" href="#Coupling" title="Permalink to this headline">¶</a></h2>
<p>We can now compute the classical coupling of transition in the aformentioned three stages,</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[31]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">!</span>cp <span class="s2">&quot;</span><span class="si">${</span><span class="nv">VOTCASHARE</span><span class="si">}</span><span class="s2">/xtp/xml/iexcitoncl.xml&quot;</span> OPTIONFILES
</pre></div>
</div>
</div>
<p>We need to change in the <code class="docutils literal notranslate"><span class="pre">iexcitoncl</span></code> input the name <code class="docutils literal notranslate"><span class="pre">map_file</span></code> option and add the state. check all the available of the <a class="reference external" href="https://www.votca.org/xtp/iexcitoncl.html">iexcitoncl calculator</a>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[32]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">edit_calculator</span><span class="p">(</span><span class="s2">&quot;iexcitoncl&quot;</span><span class="p">,</span> <span class="s2">&quot;map_file&quot;</span><span class="p">,</span> <span class="s2">&quot;system.xml&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The option &#39;map_file&#39; on file &#39;OPTIONFILES/iexcitoncl.xml&#39; has been set to &#39;system.xml&#39;
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[33]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">state</span> <span class="o">=</span> <span class="s2">&quot;&lt;states&gt;Methane:n2s1&lt;/states&gt;&quot;</span>
<span class="n">add_section</span><span class="p">(</span><span class="s2">&quot;iexcitoncl&quot;</span><span class="p">,</span> <span class="n">state</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[34]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">!</span>xtp_parallel -e iexcitoncl -o OPTIONFILES/iexcitoncl.xml -f state.hdf5 -j <span class="s2">&quot;write&quot;</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
==================================================
========   VOTCA (http://www.votca.org)   ========
==================================================

please submit bugs to https://github.com/votca/xtp/issues

xtp_parallel, version 2022-dev gitid: abcf37d (compiled Jun  4 2021, 13:18:21)
votca_csg, version 2022-dev gitid: abcf37d (compiled Jun  4 2021, 13:04:58)
votca_tools, version 2022-dev gitid: abcf37d (compiled Jun  4 2021, 13:03:10)

Initializing calculator
... iexcitoncl

... ... Initialized with 1 threads.

... ... Using 1 openmp threads for 1x1=1 total threads.
1 frames in statefile, Ids are: 0
Starting at frame 0
Evaluating frame 0
Import MD Topology (i.e. frame 0) from state.hdf5
....
... iexcitoncl
... ... Writing job file exciton.jobs
... ... In total 0 jobs
Changes have not been written to state file.
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[35]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">!</span>ls

</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
MD_FILES                 eanalyze.pairlist_s.out  iqm.jobs~
MMMM                     eanalyze.pairlist_t.out  md_segments_step_0.pdb
MP_FILES                 eanalyze.sitecorr_e.out  mp_segments_e_step_0.pdb
OPTIONFILES              eanalyze.sitecorr_h.out  mp_segments_h_step_0.pdb
OR_FILES                 eanalyze.sitecorr_s.out  qm_segments_n_step_0.pdb
QC_FILES                 eanalyze.sitecorr_t.out  qmmm.xml
QMMM_GROMACS.ipynb       eanalyze.sitehist_e.out  qmmm_mm.xml
__pycache__              eanalyze.sitehist_h.out  qmmm_mm_jobs.xml
eanalyze.pairhist_e.out  eanalyze.sitehist_s.out  qmmm_mm_jobs.xml~
eanalyze.pairhist_h.out  eanalyze.sitehist_t.out  state.hdf5
eanalyze.pairhist_s.out  eqm.jobs                 system.xml
eanalyze.pairhist_t.out  eqm.jobs~                xml_editor.py
eanalyze.pairlist_e.out  exciton.jobs
eanalyze.pairlist_h.out  iqm.jobs
</pre></div></div>
</div>
<p>Now we can run and save the jobs. For demo purposes we will run only the first job</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[36]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">!</span>sed -i <span class="s2">&quot;s/AVAILABLE/COMPLETE/g&quot;</span> exciton.jobs
<span class="o">!</span>sed -i <span class="s1">&#39;0,/COMPLETE/s/COMPLETE/AVAILABLE/&#39;</span> exciton.jobs
<span class="o">!</span>xtp_parallel -e iexcitoncl -o OPTIONFILES/iexcitoncl.xml -f state.hdf5
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
==================================================
========   VOTCA (http://www.votca.org)   ========
==================================================

please submit bugs to https://github.com/votca/xtp/issues

xtp_parallel, version 2022-dev gitid: abcf37d (compiled Jun  4 2021, 13:18:21)
votca_csg, version 2022-dev gitid: abcf37d (compiled Jun  4 2021, 13:04:58)
votca_tools, version 2022-dev gitid: abcf37d (compiled Jun  4 2021, 13:03:10)

Initializing calculator
... iexcitoncl

... ... Initialized with 1 threads.

... ... Using 1 openmp threads for 1x1=1 total threads.
1 frames in statefile, Ids are: 0
Starting at frame 0
Evaluating frame 0
Import MD Topology (i.e. frame 0) from state.hdf5
....
... iexcitoncl
MST ERR Job file = &#39;exciton.jobs&#39;, cache size =  8
MST ERR Initialize jobs from exciton.jobs
MST ERR Registered 0 jobs.
T00 ERR ... Requesting next job
T00 ERR ... Next job: ID = - (none available)
MST ERR Assign jobs from stack
Changes have not been written to state file.
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[37]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="ch">#!xtp_parallel -e iexcitoncl -o OPTIONFILES/iexcitoncl.xml -f state.hdf5 -j &quot;read&quot;</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Coupling-analysis">
<h2>Coupling analysis<a class="headerlink" href="#Coupling-analysis" title="Permalink to this headline">¶</a></h2>
<p>Using the coupling computed in the previous steps, we will generate an histogram for the squared couplings in logarithmic scale,</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[38]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">!</span>cp <span class="s2">&quot;</span><span class="si">${</span><span class="nv">VOTCASHARE</span><span class="si">}</span><span class="s2">/xtp/xml/ianalyze.xml&quot;</span> OPTIONFILES
<span class="n">edit_calculator</span><span class="p">(</span><span class="s2">&quot;ianalyze&quot;</span><span class="p">,</span> <span class="s2">&quot;states&quot;</span><span class="p">,</span> <span class="s2">&quot;e,h,s&quot;</span><span class="p">)</span>
<span class="o">!</span>xtp_run -e ianalyze -o OPTIONFILES/ianalyze.xml -f state.hdf5
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The option &#39;states&#39; on file &#39;OPTIONFILES/ianalyze.xml&#39; has been set to &#39;e,h,s&#39;
==================================================
========   VOTCA (http://www.votca.org)   ========
==================================================

please submit bugs to https://github.com/votca/xtp/issues

xtp_run, version 2022-dev gitid: abcf37d (compiled Jun  4 2021, 13:18:21)
votca_csg, version 2022-dev gitid: abcf37d (compiled Jun  4 2021, 13:04:58)
votca_tools, version 2022-dev gitid: abcf37d (compiled Jun  4 2021, 13:03:10)

Initializing calculator
... ianalyze
1 frames in statefile, Ids are: 0
Starting at frame 0
Evaluating frame 0
Import MD Topology (i.e. frame 0) from state.hdf5
....
... ianalyze
 Using 1 threads
Calculating for state e now.
Calculating for state h now.
Calculating for state s now.
Changes have not been written to state file.
</pre></div></div>
</div>
</div>
<div class="section" id="QMMM-calculations">
<h2>QMMM calculations<a class="headerlink" href="#QMMM-calculations" title="Permalink to this headline">¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[39]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">!</span>cp qmmm.xml OPTIONFILES/
<span class="o">!</span>xtp_parallel -e qmmm -o OPTIONFILES/qmmm.xml -f state.hdf5 -j <span class="s2">&quot;write&quot;</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
==================================================
========   VOTCA (http://www.votca.org)   ========
==================================================

please submit bugs to https://github.com/votca/xtp/issues

xtp_parallel, version 2022-dev gitid: abcf37d (compiled Jun  4 2021, 13:18:21)
votca_csg, version 2022-dev gitid: abcf37d (compiled Jun  4 2021, 13:04:58)
votca_tools, version 2022-dev gitid: abcf37d (compiled Jun  4 2021, 13:03:10)

Initializing calculator
... qmmm

... ... Initialized with 1 threads.

... ... Using 1 openmp threads for 1x1=1 total threads.
1 frames in statefile, Ids are: 0
Starting at frame 0
Evaluating frame 0
Import MD Topology (i.e. frame 0) from state.hdf5
....
... qmmm
... ... Writing job file qmmm_jobs.xml
... ... In total 3001 jobs
Changes have not been written to state file.
</pre></div></div>
</div>
<p>Lets run just the first job</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[40]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">!</span>sed -i <span class="s2">&quot;s/AVAILABLE/COMPLETE/g&quot;</span> qmmm_jobs.xml
<span class="o">!</span>sed -i <span class="s1">&#39;0,/COMPLETE/s/COMPLETE/AVAILABLE/&#39;</span> qmmm_jobs.xml
<span class="o">!</span>sed -i <span class="s1">&#39;0,/COMPLETE/s/COMPLETE/AVAILABLE/&#39;</span> qmmm_jobs.xml
<span class="o">!</span>xtp_parallel -e qmmm -o OPTIONFILES/qmmm.xml -p <span class="m">2</span> -f state.hdf5 -j run
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
==================================================
========   VOTCA (http://www.votca.org)   ========
==================================================

please submit bugs to https://github.com/votca/xtp/issues

xtp_parallel, version 2022-dev gitid: abcf37d (compiled Jun  4 2021, 13:18:21)
votca_csg, version 2022-dev gitid: abcf37d (compiled Jun  4 2021, 13:04:58)
votca_tools, version 2022-dev gitid: abcf37d (compiled Jun  4 2021, 13:03:10)

Initializing calculator
... qmmm

... ... Initialized with 1 threads.

... ... Using 2 openmp threads for 1x2=2 total threads.
1 frames in statefile, Ids are: 0
Starting at frame 0
Evaluating frame 0
Import MD Topology (i.e. frame 0) from state.hdf5
....
... qmmm
MST ERR Job file = &#39;qmmm_jobs.xml&#39;, cache size =  8
MST ERR Initialize jobs from qmmm_jobs.xml
MST ERR Registered 3000 jobs.
T00 ERR ... Requesting next job
T00 ERR ... Assign jobs from stack
T00 ERR ... Next job: ID = 0=&gt; [ 0%]
T00 ERR ...  Regions created
T00 ERR ... Id: 0 type: qm size: 1 charge[e]= 12
T00 ERR ... Id: 1 type: polar size: 92 charge[e]= -5.09315e-15
T00 ERR ... Id: 2 type: static size: 178 charge[e]= -9.86711e-15
T00 ERR ... 2021-6-4 13:28:48 Writing jobtopology to QMMM/frame_0/job_0_Methane_0:n/regions.pdb
T00 ERR ... 2021-6-4 13:28:48 --Inter Region SCF Iteration 1 of 50
T00 ERR ... 2021-6-4 13:28:48 Evaluating qm 0
T00 ERR ... 2021-6-4 13:28:48 Evaluating interaction between qm 0 and polar 1
T00 ERR ... 2021-6-4 13:28:48 Evaluating interaction between qm 0 and static 2
T00 ERR ... Running DFT calculation
T00 ERR ... 2021-6-4 13:28:48 Using 2 threads
T00 ERR ... 2021-6-4 13:28:48 Using native Eigen implementation, no BLAS overload
T00 ERR ...  Molecule Coordinates [A]
T00 ERR ...   C   +30.3000 +1.2704 +5.5205
T00 ERR ...   H   +31.2392 +1.4802 +6.0301
T00 ERR ...   H   +30.4910 +0.6554 +4.6433
T00 ERR ...   H   +29.8500 +2.2100 +5.2100
T00 ERR ...   H   +29.6200 +0.7500 +6.2000
T00 ERR ... 2021-6-4 13:28:48 Loaded DFT Basis Set def2-svp with 34 functions
T00 ERR ... 2021-6-4 13:28:48 Total number of electrons: 10
T00 ERR ... 2021-6-4 13:28:48 Smallest value of AOOverlap matrix is 0.013882
T00 ERR ... 2021-6-4 13:28:48 Removed 0 basisfunction from inverse overlap matrix
T00 ERR ... 2021-6-4 13:28:48 Convergence Options:
T00 ERR ...              Delta E [Ha]: 1e-07
T00 ERR ...              DIIS max error: 1e-07
T00 ERR ...              DIIS histlength: 20
T00 ERR ...              ADIIS start: 0.8
T00 ERR ...              DIIS start: 0.002
T00 ERR ...              Deleting oldest element from DIIS hist
T00 ERR ...              Levelshift[Ha]: 0
T00 ERR ...              Levelshift end: 0.2
T00 ERR ...              Mixing Parameter alpha: 0.7
T00 ERR ... 2021-6-4 13:28:48 Constructed independent particle hamiltonian
T00 ERR ... 2021-6-4 13:28:48 Nuclear Repulsion Energy is 13.4434088
T00 ERR ... 2021-6-4 13:28:48 Using hybrid functional with alpha=0.25
T00 ERR ... 2021-6-4 13:28:48 Setup numerical integration grid medium for vxc functional XC_HYB_GGA_XC_PBEH
T00 ERR ... 2021-6-4 13:28:48 Setup Initial Guess using: atom
T00 ERR ... 2021-6-4 13:28:48 Calculating atom density for C
T00 ERR ... 2021-6-4 13:28:49 Calculating atom density for H
T00 ERR ... 2021-6-4 13:28:49 STARTING SCF cycle
T00 ERR ...  --------------------------------------------------------------------------
T00 ERR ...
T00 ERR ... 2021-6-4 13:28:49 Iteration 1 of 100
T00 ERR ... 2021-6-4 13:28:49 Total Energy -40.3160382356
T00 ERR ... 2021-6-4 13:28:49 DIIs error 0.224343479818
T00 ERR ... 2021-6-4 13:28:49 Delta Etot 0
T00 ERR ...
T00 ERR ... 2021-6-4 13:28:49 Iteration 2 of 100
T00 ERR ... 2021-6-4 13:28:49 Total Energy -40.3631646134
T00 ERR ... 2021-6-4 13:28:49 DIIs error 0.134009744313
T00 ERR ... 2021-6-4 13:28:49 Delta Etot -0.0471263777519
T00 ERR ...
T00 ERR ... 2021-6-4 13:28:49 Iteration 3 of 100
T00 ERR ... 2021-6-4 13:28:49 Total Energy -40.3846940826
T00 ERR ... 2021-6-4 13:28:49 DIIs error 0.0839223444315
T00 ERR ... 2021-6-4 13:28:49 Delta Etot -0.0215294692531
T00 ERR ...
T00 ERR ... 2021-6-4 13:28:49 Iteration 4 of 100
T00 ERR ... 2021-6-4 13:28:50 Total Energy -40.4256412728
T00 ERR ... 2021-6-4 13:28:50 DIIs error 0.0278434439037
T00 ERR ... 2021-6-4 13:28:50 Delta Etot -0.0409471901587
T00 ERR ...
T00 ERR ... 2021-6-4 13:28:50 Iteration 5 of 100
T00 ERR ... 2021-6-4 13:28:50 Total Energy -40.4252782797
T00 ERR ... 2021-6-4 13:28:50 DIIs error 0.0303866011461
T00 ERR ... 2021-6-4 13:28:50 Delta Etot 0.00036299304081
T00 ERR ...
T00 ERR ... 2021-6-4 13:28:50 Iteration 6 of 100
T00 ERR ... 2021-6-4 13:28:50 Total Energy -40.428332092
T00 ERR ... 2021-6-4 13:28:50 DIIs error 0.000900149072067
T00 ERR ... 2021-6-4 13:28:50 Delta Etot -0.00305381231327
T00 ERR ...
T00 ERR ... 2021-6-4 13:28:50 Iteration 7 of 100
T00 ERR ... 2021-6-4 13:28:50 Total Energy -40.4283348639
T00 ERR ... 2021-6-4 13:28:50 DIIs error 4.04992169156e-05
T00 ERR ... 2021-6-4 13:28:50 Delta Etot -2.77188465958e-06
T00 ERR ...
T00 ERR ... 2021-6-4 13:28:50 Iteration 8 of 100
T00 ERR ... 2021-6-4 13:28:50 Total Energy -40.4283348731
T00 ERR ... 2021-6-4 13:28:50 DIIs error 8.29240237372e-06
T00 ERR ... 2021-6-4 13:28:50 Delta Etot -9.22539555859e-09
T00 ERR ...
T00 ERR ... 2021-6-4 13:28:50 Iteration 9 of 100
T00 ERR ... 2021-6-4 13:28:50 Total Energy -40.4283348732
T00 ERR ... 2021-6-4 13:28:50 DIIs error 4.11847975374e-06
T00 ERR ... 2021-6-4 13:28:50 Delta Etot -3.52002871296e-11
T00 ERR ...
T00 ERR ... 2021-6-4 13:28:50 Iteration 10 of 100
T00 ERR ... 2021-6-4 13:28:50 Total Energy -40.4283348733
T00 ERR ... 2021-6-4 13:28:50 DIIs error 6.39551199038e-07
T00 ERR ... 2021-6-4 13:28:50 Delta Etot -6.89368562234e-11
T00 ERR ...
T00 ERR ... 2021-6-4 13:28:50 Iteration 11 of 100
T00 ERR ... 2021-6-4 13:28:50 Total Energy -40.4283348733
T00 ERR ... 2021-6-4 13:28:50 DIIs error 1.34029593244e-07
T00 ERR ... 2021-6-4 13:28:50 Delta Etot -1.90425453184e-12
T00 ERR ...
T00 ERR ... 2021-6-4 13:28:50 Iteration 12 of 100
T00 ERR ... 2021-6-4 13:28:51 Total Energy -40.4283348733
T00 ERR ... 2021-6-4 13:28:51 DIIs error 1.42665770293e-08
T00 ERR ... 2021-6-4 13:28:51 Delta Etot -6.39488462184e-14
T00 ERR ... 2021-6-4 13:28:51 Total Energy has converged to -6.39488462e-14[Ha] after 12 iterations. DIIS error is converged up to 1.4266577e-08
T00 ERR ... 2021-6-4 13:28:51 Final Single Point Energy -40.4283348733 Ha
T00 ERR ... 2021-6-4 13:28:51 Final Local Exc contribution -5.19288292765 Ha
T00 ERR ... 2021-6-4 13:28:51 Final Non Local Ex contribution -1.64346676034 Ha
T00 ERR ...   Orbital energies:
T00 ERR ...   index occupation energy(Hartree)
T00 ERR ...      0      2   -10.2155439702
T00 ERR ...      1      2   -0.7051474502
T00 ERR ...      2      2   -0.4018530763
T00 ERR ...      3      2   -0.4013030561
T00 ERR ...      4      2   -0.4005167239
T00 ERR ...      5      0   +0.0873160644
T00 ERR ...      6      0   +0.1580404991
T00 ERR ...      7      0   +0.1586955443
T00 ERR ...      8      0   +0.1589281315
T00 ERR ...      9      0   +0.4330256012
T00 ERR ...     10      0   +0.4342802104
T00 ERR ...     11      0   +0.4352482599
T00 ERR ...     12      0   +0.6747490915
T00 ERR ...     13      0   +0.7038048165
T00 ERR ...     14      0   +0.7052280157
T00 ERR ...     15      0   +0.7057531842
T00 ERR ...     16      0   +0.8002909160
T00 ERR ...     17      0   +1.0999417333
T00 ERR ...     18      0   +1.1004096807
T00 ERR ...     19      0   +1.5445777049
T00 ERR ...     20      0   +1.5470371037
T00 ERR ...     21      0   +1.5494748355
T00 ERR ...     22      0   +1.7740441528
T00 ERR ...     23      0   +1.7790714705
T00 ERR ...     24      0   +1.7829840060
T00 ERR ...     25      0   +2.1478692073
T00 ERR ...     26      0   +2.1543523363
T00 ERR ...     27      0   +2.1593032775
T00 ERR ...     28      0   +2.5457715880
T00 ERR ...     29      0   +2.5462267824
T00 ERR ...     30      0   +2.6358795669
T00 ERR ...     31      0   +2.9321001950
T00 ERR ...     32      0   +2.9387290718
T00 ERR ...     33      0   +2.9434070937
T00 ERR ... 2021-6-4 13:28:51 Electric Dipole is[e*bohr]:
                 dx=0.000671714438769
                 dy=0.00319883857111
                 dz=-0.00105486264846
T00 ERR ... Writing result to votca.orb
T00 ERR ... QM energy[Hrt]: -40.42833487
T00 ERR ... 2021-6-4 13:28:51 Evaluating polar 1
T00 ERR ... 2021-6-4 13:28:51 Evaluating interaction between polar 1 and qm 0
T00 ERR ... 2021-6-4 13:28:51 Evaluating interaction between polar 1 and static 2
T00 ERR ... 2021-6-4 13:28:51 Starting Solving for classical polarization with 1380 degrees of freedom.
T00 ERR ... 2021-6-4 13:28:51 CG: #iterations: 7, estimated error: 5.51883553603e-06
T00 ERR ...   Total static energy [hrt]= 0.0009102654542
T00 ERR ...   Total polar energy [hrt]= -0.0006230373479
T00 ERR ...  Total energy [hrt]= 0.0002872281063
T00 ERR ... 2021-6-4 13:28:51 Evaluating static 2
T00 ERR ... 2021-6-4 13:28:51 Writing checkpoint to checkpoint_iter_1.hdf5
T00 ERR ...  Region:qm 0 is not converged deltaE=-40.42833487 RMS Dmat=0.0813492265 MaxDmat=2.078065548
T00 ERR ... 2021-6-4 13:28:51 Region:polar 1 is not converged deltaE=0.0002872281063
T00 ERR ... 2021-6-4 13:28:51 --Total Energy all regions -40.42804765
T00 ERR ... 2021-6-4 13:28:51 --Inter Region SCF Iteration 2 of 50
T00 ERR ... 2021-6-4 13:28:51 Evaluating qm 0
T00 ERR ... 2021-6-4 13:28:51 Evaluating interaction between qm 0 and polar 1
T00 ERR ... 2021-6-4 13:28:51 Evaluating interaction between qm 0 and static 2
T00 ERR ... Running DFT calculation
T00 ERR ... 2021-6-4 13:28:51 Using 2 threads
T00 ERR ... 2021-6-4 13:28:51 Using native Eigen implementation, no BLAS overload
T00 ERR ...  Molecule Coordinates [A]
T00 ERR ...   C   +30.3000 +1.2704 +5.5205
T00 ERR ...   H   +31.2392 +1.4802 +6.0301
T00 ERR ...   H   +30.4910 +0.6554 +4.6433
T00 ERR ...   H   +29.8500 +2.2100 +5.2100
T00 ERR ...   H   +29.6200 +0.7500 +6.2000
T00 ERR ... 2021-6-4 13:28:51 Loaded DFT Basis Set def2-svp with 34 functions
T00 ERR ... 2021-6-4 13:28:51 Total number of electrons: 10
T00 ERR ... 2021-6-4 13:28:51 Smallest value of AOOverlap matrix is 0.01388201597
T00 ERR ... 2021-6-4 13:28:51 Removed 0 basisfunction from inverse overlap matrix
T00 ERR ... 2021-6-4 13:28:51 Convergence Options:
T00 ERR ...              Delta E [Ha]: 1e-07
T00 ERR ...              DIIS max error: 1e-07
T00 ERR ...              DIIS histlength: 20
T00 ERR ...              ADIIS start: 0.8
T00 ERR ...              DIIS start: 0.002
T00 ERR ...              Deleting oldest element from DIIS hist
T00 ERR ...              Levelshift[Ha]: 0
T00 ERR ...              Levelshift end: 0.2
T00 ERR ...              Mixing Parameter alpha: 0.7
T00 ERR ... 2021-6-4 13:28:51 Constructed independent particle hamiltonian
T00 ERR ... 2021-6-4 13:28:51 Nuclear Repulsion Energy is 13.4434088
T00 ERR ... 2021-6-4 13:28:51 Using hybrid functional with alpha=0.25
T00 ERR ... 2021-6-4 13:28:51 Setup numerical integration grid medium for vxc functional XC_HYB_GGA_XC_PBEH
T00 ERR ... 2021-6-4 13:28:51 Setup Initial Guess using: atom
T00 ERR ... 2021-6-4 13:28:51 Calculating atom density for C
T00 ERR ... 2021-6-4 13:28:52 Calculating atom density for H
T00 ERR ... 2021-6-4 13:28:52 STARTING SCF cycle
T00 ERR ...  --------------------------------------------------------------------------
T00 ERR ...
T00 ERR ... 2021-6-4 13:28:52 Iteration 1 of 100
T00 ERR ... 2021-6-4 13:28:53 Total Energy -40.3160382356
T00 ERR ... 2021-6-4 13:28:53 DIIs error 0.224343479818
T00 ERR ... 2021-6-4 13:28:53 Delta Etot 0
T00 ERR ...
T00 ERR ... 2021-6-4 13:28:53 Iteration 2 of 100
T00 ERR ... 2021-6-4 13:28:53 Total Energy -40.3631646134
T00 ERR ... 2021-6-4 13:28:53 DIIs error 0.134009744313
T00 ERR ... 2021-6-4 13:28:53 Delta Etot -0.047126377752
T00 ERR ...
T00 ERR ... 2021-6-4 13:28:53 Iteration 3 of 100
T00 ERR ... 2021-6-4 13:28:53 Total Energy -40.3846940826
T00 ERR ... 2021-6-4 13:28:53 DIIs error 0.0839223444315
T00 ERR ... 2021-6-4 13:28:53 Delta Etot -0.021529469253
T00 ERR ...
T00 ERR ... 2021-6-4 13:28:53 Iteration 4 of 100
T00 ERR ... 2021-6-4 13:28:53 Total Energy -40.4256412728
T00 ERR ... 2021-6-4 13:28:53 DIIs error 0.0278434439037
T00 ERR ... 2021-6-4 13:28:53 Delta Etot -0.0409471901588
T00 ERR ...
T00 ERR ... 2021-6-4 13:28:53 Iteration 5 of 100
T00 ERR ... 2021-6-4 13:28:53 Total Energy -40.4252782797
T00 ERR ... 2021-6-4 13:28:53 DIIs error 0.0303866011461
T00 ERR ... 2021-6-4 13:28:53 Delta Etot 0.000362993040795
T00 ERR ...
T00 ERR ... 2021-6-4 13:28:53 Iteration 6 of 100
T00 ERR ... 2021-6-4 13:28:53 Total Energy -40.428332092
T00 ERR ... 2021-6-4 13:28:53 DIIs error 0.000900149072095
T00 ERR ... 2021-6-4 13:28:53 Delta Etot -0.00305381231323
T00 ERR ...
T00 ERR ... 2021-6-4 13:28:53 Iteration 7 of 100
T00 ERR ... 2021-6-4 13:28:53 Total Energy -40.4283348639
T00 ERR ... 2021-6-4 13:28:53 DIIs error 4.04992169167e-05
T00 ERR ... 2021-6-4 13:28:53 Delta Etot -2.7718846809e-06
T00 ERR ...
T00 ERR ... 2021-6-4 13:28:53 Iteration 8 of 100
T00 ERR ... 2021-6-4 13:28:53 Total Energy -40.4283348731
T00 ERR ... 2021-6-4 13:28:53 DIIs error 8.29240236172e-06
T00 ERR ... 2021-6-4 13:28:53 Delta Etot -9.22540266401e-09
T00 ERR ...
T00 ERR ... 2021-6-4 13:28:53 Iteration 9 of 100
T00 ERR ... 2021-6-4 13:28:54 Total Energy -40.4283348732
T00 ERR ... 2021-6-4 13:28:54 DIIs error 4.11847976672e-06
T00 ERR ... 2021-6-4 13:28:54 Delta Etot -3.51434437107e-11
T00 ERR ...
T00 ERR ... 2021-6-4 13:28:54 Iteration 10 of 100
T00 ERR ... 2021-6-4 13:28:54 Total Energy -40.4283348733
T00 ERR ... 2021-6-4 13:28:54 DIIs error 6.39551194885e-07
T00 ERR ... 2021-6-4 13:28:54 Delta Etot -6.88658019499e-11
T00 ERR ...
T00 ERR ... 2021-6-4 13:28:54 Iteration 11 of 100
T00 ERR ... 2021-6-4 13:28:54 Total Energy -40.4283348733
T00 ERR ... 2021-6-4 13:28:54 DIIs error 1.3402955047e-07
T00 ERR ... 2021-6-4 13:28:54 Delta Etot -1.9610979507e-12
T00 ERR ...
T00 ERR ... 2021-6-4 13:28:54 Iteration 12 of 100
T00 ERR ... 2021-6-4 13:28:54 Total Energy -40.4283348733
T00 ERR ... 2021-6-4 13:28:54 DIIs error 1.4266543848e-08
T00 ERR ... 2021-6-4 13:28:54 Delta Etot -9.94759830064e-14
T00 ERR ... 2021-6-4 13:28:54 Total Energy has converged to -9.9475983e-14[Ha] after 12 iterations. DIIS error is converged up to 1.42665438e-08
T00 ERR ... 2021-6-4 13:28:54 Final Single Point Energy -40.4283348733 Ha
T00 ERR ... 2021-6-4 13:28:54 Final Local Exc contribution -5.19288292765 Ha
T00 ERR ... 2021-6-4 13:28:54 Final Non Local Ex contribution -1.64346676034 Ha
T00 ERR ...   Orbital energies:
T00 ERR ...   index occupation energy(Hartree)
T00 ERR ...      0      2   -10.2155439702
T00 ERR ...      1      2   -0.7051474502
T00 ERR ...      2      2   -0.4018530763
T00 ERR ...      3      2   -0.4013030561
T00 ERR ...      4      2   -0.4005167239
T00 ERR ...      5      0   +0.0873160644
T00 ERR ...      6      0   +0.1580404991
T00 ERR ...      7      0   +0.1586955443
T00 ERR ...      8      0   +0.1589281315
T00 ERR ...      9      0   +0.4330256012
T00 ERR ...     10      0   +0.4342802104
T00 ERR ...     11      0   +0.4352482599
T00 ERR ...     12      0   +0.6747490915
T00 ERR ...     13      0   +0.7038048165
T00 ERR ...     14      0   +0.7052280157
T00 ERR ...     15      0   +0.7057531842
T00 ERR ...     16      0   +0.8002909160
T00 ERR ...     17      0   +1.0999417333
T00 ERR ...     18      0   +1.1004096807
T00 ERR ...     19      0   +1.5445777049
T00 ERR ...     20      0   +1.5470371037
T00 ERR ...     21      0   +1.5494748355
T00 ERR ...     22      0   +1.7740441528
T00 ERR ...     23      0   +1.7790714705
T00 ERR ...     24      0   +1.7829840060
T00 ERR ...     25      0   +2.1478692073
T00 ERR ...     26      0   +2.1543523363
T00 ERR ...     27      0   +2.1593032775
T00 ERR ...     28      0   +2.5457715880
T00 ERR ...     29      0   +2.5462267824
T00 ERR ...     30      0   +2.6358795669
T00 ERR ...     31      0   +2.9321001950
T00 ERR ...     32      0   +2.9387290718
T00 ERR ...     33      0   +2.9434070937
T00 ERR ... 2021-6-4 13:28:54 Electric Dipole is[e*bohr]:
                 dx=0.000671714438767
                 dy=0.00319883857109
                 dz=-0.00105486264848
T00 ERR ... Writing result to votca.orb
T00 ERR ... QM energy[Hrt]: -40.42833487
T00 ERR ... 2021-6-4 13:28:54 Evaluating polar 1
T00 ERR ... 2021-6-4 13:28:54 Evaluating interaction between polar 1 and qm 0
T00 ERR ... 2021-6-4 13:28:54 Evaluating interaction between polar 1 and static 2
T00 ERR ... 2021-6-4 13:28:54 Starting Solving for classical polarization with 1380 degrees of freedom.
T00 ERR ... 2021-6-4 13:28:54 CG: #iterations: 0, estimated error: 5.51883553514e-06
T00 ERR ...   Total static energy [hrt]= 0.0009102654542
T00 ERR ...   Total polar energy [hrt]= -0.0006230373479
T00 ERR ...  Total energy [hrt]= 0.0002872281063
T00 ERR ... 2021-6-4 13:28:54 Evaluating static 2
T00 ERR ... 2021-6-4 13:28:54 Writing checkpoint to checkpoint_iter_2.hdf5
T00 ERR ...  Region:qm 0 is converged deltaE=2.131628207e-14 RMS Dmat=8.798793997e-15 MaxDmat=1.054989429e-13
T00 ERR ... 2021-6-4 13:28:55 Region:polar 1 is converged deltaE=0
T00 ERR ... 2021-6-4 13:28:55 --Total Energy all regions -40.42804765
T00 ERR ... 2021-6-4 13:28:55 Job converged after 2 iterations.
T00 ERR ... Reporting job results

T00 ERR ... Requesting next job
T00 ERR ... Next job: ID = 1
T00 ERR ... Initial state: s1
T00 ERR ... Using overlap filter with threshold 0.8
T00 ERR ...  Regions created
T00 ERR ... Id: 0 type: qm size: 1 charge[e]= 0
T00 ERR ... Id: 1 type: polar size: 92 charge[e]= -5.093148125e-15
T00 ERR ... Id: 2 type: static size: 178 charge[e]= -9.867107131e-15
T00 ERR ... 2021-6-4 13:28:55 Writing jobtopology to QMMM/frame_0/job_1_Methane_0:s1/regions.pdb
T00 ERR ... 2021-6-4 13:28:55 --Inter Region SCF Iteration 1 of 50
T00 ERR ... 2021-6-4 13:28:55 Evaluating qm 0
T00 ERR ... 2021-6-4 13:28:55 Evaluating interaction between qm 0 and polar 1
T00 ERR ... 2021-6-4 13:28:55 Evaluating interaction between qm 0 and static 2
T00 ERR ... Running DFT calculation
T00 ERR ... 2021-6-4 13:28:55 Using 2 threads
T00 ERR ... 2021-6-4 13:28:55 Using native Eigen implementation, no BLAS overload
T00 ERR ...  Molecule Coordinates [A]
T00 ERR ...   C   +30.3000 +1.2704 +5.5205
T00 ERR ...   H   +31.2392 +1.4802 +6.0301
T00 ERR ...   H   +30.4910 +0.6554 +4.6433
T00 ERR ...   H   +29.8500 +2.2100 +5.2100
T00 ERR ...   H   +29.6200 +0.7500 +6.2000
T00 ERR ... 2021-6-4 13:28:55 Loaded DFT Basis Set def2-svp with 34 functions
T00 ERR ... 2021-6-4 13:28:55 Total number of electrons: 10
T00 ERR ... 2021-6-4 13:28:55 Smallest value of AOOverlap matrix is 0.01388201597
T00 ERR ... 2021-6-4 13:28:55 Removed 0 basisfunction from inverse overlap matrix
T00 ERR ... 2021-6-4 13:28:55 Convergence Options:
T00 ERR ...              Delta E [Ha]: 1e-07
T00 ERR ...              DIIS max error: 1e-07
T00 ERR ...              DIIS histlength: 20
T00 ERR ...              ADIIS start: 0.8
T00 ERR ...              DIIS start: 0.002
T00 ERR ...              Deleting oldest element from DIIS hist
T00 ERR ...              Levelshift[Ha]: 0
T00 ERR ...              Levelshift end: 0.2
T00 ERR ...              Mixing Parameter alpha: 0.7
T00 ERR ... 2021-6-4 13:28:55 Constructed independent particle hamiltonian
T00 ERR ... 2021-6-4 13:28:55 Nuclear Repulsion Energy is 13.4434088
T00 ERR ... 2021-6-4 13:28:55 Using hybrid functional with alpha=0.25
T00 ERR ... 2021-6-4 13:28:55 Setup numerical integration grid medium for vxc functional XC_HYB_GGA_XC_PBEH
T00 ERR ... 2021-6-4 13:28:55 Setup Initial Guess using: atom
T00 ERR ... 2021-6-4 13:28:55 Calculating atom density for C
T00 ERR ... 2021-6-4 13:28:56 Calculating atom density for H
T00 ERR ... 2021-6-4 13:28:56 STARTING SCF cycle
T00 ERR ...  --------------------------------------------------------------------------
T00 ERR ...
T00 ERR ... 2021-6-4 13:28:56 Iteration 1 of 100
T00 ERR ... 2021-6-4 13:28:56 Total Energy -40.3160382356
T00 ERR ... 2021-6-4 13:28:56 DIIs error 0.224343479818
T00 ERR ... 2021-6-4 13:28:56 Delta Etot 0
T00 ERR ...
T00 ERR ... 2021-6-4 13:28:56 Iteration 2 of 100
T00 ERR ... 2021-6-4 13:28:56 Total Energy -40.3631646134
T00 ERR ... 2021-6-4 13:28:56 DIIs error 0.134009744313
T00 ERR ... 2021-6-4 13:28:56 Delta Etot -0.047126377752
T00 ERR ...
T00 ERR ... 2021-6-4 13:28:56 Iteration 3 of 100
T00 ERR ... 2021-6-4 13:28:56 Total Energy -40.3846940826
T00 ERR ... 2021-6-4 13:28:56 DIIs error 0.0839223444316
T00 ERR ... 2021-6-4 13:28:56 Delta Etot -0.021529469253
T00 ERR ...
T00 ERR ... 2021-6-4 13:28:56 Iteration 4 of 100
T00 ERR ... 2021-6-4 13:28:57 Total Energy -40.4256412728
T00 ERR ... 2021-6-4 13:28:57 DIIs error 0.0278434439037
T00 ERR ... 2021-6-4 13:28:57 Delta Etot -0.0409471901588
T00 ERR ...
T00 ERR ... 2021-6-4 13:28:57 Iteration 5 of 100
T00 ERR ... 2021-6-4 13:28:57 Total Energy -40.4252782797
T00 ERR ... 2021-6-4 13:28:57 DIIs error 0.0303866011461
T00 ERR ... 2021-6-4 13:28:57 Delta Etot 0.000362993040824
T00 ERR ...
T00 ERR ... 2021-6-4 13:28:57 Iteration 6 of 100
T00 ERR ... 2021-6-4 13:28:57 Total Energy -40.428332092
T00 ERR ... 2021-6-4 13:28:57 DIIs error 0.000900149072229
T00 ERR ... 2021-6-4 13:28:57 Delta Etot -0.00305381231325
T00 ERR ...
T00 ERR ... 2021-6-4 13:28:57 Iteration 7 of 100
T00 ERR ... 2021-6-4 13:28:57 Total Energy -40.4283348639
T00 ERR ... 2021-6-4 13:28:57 DIIs error 4.0499216913e-05
T00 ERR ... 2021-6-4 13:28:57 Delta Etot -2.7718846809e-06
T00 ERR ...
T00 ERR ... 2021-6-4 13:28:57 Iteration 8 of 100
T00 ERR ... 2021-6-4 13:28:57 Total Energy -40.4283348731
T00 ERR ... 2021-6-4 13:28:57 DIIs error 8.29240235601e-06
T00 ERR ... 2021-6-4 13:28:57 Delta Etot -9.22540266401e-09
T00 ERR ...
T00 ERR ... 2021-6-4 13:28:57 Iteration 9 of 100
T00 ERR ... 2021-6-4 13:28:57 Total Energy -40.4283348732
T00 ERR ... 2021-6-4 13:28:57 DIIs error 4.11847975514e-06
T00 ERR ... 2021-6-4 13:28:57 Delta Etot -3.51860762748e-11
T00 ERR ...
T00 ERR ... 2021-6-4 13:28:57 Iteration 10 of 100
T00 ERR ... 2021-6-4 13:28:57 Total Energy -40.4283348733
T00 ERR ... 2021-6-4 13:28:57 DIIs error 6.39551201215e-07
T00 ERR ... 2021-6-4 13:28:57 Delta Etot -6.88729073772e-11
T00 ERR ...
T00 ERR ... 2021-6-4 13:28:57 Iteration 11 of 100
T00 ERR ... 2021-6-4 13:28:57 Total Energy -40.4283348733
T00 ERR ... 2021-6-4 13:28:57 DIIs error 1.34029606146e-07
T00 ERR ... 2021-6-4 13:28:57 Delta Etot -1.89714910448e-12
T00 ERR ...
T00 ERR ... 2021-6-4 13:28:57 Iteration 12 of 100
T00 ERR ... 2021-6-4 13:28:58 Total Energy -40.4283348733
T00 ERR ... 2021-6-4 13:28:58 DIIs error 1.4266563383e-08
T00 ERR ... 2021-6-4 13:28:58 Delta Etot -1.20792265079e-13
T00 ERR ... 2021-6-4 13:28:58 Total Energy has converged to -1.20792265e-13[Ha] after 12 iterations. DIIS error is converged up to 1.42665634e-08
T00 ERR ... 2021-6-4 13:28:58 Final Single Point Energy -40.4283348733 Ha
T00 ERR ... 2021-6-4 13:28:58 Final Local Exc contribution -5.19288292765 Ha
T00 ERR ... 2021-6-4 13:28:58 Final Non Local Ex contribution -1.64346676034 Ha
T00 ERR ...   Orbital energies:
T00 ERR ...   index occupation energy(Hartree)
T00 ERR ...      0      2   -10.2155439702
T00 ERR ...      1      2   -0.7051474502
T00 ERR ...      2      2   -0.4018530763
T00 ERR ...      3      2   -0.4013030561
T00 ERR ...      4      2   -0.4005167239
T00 ERR ...      5      0   +0.0873160644
T00 ERR ...      6      0   +0.1580404991
T00 ERR ...      7      0   +0.1586955443
T00 ERR ...      8      0   +0.1589281315
T00 ERR ...      9      0   +0.4330256012
T00 ERR ...     10      0   +0.4342802104
T00 ERR ...     11      0   +0.4352482599
T00 ERR ...     12      0   +0.6747490915
T00 ERR ...     13      0   +0.7038048165
T00 ERR ...     14      0   +0.7052280157
T00 ERR ...     15      0   +0.7057531842
T00 ERR ...     16      0   +0.8002909160
T00 ERR ...     17      0   +1.0999417333
T00 ERR ...     18      0   +1.1004096807
T00 ERR ...     19      0   +1.5445777049
T00 ERR ...     20      0   +1.5470371037
T00 ERR ...     21      0   +1.5494748355
T00 ERR ...     22      0   +1.7740441528
T00 ERR ...     23      0   +1.7790714705
T00 ERR ...     24      0   +1.7829840060
T00 ERR ...     25      0   +2.1478692073
T00 ERR ...     26      0   +2.1543523363
T00 ERR ...     27      0   +2.1593032775
T00 ERR ...     28      0   +2.5457715880
T00 ERR ...     29      0   +2.5462267824
T00 ERR ...     30      0   +2.6358795669
T00 ERR ...     31      0   +2.9321001950
T00 ERR ...     32      0   +2.9387290718
T00 ERR ...     33      0   +2.9434070937
T00 ERR ... 2021-6-4 13:28:58 Electric Dipole is[e*bohr]:
                 dx=0.000671714438772
                 dy=0.0031988385711
                 dz=-0.00105486264845
T00 ERR ... Writing result to votca.orb
T00 ERR ... QM energy[Hrt]: -40.42833487
T00 ERR ... 2021-6-4 13:28:58 RPA level range [0:33]
T00 ERR ... 2021-6-4 13:28:58 GW  level range [0:13]
T00 ERR ... 2021-6-4 13:28:58 BSE level range occ[0:4]  virt[5:13]
T00 ERR ... 2021-6-4 13:28:58 BSE Hamiltonian has size 45x45
T00 ERR ...  BSE type: full
T00 ERR ...  BSE without Hqp offdiagonal elements
T00 ERR ...  Running GW as: evGW
T00 ERR ...  g_sc_limit [Hartree]: 1e-05
T00 ERR ...  gw_sc_limit [Hartree]: 1e-05
T00 ERR ...  Tasks:
T00 ERR ...  GW
T00 ERR ...  singlets
T00 ERR ...  Store:
T00 ERR ...  GW
T00 ERR ...  Sigma integration: ppm
T00 ERR ...  eta: 0.001
T00 ERR ...  Quadrature integration order : 12
T00 ERR ...  Quadrature integration scheme : legendre
T00 ERR ...  Alpha smoothing parameter : 0.001
T00 ERR ...  QP solver: grid
T00 ERR ...  QP grid steps: 1001
T00 ERR ...  QP grid spacing: 0.001
T00 ERR ...  evGW with Anderson update with history 20 using alpha 0.7
T00 ERR ... 2021-6-4 13:28:58 Using 2 threads
T00 ERR ... 2021-6-4 13:28:58 Using native Eigen implementation, no BLAS overload
T00 ERR ... 2021-6-4 13:28:58 Molecule Coordinates [A]
T00 ERR ...     0    C   30.3000 1.2704 5.5205
T00 ERR ...     1    H   31.2392 1.4802 6.0301
T00 ERR ...     2    H   30.4910 0.6554 4.6433
T00 ERR ...     3    H   29.8500 2.2100 5.2100
T00 ERR ...     4    H   29.6200 0.7500 6.2000
T00 ERR ... 2021-6-4 13:28:58 DFT data was created by xtp
T00 ERR ... 2021-6-4 13:28:58 Loaded DFT Basis Set def2-svp
T00 ERR ... 2021-6-4 13:28:58 Filled DFT Basis of size 34
T00 ERR ... 2021-6-4 13:28:58 Loaded Auxbasis Set aux-def2-svp
T00 ERR ... 2021-6-4 13:28:58 Filled Auxbasis of size 104
T00 ERR ... 2021-6-4 13:28:58 Calculating Mmn_beta (3-center-repulsion x orbitals)
T00 ERR ... 2021-6-4 13:28:58 Calculated Mmn_beta (3-center-repulsion x orbitals)
T00 ERR ... 2021-6-4 13:28:58 Integrating Vxc in VOTCA with functional XC_HYB_GGA_XC_PBEH
T00 ERR ... 2021-6-4 13:28:58 Set hybrid exchange factor: 0.25
T00 ERR ... 2021-6-4 13:28:58 Calculated exchange-correlation expectation values
T00 ERR ... 2021-6-4 13:28:58 Calculated Hartree exchange contribution
T00 ERR ... 2021-6-4 13:28:58 Scissor shifting DFT energies by: 0 Hrt
T00 ERR ...   ====== Perturbative quasiparticle energies (Hartree) ======
T00 ERR ...    DeltaHLGap = +0.205535 Hartree
T00 ERR ...   Level =    0 DFT = -10.2155 VXC = -1.6995 S-X = -2.6641 S-C = +0.3756 GWA = -10.8046
T00 ERR ...   Level =    1 DFT = -0.7051 VXC = -0.4442 S-X = -0.6638 S-C = +0.0825 GWA = -0.8422
T00 ERR ...   Level =    2 DFT = -0.4019 VXC = -0.3984 S-X = -0.5342 S-C = +0.0166 GWA = -0.5210
T00 ERR ...   Level =    3 DFT = -0.4013 VXC = -0.3981 S-X = -0.5336 S-C = +0.0164 GWA = -0.5205
T00 ERR ...   HOMO  =    4 DFT = -0.4005 VXC = -0.3984 S-X = -0.5340 S-C = +0.0165 GWA = -0.5196
T00 ERR ...   LUMO  =    5 DFT = +0.0873 VXC = -0.1668 S-X = -0.0618 S-C = -0.0186 GWA = +0.1738
T00 ERR ...   Level =    6 DFT = +0.1580 VXC = -0.2033 S-X = -0.0792 S-C = -0.0233 GWA = +0.2590
T00 ERR ...   Level =    7 DFT = +0.1587 VXC = -0.2030 S-X = -0.0790 S-C = -0.0232 GWA = +0.2596
T00 ERR ...   Level =    8 DFT = +0.1589 VXC = -0.2028 S-X = -0.0788 S-C = -0.0232 GWA = +0.2598
T00 ERR ...   Level =    9 DFT = +0.4330 VXC = -0.2605 S-X = -0.0984 S-C = -0.0300 GWA = +0.5651
T00 ERR ...   Level =   10 DFT = +0.4343 VXC = -0.2608 S-X = -0.0984 S-C = -0.0301 GWA = +0.5666
T00 ERR ...   Level =   11 DFT = +0.4352 VXC = -0.2609 S-X = -0.0983 S-C = -0.0302 GWA = +0.5676
T00 ERR ...   Level =   12 DFT = +0.6747 VXC = -0.3539 S-X = -0.1453 S-C = -0.0757 GWA = +0.8076
T00 ERR ...   Level =   13 DFT = +0.7038 VXC = -0.3485 S-X = -0.1218 S-C = -0.0883 GWA = +0.8422
T00 ERR ... 2021-6-4 13:28:58 Calculated offdiagonal part of Sigma
T00 ERR ... 2021-6-4 13:28:58 Full quasiparticle Hamiltonian
T00 ERR ...   ====== Diagonalized quasiparticle energies (Hartree) ======
T00 ERR ...   Level =    0 PQP = -10.804624 DQP = -10.804684
T00 ERR ...   Level =    1 PQP = -0.842223 DQP = -0.842330
T00 ERR ...   Level =    2 PQP = -0.521043 DQP = -0.521146
T00 ERR ...   Level =    3 PQP = -0.520454 DQP = -0.520575
T00 ERR ...   HOMO  =    4 PQP = -0.519610 DQP = -0.519708
T00 ERR ...   LUMO  =    5 PQP = +0.173758 DQP = +0.172572
T00 ERR ...   Level =    6 PQP = +0.258964 DQP = +0.257085
T00 ERR ...   Level =    7 PQP = +0.259577 DQP = +0.259238
T00 ERR ...   Level =    8 PQP = +0.259752 DQP = +0.259485
T00 ERR ...   Level =    9 PQP = +0.565118 DQP = +0.565520
T00 ERR ...   Level =   10 PQP = +0.566580 DQP = +0.566975
T00 ERR ...   Level =   11 PQP = +0.567579 DQP = +0.567978
T00 ERR ...   Level =   12 PQP = +0.807555 DQP = +0.808905
T00 ERR ...   Level =   13 PQP = +0.842239 DQP = +0.843852
T00 ERR ... 2021-6-4 13:28:58 Diagonalized QP Hamiltonian
T00 ERR ... 2021-6-4 13:28:58 Setup Full singlet hamiltonian
T00 ERR ... 2021-6-4 13:28:58 Davidson Solver using 2 threads.
T00 ERR ... 2021-6-4 13:28:58 Tolerance : 0.0001
T00 ERR ... 2021-6-4 13:28:58 DPR Correction
T00 ERR ... 2021-6-4 13:28:58 Matrix size : 90x90
T00 ERR ... 2021-6-4 13:28:58 iter      Search Space    Norm
T00 ERR ... 2021-6-4 13:28:58    0           10          5.73e-02         0.00% converged
T00 ERR ... 2021-6-4 13:28:58    1           17          2.82e-02         0.00% converged
T00 ERR ... 2021-6-4 13:28:58    2           24          1.59e-02         0.00% converged
T00 ERR ... 2021-6-4 13:28:58    3           31          2.92e-03        60.00% converged
T00 ERR ... 2021-6-4 13:28:58    4           35          2.02e-04        80.00% converged
T00 ERR ... 2021-6-4 13:28:58    5           37          4.42e-05        100.00% converged
T00 ERR ... 2021-6-4 13:28:58 Davidson converged after 5 iterations.
T00 ERR ... 2021-6-4 13:28:58-----------------------------------
T00 ERR ... 2021-6-4 13:28:58- Davidson ran for 0.009065214secs.
T00 ERR ... 2021-6-4 13:28:58-----------------------------------
T00 ERR ... 2021-6-4 13:28:58 Solved BSE for singlets
T00 ERR ...   ====== singlet energies (eV) ======
T00 ERR ...   S =    1 Omega = +12.238216313937 eV  lamdba = +101.32 nm &lt;FT&gt; = +19.0081 &lt;K_x&gt; = +0.8682 &lt;K_d&gt; = -7.6381
T00 ERR ...            TrDipole length gauge[e*bohr]  dx = -0.4627 dy = +0.6020 dz = -0.4784 |d|^2 = +0.8052 f = +0.2414
T00 ERR ...            HOMO-0   -&gt; LUMO+0    : 98.3%
T00 ERR ...
T00 ERR ...   S =    2 Omega = +12.256189015094 eV  lamdba = +101.17 nm &lt;FT&gt; = +19.0436 &lt;K_x&gt; = +0.8526 &lt;K_d&gt; = -7.6400
T00 ERR ...            TrDipole length gauge[e*bohr]  dx = +0.7649 dy = +0.4729 dz = -0.1553 |d|^2 = +0.8329 f = +0.2501
T00 ERR ...            HOMO-1   -&gt; LUMO+0    : 96.5%
T00 ERR ...
T00 ERR ...   S =    3 Omega = +12.278446707807 eV  lamdba = +100.99 nm &lt;FT&gt; = +19.0484 &lt;K_x&gt; = +0.8724 &lt;K_d&gt; = -7.6424
T00 ERR ...            TrDipole length gauge[e*bohr]  dx = -0.1499 dy = +0.4753 dz = +0.7571 |d|^2 = +0.8215 f = +0.2471
T00 ERR ...            HOMO-2   -&gt; LUMO+0    : 97.1%
T00 ERR ...
T00 ERR ...   S =    4 Omega = +13.876840966781 eV  lamdba = +89.36 nm &lt;FT&gt; = +21.3641 &lt;K_x&gt; = +0.2514 &lt;K_d&gt; = -7.7387
T00 ERR ...            TrDipole length gauge[e*bohr]  dx = +0.0830 dy = -0.0229 dz = +0.0185 |d|^2 = +0.0078 f = +0.0026
T00 ERR ...            HOMO-0   -&gt; LUMO+1    : 67.2%
T00 ERR ...
T00 ERR ...   S =    5 Omega = +13.905418816386 eV  lamdba = +89.17 nm &lt;FT&gt; = +21.3870 &lt;K_x&gt; = +0.2471 &lt;K_d&gt; = -7.7287
T00 ERR ...            TrDipole length gauge[e*bohr]  dx = -0.0133 dy = -0.0444 dz = -0.0585 |d|^2 = +0.0056 f = +0.0019
T00 ERR ...            HOMO-2   -&gt; LUMO+1    : 51.9%
T00 ERR ...
T00 ERR ... 2021-6-4 13:28:58 GWBSE calculation finished
T00 ERR ... Filter overlap not used in first iteration as it needs a reference state
T00 ERR ... No State found by tracker using last state: s1
T00 ERR ... 2021-6-4 13:28:58 Evaluating polar 1
T00 ERR ... 2021-6-4 13:28:58 Evaluating interaction between polar 1 and qm 0
T00 ERR ... Next State is: s1
T00 ERR ... 2021-6-4 13:28:59 Evaluating interaction between polar 1 and static 2
T00 ERR ... 2021-6-4 13:28:59 Starting Solving for classical polarization with 1380 degrees of freedom.
T00 ERR ... 2021-6-4 13:28:59 CG: #iterations: 7, estimated error: 4.94939136576e-06
T00 ERR ...   Total static energy [hrt]= 0.0009102654542
T00 ERR ...   Total polar energy [hrt]= -0.0002985415123
T00 ERR ...  Total energy [hrt]= 0.0006117239419
T00 ERR ... 2021-6-4 13:28:59 Evaluating static 2
T00 ERR ... 2021-6-4 13:28:59 Writing checkpoint to checkpoint_iter_1.hdf5
T00 ERR ...  Region:qm 0 is not converged deltaE=-39.97858872 RMS Dmat=0.3394153921 MaxDmat=7.053509991
T00 ERR ... 2021-6-4 13:28:59 Region:polar 1 is not converged deltaE=0.0006117239419
T00 ERR ... 2021-6-4 13:28:59 --Total Energy all regions -39.97797699
T00 ERR ... 2021-6-4 13:28:59 --Inter Region SCF Iteration 2 of 50
T00 ERR ... 2021-6-4 13:28:59 Evaluating qm 0
T00 ERR ... 2021-6-4 13:28:59 Evaluating interaction between qm 0 and polar 1
T00 ERR ... 2021-6-4 13:28:59 Evaluating interaction between qm 0 and static 2
T00 ERR ... Running DFT calculation
T00 ERR ... 2021-6-4 13:28:59 Using 2 threads
T00 ERR ... 2021-6-4 13:28:59 Using native Eigen implementation, no BLAS overload
T00 ERR ...  Molecule Coordinates [A]
T00 ERR ...   C   +30.3000 +1.2704 +5.5205
T00 ERR ...   H   +31.2392 +1.4802 +6.0301
T00 ERR ...   H   +30.4910 +0.6554 +4.6433
T00 ERR ...   H   +29.8500 +2.2100 +5.2100
T00 ERR ...   H   +29.6200 +0.7500 +6.2000
T00 ERR ... 2021-6-4 13:28:59 Loaded DFT Basis Set def2-svp with 34 functions
T00 ERR ... 2021-6-4 13:28:59 Total number of electrons: 10
T00 ERR ... 2021-6-4 13:28:59 Smallest value of AOOverlap matrix is 0.01388201597
T00 ERR ... 2021-6-4 13:28:59 Removed 0 basisfunction from inverse overlap matrix
T00 ERR ... 2021-6-4 13:28:59 Convergence Options:
T00 ERR ...              Delta E [Ha]: 1e-07
T00 ERR ...              DIIS max error: 1e-07
T00 ERR ...              DIIS histlength: 20
T00 ERR ...              ADIIS start: 0.8
T00 ERR ...              DIIS start: 0.002
T00 ERR ...              Deleting oldest element from DIIS hist
T00 ERR ...              Levelshift[Ha]: 0
T00 ERR ...              Levelshift end: 0.2
T00 ERR ...              Mixing Parameter alpha: 0.7
T00 ERR ... 2021-6-4 13:28:59 Constructed independent particle hamiltonian
T00 ERR ... 2021-6-4 13:28:59 Nuclear Repulsion Energy is 13.4434088
T00 ERR ... 2021-6-4 13:28:59 Using hybrid functional with alpha=0.25
T00 ERR ... 2021-6-4 13:28:59 Setup numerical integration grid medium for vxc functional XC_HYB_GGA_XC_PBEH
T00 ERR ... 2021-6-4 13:28:59 Setup Initial Guess using: atom
T00 ERR ... 2021-6-4 13:28:59 Calculating atom density for C
T00 ERR ... 2021-6-4 13:29:0 Calculating atom density for H
T00 ERR ... 2021-6-4 13:29:0 STARTING SCF cycle
T00 ERR ...  --------------------------------------------------------------------------
T00 ERR ...
T00 ERR ... 2021-6-4 13:29:0 Iteration 1 of 100
T00 ERR ... 2021-6-4 13:29:0 Total Energy -40.3160382356
T00 ERR ... 2021-6-4 13:29:0 DIIs error 0.224343479818
T00 ERR ... 2021-6-4 13:29:0 Delta Etot 0
T00 ERR ...
T00 ERR ... 2021-6-4 13:29:0 Iteration 2 of 100
T00 ERR ... 2021-6-4 13:29:0 Total Energy -40.3631646134
T00 ERR ... 2021-6-4 13:29:0 DIIs error 0.134009744313
T00 ERR ... 2021-6-4 13:29:0 Delta Etot -0.0471263777519
T00 ERR ...
T00 ERR ... 2021-6-4 13:29:0 Iteration 3 of 100
T00 ERR ... 2021-6-4 13:29:1 Total Energy -40.3846940826
T00 ERR ... 2021-6-4 13:29:1 DIIs error 0.0839223444315
T00 ERR ... 2021-6-4 13:29:1 Delta Etot -0.021529469253
T00 ERR ...
T00 ERR ... 2021-6-4 13:29:1 Iteration 4 of 100
T00 ERR ... 2021-6-4 13:29:1 Total Energy -40.4256412728
T00 ERR ... 2021-6-4 13:29:1 DIIs error 0.0278434439037
T00 ERR ... 2021-6-4 13:29:1 Delta Etot -0.0409471901589
T00 ERR ...
T00 ERR ... 2021-6-4 13:29:1 Iteration 5 of 100
T00 ERR ... 2021-6-4 13:29:1 Total Energy -40.4252782797
T00 ERR ... 2021-6-4 13:29:1 DIIs error 0.0303866011461
T00 ERR ... 2021-6-4 13:29:1 Delta Etot 0.000362993040909
T00 ERR ...
T00 ERR ... 2021-6-4 13:29:1 Iteration 6 of 100
T00 ERR ... 2021-6-4 13:29:1 Total Energy -40.428332092
T00 ERR ... 2021-6-4 13:29:1 DIIs error 0.000900149072141
T00 ERR ... 2021-6-4 13:29:1 Delta Etot -0.00305381231328
T00 ERR ...
T00 ERR ... 2021-6-4 13:29:1 Iteration 7 of 100
T00 ERR ... 2021-6-4 13:29:1 Total Energy -40.4283348639
T00 ERR ... 2021-6-4 13:29:1 DIIs error 4.0499216915e-05
T00 ERR ... 2021-6-4 13:29:1 Delta Etot -2.77188465247e-06
T00 ERR ...
T00 ERR ... 2021-6-4 13:29:1 Iteration 8 of 100
T00 ERR ... 2021-6-4 13:29:1 Total Energy -40.4283348731
T00 ERR ... 2021-6-4 13:29:1 DIIs error 8.29240235489e-06
T00 ERR ... 2021-6-4 13:29:1 Delta Etot -9.22543108572e-09
T00 ERR ...
T00 ERR ... 2021-6-4 13:29:1 Iteration 9 of 100
T00 ERR ... 2021-6-4 13:29:1 Total Energy -40.4283348732
T00 ERR ... 2021-6-4 13:29:1 DIIs error 4.11847976581e-06
T00 ERR ... 2021-6-4 13:29:1 Delta Etot -3.51931817022e-11
T00 ERR ...
T00 ERR ... 2021-6-4 13:29:1 Iteration 10 of 100
T00 ERR ... 2021-6-4 13:29:1 Total Energy -40.4283348733
T00 ERR ... 2021-6-4 13:29:1 DIIs error 6.39551196634e-07
T00 ERR ... 2021-6-4 13:29:1 Delta Etot -6.88586965225e-11
T00 ERR ...
T00 ERR ... 2021-6-4 13:29:1 Iteration 11 of 100
T00 ERR ... 2021-6-4 13:29:2 Total Energy -40.4283348733
T00 ERR ... 2021-6-4 13:29:2 DIIs error 1.34029577873e-07
T00 ERR ... 2021-6-4 13:29:2 Delta Etot -1.9610979507e-12
T00 ERR ...
T00 ERR ... 2021-6-4 13:29:2 Iteration 12 of 100
T00 ERR ... 2021-6-4 13:29:2 Total Energy -40.4283348733
T00 ERR ... 2021-6-4 13:29:2 DIIs error 1.42665661485e-08
T00 ERR ... 2021-6-4 13:29:2 Delta Etot -7.1054273576e-14
T00 ERR ... 2021-6-4 13:29:2 Total Energy has converged to -7.10542736e-14[Ha] after 12 iterations. DIIS error is converged up to 1.42665661e-08
T00 ERR ... 2021-6-4 13:29:2 Final Single Point Energy -40.4283348733 Ha
T00 ERR ... 2021-6-4 13:29:2 Final Local Exc contribution -5.19288292765 Ha
T00 ERR ... 2021-6-4 13:29:2 Final Non Local Ex contribution -1.64346676034 Ha
T00 ERR ...   Orbital energies:
T00 ERR ...   index occupation energy(Hartree)
T00 ERR ...      0      2   -10.2155439702
T00 ERR ...      1      2   -0.7051474502
T00 ERR ...      2      2   -0.4018530763
T00 ERR ...      3      2   -0.4013030561
T00 ERR ...      4      2   -0.4005167239
T00 ERR ...      5      0   +0.0873160644
T00 ERR ...      6      0   +0.1580404991
T00 ERR ...      7      0   +0.1586955443
T00 ERR ...      8      0   +0.1589281315
T00 ERR ...      9      0   +0.4330256012
T00 ERR ...     10      0   +0.4342802104
T00 ERR ...     11      0   +0.4352482599
T00 ERR ...     12      0   +0.6747490915
T00 ERR ...     13      0   +0.7038048165
T00 ERR ...     14      0   +0.7052280157
T00 ERR ...     15      0   +0.7057531842
T00 ERR ...     16      0   +0.8002909160
T00 ERR ...     17      0   +1.0999417333
T00 ERR ...     18      0   +1.1004096807
T00 ERR ...     19      0   +1.5445777049
T00 ERR ...     20      0   +1.5470371037
T00 ERR ...     21      0   +1.5494748355
T00 ERR ...     22      0   +1.7740441528
T00 ERR ...     23      0   +1.7790714705
T00 ERR ...     24      0   +1.7829840060
T00 ERR ...     25      0   +2.1478692073
T00 ERR ...     26      0   +2.1543523363
T00 ERR ...     27      0   +2.1593032775
T00 ERR ...     28      0   +2.5457715880
T00 ERR ...     29      0   +2.5462267824
T00 ERR ...     30      0   +2.6358795669
T00 ERR ...     31      0   +2.9321001950
T00 ERR ...     32      0   +2.9387290718
T00 ERR ...     33      0   +2.9434070937
T00 ERR ... 2021-6-4 13:29:2 Electric Dipole is[e*bohr]:
                 dx=0.000671714438788
                 dy=0.00319883857112
                 dz=-0.00105486264846
T00 ERR ... Writing result to votca.orb
T00 ERR ... QM energy[Hrt]: -40.42833487
T00 ERR ... 2021-6-4 13:29:2 RPA level range [0:33]
T00 ERR ... 2021-6-4 13:29:2 GW  level range [0:13]
T00 ERR ... 2021-6-4 13:29:2 BSE level range occ[0:4]  virt[5:13]
T00 ERR ... 2021-6-4 13:29:2 BSE Hamiltonian has size 45x45
T00 ERR ...  BSE type: full
T00 ERR ...  BSE without Hqp offdiagonal elements
T00 ERR ...  Running GW as: evGW
T00 ERR ...  g_sc_limit [Hartree]: 1e-05
T00 ERR ...  gw_sc_limit [Hartree]: 1e-05
T00 ERR ...  Tasks:
T00 ERR ...  GW
T00 ERR ...  singlets
T00 ERR ...  Store:
T00 ERR ...  GW
T00 ERR ...  Sigma integration: ppm
T00 ERR ...  eta: 0.001
T00 ERR ...  Quadrature integration order : 12
T00 ERR ...  Quadrature integration scheme : legendre
T00 ERR ...  Alpha smoothing parameter : 0.001
T00 ERR ...  QP solver: grid
T00 ERR ...  QP grid steps: 1001
T00 ERR ...  QP grid spacing: 0.001
T00 ERR ...  evGW with Anderson update with history 20 using alpha 0.7
T00 ERR ... 2021-6-4 13:29:2 Using 2 threads
T00 ERR ... 2021-6-4 13:29:2 Using native Eigen implementation, no BLAS overload
T00 ERR ... 2021-6-4 13:29:2 Molecule Coordinates [A]
T00 ERR ...     0    C   30.3000 1.2704 5.5205
T00 ERR ...     1    H   31.2392 1.4802 6.0301
T00 ERR ...     2    H   30.4910 0.6554 4.6433
T00 ERR ...     3    H   29.8500 2.2100 5.2100
T00 ERR ...     4    H   29.6200 0.7500 6.2000
T00 ERR ... 2021-6-4 13:29:2 DFT data was created by xtp
T00 ERR ... 2021-6-4 13:29:2 Loaded DFT Basis Set def2-svp
T00 ERR ... 2021-6-4 13:29:2 Filled DFT Basis of size 34
T00 ERR ... 2021-6-4 13:29:2 Loaded Auxbasis Set aux-def2-svp
T00 ERR ... 2021-6-4 13:29:2 Filled Auxbasis of size 104
T00 ERR ... 2021-6-4 13:29:2 Calculating Mmn_beta (3-center-repulsion x orbitals)
T00 ERR ... 2021-6-4 13:29:2 Calculated Mmn_beta (3-center-repulsion x orbitals)
T00 ERR ... 2021-6-4 13:29:2 Integrating Vxc in VOTCA with functional XC_HYB_GGA_XC_PBEH
T00 ERR ... 2021-6-4 13:29:2 Set hybrid exchange factor: 0.25
T00 ERR ... 2021-6-4 13:29:2 Calculated exchange-correlation expectation values
T00 ERR ... 2021-6-4 13:29:2 Calculated Hartree exchange contribution
T00 ERR ... 2021-6-4 13:29:2 Scissor shifting DFT energies by: 0 Hrt
T00 ERR ...   ====== Perturbative quasiparticle energies (Hartree) ======
T00 ERR ...    DeltaHLGap = +0.205535 Hartree
T00 ERR ...   Level =    0 DFT = -10.2155 VXC = -1.6995 S-X = -2.6641 S-C = +0.3756 GWA = -10.8046
T00 ERR ...   Level =    1 DFT = -0.7051 VXC = -0.4442 S-X = -0.6638 S-C = +0.0825 GWA = -0.8422
T00 ERR ...   Level =    2 DFT = -0.4019 VXC = -0.3984 S-X = -0.5342 S-C = +0.0166 GWA = -0.5210
T00 ERR ...   Level =    3 DFT = -0.4013 VXC = -0.3981 S-X = -0.5336 S-C = +0.0164 GWA = -0.5205
T00 ERR ...   HOMO  =    4 DFT = -0.4005 VXC = -0.3984 S-X = -0.5340 S-C = +0.0165 GWA = -0.5196
T00 ERR ...   LUMO  =    5 DFT = +0.0873 VXC = -0.1668 S-X = -0.0618 S-C = -0.0186 GWA = +0.1738
T00 ERR ...   Level =    6 DFT = +0.1580 VXC = -0.2033 S-X = -0.0792 S-C = -0.0233 GWA = +0.2590
T00 ERR ...   Level =    7 DFT = +0.1587 VXC = -0.2030 S-X = -0.0790 S-C = -0.0232 GWA = +0.2596
T00 ERR ...   Level =    8 DFT = +0.1589 VXC = -0.2028 S-X = -0.0788 S-C = -0.0232 GWA = +0.2598
T00 ERR ...   Level =    9 DFT = +0.4330 VXC = -0.2605 S-X = -0.0984 S-C = -0.0300 GWA = +0.5651
T00 ERR ...   Level =   10 DFT = +0.4343 VXC = -0.2608 S-X = -0.0984 S-C = -0.0301 GWA = +0.5666
T00 ERR ...   Level =   11 DFT = +0.4352 VXC = -0.2609 S-X = -0.0983 S-C = -0.0302 GWA = +0.5676
T00 ERR ...   Level =   12 DFT = +0.6747 VXC = -0.3539 S-X = -0.1453 S-C = -0.0757 GWA = +0.8076
T00 ERR ...   Level =   13 DFT = +0.7038 VXC = -0.3485 S-X = -0.1218 S-C = -0.0883 GWA = +0.8422
T00 ERR ... 2021-6-4 13:29:2 Calculated offdiagonal part of Sigma
T00 ERR ... 2021-6-4 13:29:2 Full quasiparticle Hamiltonian
T00 ERR ...   ====== Diagonalized quasiparticle energies (Hartree) ======
T00 ERR ...   Level =    0 PQP = -10.804624 DQP = -10.804684
T00 ERR ...   Level =    1 PQP = -0.842223 DQP = -0.842330
T00 ERR ...   Level =    2 PQP = -0.521043 DQP = -0.521146
T00 ERR ...   Level =    3 PQP = -0.520454 DQP = -0.520575
T00 ERR ...   HOMO  =    4 PQP = -0.519610 DQP = -0.519708
T00 ERR ...   LUMO  =    5 PQP = +0.173758 DQP = +0.172572
T00 ERR ...   Level =    6 PQP = +0.258964 DQP = +0.257085
T00 ERR ...   Level =    7 PQP = +0.259577 DQP = +0.259238
T00 ERR ...   Level =    8 PQP = +0.259752 DQP = +0.259485
T00 ERR ...   Level =    9 PQP = +0.565118 DQP = +0.565520
T00 ERR ...   Level =   10 PQP = +0.566580 DQP = +0.566975
T00 ERR ...   Level =   11 PQP = +0.567579 DQP = +0.567978
T00 ERR ...   Level =   12 PQP = +0.807555 DQP = +0.808905
T00 ERR ...   Level =   13 PQP = +0.842239 DQP = +0.843852
T00 ERR ... 2021-6-4 13:29:2 Diagonalized QP Hamiltonian
T00 ERR ... 2021-6-4 13:29:2 Setup Full singlet hamiltonian
T00 ERR ... 2021-6-4 13:29:2 Davidson Solver using 2 threads.
T00 ERR ... 2021-6-4 13:29:2 Tolerance : 0.0001
T00 ERR ... 2021-6-4 13:29:2 DPR Correction
T00 ERR ... 2021-6-4 13:29:2 Matrix size : 90x90
T00 ERR ... 2021-6-4 13:29:2 iter       Search Space    Norm
T00 ERR ... 2021-6-4 13:29:2    0           10   5.73e-02         0.00% converged
T00 ERR ... 2021-6-4 13:29:2    1           17   2.82e-02         0.00% converged
T00 ERR ... 2021-6-4 13:29:2    2           24   1.59e-02         0.00% converged
T00 ERR ... 2021-6-4 13:29:2    3           31   2.92e-03        60.00% converged
T00 ERR ... 2021-6-4 13:29:2    4           35   2.02e-04        80.00% converged
T00 ERR ... 2021-6-4 13:29:2    5           37   4.42e-05        100.00% converged
T00 ERR ... 2021-6-4 13:29:2 Davidson converged after 5 iterations.
T00 ERR ... 2021-6-4 13:29:2-----------------------------------
T00 ERR ... 2021-6-4 13:29:2- Davidson ran for 0.01035853secs.
T00 ERR ... 2021-6-4 13:29:2-----------------------------------
T00 ERR ... 2021-6-4 13:29:2 Solved BSE for singlets
T00 ERR ...   ====== singlet energies (eV) ======
T00 ERR ...   S =    1 Omega = +12.238216313939 eV  lamdba = +101.32 nm &lt;FT&gt; = +19.0081 &lt;K_x&gt; = +0.8682 &lt;K_d&gt; = -7.6381
T00 ERR ...            TrDipole length gauge[e*bohr]  dx = -0.4627 dy = +0.6020 dz = -0.4784 |d|^2 = +0.8052 f = +0.2414
T00 ERR ...            HOMO-0   -&gt; LUMO+0    : 98.3%
T00 ERR ...
T00 ERR ...   S =    2 Omega = +12.256189015095 eV  lamdba = +101.17 nm &lt;FT&gt; = +19.0436 &lt;K_x&gt; = +0.8526 &lt;K_d&gt; = -7.6400
T00 ERR ...            TrDipole length gauge[e*bohr]  dx = +0.7649 dy = +0.4729 dz = -0.1553 |d|^2 = +0.8329 f = +0.2501
T00 ERR ...            HOMO-1   -&gt; LUMO+0    : 96.5%
T00 ERR ...
T00 ERR ...   S =    3 Omega = +12.278446707808 eV  lamdba = +100.99 nm &lt;FT&gt; = +19.0484 &lt;K_x&gt; = +0.8724 &lt;K_d&gt; = -7.6424
T00 ERR ...            TrDipole length gauge[e*bohr]  dx = -0.1499 dy = +0.4753 dz = +0.7571 |d|^2 = +0.8215 f = +0.2471
T00 ERR ...            HOMO-2   -&gt; LUMO+0    : 97.1%
T00 ERR ...
T00 ERR ...   S =    4 Omega = +13.876840966781 eV  lamdba = +89.36 nm &lt;FT&gt; = +21.3641 &lt;K_x&gt; = +0.2514 &lt;K_d&gt; = -7.7387
T00 ERR ...            TrDipole length gauge[e*bohr]  dx = -0.0830 dy = +0.0229 dz = -0.0185 |d|^2 = +0.0078 f = +0.0026
T00 ERR ...            HOMO-0   -&gt; LUMO+1    : 67.2%
T00 ERR ...
T00 ERR ...   S =    5 Omega = +13.905418816386 eV  lamdba = +89.17 nm &lt;FT&gt; = +21.3870 &lt;K_x&gt; = +0.2471 &lt;K_d&gt; = -7.7287
T00 ERR ...            TrDipole length gauge[e*bohr]  dx = +0.0133 dy = +0.0444 dz = +0.0585 |d|^2 = +0.0056 f = +0.0019
T00 ERR ...            HOMO-2   -&gt; LUMO+1    : 51.9%
T00 ERR ...
T00 ERR ... 2021-6-4 13:29:2 GWBSE calculation finished
T00 ERR ... Next State is: s1
T00 ERR ... 2021-6-4 13:29:2 Evaluating polar 1
T00 ERR ... 2021-6-4 13:29:2 Evaluating interaction between polar 1 and qm 0
T00 ERR ... Next State is: s1
T00 ERR ... 2021-6-4 13:29:3 Evaluating interaction between polar 1 and static 2
T00 ERR ... 2021-6-4 13:29:3 Starting Solving for classical polarization with 1380 degrees of freedom.
T00 ERR ... 2021-6-4 13:29:3 CG: #iterations: 0, estimated error: 4.94939142948e-06
T00 ERR ...   Total static energy [hrt]= 0.0009102654542
T00 ERR ...   Total polar energy [hrt]= -0.0002985415123
T00 ERR ...  Total energy [hrt]= 0.0006117239419
T00 ERR ... 2021-6-4 13:29:3 Evaluating static 2
T00 ERR ... 2021-6-4 13:29:3 Writing checkpoint to checkpoint_iter_2.hdf5
T00 ERR ...  Region:qm 0 is converged deltaE=5.684341886e-14 RMS Dmat=2.021477407e-13 MaxDmat=4.260591879e-12
T00 ERR ... 2021-6-4 13:29:3 Region:polar 1 is converged deltaE=0
T00 ERR ... 2021-6-4 13:29:3 --Total Energy all regions -39.97797699
T00 ERR ... 2021-6-4 13:29:3 Job converged after 2 iterations.
T00 ERR ... Next State is: s1
T00 ERR ... Reporting job results

T00 ERR ... Requesting next job
T00 ERR ... Assign jobs from stack
T00 ERR ... Sync did not yield any new jobs.
T00 ERR ... Next job: ID = - (none available)
MST ERR Assign jobs from stack
Changes have not been written to state file.
</pre></div></div>
</div>
<p>Finally, save the results</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[41]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="ch">#!xtp_parallel -e qmmm -o OPTIONFILES/qmmm.xml -f state.hdf5 -j &quot;read&quot;</span>
</pre></div>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="QMMM_LAMMPS.html" class="btn btn-neutral float-right" title="QMMM workflow using LAMMPS and VOTCA-XTP" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="DFTGWBSE_OPTIMIZATION.html" class="btn btn-neutral float-left" title="DFT + GWBSE Optimization Using CO" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2020, VOTCA Development Team.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>