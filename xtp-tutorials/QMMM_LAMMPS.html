

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>QMMM workflow using LAMMPS and VOTCA-XTP &mdash; VOTCA 2022-dev documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/theme_overrides.css" type="text/css" />

  
  

  
  

  

  
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Kinect Monte Carlo Simulations Using LAMMPS" href="LAMMPS_KMC.html" />
    <link rel="prev" title="QMMM workflow using GROMACS and VOTCA-XTP" href="QMMM_GROMACS.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html">
          

          
            
            <img src="../_static/customLogo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../INSTALL.html">Installation</a></li>
</ul>
<p class="caption"><span class="caption-text">Manuals</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tools/index.html">TOOLS Manual</a></li>
<li class="toctree-l1"><a class="reference internal" href="../csg/index.html">CSG Manual</a></li>
<li class="toctree-l1"><a class="reference internal" href="../xtp/XTP-MANUAL.html">XTP Manual</a></li>
</ul>
<p class="caption"><span class="caption-text">Tutorials</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../csg-tutorials/README.html">CSG Tutorial</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="XTP-TUTORIAL.html">XTP Tutorials</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="help.html">Support</a></li>
<li class="toctree-l2"><a class="reference internal" href="DFTGWBSE_ENERGY.html">DFT + GWBSE Energy Calculation Using CH4</a></li>
<li class="toctree-l2"><a class="reference internal" href="DFTGWBSE_OPTIMIZATION.html">DFT + GWBSE Optimization Using CO</a></li>
<li class="toctree-l2"><a class="reference internal" href="DFTGWBSE_OPTIMIZATION.html#Introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="DFTGWBSE_OPTIMIZATION.html#Requirements">Requirements</a></li>
<li class="toctree-l2"><a class="reference internal" href="DFTGWBSE_OPTIMIZATION.html#Preparing-the-input">Preparing the input</a></li>
<li class="toctree-l2"><a class="reference internal" href="QMMM_GROMACS.html">QMMM workflow using GROMACS and VOTCA-XTP</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">QMMM workflow using LAMMPS and VOTCA-XTP</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#What-is-this-tutorial-about">What is this tutorial about</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Requirements">Requirements</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Interacting-with-the-XTP-command-line-interface">Interacting with the XTP command line interface</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Note">Note</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#Setting-the-environment">Setting the environment</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Generate-the-topology-from-the-Gromacs-file">Generate the topology from the Gromacs file</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Check-the-mapping">Check the mapping</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Neighborlist-Calculation">Neighborlist Calculation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Read-reorganization-energies">Read reorganization energies</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Compute-site-energy">Compute site energy</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Site-energy-and-pair-energy-analysis">Site energy and pair energy analysis</a></li>
<li class="toctree-l3"><a class="reference internal" href="#QM-energy-calculation">QM energy calculation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#QM-calculation-for-pairs">QM calculation for pairs</a></li>
<li class="toctree-l3"><a class="reference internal" href="#QMMM-Calculations">QMMM Calculations</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="LAMMPS_KMC.html">Kinect Monte Carlo Simulations Using LAMMPS</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Development</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../DEVELOPERS_GUIDE.html">Developer and Contributor Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../VOTCA_LANGUAGE_GUIDE.html">VOTCA Internal Contributor Language Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../CODE_OF_CONDUCT.html">Code of Conduct</a></li>
<li class="toctree-l1"><a class="reference internal" href="../websiteAndDocumentation.html">Website and Documentation</a></li>
</ul>
<p class="caption"><span class="caption-text">Community</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://github.com/votca">GitHub</a></li>
<li class="toctree-l1"><a class="reference external" href="https://twitter.com/votca_software">Twitter</a></li>
<li class="toctree-l1"><a class="reference external" href="https://groups.google.com/g/votca">Forum</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">VOTCA</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="XTP-TUTORIAL.html">XTP Tutorials</a> &raquo;</li>
        
      <li>QMMM workflow using LAMMPS and VOTCA-XTP</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/xtp-tutorials/QMMM_LAMMPS.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="QMMM-workflow-using-LAMMPS-and-VOTCA-XTP">
<h1>QMMM workflow using LAMMPS and VOTCA-XTP<a class="headerlink" href="#QMMM-workflow-using-LAMMPS-and-VOTCA-XTP" title="Permalink to this headline">¶</a></h1>
<div class="section" id="What-is-this-tutorial-about">
<h2>What is this tutorial about<a class="headerlink" href="#What-is-this-tutorial-about" title="Permalink to this headline">¶</a></h2>
<p>In this tutorial, we will learn how to set and perform excited state calculation using the Votca XTP library. We will use thiophene as our QM region.</p>
</div>
<div class="section" id="Requirements">
<h2>Requirements<a class="headerlink" href="#Requirements" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>You will need to install <strong>VOTCA</strong> using the instructions described <a class="reference external" href="https://github.com/votca/votca/blob/master/share/doc/INSTALL.rst">here</a></p></li>
<li><p>Once the installation is completed you need to activate the VOTCA enviroment by running the <code class="docutils literal notranslate"><span class="pre">VOTCARC.bash</span></code> script that has been installed at the bin subfolder for the path that you have provided for the installation step above</p></li>
</ul>
</div>
<div class="section" id="Interacting-with-the-XTP-command-line-interface">
<h2>Interacting with the XTP command line interface<a class="headerlink" href="#Interacting-with-the-XTP-command-line-interface" title="Permalink to this headline">¶</a></h2>
<p>The XTP package offers the following command line interface that the user can interact with: * <a class="reference external" href="https://www.votca.org/xtp/xtp_map.html">xtp_map</a> * <a class="reference external" href="https://www.votca.org/xtp/xtp_parallel.html">xtp_parallel</a> * <a class="reference external" href="https://www.votca.org/xtp/xtp_run.html">xtp_run</a> * <a class="reference external" href="https://www.votca.org/xtp/xtp_tools.html">xtp_tools</a></p>
<p>Run the following command to view the help message of <code class="docutils literal notranslate"><span class="pre">xtp_tools</span></code>:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">!</span>xtp_tools -h
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
==================================================
========   VOTCA (http://www.votca.org)   ========
==================================================

please submit bugs to https://github.com/votca/xtp/issues

xtp_tools, version 2022-dev gitid: 834347a (compiled May 21 2021, 06:20:45)
votca_csg, version 2022-dev gitid: 834347a (compiled May 21 2021, 06:04:29)
votca_tools, version 2022-dev gitid: 834347a (compiled May 21 2021, 06:01:42)

Runs excitation/charge transport tools



Allowed options:
  -h [ --help ]                 display this help and exit
  --verbose                     be loud and noisy
  --verbose1                    be very loud and noisy
  -v [ --verbose2 ]             be extremly loud and noisy
  -o [ --options ] arg          calculator options
  -t [ --nthreads ] arg (=1)    number of threads to create

Tools:
  -e [ --execute ] arg        name of the tool to run
  -l [ --list ]               Lists all available tools
  -d [ --description ] arg    Short description of a tool
  -n [ --name ] arg           Name of the job to run

</pre></div></div>
</div>
<div class="section" id="Note">
<h3>Note<a class="headerlink" href="#Note" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><ul class="simple">
<li><p>In Jupyter the <code class="docutils literal notranslate"><span class="pre">!</span></code> symbol means: <em>run the following command as a standard unix command</em></p></li>
<li><p>In Jupyter the command <code class="docutils literal notranslate"><span class="pre">%env</span></code> set an environmental variable</p></li>
</ul>
</div></blockquote>
</div>
</div>
<div class="section" id="Setting-the-environment">
<h2>Setting the environment<a class="headerlink" href="#Setting-the-environment" title="Permalink to this headline">¶</a></h2>
<p>Create a folder to store the input <code class="docutils literal notranslate"><span class="pre">Options</span></code> for XTP</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">!</span>mkdir -p OPTIONFILES
</pre></div>
</div>
</div>
<p>Remove previous hdf5 file</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">!</span>rm -f state.hdf5
</pre></div>
</div>
</div>
<p>Import an small python module to edit xml files</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">xml_editor</span> <span class="kn">import</span> <span class="n">add_section</span><span class="p">,</span> <span class="n">edit_calculator</span>
<span class="kn">import</span> <span class="nn">os</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Generate-the-topology-from-the-Gromacs-file">
<h2>Generate the topology from the Gromacs file<a class="headerlink" href="#Generate-the-topology-from-the-Gromacs-file" title="Permalink to this headline">¶</a></h2>
<p>We will first generate the mapping from MD coordinates to segments, creating an <a class="reference external" href="https://www.hdfgroup.org/solutions/hdf5/">hdf5 file</a> to store the results. You can explore the generated <code class="docutils literal notranslate"><span class="pre">state.hdf5</span></code> file with e.g. hdf5itebrowser. In Python, you can use the <a class="reference external" href="https://www.h5py.org/">h5py library</a>. The command to generate the mapping is the following,</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">!</span>xtp_map -v -t MD_FILES/newfile.data -c MD_FILES/traj.dump -s system.xml -f state.hdf5 -i <span class="m">99</span> &gt; mapping.out
</pre></div>
</div>
</div>
</div>
<div class="section" id="Check-the-mapping">
<h2>Check the mapping<a class="headerlink" href="#Check-the-mapping" title="Permalink to this headline">¶</a></h2>
<p>Let us first output <code class="docutils literal notranslate"><span class="pre">.pdb</span></code> files for the segments, qmmolecules and classical segments in order to check the mapping. We will need to copy the input from the <code class="docutils literal notranslate"><span class="pre">VOTCA</span></code> installation path to our local copy.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">!</span>cp <span class="s2">&quot;</span><span class="nv">$VOTCASHARE</span><span class="s2">/xtp/xml/mapchecker.xml&quot;</span> OPTIONFILES/
</pre></div>
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">${VOTCASHARE}</span></code> environmental variable is set to the path that you provided during the <code class="docutils literal notranslate"><span class="pre">VOTCA</span></code> <a class="reference external" href="https://github.com/votca/votca/blob/master/share/doc/INSTALL.rst">installation</a>, by the default is set to <code class="docutils literal notranslate"><span class="pre">/usr/local/votca</span></code>.</p>
<p>We need to update the <code class="docutils literal notranslate"><span class="pre">mapchecker</span></code> options with the file containing the definition of the system. For doing, so we will use the python module <code class="docutils literal notranslate"><span class="pre">xml_editor</span></code> that we have imported above. The first argument is the name of the calculator (i.e. <code class="docutils literal notranslate"><span class="pre">mapchecker</span></code>), the seconds argument is the name of the option to change and the third one, the value to use.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">edit_calculator</span><span class="p">(</span><span class="s2">&quot;mapchecker&quot;</span><span class="p">,</span> <span class="s2">&quot;map_file&quot;</span><span class="p">,</span> <span class="s2">&quot;system.xml&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The option &#39;map_file&#39; on file &#39;OPTIONFILES/mapchecker.xml&#39; has been set to &#39;system.xml&#39;
</pre></div></div>
</div>
<p>In the <a class="reference external" href="https://www.votca.org/xtp/mapchecker.html">mapchecker section of the manual</a> you can find a table with the <code class="docutils literal notranslate"><span class="pre">mapchecker</span></code> input variables and their corresponding defaults. Finally, the following command run the check</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">!</span>xtp_run -e mapchecker -o OPTIONFILES/mapchecker.xml -f state.hdf5
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
==================================================
========   VOTCA (http://www.votca.org)   ========
==================================================

please submit bugs to https://github.com/votca/xtp/issues

xtp_run, version 2022-dev gitid: 834347a (compiled May 21 2021, 06:20:45)
votca_csg, version 2022-dev gitid: 834347a (compiled May 21 2021, 06:04:29)
votca_tools, version 2022-dev gitid: 834347a (compiled May 21 2021, 06:01:42)

Initializing calculator
... mapchecker
1 frames in statefile, Ids are: 10000
Starting at frame 10000
Evaluating frame 10000
Import MD Topology (i.e. frame 10000) from state.hdf5
....
... mapchecker  Using 1 threads
Writing segments to md_segments_step_10000.pdb
Writing qmmolecules to qm_segments_n_step_10000.pdb
Writing polarsegments to mp_segments_e_step_10000.pdb
Writing polarsegments to mp_segments_h_step_10000.pdb

Changes have not been written to state file.
</pre></div></div>
</div>
</div>
<div class="section" id="Neighborlist-Calculation">
<h2>Neighborlist Calculation<a class="headerlink" href="#Neighborlist-Calculation" title="Permalink to this headline">¶</a></h2>
<p>The following step is to determine the neighbouring pairs for exciton transport.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">!</span>cp <span class="s2">&quot;</span><span class="nv">$VOTCASHARE</span><span class="s2">/xtp/xml/neighborlist.xml&quot;</span> OPTIONFILES/
</pre></div>
</div>
</div>
<p>We will use a cutoff of 1.5,</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">constant</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;&lt;constant help=&quot;cutoff for all other types of pairs&quot;&gt;1.5&lt;/constant&gt;&quot;&quot;&quot;</span>
<span class="n">add_section</span><span class="p">(</span><span class="s2">&quot;neighborlist&quot;</span><span class="p">,</span> <span class="n">constant</span><span class="p">)</span>
<span class="o">!</span>xtp_run -e neighborlist -o OPTIONFILES/neighborlist.xml -f state.hdf5
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
==================================================
========   VOTCA (http://www.votca.org)   ========
==================================================

please submit bugs to https://github.com/votca/xtp/issues

xtp_run, version 2022-dev gitid: 834347a (compiled May 21 2021, 06:20:45)
votca_csg, version 2022-dev gitid: 834347a (compiled May 21 2021, 06:04:29)
votca_tools, version 2022-dev gitid: 834347a (compiled May 21 2021, 06:01:42)

Initializing calculator
... neighborlist
1 frames in statefile, Ids are: 10000
Starting at frame 10000
Evaluating frame 10000
Import MD Topology (i.e. frame 10000) from state.hdf5
....
... neighborlist  Using 1 threads
Evaluating 1000 segments for neighborlist.
 ... ... Evaluating
0%   10   20   30   40   50   60   70   80   90   100%
|----|----|----|----|----|----|----|----|----|----|
***************************************************

 ... ... Created 90067 direct pairs.
Wrote MD topology (step = 10000, time = 0) to state.hdf5
... .
</pre></div></div>
</div>
</div>
<div class="section" id="Read-reorganization-energies">
<h2>Read reorganization energies<a class="headerlink" href="#Read-reorganization-energies" title="Permalink to this headline">¶</a></h2>
<p>In this step we will read the in site reorganization energies and store them in the <code class="docutils literal notranslate"><span class="pre">state.hdf5</span></code> file. We just need to copy the input file and execute the calculation</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">!</span>cp <span class="s2">&quot;</span><span class="nv">$VOTCASHARE</span><span class="s2">/xtp/xml/einternal.xml&quot;</span> OPTIONFILES/
<span class="o">!</span>xtp_run -e einternal -o OPTIONFILES/einternal.xml -f state.hdf5
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
==================================================
========   VOTCA (http://www.votca.org)   ========
==================================================

please submit bugs to https://github.com/votca/xtp/issues

xtp_run, version 2022-dev gitid: 834347a (compiled May 21 2021, 06:20:45)
votca_csg, version 2022-dev gitid: 834347a (compiled May 21 2021, 06:04:29)
votca_tools, version 2022-dev gitid: 834347a (compiled May 21 2021, 06:01:42)

Initializing calculator
... einternal
1 frames in statefile, Ids are: 10000
Starting at frame 10000
Evaluating frame 10000
Import MD Topology (i.e. frame 10000) from state.hdf5
....
... einternal  Using 1 threads
... ... Site, reorg. energies from system.xml.

... ... Read in site, reorg. energies for 1000 segments.
Wrote MD topology (step = 10000, time = 0) to state.hdf5
... .
</pre></div></div>
</div>
</div>
<div class="section" id="Compute-site-energy">
<h2>Compute site energy<a class="headerlink" href="#Compute-site-energy" title="Permalink to this headline">¶</a></h2>
<p>In this step we will perform some <em>QMMM</em> calculations to compute the site energies. The <code class="docutils literal notranslate"><span class="pre">qmmm_mm.xml</span></code> file contains some predefined settings to perform the <em>MM</em> calculations. Let us first copy these settings into the state file,</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">!</span>cp qmmm_mm.xml OPTIONFILES
<span class="o">!</span>xtp_parallel -e qmmm -o OPTIONFILES/qmmm_mm.xml -f state.hdf5 -j <span class="s2">&quot;write&quot;</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
==================================================
========   VOTCA (http://www.votca.org)   ========
==================================================

please submit bugs to https://github.com/votca/xtp/issues

xtp_parallel, version 2022-dev gitid: 834347a (compiled May 21 2021, 06:20:45)
votca_csg, version 2022-dev gitid: 834347a (compiled May 21 2021, 06:04:29)
votca_tools, version 2022-dev gitid: 834347a (compiled May 21 2021, 06:01:42)

Initializing calculator
... qmmm
... ... Initialized with 1 threads.

... ... Using 1 openmp threads for 1x1=1 total threads.
1 frames in statefile, Ids are: 10000
Starting at frame 10000
Evaluating frame 10000
Import MD Topology (i.e. frame 10000) from state.hdf5
....
... qmmm
... ... Writing job file qmmm_mm_jobs.xml
... ... In total 3001 jobs
Changes have not been written to state file.
</pre></div></div>
</div>
<p>The previous command generates a <code class="docutils literal notranslate"><span class="pre">qmmm_mm_jobs.xml</span></code> containing 3000 <em>MM</em> jobs to compute, if you examine that file, it should look something like:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;jobs&gt;</span>
        <span class="nt">&lt;job&gt;</span>
                <span class="nt">&lt;id&gt;</span>0<span class="nt">&lt;/id&gt;</span>
                <span class="nt">&lt;tag&gt;</span>thiophene_0:n<span class="nt">&lt;/tag&gt;</span>
                <span class="nt">&lt;input&gt;</span>
                        <span class="nt">&lt;site_energies&gt;</span>0:n<span class="nt">&lt;/site_energies&gt;</span>
                        <span class="nt">&lt;regions&gt;</span>
                                <span class="nt">&lt;region&gt;</span>
                                        <span class="nt">&lt;id&gt;</span>0<span class="nt">&lt;/id&gt;</span>
                                        <span class="nt">&lt;segments&gt;</span>0:n<span class="nt">&lt;/segments&gt;</span>
                                <span class="nt">&lt;/region&gt;</span>
                        <span class="nt">&lt;/regions&gt;</span>
                <span class="nt">&lt;/input&gt;</span>
                <span class="nt">&lt;status&gt;</span>AVAILABLE<span class="nt">&lt;/status&gt;</span>
        <span class="nt">&lt;/job&gt;</span>
</pre></div>
</div>
<p>Let us run just the first 4 jobs by settings all jobs <code class="docutils literal notranslate"><span class="pre">status</span></code> to <code class="docutils literal notranslate"><span class="pre">COMPLETE</span></code> except for the first four. This can be easily done with <a class="reference external" href="https://www.gnu.org/software/sed/manual/sed.html">sed</a> as follows,</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">!</span>sed -i <span class="s2">&quot;s/AVAILABLE/COMPLETE/g&quot;</span> qmmm_mm_jobs.xml
<span class="o">!</span>sed -i <span class="s1">&#39;0,/COMPLETE/s/COMPLETE/AVAILABLE/&#39;</span> qmmm_mm_jobs.xml
<span class="o">!</span>sed -i <span class="s1">&#39;0,/COMPLETE/s/COMPLETE/AVAILABLE/&#39;</span> qmmm_mm_jobs.xml
<span class="o">!</span>sed -i <span class="s1">&#39;0,/COMPLETE/s/COMPLETE/AVAILABLE/&#39;</span> qmmm_mm_jobs.xml
<span class="o">!</span>sed -i <span class="s1">&#39;0,/COMPLETE/s/COMPLETE/AVAILABLE/&#39;</span> qmmm_mm_jobs.xml
</pre></div>
</div>
</div>
<p>Now we can run the jobs and save the results in the state file</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">!</span>xtp_parallel -e qmmm -o OPTIONFILES/qmmm_mm.xml -f state.hdf5 -j <span class="s2">&quot;run&quot;</span>
<span class="o">!</span>xtp_parallel -e qmmm -o OPTIONFILES/qmmm_mm.xml -f state.hdf5 -j <span class="s2">&quot;read&quot;</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
==================================================
========   VOTCA (http://www.votca.org)   ========
==================================================

please submit bugs to https://github.com/votca/xtp/issues

xtp_parallel, version 2022-dev gitid: 834347a (compiled May 21 2021, 06:20:45)
votca_csg, version 2022-dev gitid: 834347a (compiled May 21 2021, 06:04:29)
votca_tools, version 2022-dev gitid: 834347a (compiled May 21 2021, 06:01:42)

Initializing calculator
... qmmm
... ... Initialized with 1 threads.

... ... Using 1 openmp threads for 1x1=1 total threads.
1 frames in statefile, Ids are: 10000
Starting at frame 10000
Evaluating frame 10000
Import MD Topology (i.e. frame 10000) from state.hdf5
....
... qmmm
MST ERR Job file = &#39;qmmm_mm_jobs.xml&#39;, cache size =  8
MST ERR Initialize jobs from qmmm_mm_jobs.xml
MST ERR Registered 3000 jobs.
T00 ERR ... Requesting next job
T00 ERR ... Assign jobs from stack
T00 ERR ... Next job: ID = 0=&gt; [ 0%]
T00 ERR ...  Regions created
T00 ERR ... Id: 0 type: polar size: 109 charge[e]= -2.40363e-14
T00 ERR ... Id: 1 type: static size: 220 charge[e]= -4.86833e-14
T00 ERR ... 2021-5-21 6:34:22 Writing jobtopology to MMMM/frame_10000/job_0_thiophene_0:n/regions.pdb
T00 ERR ... 2021-5-21 6:34:22 Only 1 scf region is used. The remaining regions are static. So no inter regions scf is required.
T00 ERR ... 2021-5-21 6:34:22 --Inter Region SCF Iteration 1 of 1
T00 ERR ... 2021-5-21 6:34:22 Evaluating polar 0
T00 ERR ... 2021-5-21 6:34:22 Evaluating interaction between polar 0 and static 1
T00 ERR ... 2021-5-21 6:34:22 Starting Solving for classical polarization with 2943 degrees of freedom.
T00 ERR ... 2021-5-21 6:34:22 CG: #iterations: 9, estimated error: 5.8912e-06
T00 ERR ...   Total static energy [hrt]= -0.1317875845
T00 ERR ...   Total polar energy [hrt]= -0.04919654338
T00 ERR ...  Total energy [hrt]= -0.1809841279
T00 ERR ... 2021-5-21 6:34:23 Evaluating static 1
T00 ERR ... 2021-5-21 6:34:23 Writing checkpoint to checkpoint_iter_1.hdf5
T00 ERR ... Reporting job results

T00 ERR ... Requesting next job
T00 ERR ... Next job: ID = 1
T00 ERR ...  Regions created
T00 ERR ... Id: 0 type: polar size: 109 charge[e]= -1
T00 ERR ... Id: 1 type: static size: 220 charge[e]= -4.868327963e-14
T00 ERR ... 2021-5-21 6:34:23 Writing jobtopology to MMMM/frame_10000/job_1_thiophene_0:e/regions.pdb
T00 ERR ... 2021-5-21 6:34:23 Only 1 scf region is used. The remaining regions are static. So no inter regions scf is required.
T00 ERR ... 2021-5-21 6:34:23 --Inter Region SCF Iteration 1 of 1
T00 ERR ... 2021-5-21 6:34:23 Evaluating polar 0
T00 ERR ... 2021-5-21 6:34:23 Evaluating interaction between polar 0 and static 1
T00 ERR ... 2021-5-21 6:34:23 Starting Solving for classical polarization with 2943 degrees of freedom.
T00 ERR ... 2021-5-21 6:34:23 CG: #iterations: 9, estimated error: 7.290261819e-06
T00 ERR ...   Total static energy [hrt]= -0.1308082539
T00 ERR ...   Total polar energy [hrt]= -0.07598511534
T00 ERR ...  Total energy [hrt]= -0.2067933693
T00 ERR ... 2021-5-21 6:34:23 Evaluating static 1
T00 ERR ... 2021-5-21 6:34:23 Writing checkpoint to checkpoint_iter_1.hdf5
T00 ERR ... Reporting job results

T00 ERR ... Requesting next job
T00 ERR ... Next job: ID = 2
T00 ERR ...  Regions created
T00 ERR ... Id: 0 type: polar size: 109 charge[e]= 1
T00 ERR ... Id: 1 type: static size: 220 charge[e]= -4.868327963e-14
T00 ERR ... 2021-5-21 6:34:24 Writing jobtopology to MMMM/frame_10000/job_2_thiophene_0:h/regions.pdb
T00 ERR ... 2021-5-21 6:34:24 Only 1 scf region is used. The remaining regions are static. So no inter regions scf is required.
T00 ERR ... 2021-5-21 6:34:24 --Inter Region SCF Iteration 1 of 1
T00 ERR ... 2021-5-21 6:34:24 Evaluating polar 0
T00 ERR ... 2021-5-21 6:34:24 Evaluating interaction between polar 0 and static 1
T00 ERR ... 2021-5-21 6:34:24 Starting Solving for classical polarization with 2943 degrees of freedom.
T00 ERR ... 2021-5-21 6:34:24 CG: #iterations: 9, estimated error: 6.815230208e-06
T00 ERR ...   Total static energy [hrt]= -0.1321768235
T00 ERR ...   Total polar energy [hrt]= -0.07922942047
T00 ERR ...  Total energy [hrt]= -0.2114062439
T00 ERR ... 2021-5-21 6:34:24 Evaluating static 1
T00 ERR ... 2021-5-21 6:34:24 Writing checkpoint to checkpoint_iter_1.hdf5
T00 ERR ... Reporting job results

T00 ERR ... Requesting next job
T00 ERR ... Next job: ID = 3
T00 ERR ...  Regions created
T00 ERR ... Id: 0 type: polar size: 104 charge[e]= -2.292610546e-14
T00 ERR ... Id: 1 type: static size: 222 charge[e]= -4.912736884e-14
T00 ERR ... 2021-5-21 6:34:25 Writing jobtopology to MMMM/frame_10000/job_3_thiophene_1:n/regions.pdb
T00 ERR ... 2021-5-21 6:34:25 Only 1 scf region is used. The remaining regions are static. So no inter regions scf is required.
T00 ERR ... 2021-5-21 6:34:25 --Inter Region SCF Iteration 1 of 1
T00 ERR ... 2021-5-21 6:34:25 Evaluating polar 0
T00 ERR ... 2021-5-21 6:34:25 Evaluating interaction between polar 0 and static 1
T00 ERR ... 2021-5-21 6:34:25 Starting Solving for classical polarization with 2808 degrees of freedom.
T00 ERR ... 2021-5-21 6:34:25 CG: #iterations: 9, estimated error: 5.656501514e-06
T00 ERR ...   Total static energy [hrt]= -0.1295146321
T00 ERR ...   Total polar energy [hrt]= -0.04409049212
T00 ERR ...  Total energy [hrt]= -0.1736051242
T00 ERR ... 2021-5-21 6:34:25 Evaluating static 1
T00 ERR ... 2021-5-21 6:34:25 Writing checkpoint to checkpoint_iter_1.hdf5
T00 ERR ... Reporting job results

T00 ERR ... Requesting next job
T00 ERR ... Assign jobs from stack
T00 ERR ... Sync did not yield any new jobs.
T00 ERR ... Next job: ID = - (none available)
MST ERR Assign jobs from stack
Changes have not been written to state file.
==================================================
========   VOTCA (http://www.votca.org)   ========
==================================================

please submit bugs to https://github.com/votca/xtp/issues

xtp_parallel, version 2022-dev gitid: 834347a (compiled May 21 2021, 06:20:45)
votca_csg, version 2022-dev gitid: 834347a (compiled May 21 2021, 06:04:29)
votca_tools, version 2022-dev gitid: 834347a (compiled May 21 2021, 06:01:42)

Initializing calculator
... qmmm
... ... Initialized with 1 threads.

... ... Using 1 openmp threads for 1x1=1 total threads.
1 frames in statefile, Ids are: 10000
Starting at frame 10000
Evaluating frame 10000
Import MD Topology (i.e. frame 10000) from state.hdf5
....
... qmmm
Found 1 states of type e
Found 1 states of type h
Found 2 states of type n
2996 incomplete jobs found.

Wrote MD topology (step = 10000, time = 0) to state.hdf5
... .
</pre></div></div>
</div>
</div>
<div class="section" id="Site-energy-and-pair-energy-analysis">
<h2>Site energy and pair energy analysis<a class="headerlink" href="#Site-energy-and-pair-energy-analysis" title="Permalink to this headline">¶</a></h2>
<p>In this step we generate an histogram and compute the correlation function of site energies and pair energy differences.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">!</span>cp <span class="s2">&quot;</span><span class="nv">$VOTCASHARE</span><span class="s2">/xtp/xml/eanalyze.xml&quot;</span> OPTIONFILES/
<span class="o">!</span>xtp_run -e eanalyze -o OPTIONFILES/eanalyze.xml -f state.hdf5
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
==================================================
========   VOTCA (http://www.votca.org)   ========
==================================================

please submit bugs to https://github.com/votca/xtp/issues

xtp_run, version 2022-dev gitid: 834347a (compiled May 21 2021, 06:20:45)
votca_csg, version 2022-dev gitid: 834347a (compiled May 21 2021, 06:04:29)
votca_tools, version 2022-dev gitid: 834347a (compiled May 21 2021, 06:01:42)

Initializing calculator
... eanalyze
1 frames in statefile, Ids are: 10000
Starting at frame 10000
Evaluating frame 10000
Import MD Topology (i.e. frame 10000) from state.hdf5
....
... eanalyze  Using 1 threads
... ... Short-listed 1000 segments (pattern=&#39;*&#39;)
... ... ... NOTE Statistics of site energies and spatial correlations thereof are based on the short-listed segments only.
... ... ...      Statistics of site-energy differences operate on the full list.
... ... excited state e
... ... excited state h
... ... excited state s
... ... excited state t
Changes have not been written to state file.
</pre></div></div>
</div>
<p>You should now see a set of files prefixed with <code class="docutils literal notranslate"><span class="pre">eanalyze</span></code> containing the histrogram and correlation functions.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">!</span>ls eanalyze*
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
eanalyze.pairhist_e.out  eanalyze.pairlist_s.out  eanalyze.sitehist_e.out
eanalyze.pairhist_h.out  eanalyze.pairlist_t.out  eanalyze.sitehist_h.out
eanalyze.pairhist_s.out  eanalyze.sitecorr_e.out  eanalyze.sitehist_s.out
eanalyze.pairhist_t.out  eanalyze.sitecorr_h.out  eanalyze.sitehist_t.out
eanalyze.pairlist_e.out  eanalyze.sitecorr_s.out
eanalyze.pairlist_h.out  eanalyze.sitecorr_t.out
</pre></div></div>
</div>
</div>
<div class="section" id="QM-energy-calculation">
<h2>QM energy calculation<a class="headerlink" href="#QM-energy-calculation" title="Permalink to this headline">¶</a></h2>
<p>Our next task is to perform the qm calculations for each segment that we have stored in the hdf5 file. The calculations take place in 3 stages: write the jobs to a file, perform the computation and finally save the results to the state file. We will first copy the input into our local folder</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">!</span>cp <span class="s2">&quot;</span><span class="nv">$VOTCASHARE</span><span class="s2">/xtp/xml/eqm.xml&quot;</span> OPTIONFILES/
</pre></div>
</div>
</div>
<p>Now we set the GWBSE mode to <code class="docutils literal notranslate"><span class="pre">G0W0</span></code>, the <code class="docutils literal notranslate"><span class="pre">ranges</span></code> to <code class="docutils literal notranslate"><span class="pre">full</span></code> and the <code class="docutils literal notranslate"><span class="pre">basisset</span></code> and <code class="docutils literal notranslate"><span class="pre">auxbasisset</span></code> to <code class="docutils literal notranslate"><span class="pre">def2-svp</span></code> and <code class="docutils literal notranslate"><span class="pre">aux-def2-svp</span></code>. For more information, check the <a class="reference external" href="https://www.votca.org/xtp/eqm.html">eqm calculator options</a>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">edit_calculator</span><span class="p">(</span><span class="s2">&quot;eqm&quot;</span><span class="p">,</span> <span class="s2">&quot;gwbse_options.gwbse.ranges&quot;</span><span class="p">,</span> <span class="s2">&quot;full&quot;</span><span class="p">)</span>
<span class="n">edit_calculator</span><span class="p">(</span><span class="s2">&quot;eqm&quot;</span><span class="p">,</span> <span class="s2">&quot;gwbse_options.gwbse.mode&quot;</span><span class="p">,</span> <span class="s2">&quot;G0W0&quot;</span><span class="p">)</span>
<span class="n">edit_calculator</span><span class="p">(</span><span class="s2">&quot;eqm&quot;</span><span class="p">,</span> <span class="s2">&quot;gwbse_options.gwbse.qp_solver&quot;</span><span class="p">,</span> <span class="s2">&quot;fixedpoint&quot;</span><span class="p">)</span>
<span class="n">edit_calculator</span><span class="p">(</span><span class="s2">&quot;eqm&quot;</span><span class="p">,</span> <span class="s2">&quot;gwbse_options.gwbse.qp_grid_steps&quot;</span><span class="p">,</span> <span class="s2">&quot;100&quot;</span><span class="p">)</span>
<span class="n">edit_calculator</span><span class="p">(</span><span class="s2">&quot;eqm&quot;</span><span class="p">,</span> <span class="s2">&quot;gwbse_options.gwbse.qp_grid_spacing&quot;</span><span class="p">,</span> <span class="s2">&quot;0.01&quot;</span><span class="p">)</span>
<span class="n">edit_calculator</span><span class="p">(</span><span class="s2">&quot;eqm&quot;</span><span class="p">,</span> <span class="s2">&quot;gwbse_options.gwbse.exctotal&quot;</span><span class="p">,</span> <span class="s2">&quot;10&quot;</span><span class="p">)</span>
<span class="n">edit_calculator</span><span class="p">(</span><span class="s2">&quot;eqm&quot;</span><span class="p">,</span> <span class="s2">&quot;map_file&quot;</span><span class="p">,</span> <span class="s2">&quot;system.xml&quot;</span><span class="p">)</span>
<span class="n">edit_calculator</span><span class="p">(</span><span class="s2">&quot;eqm&quot;</span><span class="p">,</span> <span class="s2">&quot;basisset&quot;</span><span class="p">,</span> <span class="s2">&quot;3-21G&quot;</span><span class="p">)</span>
<span class="n">edit_calculator</span><span class="p">(</span><span class="s2">&quot;eqm&quot;</span><span class="p">,</span> <span class="s2">&quot;auxbasisset&quot;</span><span class="p">,</span> <span class="s2">&quot;aux-def2-svp&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The option &#39;gwbse_options.gwbse.ranges&#39; on file &#39;OPTIONFILES/eqm.xml&#39; has been set to &#39;full&#39;
The option &#39;gwbse_options.gwbse.mode&#39; on file &#39;OPTIONFILES/eqm.xml&#39; has been set to &#39;G0W0&#39;
The option &#39;gwbse_options.gwbse.qp_solver&#39; on file &#39;OPTIONFILES/eqm.xml&#39; has been set to &#39;fixedpoint&#39;
The option &#39;gwbse_options.gwbse.qp_grid_steps&#39; on file &#39;OPTIONFILES/eqm.xml&#39; has been set to &#39;100&#39;
The option &#39;gwbse_options.gwbse.qp_grid_spacing&#39; on file &#39;OPTIONFILES/eqm.xml&#39; has been set to &#39;0.01&#39;
The option &#39;gwbse_options.gwbse.exctotal&#39; on file &#39;OPTIONFILES/eqm.xml&#39; has been set to &#39;10&#39;
The option &#39;map_file&#39; on file &#39;OPTIONFILES/eqm.xml&#39; has been set to &#39;system.xml&#39;
The option &#39;basisset&#39; on file &#39;OPTIONFILES/eqm.xml&#39; has been set to &#39;3-21G&#39;
The option &#39;auxbasisset&#39; on file &#39;OPTIONFILES/eqm.xml&#39; has been set to &#39;aux-def2-svp&#39;
</pre></div></div>
</div>
<p>For the sake of computational time let just compute the <code class="docutils literal notranslate"><span class="pre">gw</span></code> approximation and the <code class="docutils literal notranslate"><span class="pre">singlet</span></code>. You can also request the <code class="docutils literal notranslate"><span class="pre">triplet</span></code> or <code class="docutils literal notranslate"><span class="pre">all</span></code>, see the <a class="reference external" href="https://www.votca.org/xtp/eqm.html">gwbse sectionfor the eqm calculator</a>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">edit_calculator</span><span class="p">(</span><span class="s2">&quot;eqm&quot;</span><span class="p">,</span> <span class="s2">&quot;gwbse_options.gwbse.tasks&quot;</span><span class="p">,</span> <span class="s2">&quot;gw,singlets&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The option &#39;gwbse_options.gwbse.tasks&#39; on file &#39;OPTIONFILES/eqm.xml&#39; has been set to &#39;gw,singlets&#39;
</pre></div></div>
</div>
<p>First we will write the job in a file and enable only the first 2 jobs</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">!</span>xtp_parallel -e eqm -o OPTIONFILES/eqm.xml -f state.hdf5 -s <span class="m">0</span> -j <span class="s2">&quot;write&quot;</span>
<span class="o">!</span>sed -i <span class="s2">&quot;s/AVAILABLE/COMPLETE/g&quot;</span> eqm.jobs
<span class="o">!</span>sed -i <span class="s1">&#39;0,/COMPLETE/s/COMPLETE/AVAILABLE/&#39;</span> eqm.jobs
<span class="o">!</span>sed -i <span class="s1">&#39;0,/COMPLETE/s/COMPLETE/AVAILABLE/&#39;</span> eqm.jobs
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
==================================================
========   VOTCA (http://www.votca.org)   ========
==================================================

please submit bugs to https://github.com/votca/xtp/issues

xtp_parallel, version 2022-dev gitid: 834347a (compiled May 21 2021, 06:20:45)
votca_csg, version 2022-dev gitid: 834347a (compiled May 21 2021, 06:04:29)
votca_tools, version 2022-dev gitid: 834347a (compiled May 21 2021, 06:01:42)

Initializing calculator
... eqm
... ... Initialized with 1 threads.

... ... Using 1 openmp threads for 1x1=1 total threads.
1 frames in statefile, Ids are: 10000
Starting at frame 10000
Evaluating frame 10000
Import MD Topology (i.e. frame 10000) from state.hdf5
....
... eqm
... ... Writing job file: eqm.jobs with 1000 jobs
Changes have not been written to state file.
</pre></div></div>
</div>
<p>Now, let run these 2 jobs</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">!</span>xtp_parallel -e eqm -o OPTIONFILES/eqm.xml -f state.hdf5 -s <span class="m">0</span> -j run -c <span class="m">1</span> -p <span class="m">4</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
==================================================
========   VOTCA (http://www.votca.org)   ========
==================================================

please submit bugs to https://github.com/votca/xtp/issues

xtp_parallel, version 2022-dev gitid: 834347a (compiled May 21 2021, 06:20:45)
votca_csg, version 2022-dev gitid: 834347a (compiled May 21 2021, 06:04:29)
votca_tools, version 2022-dev gitid: 834347a (compiled May 21 2021, 06:01:42)

Initializing calculator
... eqm
... ... Initialized with 1 threads.

... ... Using 4 openmp threads for 1x4=4 total threads.
1 frames in statefile, Ids are: 10000
Starting at frame 10000
Evaluating frame 10000
Import MD Topology (i.e. frame 10000) from state.hdf5
....
... eqm
MST ERR Job file = &#39;eqm.jobs&#39;, cache size =  1
MST ERR Initialize jobs from eqm.jobs
MST ERR Registered 1000 jobs.
T00 ERR ... Requesting next job
T00 ERR ... Assign jobs from stack
T00 ERR ... Next job: ID = 0=&gt; [ 0%]
T00 ERR ... 2021-5-21 6:34:39 Evaluating site 0
T00 ERR ... Running DFT
T00 ERR ... Running GWBSE
T00 ERR ... Running ESPFIT
T00 ERR ... ===== Running on 4 threads =====
T00 ERR ... 2021-5-21 6:34:50 Calculated Densities at Numerical Grid, Number of electrons is 6.74017e-08
T00 ERR ... 2021-5-21 6:34:50 Calculating ESP at CHELPG grid points
T00 ERR ... 2021-5-21 6:34:53 Netcharge constrained to 0
T00 ERR ...  Sum of fitted charges: -9.22873e-16
T00 ERR ...  RMSE of fit:  0.00256657
T00 ERR ...  RRMSE of fit: 0.239702
T00 ERR ... El Dipole from fitted charges [e*bohr]:
                 dx = -0.6799 dy = +0.1553 dz = -0.2849 |d|^2 = +0.5675
T00 ERR ... El Dipole from exact qm density [e*bohr]:
                 dx = -0.7021 dy = +0.1605 dz = -0.2942 |d|^2 = +0.6053
T00 ERR ... Written charges to MP_FILES/frame_10000/n2s1/thiophene_0_n2s1.mps
T00 ERR ... 2021-5-21 6:34:53 Finished evaluating site 0
T00 ERR ... Saving data to molecule_0.orb
T00 ERR ... Reporting job results

T00 ERR ... Requesting next job
T00 ERR ... Assign jobs from stack
T00 ERR ... Next job: ID = 1
T00 ERR ... 2021-5-21 6:34:53 Evaluating site 1
T00 ERR ... Running DFT
T00 ERR ... Running GWBSE
T00 ERR ... Running ESPFIT
T00 ERR ... ===== Running on 4 threads =====
T00 ERR ... 2021-5-21 6:35:4 Calculated Densities at Numerical Grid, Number of electrons is 2.83856e-08
T00 ERR ... 2021-5-21 6:35:4 Calculating ESP at CHELPG grid points
T00 ERR ... 2021-5-21 6:35:8 Netcharge constrained to 0
T00 ERR ...  Sum of fitted charges: -7.00828e-16
T00 ERR ...  RMSE of fit:  0.00254444
T00 ERR ...  RRMSE of fit: 0.237897
T00 ERR ... El Dipole from fitted charges [e*bohr]:
                 dx = -0.1910 dy = -0.6923 dz = +0.2258 |d|^2 = +0.5668
T00 ERR ... El Dipole from exact qm density [e*bohr]:
                 dx = -0.1974 dy = -0.7154 dz = +0.2334 |d|^2 = +0.6053
T00 ERR ... Written charges to MP_FILES/frame_10000/n2s1/thiophene_1_n2s1.mps
T00 ERR ... 2021-5-21 6:35:8 Finished evaluating site 1
T00 ERR ... Saving data to molecule_1.orb
T00 ERR ... Reporting job results

T00 ERR ... Requesting next job
T00 ERR ... Assign jobs from stack
T00 ERR ... Sync did not yield any new jobs.
T00 ERR ... Next job: ID = - (none available)
MST ERR Assign jobs from stack
Changes have not been written to state file.
</pre></div></div>
</div>
</div>
<div class="section" id="QM-calculation-for-pairs">
<h2>QM calculation for pairs<a class="headerlink" href="#QM-calculation-for-pairs" title="Permalink to this headline">¶</a></h2>
<p>In the following step we will run QM calculations for each pair in the hdf5 file. As the calculations on the previous step, we will first write the jobs in a file, then run them and finally store the results in the state file. First, we need to copy the input to our local folder</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">!</span>cp <span class="s2">&quot;</span><span class="nv">$VOTCASHARE</span><span class="s2">/xtp/xml/iqm.xml&quot;</span> OPTIONFILES/
</pre></div>
</div>
</div>
<p>As in the previous section, we set the GWBSE mode to <code class="docutils literal notranslate"><span class="pre">G0W0</span></code>and the <code class="docutils literal notranslate"><span class="pre">ranges</span></code> to <code class="docutils literal notranslate"><span class="pre">full</span></code>, but we compute only the <code class="docutils literal notranslate"><span class="pre">gw</span></code> approximation. We are also going to compute a single excited state. For more information, check the <a class="reference external" href="https://www.votca.org/xtp/iqm.html">iqm calculator options</a>. We also want to compute the <code class="docutils literal notranslate"><span class="pre">singlet</span></code> couplings.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">edit_calculator</span><span class="p">(</span><span class="s2">&quot;iqm&quot;</span><span class="p">,</span> <span class="s2">&quot;states&quot;</span><span class="p">,</span> <span class="s2">&quot;1&quot;</span><span class="p">)</span>
<span class="n">edit_calculator</span><span class="p">(</span><span class="s2">&quot;iqm&quot;</span><span class="p">,</span> <span class="s2">&quot;map_file&quot;</span><span class="p">,</span> <span class="s2">&quot;system.xml&quot;</span><span class="p">)</span>
<span class="n">edit_calculator</span><span class="p">(</span><span class="s2">&quot;iqm&quot;</span><span class="p">,</span> <span class="s2">&quot;gwbse_options.gwbse.ranges&quot;</span><span class="p">,</span> <span class="s2">&quot;full&quot;</span><span class="p">)</span>
<span class="n">edit_calculator</span><span class="p">(</span><span class="s2">&quot;iqm&quot;</span><span class="p">,</span> <span class="s2">&quot;gwbse_options.gwbse.tasks&quot;</span><span class="p">,</span> <span class="s2">&quot;gw&quot;</span><span class="p">)</span>
<span class="n">edit_calculator</span><span class="p">(</span><span class="s2">&quot;iqm&quot;</span><span class="p">,</span> <span class="s2">&quot;gwbse_options.gwbse.qp_solver&quot;</span><span class="p">,</span> <span class="s2">&quot;fixedpoint&quot;</span><span class="p">)</span>
<span class="n">edit_calculator</span><span class="p">(</span><span class="s2">&quot;iqm&quot;</span><span class="p">,</span> <span class="s2">&quot;gwbse_options.gwbse.qp_grid_steps&quot;</span><span class="p">,</span> <span class="s2">&quot;100&quot;</span><span class="p">)</span>
<span class="n">edit_calculator</span><span class="p">(</span><span class="s2">&quot;iqm&quot;</span><span class="p">,</span> <span class="s2">&quot;gwbse_options.gwbse.qp_grid_spacing&quot;</span><span class="p">,</span> <span class="s2">&quot;0.01&quot;</span><span class="p">)</span>
<span class="n">edit_calculator</span><span class="p">(</span><span class="s2">&quot;iqm&quot;</span><span class="p">,</span> <span class="s2">&quot;bsecoupling.spin&quot;</span><span class="p">,</span> <span class="s2">&quot;singlet&quot;</span><span class="p">)</span>
<span class="n">edit_calculator</span><span class="p">(</span><span class="s2">&quot;iqm&quot;</span><span class="p">,</span> <span class="s2">&quot;basisset&quot;</span><span class="p">,</span> <span class="s2">&quot;3-21G&quot;</span><span class="p">)</span>
<span class="n">edit_calculator</span><span class="p">(</span><span class="s2">&quot;iqm&quot;</span><span class="p">,</span> <span class="s2">&quot;auxbasisset&quot;</span><span class="p">,</span> <span class="s2">&quot;aux-def2-svp&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The option &#39;states&#39; on file &#39;OPTIONFILES/iqm.xml&#39; has been set to &#39;1&#39;
The option &#39;map_file&#39; on file &#39;OPTIONFILES/iqm.xml&#39; has been set to &#39;system.xml&#39;
The option &#39;gwbse_options.gwbse.ranges&#39; on file &#39;OPTIONFILES/iqm.xml&#39; has been set to &#39;full&#39;
The option &#39;gwbse_options.gwbse.tasks&#39; on file &#39;OPTIONFILES/iqm.xml&#39; has been set to &#39;gw&#39;
The option &#39;gwbse_options.gwbse.qp_solver&#39; on file &#39;OPTIONFILES/iqm.xml&#39; has been set to &#39;fixedpoint&#39;
The option &#39;gwbse_options.gwbse.qp_grid_steps&#39; on file &#39;OPTIONFILES/iqm.xml&#39; has been set to &#39;100&#39;
The option &#39;gwbse_options.gwbse.qp_grid_spacing&#39; on file &#39;OPTIONFILES/iqm.xml&#39; has been set to &#39;0.01&#39;
The option &#39;bsecoupling.spin&#39; on file &#39;OPTIONFILES/iqm.xml&#39; has been set to &#39;singlet&#39;
The option &#39;basisset&#39; on file &#39;OPTIONFILES/iqm.xml&#39; has been set to &#39;3-21G&#39;
The option &#39;auxbasisset&#39; on file &#39;OPTIONFILES/iqm.xml&#39; has been set to &#39;aux-def2-svp&#39;
</pre></div></div>
</div>
<p>Before running the calculations, we need to specify in the <code class="docutils literal notranslate"><span class="pre">iqm</span></code> input which states to read into the jobfile for each segment type. The following <em>XML</em> snippet needs to be added</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">readjobfile</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">&lt;readjobfile help=&quot;which states to read into the jobfile for each segment type&quot;&gt;</span>
<span class="s2">     &lt;singlet&gt;thiophene:s1&lt;/singlet&gt;</span>
<span class="s2">     &lt;triplet&gt;thiophene:t1&lt;/triplet&gt;</span>
<span class="s2">     &lt;electron&gt;thiophene:e1&lt;/electron&gt;</span>
<span class="s2">     &lt;hole&gt;thiophene:h1&lt;/hole&gt;</span>
<span class="s2">&lt;/readjobfile&gt;</span>
<span class="s2">&quot;&quot;&quot;</span>
</pre></div>
</div>
</div>
<p>The following function add the <code class="docutils literal notranslate"><span class="pre">readjobfile</span></code> section,</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">add_section</span><span class="p">(</span><span class="s2">&quot;iqm&quot;</span><span class="p">,</span> <span class="n">readjobfile</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Now, let’s write the jobs to the file</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">!</span>xtp_parallel -e iqm -o OPTIONFILES/iqm.xml -f state.hdf5 -s <span class="m">0</span> -j <span class="s2">&quot;write&quot;</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
==================================================
========   VOTCA (http://www.votca.org)   ========
==================================================

please submit bugs to https://github.com/votca/xtp/issues

xtp_parallel, version 2022-dev gitid: 834347a (compiled May 21 2021, 06:20:45)
votca_csg, version 2022-dev gitid: 834347a (compiled May 21 2021, 06:04:29)
votca_tools, version 2022-dev gitid: 834347a (compiled May 21 2021, 06:01:42)

Initializing calculator
... iqm
... ... Initialized with 1 threads.

... ... Using 1 openmp threads for 1x1=1 total threads.
1 frames in statefile, Ids are: 10000
Starting at frame 10000
Evaluating frame 10000
Import MD Topology (i.e. frame 10000) from state.hdf5
....
... iqm
... ... Writing job file iqm.jobs
... ... In total 90067 jobs
Changes have not been written to state file.
</pre></div></div>
</div>
<p>From the jobs that we just write down, let’s make available only the first job</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">!</span>sed -i <span class="s2">&quot;s/AVAILABLE/COMPLETE/g&quot;</span> iqm.jobs
<span class="o">!</span>sed -i <span class="s1">&#39;0,/COMPLETE/s/COMPLETE/AVAILABLE/&#39;</span> iqm.jobs
</pre></div>
</div>
</div>
<p>Now we can run and store the jobs results</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">!</span>xtp_parallel -e iqm -o OPTIONFILES/iqm.xml -f state.hdf5 -s <span class="m">0</span> -j run -c <span class="m">1</span> -p <span class="m">4</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
==================================================
========   VOTCA (http://www.votca.org)   ========
==================================================

please submit bugs to https://github.com/votca/xtp/issues

xtp_parallel, version 2022-dev gitid: 834347a (compiled May 21 2021, 06:20:45)
votca_csg, version 2022-dev gitid: 834347a (compiled May 21 2021, 06:04:29)
votca_tools, version 2022-dev gitid: 834347a (compiled May 21 2021, 06:01:42)

Initializing calculator
... iqm
... ... Initialized with 1 threads.

... ... Using 4 openmp threads for 1x4=4 total threads.
1 frames in statefile, Ids are: 10000
Starting at frame 10000
Evaluating frame 10000
Import MD Topology (i.e. frame 10000) from state.hdf5
....
... iqm
MST ERR Job file = &#39;iqm.jobs&#39;, cache size =  1
MST ERR Initialize jobs from iqm.jobs
MST ERR Registered 90067 jobs.
T00 ERR ... Requesting next job
T00 ERR ... Assign jobs from stack
T00 ERR ... Next job: ID = 0=&gt; [ 0%]
T00 ERR ... 2021-5-21 6:35:25 Evaluating pair 0 [0:1] out of 90067
T00 ERR ... Guess requested, reading molecular orbitals
T00 ERR ... Reading MoleculeA from OR_FILES/molecules/frame_10000/molecule_0.orb
T00 ERR ... Reading MoleculeB from OR_FILES/molecules/frame_10000/molecule_1.orb
T00 ERR ... Running DFT
T00 ERR ... Calculating electronic couplings
T00 ERR ... Levels:Basis A[2:57] B[2:57]
T00 ERR ... Done with electronic couplings
T00 ERR ... Running GWBSE
T00 ERR ... Running BSECoupling
T00 ERR ... 2021-5-21 6:36:20 Finished evaluating pair 0:1
T00 ERR ... Orb file is not saved according to options
T00 ERR ... Reporting job results

T00 ERR ... Requesting next job
T00 ERR ... Assign jobs from stack
T00 ERR ... Sync did not yield any new jobs.
T00 ERR ... Next job: ID = - (none available)
MST ERR Assign jobs from stack
Changes have not been written to state file.
</pre></div></div>
</div>
<p>Finally, we read the results into the state</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">!</span>xtp_parallel -e iqm -o OPTIONFILES/iqm.xml -f state.hdf5 -j <span class="s2">&quot;read&quot;</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
==================================================
========   VOTCA (http://www.votca.org)   ========
==================================================

please submit bugs to https://github.com/votca/xtp/issues

xtp_parallel, version 2022-dev gitid: 834347a (compiled May 21 2021, 06:20:45)
votca_csg, version 2022-dev gitid: 834347a (compiled May 21 2021, 06:04:29)
votca_tools, version 2022-dev gitid: 834347a (compiled May 21 2021, 06:01:42)

Initializing calculator
... iqm
... ... Initialized with 1 threads.

... ... Using 1 openmp threads for 1x1=1 total threads.
1 frames in statefile, Ids are: 10000
Starting at frame 10000
Evaluating frame 10000
Import MD Topology (i.e. frame 10000) from state.hdf5
....
... iqm
Wrote MD topology (step = 10000, time = 0) to state.hdf5
... .
</pre></div></div>
</div>
</div>
<div class="section" id="QMMM-Calculations">
<h2>QMMM Calculations<a class="headerlink" href="#QMMM-Calculations" title="Permalink to this headline">¶</a></h2>
<p>We will run the <em>QMMM</em> calculations we will use the pregenerated <code class="docutils literal notranslate"><span class="pre">qmmm.jobs</span></code> file in the current work directory, so we can directly run the calculations</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">!</span>cp qmmm.xml OPTIONFILES
<span class="o">!</span>xtp_parallel -e qmmm -o OPTIONFILES/qmmm.xml -f state.hdf5 -j run -p <span class="m">4</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
==================================================
========   VOTCA (http://www.votca.org)   ========
==================================================

please submit bugs to https://github.com/votca/xtp/issues

xtp_parallel, version 2022-dev gitid: 834347a (compiled May 21 2021, 06:20:45)
votca_csg, version 2022-dev gitid: 834347a (compiled May 21 2021, 06:04:29)
votca_tools, version 2022-dev gitid: 834347a (compiled May 21 2021, 06:01:42)

Initializing calculator
... qmmm
... ... Initialized with 1 threads.

... ... Using 4 openmp threads for 1x4=4 total threads.
1 frames in statefile, Ids are: 10000
Starting at frame 10000
Evaluating frame 10000
Import MD Topology (i.e. frame 10000) from state.hdf5
....
... qmmm
MST ERR Job file = &#39;qmmm.jobs&#39;, cache size =  8
MST ERR Initialize jobs from qmmm.jobs
MST ERR Registered 2 jobs.
T00 ERR ... Requesting next job
T00 ERR ... Assign jobs from stack
T00 ERR ... Next job: ID = 0=&gt; [ 0%]
T00 ERR ... Initial state: s1
T00 ERR ... Using overlap filter with threshold 0.8
T00 ERR ...  Regions created
T00 ERR ... Id: 0 type: qm size: 1 charge[e]= 0
T00 ERR ... Id: 1 type: static size: 0 charge[e]= 0
T00 ERR ... 2021-5-21 6:36:38 Writing jobtopology to QMMM/frame_10000/job_0_vacuum/regions.pdb
T00 ERR ... 2021-5-21 6:36:38 Only 1 scf region is used. The remaining regions are static. So no inter regions scf is required.
T00 ERR ... 2021-5-21 6:36:38 --Inter Region SCF Iteration 1 of 1
T00 ERR ... 2021-5-21 6:36:38 Evaluating qm 0
T00 ERR ... 2021-5-21 6:36:38 Evaluating interaction between qm 0 and static 1
T00 ERR ... Running DFT calculation
T00 ERR ... 2021-5-21 6:36:38 Using 4 threads
T00 ERR ... 2021-5-21 6:36:38 Using native Eigen implementation, no BLAS overload
T00 ERR ...  Molecule Coordinates [A]
T00 ERR ...   C   +7.2498 +5.9987 +6.9816
T00 ERR ...   C   +8.3941 +5.2905 +7.2231
T00 ERR ...   S   +9.4238 +6.1259 +8.2255
T00 ERR ...   C   +8.4019 +7.4292 +8.3679
T00 ERR ...   C   +7.2542 +7.2442 +7.6483
T00 ERR ...   H   +6.4443 +5.6423 +6.3555
T00 ERR ...   H   +8.6517 +4.3152 +6.8421
T00 ERR ...   H   +8.6666 +8.2851 +8.9679
T00 ERR ...   H   +6.4528 +7.9674 +7.5999
T00 ERR ... 2021-5-21 6:36:38 Loaded DFT Basis Set def2-svp with 94 functions
T00 ERR ... 2021-5-21 6:36:38 Total number of electrons: 44
T00 ERR ... 2021-5-21 6:36:38 Smallest value of AOOverlap matrix is 0.000982361
T00 ERR ... 2021-5-21 6:36:38 Removed 0 basisfunction from inverse overlap matrix
T00 ERR ... 2021-5-21 6:36:38 Convergence Options:
T00 ERR ...              Delta E [Ha]: 1e-07
T00 ERR ...              DIIS max error: 1e-07
T00 ERR ...              DIIS histlength: 20
T00 ERR ...              ADIIS start: 0.8
T00 ERR ...              DIIS start: 0.002
T00 ERR ...              Deleting oldest element from DIIS hist
T00 ERR ...              Levelshift[Ha]: 0
T00 ERR ...              Levelshift end: 0.2
T00 ERR ...              Mixing Parameter alpha: 0.7
T00 ERR ... 2021-5-21 6:36:38 Constructed independent particle hamiltonian
T00 ERR ... 2021-5-21 6:36:38 Nuclear Repulsion Energy is 206.268375
T00 ERR ... 2021-5-21 6:36:38 Using hybrid functional with alpha=0.25
T00 ERR ... 2021-5-21 6:36:39 Setup numerical integration grid medium for vxc functional XC_HYB_GGA_XC_PBEH
T00 ERR ... 2021-5-21 6:36:39 Setup Initial Guess using: atom
T00 ERR ... 2021-5-21 6:36:39 Calculating atom density for C
T00 ERR ... 2021-5-21 6:36:40 Calculating atom density for S
T00 ERR ... 2021-5-21 6:36:42 Calculating atom density for H
T00 ERR ... 2021-5-21 6:36:42 STARTING SCF cycle
T00 ERR ...  --------------------------------------------------------------------------
T00 ERR ...
T00 ERR ... 2021-5-21 6:36:42 Iteration 1 of 100
T00 ERR ... 2021-5-21 6:36:43 Total Energy -552.151670272
T00 ERR ... 2021-5-21 6:36:43 DIIs error 0.208138125325
T00 ERR ... 2021-5-21 6:36:43 Delta Etot 0
T00 ERR ...
T00 ERR ... 2021-5-21 6:36:43 Iteration 2 of 100
T00 ERR ... 2021-5-21 6:36:44 Total Energy -552.264922981
T00 ERR ... 2021-5-21 6:36:44 DIIs error 0.141559846855
T00 ERR ... 2021-5-21 6:36:44 Delta Etot -0.11325270975
T00 ERR ...
T00 ERR ... 2021-5-21 6:36:44 Iteration 3 of 100
T00 ERR ... 2021-5-21 6:36:45 Total Energy -552.321794403
T00 ERR ... 2021-5-21 6:36:45 DIIs error 0.0928358172494
T00 ERR ... 2021-5-21 6:36:45 Delta Etot -0.0568714213543
T00 ERR ...
T00 ERR ... 2021-5-21 6:36:45 Iteration 4 of 100
T00 ERR ... 2021-5-21 6:36:46 Total Energy -552.440416134
T00 ERR ... 2021-5-21 6:36:46 DIIs error 0.020414373772
T00 ERR ... 2021-5-21 6:36:46 Delta Etot -0.1186217312
T00 ERR ...
T00 ERR ... 2021-5-21 6:36:46 Iteration 5 of 100
T00 ERR ... 2021-5-21 6:36:47 Total Energy -552.44026576
T00 ERR ... 2021-5-21 6:36:47 DIIs error 0.0193679072957
T00 ERR ... 2021-5-21 6:36:47 Delta Etot 0.000150374293639
T00 ERR ...
T00 ERR ... 2021-5-21 6:36:47 Iteration 6 of 100
T00 ERR ... 2021-5-21 6:36:48 Total Energy -552.444089359
T00 ERR ... 2021-5-21 6:36:48 DIIs error 0.00403432709037
T00 ERR ... 2021-5-21 6:36:48 Delta Etot -0.00382359922457
T00 ERR ...
T00 ERR ... 2021-5-21 6:36:48 Iteration 7 of 100
T00 ERR ... 2021-5-21 6:36:49 Total Energy -552.443950386
T00 ERR ... 2021-5-21 6:36:49 DIIs error 0.00491541987333
T00 ERR ... 2021-5-21 6:36:49 Delta Etot 0.000138973394996
T00 ERR ...
T00 ERR ... 2021-5-21 6:36:49 Iteration 8 of 100
T00 ERR ... 2021-5-21 6:36:50 Total Energy -552.444200273
T00 ERR ... 2021-5-21 6:36:50 DIIs error 0.000927695980391
T00 ERR ... 2021-5-21 6:36:50 Delta Etot -0.000249887400059
T00 ERR ...
T00 ERR ... 2021-5-21 6:36:50 Iteration 9 of 100
T00 ERR ... 2021-5-21 6:36:51 Total Energy -552.444206072
T00 ERR ... 2021-5-21 6:36:51 DIIs error 3.98553418089e-05
T00 ERR ... 2021-5-21 6:36:51 Delta Etot -5.79902598474e-06
T00 ERR ...
T00 ERR ... 2021-5-21 6:36:51 Iteration 10 of 100
T00 ERR ... 2021-5-21 6:36:52 Total Energy -552.444206089
T00 ERR ... 2021-5-21 6:36:52 DIIs error 1.3243893922e-05
T00 ERR ... 2021-5-21 6:36:52 Delta Etot -1.73424723471e-08
T00 ERR ...
T00 ERR ... 2021-5-21 6:36:53 Iteration 11 of 100
T00 ERR ... 2021-5-21 6:36:53 Total Energy -552.44420609
T00 ERR ... 2021-5-21 6:36:53 DIIs error 9.37638542573e-06
T00 ERR ... 2021-5-21 6:36:53 Delta Etot -6.17774276179e-10
T00 ERR ...
T00 ERR ... 2021-5-21 6:36:54 Iteration 12 of 100
T00 ERR ... 2021-5-21 6:36:54 Total Energy -552.444206091
T00 ERR ... 2021-5-21 6:36:55 DIIs error 2.1473295096e-06
T00 ERR ... 2021-5-21 6:36:55 Delta Etot -7.44535100239e-10
T00 ERR ...
T00 ERR ... 2021-5-21 6:36:55 Iteration 13 of 100
T00 ERR ... 2021-5-21 6:36:55 Total Energy -552.444206091
T00 ERR ... 2021-5-21 6:36:56 DIIs error 1.44065662858e-06
T00 ERR ... 2021-5-21 6:36:56 Delta Etot -4.14956957684e-11
T00 ERR ...
T00 ERR ... 2021-5-21 6:36:56 Iteration 14 of 100
T00 ERR ... 2021-5-21 6:36:56 Total Energy -552.444206091
T00 ERR ... 2021-5-21 6:36:57 DIIs error 5.24749121977e-08
T00 ERR ... 2021-5-21 6:36:57 Delta Etot -1.45519152284e-11
T00 ERR ... 2021-5-21 6:36:57 Total Energy has converged to -1.45519152e-11[Ha] after 14 iterations. DIIS error is converged up to 5.24749122e-08
T00 ERR ... 2021-5-21 6:36:57 Final Single Point Energy -552.444206091 Ha
T00 ERR ... 2021-5-21 6:36:57 Final Local Exc contribution -36.7917998573 Ha
T00 ERR ... 2021-5-21 6:36:57 Final Non Local Ex contribution -11.7975219267 Ha
T00 ERR ...   Orbital energies:
T00 ERR ...   index occupation energy(Hartree)
T00 ERR ...      0      2   -89.0320195152
T00 ERR ...      1      2   -10.2524875882
T00 ERR ...      2      2   -10.2524601231
T00 ERR ...      3      2   -10.2357243999
T00 ERR ...      4      2   -10.2353848876
T00 ERR ...      5      2   -8.0359620445
T00 ERR ...      6      2   -5.9769383909
T00 ERR ...      7      2   -5.9729657765
T00 ERR ...      8      2   -5.9709237334
T00 ERR ...      9      2   -0.9214830279
T00 ERR ...     10      2   -0.7581677031
T00 ERR ...     11      2   -0.7427570789
T00 ERR ...     12      2   -0.5748529997
T00 ERR ...     13      2   -0.5722977811
T00 ERR ...     14      2   -0.5347813312
T00 ERR ...     15      2   -0.4272682817
T00 ERR ...     16      2   -0.4074548707
T00 ERR ...     17      2   -0.4064476286
T00 ERR ...     18      2   -0.4052866164
T00 ERR ...     19      2   -0.3580971574
T00 ERR ...     20      2   -0.2658765980
T00 ERR ...     21      2   -0.2529588523
T00 ERR ...     22      0   -0.0030767979
T00 ERR ...     23      0   +0.0653625978
T00 ERR ...     24      0   +0.0764140097
T00 ERR ...     25      0   +0.0828281279
T00 ERR ...     26      0   +0.1236579615
T00 ERR ...     27      0   +0.1266889216
T00 ERR ...     28      0   +0.1556527850
T00 ERR ...     29      0   +0.1716019819
T00 ERR ...     30      0   +0.2904633731
T00 ERR ...     31      0   +0.3179356803
T00 ERR ...     32      0   +0.3463181793
T00 ERR ...     33      0   +0.4074212598
T00 ERR ...     34      0   +0.4148539366
T00 ERR ...     35      0   +0.4273319630
T00 ERR ...     36      0   +0.4420090743
T00 ERR ...     37      0   +0.4614543484
T00 ERR ...     38      0   +0.5040930100
T00 ERR ...     39      0   +0.5129850167
T00 ERR ...     40      0   +0.5414361755
T00 ERR ...     41      0   +0.5474662952
T00 ERR ...     42      0   +0.5845261383
T00 ERR ...     43      0   +0.6099380064
T00 ERR ...     44      0   +0.6358949545
T00 ERR ...     45      0   +0.6481068018
T00 ERR ...     46      0   +0.6826985677
T00 ERR ...     47      0   +0.7053958198
T00 ERR ...     48      0   +0.7137924610
T00 ERR ...     49      0   +0.7249973848
T00 ERR ...     50      0   +0.7364482937
T00 ERR ...     51      0   +0.7566513419
T00 ERR ...     52      0   +0.7965398410
T00 ERR ...     53      0   +0.8025155252
T00 ERR ...     54      0   +0.8087688812
T00 ERR ...     55      0   +0.8626964686
T00 ERR ...     56      0   +0.9345872837
T00 ERR ...     57      0   +0.9858602289
T00 ERR ...     58      0   +1.1567316765
T00 ERR ...     59      0   +1.1843918982
T00 ERR ...     60      0   +1.1886167914
T00 ERR ...     61      0   +1.1900616942
T00 ERR ...     62      0   +1.2662158895
T00 ERR ...     63      0   +1.2781999893
T00 ERR ...     64      0   +1.2875581789
T00 ERR ...     65      0   +1.5420391369
T00 ERR ...     66      0   +1.5983336596
T00 ERR ...     67      0   +1.6440137834
T00 ERR ...     68      0   +1.6840681091
T00 ERR ...     69      0   +1.7331984004
T00 ERR ...     70      0   +1.7667036169
T00 ERR ...     71      0   +1.7947551964
T00 ERR ...     72      0   +1.8260025029
T00 ERR ...     73      0   +1.9324477283
T00 ERR ...     74      0   +1.9460623553
T00 ERR ...     75      0   +1.9837747757
T00 ERR ...     76      0   +1.9897912985
T00 ERR ...     77      0   +2.0351548833
T00 ERR ...     78      0   +2.0756568310
T00 ERR ...     79      0   +2.1140417757
T00 ERR ...     80      0   +2.1786069310
T00 ERR ...     81      0   +2.1910169527
T00 ERR ...     82      0   +2.3786466895
T00 ERR ...     83      0   +2.3789542813
T00 ERR ...     84      0   +2.4136994147
T00 ERR ...     85      0   +2.4526658311
T00 ERR ...     86      0   +2.5556819100
T00 ERR ...     87      0   +2.7097107414
T00 ERR ...     88      0   +2.7173101354
T00 ERR ...     89      0   +2.7615172284
T00 ERR ...     90      0   +2.7817984720
T00 ERR ...     91      0   +3.0880889975
T00 ERR ...     92      0   +3.0892005042
T00 ERR ...     93      0   +3.4882183342
T00 ERR ... 2021-5-21 6:36:57 Electric Dipole is[e*bohr]:
                 dx=-0.125596621345
                 dy=0.0287761744097
                 dz=-0.0528863609142
T00 ERR ... Writing result to votca.orb
T00 ERR ... QM energy[Hrt]: -552.44420609
T00 ERR ... 2021-5-21 6:36:57 RPA level range [0:93]
T00 ERR ... 2021-5-21 6:36:57 GW  level range [0:64]
T00 ERR ... 2021-5-21 6:36:57 BSE level range occ[0:21]  virt[22:64]
T00 ERR ... 2021-5-21 6:36:57 BSE Hamiltonian has size 946x946
T00 ERR ...  BSE type: full
T00 ERR ...  BSE without Hqp offdiagonal elements
T00 ERR ...  Running GW as: evGW
T00 ERR ...  g_sc_limit [Hartree]: 1e-05
T00 ERR ...  gw_sc_limit [Hartree]: 1e-05
T00 ERR ...  Tasks:
T00 ERR ...  GW
T00 ERR ...  singlets
T00 ERR ...  Store:
T00 ERR ...  GW
T00 ERR ...  Sigma integration: ppm
T00 ERR ...  eta: 0.001
T00 ERR ...  Quadrature integration order : 12
T00 ERR ...  Quadrature integration scheme : legendre
T00 ERR ...  Alpha smoothing parameter : 0.001
T00 ERR ...  QP solver: grid
T00 ERR ...  QP grid steps: 1001
T00 ERR ...  QP grid spacing: 0.001
T00 ERR ...  evGW with Anderson update with history 20 using alpha 0.7
T00 ERR ... 2021-5-21 6:36:57 Using 4 threads
T00 ERR ... 2021-5-21 6:36:57 Using native Eigen implementation, no BLAS overload
T00 ERR ... 2021-5-21 6:36:57 Molecule Coordinates [A]
T00 ERR ...     0    C   7.2498 5.9987 6.9816
T00 ERR ...     1    C   8.3941 5.2905 7.2231
T00 ERR ...     2    S   9.4238 6.1259 8.2255
T00 ERR ...     3    C   8.4019 7.4292 8.3679
T00 ERR ...     4    C   7.2542 7.2442 7.6483
T00 ERR ...     5    H   6.4443 5.6423 6.3555
T00 ERR ...     6    H   8.6517 4.3152 6.8421
T00 ERR ...     7    H   8.6666 8.2851 8.9679
T00 ERR ...     8    H   6.4528 7.9674 7.5999
T00 ERR ... 2021-5-21 6:36:57 DFT data was created by xtp
T00 ERR ... 2021-5-21 6:36:57 Loaded DFT Basis Set def2-svp
T00 ERR ... 2021-5-21 6:36:57 Filled DFT Basis of size 94
T00 ERR ... 2021-5-21 6:36:57 Loaded Auxbasis Set aux-def2-svp
T00 ERR ... 2021-5-21 6:36:57 Filled Auxbasis of size 310
T00 ERR ... 2021-5-21 6:36:57 Calculating Mmn_beta (3-center-repulsion x orbitals)
T00 ERR ... 2021-5-21 6:36:57 Calculated Mmn_beta (3-center-repulsion x orbitals)
T00 ERR ... 2021-5-21 6:36:57 Integrating Vxc in VOTCA with functional XC_HYB_GGA_XC_PBEH
T00 ERR ... 2021-5-21 6:36:58 Set hybrid exchange factor: 0.25
T00 ERR ... 2021-5-21 6:36:58 Calculated exchange-correlation expectation values
T00 ERR ... 2021-5-21 6:36:58 Calculated Hartree exchange contribution
T00 ERR ... 2021-5-21 6:36:58 Scissor shifting DFT energies by: 0 Hrt
T00 ERR ... 2021-5-21 6:37:2 Not converged PQP states are:0
T00 ERR ... 2021-5-21 6:37:2 Increase the grid search interval
T00 ERR ...   ====== Perturbative quasiparticle energies (Hartree) ======
T00 ERR ...    DeltaHLGap = +0.167346 Hartree
T00 ERR ...   Level =    0 DFT = -89.0320 VXC = -4.8453 S-X = -7.2785 S-C = +0.5877 GWA = -90.8775
T00 ERR ...   Level =    1 DFT = -10.2525 VXC = -1.7010 S-X = -2.6670 S-C = +0.4188 GWA = -10.7998
T00 ERR ...   Level =    2 DFT = -10.2525 VXC = -1.7010 S-X = -2.6671 S-C = +0.4188 GWA = -10.7997
T00 ERR ...   Level =    3 DFT = -10.2357 VXC = -1.7011 S-X = -2.6672 S-C = +0.4123 GWA = -10.7896
T00 ERR ...   Level =    4 DFT = -10.2354 VXC = -1.7001 S-X = -2.6656 S-C = +0.4121 GWA = -10.7888
T00 ERR ...   Level =    5 DFT = -8.0360 VXC = -1.5650 S-X = -2.4878 S-C = +0.2246 GWA = -8.7341
T00 ERR ...   Level =    6 DFT = -5.9769 VXC = -1.5871 S-X = -2.2062 S-C = +0.3070 GWA = -6.2890
T00 ERR ...   Level =    7 DFT = -5.9730 VXC = -1.5886 S-X = -2.2112 S-C = +0.3073 GWA = -6.2882
T00 ERR ...   Level =    8 DFT = -5.9709 VXC = -1.5894 S-X = -2.2122 S-C = +0.3106 GWA = -6.2832
T00 ERR ...   Level =    9 DFT = -0.9215 VXC = -0.4886 S-X = -0.7337 S-C = +0.1761 GWA = -0.9904
T00 ERR ...   Level =   10 DFT = -0.7582 VXC = -0.4866 S-X = -0.7012 S-C = +0.1363 GWA = -0.8365
T00 ERR ...   Level =   11 DFT = -0.7428 VXC = -0.4812 S-X = -0.6978 S-C = +0.1310 GWA = -0.8284
T00 ERR ...   Level =   12 DFT = -0.5749 VXC = -0.4526 S-X = -0.6220 S-C = +0.0818 GWA = -0.6625
T00 ERR ...   Level =   13 DFT = -0.5723 VXC = -0.4514 S-X = -0.6139 S-C = +0.0751 GWA = -0.6598
T00 ERR ...   Level =   14 DFT = -0.5348 VXC = -0.4246 S-X = -0.5780 S-C = +0.0656 GWA = -0.6226
T00 ERR ...   Level =   15 DFT = -0.4273 VXC = -0.4425 S-X = -0.5721 S-C = +0.0450 GWA = -0.5119
T00 ERR ...   Level =   16 DFT = -0.4075 VXC = -0.3859 S-X = -0.5017 S-C = +0.0479 GWA = -0.4753
T00 ERR ...   Level =   17 DFT = -0.4064 VXC = -0.4454 S-X = -0.5631 S-C = +0.0374 GWA = -0.4868
T00 ERR ...   Level =   18 DFT = -0.4053 VXC = -0.4533 S-X = -0.5788 S-C = +0.0465 GWA = -0.4843
T00 ERR ...   Level =   19 DFT = -0.3581 VXC = -0.4424 S-X = -0.5459 S-C = +0.0320 GWA = -0.4296
T00 ERR ...   Level =   20 DFT = -0.2659 VXC = -0.3962 S-X = -0.4628 S-C = +0.0075 GWA = -0.3251
T00 ERR ...   HOMO  =   21 DFT = -0.2530 VXC = -0.3888 S-X = -0.4537 S-C = +0.0046 GWA = -0.3133
T00 ERR ...   LUMO  =   22 DFT = -0.0031 VXC = -0.3883 S-X = -0.2414 S-C = -0.0398 GWA = +0.1040
T00 ERR ...   Level =   23 DFT = +0.0654 VXC = -0.3714 S-X = -0.2032 S-C = -0.0600 GWA = +0.1737
T00 ERR ...   Level =   24 DFT = +0.0764 VXC = -0.3752 S-X = -0.2042 S-C = -0.0532 GWA = +0.1942
T00 ERR ...   Level =   25 DFT = +0.0828 VXC = -0.2090 S-X = -0.0886 S-C = -0.0347 GWA = +0.1685
T00 ERR ...   Level =   26 DFT = +0.1237 VXC = -0.1913 S-X = -0.0742 S-C = -0.0347 GWA = +0.2060
T00 ERR ...   Level =   27 DFT = +0.1267 VXC = -0.2498 S-X = -0.1152 S-C = -0.0420 GWA = +0.2192
T00 ERR ...   Level =   28 DFT = +0.1557 VXC = -0.2062 S-X = -0.0846 S-C = -0.0369 GWA = +0.2404
T00 ERR ...   Level =   29 DFT = +0.1716 VXC = -0.3139 S-X = -0.1559 S-C = -0.0505 GWA = +0.2791
T00 ERR ...   Level =   30 DFT = +0.2905 VXC = -0.3391 S-X = -0.1638 S-C = -0.0575 GWA = +0.4084
T00 ERR ...   Level =   31 DFT = +0.3179 VXC = -0.3057 S-X = -0.1396 S-C = -0.0545 GWA = +0.4295
T00 ERR ...   Level =   32 DFT = +0.3463 VXC = -0.3022 S-X = -0.1327 S-C = -0.0579 GWA = +0.4579
T00 ERR ...   Level =   33 DFT = +0.4074 VXC = -0.3158 S-X = -0.1393 S-C = -0.0602 GWA = +0.5236
T00 ERR ...   Level =   34 DFT = +0.4149 VXC = -0.3088 S-X = -0.1240 S-C = -0.0659 GWA = +0.5336
T00 ERR ...   Level =   35 DFT = +0.4273 VXC = -0.3237 S-X = -0.1359 S-C = -0.0611 GWA = +0.5540
T00 ERR ...   Level =   36 DFT = +0.4420 VXC = -0.2991 S-X = -0.1205 S-C = -0.0649 GWA = +0.5557
T00 ERR ...   Level =   37 DFT = +0.4615 VXC = -0.3168 S-X = -0.1301 S-C = -0.0706 GWA = +0.5776
T00 ERR ...   Level =   38 DFT = +0.5041 VXC = -0.3192 S-X = -0.1112 S-C = -0.0954 GWA = +0.6167
T00 ERR ...   Level =   39 DFT = +0.5130 VXC = -0.3229 S-X = -0.1249 S-C = -0.0805 GWA = +0.6305
T00 ERR ...   Level =   40 DFT = +0.5414 VXC = -0.3269 S-X = -0.1142 S-C = -0.1001 GWA = +0.6541
T00 ERR ...   Level =   41 DFT = +0.5475 VXC = -0.3092 S-X = -0.1218 S-C = -0.0698 GWA = +0.6651
T00 ERR ...   Level =   42 DFT = +0.5845 VXC = -0.3211 S-X = -0.1099 S-C = -0.0921 GWA = +0.7036
T00 ERR ...   Level =   43 DFT = +0.6099 VXC = -0.3673 S-X = -0.1286 S-C = -0.1183 GWA = +0.7303
T00 ERR ...   Level =   44 DFT = +0.6359 VXC = -0.4008 S-X = -0.1575 S-C = -0.1000 GWA = +0.7792
T00 ERR ...   Level =   45 DFT = +0.6481 VXC = -0.3447 S-X = -0.1315 S-C = -0.1038 GWA = +0.7575
T00 ERR ...   Level =   46 DFT = +0.6827 VXC = -0.3308 S-X = -0.1218 S-C = -0.0994 GWA = +0.7924
T00 ERR ...   Level =   47 DFT = +0.7054 VXC = -0.3543 S-X = -0.1253 S-C = -0.0912 GWA = +0.8432
T00 ERR ...   Level =   48 DFT = +0.7138 VXC = -0.3614 S-X = -0.1273 S-C = -0.1113 GWA = +0.8366
T00 ERR ...   Level =   49 DFT = +0.7250 VXC = -0.3167 S-X = -0.1108 S-C = -0.0958 GWA = +0.8351
T00 ERR ...   Level =   50 DFT = +0.7364 VXC = -0.3950 S-X = -0.1497 S-C = -0.1231 GWA = +0.8587
T00 ERR ...   Level =   51 DFT = +0.7567 VXC = -0.3835 S-X = -0.1444 S-C = -0.1159 GWA = +0.8798
T00 ERR ...   Level =   52 DFT = +0.7965 VXC = -0.3905 S-X = -0.1536 S-C = -0.0988 GWA = +0.9346
T00 ERR ...   Level =   53 DFT = +0.8025 VXC = -0.4308 S-X = -0.1758 S-C = -0.1285 GWA = +0.9290
T00 ERR ...   Level =   54 DFT = +0.8088 VXC = -0.4495 S-X = -0.1849 S-C = -0.1455 GWA = +0.9279
T00 ERR ...   Level =   55 DFT = +0.8627 VXC = -0.4001 S-X = -0.1420 S-C = -0.1387 GWA = +0.9821
T00 ERR ...   Level =   56 DFT = +0.9346 VXC = -0.3588 S-X = -0.1097 S-C = -0.1178 GWA = +1.0659
T00 ERR ...   Level =   57 DFT = +0.9859 VXC = -0.3253 S-X = -0.0968 S-C = -0.0982 GWA = +1.1161
T00 ERR ...   Level =   58 DFT = +1.1567 VXC = -0.3734 S-X = -0.1116 S-C = -0.1652 GWA = +1.2533
T00 ERR ...   Level =   59 DFT = +1.1844 VXC = -0.3034 S-X = -0.0712 S-C = -0.1114 GWA = +1.3052
T00 ERR ...   Level =   60 DFT = +1.1886 VXC = -0.3951 S-X = -0.1383 S-C = -0.1067 GWA = +1.3387
T00 ERR ...   Level =   61 DFT = +1.1901 VXC = -0.3920 S-X = -0.1176 S-C = -0.1942 GWA = +1.2703
T00 ERR ...   Level =   62 DFT = +1.2662 VXC = -0.3897 S-X = -0.1298 S-C = -0.0879 GWA = +1.4383
T00 ERR ...   Level =   63 DFT = +1.2782 VXC = -0.2996 S-X = -0.0685 S-C = -0.1206 GWA = +1.3888
T00 ERR ...   Level =   64 DFT = +1.2876 VXC = -0.4128 S-X = -0.1471 S-C = -0.1657 GWA = +1.3877
T00 ERR ... 2021-5-21 6:37:52 Calculated offdiagonal part of Sigma
T00 ERR ... 2021-5-21 6:37:52 Full quasiparticle Hamiltonian
T00 ERR ...   ====== Diagonalized quasiparticle energies (Hartree) ======
T00 ERR ...   Level =    0 PQP = -90.877474 DQP = -90.877549
T00 ERR ...   Level =    1 PQP = -10.799781 DQP = -10.799869
T00 ERR ...   Level =    2 PQP = -10.799747 DQP = -10.799836
T00 ERR ...   Level =    3 PQP = -10.789590 DQP = -10.789631
T00 ERR ...   Level =    4 PQP = -10.788829 DQP = -10.788895
T00 ERR ...   Level =    5 PQP = -8.734104 DQP = -8.734303
T00 ERR ...   Level =    6 PQP = -6.289033 DQP = -6.289051
T00 ERR ...   Level =    7 PQP = -6.288211 DQP = -6.288226
T00 ERR ...   Level =    8 PQP = -6.283165 DQP = -6.283176
T00 ERR ...   Level =    9 PQP = -0.990424 DQP = -0.991123
T00 ERR ...   Level =   10 PQP = -0.836517 DQP = -0.836969
T00 ERR ...   Level =   11 PQP = -0.828384 DQP = -0.829313
T00 ERR ...   Level =   12 PQP = -0.662477 DQP = -0.663245
T00 ERR ...   Level =   13 PQP = -0.659754 DQP = -0.661736
T00 ERR ...   Level =   14 PQP = -0.622623 DQP = -0.622409
T00 ERR ...   Level =   15 PQP = -0.511869 DQP = -0.512081
T00 ERR ...   Level =   16 PQP = -0.475330 DQP = -0.485975
T00 ERR ...   Level =   17 PQP = -0.486776 DQP = -0.483895
T00 ERR ...   Level =   18 PQP = -0.484314 DQP = -0.477825
T00 ERR ...   Level =   19 PQP = -0.429620 DQP = -0.430201
T00 ERR ...   Level =   20 PQP = -0.325075 DQP = -0.325704
T00 ERR ...   HOMO  =   21 PQP = -0.313266 DQP = -0.314495
T00 ERR ...   LUMO  =   22 PQP = +0.103962 DQP = +0.101828
T00 ERR ...   Level =   23 PQP = +0.173652 DQP = +0.167129
T00 ERR ...   Level =   24 PQP = +0.194181 DQP = +0.168253
T00 ERR ...   Level =   25 PQP = +0.168495 DQP = +0.187744
T00 ERR ...   Level =   26 PQP = +0.205990 DQP = +0.207676
T00 ERR ...   Level =   27 PQP = +0.219226 DQP = +0.212817
T00 ERR ...   Level =   28 PQP = +0.240399 DQP = +0.241660
T00 ERR ...   Level =   29 PQP = +0.279085 DQP = +0.284207
T00 ERR ...   Level =   30 PQP = +0.408366 DQP = +0.407610
T00 ERR ...   Level =   31 PQP = +0.429503 DQP = +0.429644
T00 ERR ...   Level =   32 PQP = +0.457942 DQP = +0.456964
T00 ERR ...   Level =   33 PQP = +0.523647 DQP = +0.523213
T00 ERR ...   Level =   34 PQP = +0.533633 DQP = +0.532497
T00 ERR ...   Level =   35 PQP = +0.554015 DQP = +0.554701
T00 ERR ...   Level =   36 PQP = +0.555715 DQP = +0.556639
T00 ERR ...   Level =   37 PQP = +0.577554 DQP = +0.578119
T00 ERR ...   Level =   38 PQP = +0.616724 DQP = +0.614622
T00 ERR ...   Level =   39 PQP = +0.630458 DQP = +0.630668
T00 ERR ...   Level =   40 PQP = +0.654111 DQP = +0.653785
T00 ERR ...   Level =   41 PQP = +0.665062 DQP = +0.665046
T00 ERR ...   Level =   42 PQP = +0.703623 DQP = +0.698408
T00 ERR ...   Level =   43 PQP = +0.730311 DQP = +0.723748
T00 ERR ...   Level =   44 PQP = +0.779164 DQP = +0.757712
T00 ERR ...   Level =   45 PQP = +0.757532 DQP = +0.782987
T00 ERR ...   Level =   46 PQP = +0.792368 DQP = +0.792920
T00 ERR ...   Level =   47 PQP = +0.843235 DQP = +0.834227
T00 ERR ...   Level =   48 PQP = +0.836603 DQP = +0.835807
T00 ERR ...   Level =   49 PQP = +0.835090 DQP = +0.845726
T00 ERR ...   Level =   50 PQP = +0.858680 DQP = +0.857654
T00 ERR ...   Level =   51 PQP = +0.879818 DQP = +0.879831
T00 ERR ...   Level =   52 PQP = +0.934613 DQP = +0.928192
T00 ERR ...   Level =   53 PQP = +0.929038 DQP = +0.928554
T00 ERR ...   Level =   54 PQP = +0.927922 DQP = +0.934736
T00 ERR ...   Level =   55 PQP = +0.982129 DQP = +0.981209
T00 ERR ...   Level =   56 PQP = +1.065913 DQP = +1.063534
T00 ERR ...   Level =   57 PQP = +1.116139 DQP = +1.113980
T00 ERR ...   Level =   58 PQP = +1.253319 DQP = +1.257748
T00 ERR ...   Level =   59 PQP = +1.305247 DQP = +1.270118
T00 ERR ...   Level =   60 PQP = +1.338721 DQP = +1.301893
T00 ERR ...   Level =   61 PQP = +1.270280 DQP = +1.310795
T00 ERR ...   Level =   62 PQP = +1.438286 DQP = +1.396823
T00 ERR ...   Level =   63 PQP = +1.388755 DQP = +1.434564
T00 ERR ...   Level =   64 PQP = +1.387681 DQP = +1.449348
T00 ERR ... 2021-5-21 6:37:52 Diagonalized QP Hamiltonian
T00 ERR ... 2021-5-21 6:37:52 Setup Full singlet hamiltonian
T00 ERR ... 2021-5-21 6:37:52 Davidson Solver using 4 threads.
T00 ERR ... 2021-5-21 6:37:52 Tolerance : 0.0001
T00 ERR ... 2021-5-21 6:37:52 DPR Correction
T00 ERR ... 2021-5-21 6:37:52 Matrix size : 1892x1892
T00 ERR ... 2021-5-21 6:37:52 iter      Search Space    Norm
T00 ERR ... 2021-5-21 6:37:52    0           10          3.32e-01         0.00% converged
T00 ERR ... 2021-5-21 6:37:52    1           17          7.35e-02         0.00% converged
T00 ERR ... 2021-5-21 6:37:53    2           24          2.73e-02         0.00% converged
T00 ERR ... 2021-5-21 6:37:53    3           31          8.49e-03         0.00% converged
T00 ERR ... 2021-5-21 6:37:54    4           38          1.26e-03        20.00% converged
T00 ERR ... 2021-5-21 6:37:54    5           44          2.41e-04        80.00% converged
T00 ERR ... 2021-5-21 6:37:55    6           47          4.01e-05        100.00% converged
T00 ERR ... 2021-5-21 6:37:55 Davidson converged after 6 iterations.
T00 ERR ... 2021-5-21 6:37:55-----------------------------------
T00 ERR ... 2021-5-21 6:37:55- Davidson ran for 2.829395461secs.
T00 ERR ... 2021-5-21 6:37:55-----------------------------------
T00 ERR ... 2021-5-21 6:37:55 Solved BSE for singlets
T00 ERR ...   ====== singlet energies (eV) ======
T00 ERR ...   S =    1 Omega = +6.166204096444 eV  lamdba = +201.10 nm &lt;FT&gt; = +12.3385 &lt;K_x&gt; = +0.6655 &lt;K_d&gt; = -6.8377
T00 ERR ...            TrDipole length gauge[e*bohr]  dx = -0.6612 dy = +0.1520 dz = -0.2766 |d|^2 = +0.5368 f = +0.0811
T00 ERR ...            HOMO-1   -&gt; LUMO+0    : 84.4%
T00 ERR ...
T00 ERR ...   S =    2 Omega = +6.213050675092 eV  lamdba = +199.58 nm &lt;FT&gt; = +12.3235 &lt;K_x&gt; = +1.1227 &lt;K_d&gt; = -7.2332
T00 ERR ...            TrDipole length gauge[e*bohr]  dx = +0.0040 dy = +0.7200 dz = +0.3860 |d|^2 = +0.6674 f = +0.1016
T00 ERR ...            HOMO-0   -&gt; LUMO+0    : 95.7%
T00 ERR ...
T00 ERR ...   S =    3 Omega = +7.532412170275 eV  lamdba = +164.62 nm &lt;FT&gt; = +14.2770 &lt;K_x&gt; = +0.3795 &lt;K_d&gt; = -7.1241
T00 ERR ...            TrDipole length gauge[e*bohr]  dx = +0.0001 dy = -0.0009 dz = -0.0007 |d|^2 = +0.0000 f = +0.0000
T00 ERR ...            HOMO-1   -&gt; LUMO+2    : 93.2%
T00 ERR ...
T00 ERR ...   S =    4 Omega = +7.543725966138 eV  lamdba = +164.38 nm &lt;FT&gt; = +13.9376 &lt;K_x&gt; = +0.3056 &lt;K_d&gt; = -6.6994
T00 ERR ...            TrDipole length gauge[e*bohr]  dx = +0.0150 dy = +0.0178 dz = -0.0332 |d|^2 = +0.0016 f = +0.0003
T00 ERR ...            HOMO-0   -&gt; LUMO+2    : 92.3%
T00 ERR ...
T00 ERR ...   S =    5 Omega = +7.815121690498 eV  lamdba = +158.67 nm &lt;FT&gt; = +13.3294 &lt;K_x&gt; = +0.1934 &lt;K_d&gt; = -5.7077
T00 ERR ...            TrDipole length gauge[e*bohr]  dx = -0.0004 dy = +0.0000 dz = -0.0002 |d|^2 = +0.0000 f = +0.0000
T00 ERR ...            HOMO-0   -&gt; LUMO+3    : 94.4%
T00 ERR ...
T00 ERR ... 2021-5-21 6:37:55 GWBSE calculation finished
T00 ERR ... Filter overlap not used in first iteration as it needs a reference state
T00 ERR ... No State found by tracker using last state: s1
T00 ERR ... 2021-5-21 6:37:55 Evaluating static 1
T00 ERR ... 2021-5-21 6:37:55 Writing checkpoint to checkpoint_iter_1.hdf5
T00 ERR ... Next State is: s1
T00 ERR ... Reporting job results

T00 ERR ... Requesting next job
T00 ERR ... Next job: ID = 1=&gt; [50%]
T00 ERR ... Initial state: s1
T00 ERR ... Using overlap filter with threshold 0.8
T00 ERR ...  Regions created
T00 ERR ... Id: 0 type: qm size: 1 charge[e]= 0
T00 ERR ... Id: 1 type: static size: 328 charge[e]= -7.26640969617e-14
T00 ERR ... 2021-5-21 6:37:55 Writing jobtopology to QMMM/frame_10000/job_1_static/regions.pdb
T00 ERR ... 2021-5-21 6:37:55 Only 1 scf region is used. The remaining regions are static. So no inter regions scf is required.
T00 ERR ... 2021-5-21 6:37:55 --Inter Region SCF Iteration 1 of 1
T00 ERR ... 2021-5-21 6:37:55 Evaluating qm 0
T00 ERR ... 2021-5-21 6:37:55 Evaluating interaction between qm 0 and static 1
T00 ERR ... Running DFT calculation
T00 ERR ... 2021-5-21 6:37:55 Using 4 threads
T00 ERR ... 2021-5-21 6:37:55 Using native Eigen implementation, no BLAS overload
T00 ERR ...  Molecule Coordinates [A]
T00 ERR ...   C   +7.2498 +5.9987 +6.9816
T00 ERR ...   C   +8.3941 +5.2905 +7.2231
T00 ERR ...   S   +9.4238 +6.1259 +8.2255
T00 ERR ...   C   +8.4019 +7.4292 +8.3679
T00 ERR ...   C   +7.2542 +7.2442 +7.6483
T00 ERR ...   H   +6.4443 +5.6423 +6.3555
T00 ERR ...   H   +8.6517 +4.3152 +6.8421
T00 ERR ...   H   +8.6666 +8.2851 +8.9679
T00 ERR ...   H   +6.4528 +7.9674 +7.5999
T00 ERR ... 2021-5-21 6:37:55 Loaded DFT Basis Set def2-svp with 94 functions
T00 ERR ... 2021-5-21 6:37:55 Total number of electrons: 44
T00 ERR ... 2021-5-21 6:37:55 Smallest value of AOOverlap matrix is 0.000982360698837
T00 ERR ... 2021-5-21 6:37:55 Removed 0 basisfunction from inverse overlap matrix
T00 ERR ... 2021-5-21 6:37:55 Convergence Options:
T00 ERR ...              Delta E [Ha]: 1e-07
T00 ERR ...              DIIS max error: 1e-07
T00 ERR ...              DIIS histlength: 20
T00 ERR ...              ADIIS start: 0.8
T00 ERR ...              DIIS start: 0.002
T00 ERR ...              Deleting oldest element from DIIS hist
T00 ERR ...              Levelshift[Ha]: 0
T00 ERR ...              Levelshift end: 0.2
T00 ERR ...              Mixing Parameter alpha: 0.7
T00 ERR ... 2021-5-21 6:37:55 Constructed independent particle hamiltonian
T00 ERR ... 2021-5-21 6:37:55 Nuclear Repulsion Energy is 206.268375
T00 ERR ... 2021-5-21 6:37:55 Using hybrid functional with alpha=0.25
T00 ERR ... 2021-5-21 6:37:55 Setup numerical integration grid medium for vxc functional XC_HYB_GGA_XC_PBEH
T00 ERR ... 2021-5-21 6:37:55 Setup Initial Guess using: atom
T00 ERR ... 2021-5-21 6:37:55 Calculating atom density for C
T00 ERR ... 2021-5-21 6:37:57 Calculating atom density for S
T00 ERR ... 2021-5-21 6:37:58 Calculating atom density for H
T00 ERR ... 2021-5-21 6:37:59 STARTING SCF cycle
T00 ERR ...  --------------------------------------------------------------------------
T00 ERR ...
T00 ERR ... 2021-5-21 6:37:59 Iteration 1 of 100
T00 ERR ... 2021-5-21 6:38:0 Total Energy -552.151670272
T00 ERR ... 2021-5-21 6:38:0 DIIs error 0.208138125325
T00 ERR ... 2021-5-21 6:38:0 Delta Etot 0
T00 ERR ...
T00 ERR ... 2021-5-21 6:38:0 Iteration 2 of 100
T00 ERR ... 2021-5-21 6:38:1 Total Energy -552.264922981
T00 ERR ... 2021-5-21 6:38:1 DIIs error 0.141559846855
T00 ERR ... 2021-5-21 6:38:1 Delta Etot -0.113252709752
T00 ERR ...
T00 ERR ... 2021-5-21 6:38:1 Iteration 3 of 100
T00 ERR ... 2021-5-21 6:38:2 Total Energy -552.321794403
T00 ERR ... 2021-5-21 6:38:2 DIIs error 0.0928358172494
T00 ERR ... 2021-5-21 6:38:2 Delta Etot -0.0568714213558
T00 ERR ...
T00 ERR ... 2021-5-21 6:38:2 Iteration 4 of 100
T00 ERR ... 2021-5-21 6:38:3 Total Energy -552.440416134
T00 ERR ... 2021-5-21 6:38:3 DIIs error 0.0204143737721
T00 ERR ... 2021-5-21 6:38:3 Delta Etot -0.118621731198
T00 ERR ...
T00 ERR ... 2021-5-21 6:38:3 Iteration 5 of 100
T00 ERR ... 2021-5-21 6:38:4 Total Energy -552.44026576
T00 ERR ... 2021-5-21 6:38:4 DIIs error 0.0193679072958
T00 ERR ... 2021-5-21 6:38:4 Delta Etot 0.000150374295913
T00 ERR ...
T00 ERR ... 2021-5-21 6:38:4 Iteration 6 of 100
T00 ERR ... 2021-5-21 6:38:5 Total Energy -552.444089359
T00 ERR ... 2021-5-21 6:38:5 DIIs error 0.00403432709047
T00 ERR ... 2021-5-21 6:38:5 Delta Etot -0.00382359922617
T00 ERR ...
T00 ERR ... 2021-5-21 6:38:5 Iteration 7 of 100
T00 ERR ... 2021-5-21 6:38:6 Total Energy -552.443950386
T00 ERR ... 2021-5-21 6:38:6 DIIs error 0.00491541987321
T00 ERR ... 2021-5-21 6:38:6 Delta Etot 0.000138973394428
T00 ERR ...
T00 ERR ... 2021-5-21 6:38:6 Iteration 8 of 100
T00 ERR ... 2021-5-21 6:38:7 Total Energy -552.444200273
T00 ERR ... 2021-5-21 6:38:7 DIIs error 0.000927695985779
T00 ERR ... 2021-5-21 6:38:7 Delta Etot -0.000249887399832
T00 ERR ...
T00 ERR ... 2021-5-21 6:38:7 Iteration 9 of 100
T00 ERR ... 2021-5-21 6:38:8 Total Energy -552.444206072
T00 ERR ... 2021-5-21 6:38:8 DIIs error 3.98553418056e-05
T00 ERR ... 2021-5-21 6:38:8 Delta Etot -5.79902598474e-06
T00 ERR ...
T00 ERR ... 2021-5-21 6:38:8 Iteration 10 of 100
T00 ERR ... 2021-5-21 6:38:9 Total Energy -552.444206089
T00 ERR ... 2021-5-21 6:38:9 DIIs error 1.32438939352e-05
T00 ERR ... 2021-5-21 6:38:9 Delta Etot -1.73420175997e-08
T00 ERR ...
T00 ERR ... 2021-5-21 6:38:9 Iteration 11 of 100
T00 ERR ... 2021-5-21 6:38:10 Total Energy -552.44420609
T00 ERR ... 2021-5-21 6:38:10 DIIs error 9.37638545028e-06
T00 ERR ... 2021-5-21 6:38:10 Delta Etot -6.17887963017e-10
T00 ERR ...
T00 ERR ... 2021-5-21 6:38:10 Iteration 12 of 100
T00 ERR ... 2021-5-21 6:38:11 Total Energy -552.444206091
T00 ERR ... 2021-5-21 6:38:11 DIIs error 2.14732952314e-06
T00 ERR ... 2021-5-21 6:38:11 Delta Etot -7.44307726563e-10
T00 ERR ...
T00 ERR ... 2021-5-21 6:38:11 Iteration 13 of 100
T00 ERR ... 2021-5-21 6:38:12 Total Energy -552.444206091
T00 ERR ... 2021-5-21 6:38:12 DIIs error 1.44065661449e-06
T00 ERR ... 2021-5-21 6:38:12 Delta Etot -4.0017766878e-11
T00 ERR ...
T00 ERR ... 2021-5-21 6:38:12 Iteration 14 of 100
T00 ERR ... 2021-5-21 6:38:13 Total Energy -552.444206091
T00 ERR ... 2021-5-21 6:38:13 DIIs error 5.24749133402e-08
T00 ERR ... 2021-5-21 6:38:13 Delta Etot -1.61435309565e-11
T00 ERR ... 2021-5-21 6:38:13 Total Energy has converged to -1.6143531e-11[Ha] after 14 iterations. DIIS error is converged up to 5.24749133e-08
T00 ERR ... 2021-5-21 6:38:13 Final Single Point Energy -552.444206091 Ha
T00 ERR ... 2021-5-21 6:38:13 Final Local Exc contribution -36.7917998573 Ha
T00 ERR ... 2021-5-21 6:38:13 Final Non Local Ex contribution -11.7975219267 Ha
T00 ERR ...   Orbital energies:
T00 ERR ...   index occupation energy(Hartree)
T00 ERR ...      0      2   -89.0320195152
T00 ERR ...      1      2   -10.2524875882
T00 ERR ...      2      2   -10.2524601231
T00 ERR ...      3      2   -10.2357243999
T00 ERR ...      4      2   -10.2353848876
T00 ERR ...      5      2   -8.0359620445
T00 ERR ...      6      2   -5.9769383909
T00 ERR ...      7      2   -5.9729657765
T00 ERR ...      8      2   -5.9709237334
T00 ERR ...      9      2   -0.9214830279
T00 ERR ...     10      2   -0.7581677031
T00 ERR ...     11      2   -0.7427570789
T00 ERR ...     12      2   -0.5748529997
T00 ERR ...     13      2   -0.5722977811
T00 ERR ...     14      2   -0.5347813312
T00 ERR ...     15      2   -0.4272682817
T00 ERR ...     16      2   -0.4074548707
T00 ERR ...     17      2   -0.4064476286
T00 ERR ...     18      2   -0.4052866164
T00 ERR ...     19      2   -0.3580971574
T00 ERR ...     20      2   -0.2658765980
T00 ERR ...     21      2   -0.2529588523
T00 ERR ...     22      0   -0.0030767979
T00 ERR ...     23      0   +0.0653625978
T00 ERR ...     24      0   +0.0764140097
T00 ERR ...     25      0   +0.0828281279
T00 ERR ...     26      0   +0.1236579615
T00 ERR ...     27      0   +0.1266889216
T00 ERR ...     28      0   +0.1556527850
T00 ERR ...     29      0   +0.1716019819
T00 ERR ...     30      0   +0.2904633731
T00 ERR ...     31      0   +0.3179356803
T00 ERR ...     32      0   +0.3463181793
T00 ERR ...     33      0   +0.4074212598
T00 ERR ...     34      0   +0.4148539366
T00 ERR ...     35      0   +0.4273319630
T00 ERR ...     36      0   +0.4420090743
T00 ERR ...     37      0   +0.4614543484
T00 ERR ...     38      0   +0.5040930100
T00 ERR ...     39      0   +0.5129850167
T00 ERR ...     40      0   +0.5414361755
T00 ERR ...     41      0   +0.5474662952
T00 ERR ...     42      0   +0.5845261383
T00 ERR ...     43      0   +0.6099380064
T00 ERR ...     44      0   +0.6358949545
T00 ERR ...     45      0   +0.6481068018
T00 ERR ...     46      0   +0.6826985677
T00 ERR ...     47      0   +0.7053958198
T00 ERR ...     48      0   +0.7137924610
T00 ERR ...     49      0   +0.7249973848
T00 ERR ...     50      0   +0.7364482937
T00 ERR ...     51      0   +0.7566513419
T00 ERR ...     52      0   +0.7965398410
T00 ERR ...     53      0   +0.8025155252
T00 ERR ...     54      0   +0.8087688812
T00 ERR ...     55      0   +0.8626964686
T00 ERR ...     56      0   +0.9345872837
T00 ERR ...     57      0   +0.9858602289
T00 ERR ...     58      0   +1.1567316765
T00 ERR ...     59      0   +1.1843918982
T00 ERR ...     60      0   +1.1886167914
T00 ERR ...     61      0   +1.1900616942
T00 ERR ...     62      0   +1.2662158895
T00 ERR ...     63      0   +1.2781999893
T00 ERR ...     64      0   +1.2875581789
T00 ERR ...     65      0   +1.5420391369
T00 ERR ...     66      0   +1.5983336596
T00 ERR ...     67      0   +1.6440137834
T00 ERR ...     68      0   +1.6840681091
T00 ERR ...     69      0   +1.7331984004
T00 ERR ...     70      0   +1.7667036169
T00 ERR ...     71      0   +1.7947551964
T00 ERR ...     72      0   +1.8260025029
T00 ERR ...     73      0   +1.9324477283
T00 ERR ...     74      0   +1.9460623553
T00 ERR ...     75      0   +1.9837747757
T00 ERR ...     76      0   +1.9897912985
T00 ERR ...     77      0   +2.0351548833
T00 ERR ...     78      0   +2.0756568310
T00 ERR ...     79      0   +2.1140417757
T00 ERR ...     80      0   +2.1786069310
T00 ERR ...     81      0   +2.1910169527
T00 ERR ...     82      0   +2.3786466895
T00 ERR ...     83      0   +2.3789542813
T00 ERR ...     84      0   +2.4136994147
T00 ERR ...     85      0   +2.4526658311
T00 ERR ...     86      0   +2.5556819100
T00 ERR ...     87      0   +2.7097107414
T00 ERR ...     88      0   +2.7173101354
T00 ERR ...     89      0   +2.7615172284
T00 ERR ...     90      0   +2.7817984720
T00 ERR ...     91      0   +3.0880889975
T00 ERR ...     92      0   +3.0892005042
T00 ERR ...     93      0   +3.4882183342
T00 ERR ... 2021-5-21 6:38:13 Electric Dipole is[e*bohr]:
                 dx=-0.125596621344
                 dy=0.0287761744098
                 dz=-0.0528863609142
T00 ERR ... Writing result to votca.orb
T00 ERR ... QM energy[Hrt]: -552.44420609
T00 ERR ... 2021-5-21 6:38:13 RPA level range [0:93]
T00 ERR ... 2021-5-21 6:38:13 GW  level range [0:64]
T00 ERR ... 2021-5-21 6:38:13 BSE level range occ[0:21]  virt[22:64]
T00 ERR ... 2021-5-21 6:38:13 BSE Hamiltonian has size 946x946
T00 ERR ...  BSE type: full
T00 ERR ...  BSE without Hqp offdiagonal elements
T00 ERR ...  Running GW as: evGW
T00 ERR ...  g_sc_limit [Hartree]: 1e-05
T00 ERR ...  gw_sc_limit [Hartree]: 1e-05
T00 ERR ...  Tasks:
T00 ERR ...  GW
T00 ERR ...  singlets
T00 ERR ...  Store:
T00 ERR ...  GW
T00 ERR ...  Sigma integration: ppm
T00 ERR ...  eta: 0.001
T00 ERR ...  Quadrature integration order : 12
T00 ERR ...  Quadrature integration scheme : legendre
T00 ERR ...  Alpha smoothing parameter : 0.001
T00 ERR ...  QP solver: grid
T00 ERR ...  QP grid steps: 1001
T00 ERR ...  QP grid spacing: 0.001
T00 ERR ...  evGW with Anderson update with history 20 using alpha 0.7
T00 ERR ... 2021-5-21 6:38:13 Using 4 threads
T00 ERR ... 2021-5-21 6:38:13 Using native Eigen implementation, no BLAS overload
T00 ERR ... 2021-5-21 6:38:13 Molecule Coordinates [A]
T00 ERR ...     0    C   7.2498 5.9987 6.9816
T00 ERR ...     1    C   8.3941 5.2905 7.2231
T00 ERR ...     2    S   9.4238 6.1259 8.2255
T00 ERR ...     3    C   8.4019 7.4292 8.3679
T00 ERR ...     4    C   7.2542 7.2442 7.6483
T00 ERR ...     5    H   6.4443 5.6423 6.3555
T00 ERR ...     6    H   8.6517 4.3152 6.8421
T00 ERR ...     7    H   8.6666 8.2851 8.9679
T00 ERR ...     8    H   6.4528 7.9674 7.5999
T00 ERR ... 2021-5-21 6:38:13 DFT data was created by xtp
T00 ERR ... 2021-5-21 6:38:13 Loaded DFT Basis Set def2-svp
T00 ERR ... 2021-5-21 6:38:13 Filled DFT Basis of size 94
T00 ERR ... 2021-5-21 6:38:13 Loaded Auxbasis Set aux-def2-svp
T00 ERR ... 2021-5-21 6:38:13 Filled Auxbasis of size 310
T00 ERR ... 2021-5-21 6:38:13 Calculating Mmn_beta (3-center-repulsion x orbitals)
T00 ERR ... 2021-5-21 6:38:13 Calculated Mmn_beta (3-center-repulsion x orbitals)
T00 ERR ... 2021-5-21 6:38:13 Integrating Vxc in VOTCA with functional XC_HYB_GGA_XC_PBEH
T00 ERR ... 2021-5-21 6:38:14 Set hybrid exchange factor: 0.25
T00 ERR ... 2021-5-21 6:38:14 Calculated exchange-correlation expectation values
T00 ERR ... 2021-5-21 6:38:14 Calculated Hartree exchange contribution
T00 ERR ... 2021-5-21 6:38:14 Scissor shifting DFT energies by: 0 Hrt
T00 ERR ... 2021-5-21 6:38:17 Not converged PQP states are:0
T00 ERR ... 2021-5-21 6:38:17 Increase the grid search interval
T00 ERR ...   ====== Perturbative quasiparticle energies (Hartree) ======
T00 ERR ...    DeltaHLGap = +0.167346 Hartree
T00 ERR ...   Level =    0 DFT = -89.0320 VXC = -4.8453 S-X = -7.2785 S-C = +0.5877 GWA = -90.8775
T00 ERR ...   Level =    1 DFT = -10.2525 VXC = -1.7010 S-X = -2.6670 S-C = +0.4188 GWA = -10.7998
T00 ERR ...   Level =    2 DFT = -10.2525 VXC = -1.7010 S-X = -2.6671 S-C = +0.4188 GWA = -10.7997
T00 ERR ...   Level =    3 DFT = -10.2357 VXC = -1.7011 S-X = -2.6672 S-C = +0.4123 GWA = -10.7896
T00 ERR ...   Level =    4 DFT = -10.2354 VXC = -1.7001 S-X = -2.6656 S-C = +0.4121 GWA = -10.7888
T00 ERR ...   Level =    5 DFT = -8.0360 VXC = -1.5650 S-X = -2.4878 S-C = +0.2246 GWA = -8.7341
T00 ERR ...   Level =    6 DFT = -5.9769 VXC = -1.5871 S-X = -2.2062 S-C = +0.3070 GWA = -6.2890
T00 ERR ...   Level =    7 DFT = -5.9730 VXC = -1.5886 S-X = -2.2112 S-C = +0.3073 GWA = -6.2882
T00 ERR ...   Level =    8 DFT = -5.9709 VXC = -1.5894 S-X = -2.2122 S-C = +0.3106 GWA = -6.2832
T00 ERR ...   Level =    9 DFT = -0.9215 VXC = -0.4886 S-X = -0.7337 S-C = +0.1761 GWA = -0.9904
T00 ERR ...   Level =   10 DFT = -0.7582 VXC = -0.4866 S-X = -0.7012 S-C = +0.1363 GWA = -0.8365
T00 ERR ...   Level =   11 DFT = -0.7428 VXC = -0.4812 S-X = -0.6978 S-C = +0.1310 GWA = -0.8284
T00 ERR ...   Level =   12 DFT = -0.5749 VXC = -0.4526 S-X = -0.6220 S-C = +0.0818 GWA = -0.6625
T00 ERR ...   Level =   13 DFT = -0.5723 VXC = -0.4514 S-X = -0.6139 S-C = +0.0751 GWA = -0.6598
T00 ERR ...   Level =   14 DFT = -0.5348 VXC = -0.4246 S-X = -0.5780 S-C = +0.0656 GWA = -0.6226
T00 ERR ...   Level =   15 DFT = -0.4273 VXC = -0.4425 S-X = -0.5721 S-C = +0.0450 GWA = -0.5119
T00 ERR ...   Level =   16 DFT = -0.4075 VXC = -0.3859 S-X = -0.5017 S-C = +0.0479 GWA = -0.4753
T00 ERR ...   Level =   17 DFT = -0.4064 VXC = -0.4454 S-X = -0.5631 S-C = +0.0374 GWA = -0.4868
T00 ERR ...   Level =   18 DFT = -0.4053 VXC = -0.4533 S-X = -0.5788 S-C = +0.0465 GWA = -0.4843
T00 ERR ...   Level =   19 DFT = -0.3581 VXC = -0.4424 S-X = -0.5459 S-C = +0.0320 GWA = -0.4296
T00 ERR ...   Level =   20 DFT = -0.2659 VXC = -0.3962 S-X = -0.4628 S-C = +0.0075 GWA = -0.3251
T00 ERR ...   HOMO  =   21 DFT = -0.2530 VXC = -0.3888 S-X = -0.4537 S-C = +0.0046 GWA = -0.3133
T00 ERR ...   LUMO  =   22 DFT = -0.0031 VXC = -0.3883 S-X = -0.2414 S-C = -0.0398 GWA = +0.1040
T00 ERR ...   Level =   23 DFT = +0.0654 VXC = -0.3714 S-X = -0.2032 S-C = -0.0600 GWA = +0.1737
T00 ERR ...   Level =   24 DFT = +0.0764 VXC = -0.3752 S-X = -0.2042 S-C = -0.0532 GWA = +0.1942
T00 ERR ...   Level =   25 DFT = +0.0828 VXC = -0.2090 S-X = -0.0886 S-C = -0.0347 GWA = +0.1685
T00 ERR ...   Level =   26 DFT = +0.1237 VXC = -0.1913 S-X = -0.0742 S-C = -0.0347 GWA = +0.2060
T00 ERR ...   Level =   27 DFT = +0.1267 VXC = -0.2498 S-X = -0.1152 S-C = -0.0420 GWA = +0.2192
T00 ERR ...   Level =   28 DFT = +0.1557 VXC = -0.2062 S-X = -0.0846 S-C = -0.0369 GWA = +0.2404
T00 ERR ...   Level =   29 DFT = +0.1716 VXC = -0.3139 S-X = -0.1559 S-C = -0.0505 GWA = +0.2791
T00 ERR ...   Level =   30 DFT = +0.2905 VXC = -0.3391 S-X = -0.1638 S-C = -0.0575 GWA = +0.4084
T00 ERR ...   Level =   31 DFT = +0.3179 VXC = -0.3057 S-X = -0.1396 S-C = -0.0545 GWA = +0.4295
T00 ERR ...   Level =   32 DFT = +0.3463 VXC = -0.3022 S-X = -0.1327 S-C = -0.0579 GWA = +0.4579
T00 ERR ...   Level =   33 DFT = +0.4074 VXC = -0.3158 S-X = -0.1393 S-C = -0.0602 GWA = +0.5236
T00 ERR ...   Level =   34 DFT = +0.4149 VXC = -0.3088 S-X = -0.1240 S-C = -0.0659 GWA = +0.5336
T00 ERR ...   Level =   35 DFT = +0.4273 VXC = -0.3237 S-X = -0.1359 S-C = -0.0611 GWA = +0.5540
T00 ERR ...   Level =   36 DFT = +0.4420 VXC = -0.2991 S-X = -0.1205 S-C = -0.0649 GWA = +0.5557
T00 ERR ...   Level =   37 DFT = +0.4615 VXC = -0.3168 S-X = -0.1301 S-C = -0.0706 GWA = +0.5776
T00 ERR ...   Level =   38 DFT = +0.5041 VXC = -0.3192 S-X = -0.1112 S-C = -0.0954 GWA = +0.6167
T00 ERR ...   Level =   39 DFT = +0.5130 VXC = -0.3229 S-X = -0.1249 S-C = -0.0805 GWA = +0.6305
T00 ERR ...   Level =   40 DFT = +0.5414 VXC = -0.3269 S-X = -0.1142 S-C = -0.1001 GWA = +0.6541
T00 ERR ...   Level =   41 DFT = +0.5475 VXC = -0.3092 S-X = -0.1218 S-C = -0.0698 GWA = +0.6651
T00 ERR ...   Level =   42 DFT = +0.5845 VXC = -0.3211 S-X = -0.1099 S-C = -0.0921 GWA = +0.7036
T00 ERR ...   Level =   43 DFT = +0.6099 VXC = -0.3673 S-X = -0.1286 S-C = -0.1183 GWA = +0.7303
T00 ERR ...   Level =   44 DFT = +0.6359 VXC = -0.4008 S-X = -0.1575 S-C = -0.1000 GWA = +0.7792
T00 ERR ...   Level =   45 DFT = +0.6481 VXC = -0.3447 S-X = -0.1315 S-C = -0.1038 GWA = +0.7575
T00 ERR ...   Level =   46 DFT = +0.6827 VXC = -0.3308 S-X = -0.1218 S-C = -0.0994 GWA = +0.7924
T00 ERR ...   Level =   47 DFT = +0.7054 VXC = -0.3543 S-X = -0.1253 S-C = -0.0912 GWA = +0.8432
T00 ERR ...   Level =   48 DFT = +0.7138 VXC = -0.3614 S-X = -0.1273 S-C = -0.1113 GWA = +0.8366
T00 ERR ...   Level =   49 DFT = +0.7250 VXC = -0.3167 S-X = -0.1108 S-C = -0.0958 GWA = +0.8351
T00 ERR ...   Level =   50 DFT = +0.7364 VXC = -0.3950 S-X = -0.1497 S-C = -0.1231 GWA = +0.8587
T00 ERR ...   Level =   51 DFT = +0.7567 VXC = -0.3835 S-X = -0.1444 S-C = -0.1159 GWA = +0.8798
T00 ERR ...   Level =   52 DFT = +0.7965 VXC = -0.3905 S-X = -0.1536 S-C = -0.0988 GWA = +0.9346
T00 ERR ...   Level =   53 DFT = +0.8025 VXC = -0.4308 S-X = -0.1758 S-C = -0.1285 GWA = +0.9290
T00 ERR ...   Level =   54 DFT = +0.8088 VXC = -0.4495 S-X = -0.1849 S-C = -0.1455 GWA = +0.9279
T00 ERR ...   Level =   55 DFT = +0.8627 VXC = -0.4001 S-X = -0.1420 S-C = -0.1387 GWA = +0.9821
T00 ERR ...   Level =   56 DFT = +0.9346 VXC = -0.3588 S-X = -0.1097 S-C = -0.1178 GWA = +1.0659
T00 ERR ...   Level =   57 DFT = +0.9859 VXC = -0.3253 S-X = -0.0968 S-C = -0.0982 GWA = +1.1161
T00 ERR ...   Level =   58 DFT = +1.1567 VXC = -0.3734 S-X = -0.1116 S-C = -0.1652 GWA = +1.2533
T00 ERR ...   Level =   59 DFT = +1.1844 VXC = -0.3034 S-X = -0.0712 S-C = -0.1114 GWA = +1.3052
T00 ERR ...   Level =   60 DFT = +1.1886 VXC = -0.3951 S-X = -0.1383 S-C = -0.1067 GWA = +1.3387
T00 ERR ...   Level =   61 DFT = +1.1901 VXC = -0.3920 S-X = -0.1176 S-C = -0.1942 GWA = +1.2703
T00 ERR ...   Level =   62 DFT = +1.2662 VXC = -0.3897 S-X = -0.1298 S-C = -0.0879 GWA = +1.4383
T00 ERR ...   Level =   63 DFT = +1.2782 VXC = -0.2996 S-X = -0.0685 S-C = -0.1206 GWA = +1.3888
T00 ERR ...   Level =   64 DFT = +1.2876 VXC = -0.4128 S-X = -0.1471 S-C = -0.1657 GWA = +1.3877
T00 ERR ... 2021-5-21 6:39:5 Calculated offdiagonal part of Sigma
T00 ERR ... 2021-5-21 6:39:5 Full quasiparticle Hamiltonian
T00 ERR ...   ====== Diagonalized quasiparticle energies (Hartree) ======
T00 ERR ...   Level =    0 PQP = -90.877474 DQP = -90.877549
T00 ERR ...   Level =    1 PQP = -10.799781 DQP = -10.799869
T00 ERR ...   Level =    2 PQP = -10.799747 DQP = -10.799836
T00 ERR ...   Level =    3 PQP = -10.789590 DQP = -10.789631
T00 ERR ...   Level =    4 PQP = -10.788829 DQP = -10.788895
T00 ERR ...   Level =    5 PQP = -8.734104 DQP = -8.734303
T00 ERR ...   Level =    6 PQP = -6.289033 DQP = -6.289051
T00 ERR ...   Level =    7 PQP = -6.288211 DQP = -6.288226
T00 ERR ...   Level =    8 PQP = -6.283165 DQP = -6.283176
T00 ERR ...   Level =    9 PQP = -0.990424 DQP = -0.991123
T00 ERR ...   Level =   10 PQP = -0.836517 DQP = -0.836969
T00 ERR ...   Level =   11 PQP = -0.828384 DQP = -0.829313
T00 ERR ...   Level =   12 PQP = -0.662477 DQP = -0.663245
T00 ERR ...   Level =   13 PQP = -0.659754 DQP = -0.661736
T00 ERR ...   Level =   14 PQP = -0.622623 DQP = -0.622409
T00 ERR ...   Level =   15 PQP = -0.511869 DQP = -0.512081
T00 ERR ...   Level =   16 PQP = -0.475330 DQP = -0.485975
T00 ERR ...   Level =   17 PQP = -0.486776 DQP = -0.483895
T00 ERR ...   Level =   18 PQP = -0.484314 DQP = -0.477825
T00 ERR ...   Level =   19 PQP = -0.429620 DQP = -0.430201
T00 ERR ...   Level =   20 PQP = -0.325075 DQP = -0.325704
T00 ERR ...   HOMO  =   21 PQP = -0.313266 DQP = -0.314495
T00 ERR ...   LUMO  =   22 PQP = +0.103962 DQP = +0.101828
T00 ERR ...   Level =   23 PQP = +0.173652 DQP = +0.167129
T00 ERR ...   Level =   24 PQP = +0.194181 DQP = +0.168253
T00 ERR ...   Level =   25 PQP = +0.168495 DQP = +0.187744
T00 ERR ...   Level =   26 PQP = +0.205990 DQP = +0.207676
T00 ERR ...   Level =   27 PQP = +0.219226 DQP = +0.212817
T00 ERR ...   Level =   28 PQP = +0.240399 DQP = +0.241660
T00 ERR ...   Level =   29 PQP = +0.279085 DQP = +0.284207
T00 ERR ...   Level =   30 PQP = +0.408366 DQP = +0.407610
T00 ERR ...   Level =   31 PQP = +0.429503 DQP = +0.429644
T00 ERR ...   Level =   32 PQP = +0.457942 DQP = +0.456964
T00 ERR ...   Level =   33 PQP = +0.523647 DQP = +0.523213
T00 ERR ...   Level =   34 PQP = +0.533633 DQP = +0.532497
T00 ERR ...   Level =   35 PQP = +0.554015 DQP = +0.554701
T00 ERR ...   Level =   36 PQP = +0.555715 DQP = +0.556639
T00 ERR ...   Level =   37 PQP = +0.577554 DQP = +0.578119
T00 ERR ...   Level =   38 PQP = +0.616724 DQP = +0.614622
T00 ERR ...   Level =   39 PQP = +0.630458 DQP = +0.630668
T00 ERR ...   Level =   40 PQP = +0.654111 DQP = +0.653785
T00 ERR ...   Level =   41 PQP = +0.665062 DQP = +0.665046
T00 ERR ...   Level =   42 PQP = +0.703623 DQP = +0.698408
T00 ERR ...   Level =   43 PQP = +0.730311 DQP = +0.723748
T00 ERR ...   Level =   44 PQP = +0.779164 DQP = +0.757712
T00 ERR ...   Level =   45 PQP = +0.757532 DQP = +0.782987
T00 ERR ...   Level =   46 PQP = +0.792368 DQP = +0.792920
T00 ERR ...   Level =   47 PQP = +0.843235 DQP = +0.834227
T00 ERR ...   Level =   48 PQP = +0.836603 DQP = +0.835807
T00 ERR ...   Level =   49 PQP = +0.835090 DQP = +0.845726
T00 ERR ...   Level =   50 PQP = +0.858680 DQP = +0.857654
T00 ERR ...   Level =   51 PQP = +0.879818 DQP = +0.879831
T00 ERR ...   Level =   52 PQP = +0.934613 DQP = +0.928192
T00 ERR ...   Level =   53 PQP = +0.929038 DQP = +0.928554
T00 ERR ...   Level =   54 PQP = +0.927922 DQP = +0.934736
T00 ERR ...   Level =   55 PQP = +0.982129 DQP = +0.981209
T00 ERR ...   Level =   56 PQP = +1.065913 DQP = +1.063534
T00 ERR ...   Level =   57 PQP = +1.116139 DQP = +1.113980
T00 ERR ...   Level =   58 PQP = +1.253319 DQP = +1.257748
T00 ERR ...   Level =   59 PQP = +1.305247 DQP = +1.270118
T00 ERR ...   Level =   60 PQP = +1.338721 DQP = +1.301893
T00 ERR ...   Level =   61 PQP = +1.270280 DQP = +1.310795
T00 ERR ...   Level =   62 PQP = +1.438286 DQP = +1.396823
T00 ERR ...   Level =   63 PQP = +1.388755 DQP = +1.434564
T00 ERR ...   Level =   64 PQP = +1.387681 DQP = +1.449348
T00 ERR ... 2021-5-21 6:39:5 Diagonalized QP Hamiltonian
T00 ERR ... 2021-5-21 6:39:6 Setup Full singlet hamiltonian
T00 ERR ... 2021-5-21 6:39:6 Davidson Solver using 4 threads.
T00 ERR ... 2021-5-21 6:39:6 Tolerance : 0.0001
T00 ERR ... 2021-5-21 6:39:6 DPR Correction
T00 ERR ... 2021-5-21 6:39:6 Matrix size : 1892x1892
T00 ERR ... 2021-5-21 6:39:6 iter       Search Space    Norm
T00 ERR ... 2021-5-21 6:39:6    0           10   3.32e-01         0.00% converged
T00 ERR ... 2021-5-21 6:39:6    1           17   7.35e-02         0.00% converged
T00 ERR ... 2021-5-21 6:39:7    2           24   2.73e-02         0.00% converged
T00 ERR ... 2021-5-21 6:39:7    3           31   8.49e-03         0.00% converged
T00 ERR ... 2021-5-21 6:39:7    4           38   1.26e-03        20.00% converged
T00 ERR ... 2021-5-21 6:39:8    5           44   2.41e-04        80.00% converged
T00 ERR ... 2021-5-21 6:39:8    6           47   4.01e-05        100.00% converged
T00 ERR ... 2021-5-21 6:39:8 Davidson converged after 6 iterations.
T00 ERR ... 2021-5-21 6:39:8-----------------------------------
T00 ERR ... 2021-5-21 6:39:8- Davidson ran for 2.766537669secs.
T00 ERR ... 2021-5-21 6:39:8-----------------------------------
T00 ERR ... 2021-5-21 6:39:8 Solved BSE for singlets
T00 ERR ...   ====== singlet energies (eV) ======
T00 ERR ...   S =    1 Omega = +6.166204096445 eV  lamdba = +201.10 nm &lt;FT&gt; = +12.3385 &lt;K_x&gt; = +0.6655 &lt;K_d&gt; = -6.8377
T00 ERR ...            TrDipole length gauge[e*bohr]  dx = +0.6612 dy = -0.1520 dz = +0.2766 |d|^2 = +0.5368 f = +0.0811
T00 ERR ...            HOMO-1   -&gt; LUMO+0    : 84.4%
T00 ERR ...
T00 ERR ...   S =    2 Omega = +6.213050675093 eV  lamdba = +199.58 nm &lt;FT&gt; = +12.3235 &lt;K_x&gt; = +1.1227 &lt;K_d&gt; = -7.2332
T00 ERR ...            TrDipole length gauge[e*bohr]  dx = -0.0040 dy = -0.7200 dz = -0.3860 |d|^2 = +0.6674 f = +0.1016
T00 ERR ...            HOMO-0   -&gt; LUMO+0    : 95.7%
T00 ERR ...
T00 ERR ...   S =    3 Omega = +7.532412170279 eV  lamdba = +164.62 nm &lt;FT&gt; = +14.2770 &lt;K_x&gt; = +0.3795 &lt;K_d&gt; = -7.1241
T00 ERR ...            TrDipole length gauge[e*bohr]  dx = -0.0001 dy = +0.0009 dz = +0.0007 |d|^2 = +0.0000 f = +0.0000
T00 ERR ...            HOMO-1   -&gt; LUMO+2    : 93.2%
T00 ERR ...
T00 ERR ...   S =    4 Omega = +7.543725966141 eV  lamdba = +164.38 nm &lt;FT&gt; = +13.9376 &lt;K_x&gt; = +0.3056 &lt;K_d&gt; = -6.6994
T00 ERR ...            TrDipole length gauge[e*bohr]  dx = +0.0150 dy = +0.0178 dz = -0.0332 |d|^2 = +0.0016 f = +0.0003
T00 ERR ...            HOMO-0   -&gt; LUMO+2    : 92.3%
T00 ERR ...
T00 ERR ...   S =    5 Omega = +7.815121690496 eV  lamdba = +158.67 nm &lt;FT&gt; = +13.3294 &lt;K_x&gt; = +0.1934 &lt;K_d&gt; = -5.7077
T00 ERR ...            TrDipole length gauge[e*bohr]  dx = +0.0004 dy = -0.0000 dz = +0.0002 |d|^2 = +0.0000 f = +0.0000
T00 ERR ...            HOMO-0   -&gt; LUMO+3    : 94.4%
T00 ERR ...
T00 ERR ... 2021-5-21 6:39:9 GWBSE calculation finished
T00 ERR ... Filter overlap not used in first iteration as it needs a reference state
T00 ERR ... No State found by tracker using last state: s1
T00 ERR ... 2021-5-21 6:39:9 Evaluating static 1
T00 ERR ... 2021-5-21 6:39:9 Writing checkpoint to checkpoint_iter_1.hdf5
T00 ERR ... Next State is: s1
T00 ERR ... Reporting job results

T00 ERR ... Requesting next job
T00 ERR ... Assign jobs from stack
T00 ERR ... Sync did not yield any new jobs.
T00 ERR ... Next job: ID = - (none available)
MST ERR Assign jobs from stack
Changes have not been written to state file.
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="LAMMPS_KMC.html" class="btn btn-neutral float-right" title="Kinect Monte Carlo Simulations Using LAMMPS" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="QMMM_GROMACS.html" class="btn btn-neutral float-left" title="QMMM workflow using GROMACS and VOTCA-XTP" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2020, VOTCA Development Team.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>