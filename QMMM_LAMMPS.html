

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>QMMM workflow using LAMMPS and VOTCA-XTP &mdash; VOTCA 2021-dev documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/theme_overrides.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Kinect Monte Carlo Simulations Using LAMMPS" href="LAMMPS_KMC.html" />
    <link rel="prev" title="QMMM workflow using GROMACS and VOTCA-XTP" href="QMMM_GROMACS.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html">
          

          
            
            <img src="_static/customLogo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="INSTALL.html">Installation</a></li>
</ul>
<p class="caption"><span class="caption-text">Manuals</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="CSG-MANUAL.html">CSG Manual</a></li>
<li class="toctree-l1"><a class="reference internal" href="XTP-MANUAL.html">XTP Manual</a></li>
</ul>
<p class="caption"><span class="caption-text">Tutorials</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="CSG-TUTORIAL.html">CSG Tutorial</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="XTP-TUTORIAL.html">XTP Tutorials</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="DFTGWBSE_ENERGY.html">DFT + GWBSE Energy Calculation Using CH4</a></li>
<li class="toctree-l2"><a class="reference internal" href="DFTGWBSE_OPTIMIZATION.html">DFT + GWBSE Optimization Using CO</a></li>
<li class="toctree-l2"><a class="reference internal" href="DFTGWBSE_OPTIMIZATION.html#Introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="DFTGWBSE_OPTIMIZATION.html#Requirements">Requirements</a></li>
<li class="toctree-l2"><a class="reference internal" href="DFTGWBSE_OPTIMIZATION.html#Preparing-the-input">Preparing the input</a></li>
<li class="toctree-l2"><a class="reference internal" href="QMMM_GROMACS.html">QMMM workflow using GROMACS and VOTCA-XTP</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">QMMM workflow using LAMMPS and VOTCA-XTP</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#What-is-this-tutorial-about">What is this tutorial about</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Requirements">Requirements</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Interacting-with-the-XTP-command-line-interface">Interacting with the XTP command line interface</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Note">Note</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#Setting-the-environment">Setting the environment</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Generate-the-topology-from-the-Gromacs-file">Generate the topology from the Gromacs file</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Check-the-mapping">Check the mapping</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Neighborlist-Calculation">Neighborlist Calculation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Read-reorganization-energies">Read reorganization energies</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Compute-site-energy">Compute site energy</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Site-energy-and-pair-energy-analysis">Site energy and pair energy analysis</a></li>
<li class="toctree-l3"><a class="reference internal" href="#QM-energy-calculation">QM energy calculation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#QM-calculation-for-pairs">QM calculation for pairs</a></li>
<li class="toctree-l3"><a class="reference internal" href="#QMMM-Calculations">QMMM Calculations</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="LAMMPS_KMC.html">Kinect Monte Carlo Simulations Using LAMMPS</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Development</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="DEVELOPERS_GUIDE.html">Developer and Contributor Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="CODE_OF_CONDUCT.html">Code of Conduct</a></li>
</ul>
<p class="caption"><span class="caption-text">Community</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://github.com/votca">Github</a></li>
<li class="toctree-l1"><a class="reference external" href="https://twitter.com/votca_xtp">Twitter</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">VOTCA</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
          <li><a href="XTP-TUTORIAL.html">XTP Tutorials</a> &raquo;</li>
        
      <li>QMMM workflow using LAMMPS and VOTCA-XTP</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/QMMM_LAMMPS.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput,
div.nbinput div.prompt,
div.nbinput div.input_area,
div.nbinput div[class*=highlight],
div.nbinput div[class*=highlight] pre,
div.nboutput,
div.nbinput div.prompt,
div.nbinput div.output_area,
div.nboutput div[class*=highlight],
div.nboutput div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput,
div.nboutput {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput,
    div.nboutput {
        flex-direction: column;
    }
}

/* input container */
div.nbinput {
    padding-top: 5px;
}

/* last container */
div.nblast {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput div.prompt,
div.nboutput div.prompt {
    min-width: 5ex;
    padding-top: 0.4em;
    padding-right: 0.4em;
    text-align: right;
    flex: 0;
}
@media (max-width: 540px) {
    div.nbinput div.prompt,
    div.nboutput div.prompt {
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput div.prompt.empty {
        padding: 0;
    }
}

/* disable scrollbars on prompts */
div.nbinput div.prompt pre,
div.nboutput div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput div.input_area,
div.nboutput div.output_area {
    padding: 0.4em;
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput div.input_area,
    div.nboutput div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    background: #f5f5f5;
}

/* override MathJax center alignment in output cells */
div.nboutput div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput div.math p {
    text-align: left;
}

/* standard error */
div.nboutput div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast,
.nboutput.nblast {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast + .nbinput {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="QMMM-workflow-using-LAMMPS-and-VOTCA-XTP">
<h1>QMMM workflow using LAMMPS and VOTCA-XTP<a class="headerlink" href="#QMMM-workflow-using-LAMMPS-and-VOTCA-XTP" title="Permalink to this headline">¶</a></h1>
<div class="section" id="What-is-this-tutorial-about">
<h2>What is this tutorial about<a class="headerlink" href="#What-is-this-tutorial-about" title="Permalink to this headline">¶</a></h2>
<p>In this tutorial, we will learn how to set and perform excited state calculation using the Votca XTP library. We will use thiophene as our QM region.</p>
</div>
<div class="section" id="Requirements">
<h2>Requirements<a class="headerlink" href="#Requirements" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>You will need to install <strong>VOTCA</strong> using the instructions described <a class="reference external" href="https://github.com/votca/votca/blob/master/share/doc/INSTALL.md">here</a></p></li>
<li><p>Once the installation is completed you need to activate the VOTCA enviroment by running the <code class="docutils literal notranslate"><span class="pre">VOTCARC.bash</span></code> script that has been installed at the bin subfolder for the path that you have provided for the installation step above</p></li>
</ul>
</div>
<div class="section" id="Interacting-with-the-XTP-command-line-interface">
<h2>Interacting with the XTP command line interface<a class="headerlink" href="#Interacting-with-the-XTP-command-line-interface" title="Permalink to this headline">¶</a></h2>
<p>The XTP package offers the following command line interface that the user can interact with: * <a class="reference external" href="https://votca.github.io/xtp_map.html">xtp_map</a> * <a class="reference external" href="https://votca.github.io/xtp_parallel.html">xtp_parallel</a> * <a class="reference external" href="https://votca.github.io/xtp_run.html">xtp_run</a> * <a class="reference external" href="https://votca.github.io/xtp_tools.html">xtp_tools</a></p>
<p>Run the following command to view the help message of <code class="docutils literal notranslate"><span class="pre">xtp_tools</span></code>:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>!xtp_tools -h
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
==================================================
========   VOTCA (http://www.votca.org)   ========
==================================================

please submit bugs to https://github.com/votca/xtp/issues

xtp_tools, version 2021-dev gitid: cd0a3e5 (compiled Sep 11 2020, 03:39:46)
votca_csg, version 2021-dev gitid: cd0a3e5 (compiled Sep 11 2020, 03:39:29)
votca_tools, version 2021-dev gitid: cd0a3e5 (compiled Sep 11 2020, 03:39:26)

Runs excitation/charge transport tools



Allowed options:
  -h [ --help ]                 display this help and exit
  --verbose                     be loud and noisy
  --verbose1                    be very loud and noisy
  -v [ --verbose2 ]             be extremly loud and noisy
  -o [ --options ] arg          calculator options
  -t [ --nthreads ] arg (=1)    number of threads to create

Tools:
  -e [ --execute ] arg        List of tools separated by &#39;,&#39; or &#39; &#39;
  -l [ --list ]               Lists all available tools
  -d [ --description ] arg    Short description of a tool
  -n [ --name ] arg           Name of the job to run

</pre></div></div>
</div>
<div class="section" id="Note">
<h3>Note<a class="headerlink" href="#Note" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><ul class="simple">
<li><p>In Jupyter the <code class="docutils literal notranslate"><span class="pre">!</span></code> symbol means: <em>run the following command as a standard unix command</em></p></li>
<li><p>In Jupyter the command <code class="docutils literal notranslate"><span class="pre">%env</span></code> set an environmental variable</p></li>
</ul>
</div></blockquote>
</div>
</div>
<div class="section" id="Setting-the-environment">
<h2>Setting the environment<a class="headerlink" href="#Setting-the-environment" title="Permalink to this headline">¶</a></h2>
<p>Create a folder to store the input <code class="docutils literal notranslate"><span class="pre">Options</span></code> for XTP</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>!mkdir -p OPTIONFILES
</pre></div>
</div>
</div>
<p>Remove previous hdf5 file</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>!rm -f state.hdf5
</pre></div>
</div>
</div>
<p>Import an small python module to edit xml files</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>from xml_editor import add_section, edit_calculator
import os
</pre></div>
</div>
</div>
</div>
<div class="section" id="Generate-the-topology-from-the-Gromacs-file">
<h2>Generate the topology from the Gromacs file<a class="headerlink" href="#Generate-the-topology-from-the-Gromacs-file" title="Permalink to this headline">¶</a></h2>
<p>We will first generate the mapping from MD coordinates to segments, creating an <a class="reference external" href="https://www.hdfgroup.org/solutions/hdf5/">hdf5 file</a> to store the results. You can explore the generated <code class="docutils literal notranslate"><span class="pre">state.hdf5</span></code> file with e.g. hdf5itebrowser. In Python, you can use the <a class="reference external" href="https://www.h5py.org/">h5py library</a>. The command to generate the mapping is the following,</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>!xtp_map -v -t MD_FILES/newfile.data -c MD_FILES/traj.dump -s system.xml -f state.hdf5 -i 99 &gt; mapping.out
</pre></div>
</div>
</div>
</div>
<div class="section" id="Check-the-mapping">
<h2>Check the mapping<a class="headerlink" href="#Check-the-mapping" title="Permalink to this headline">¶</a></h2>
<p>Let us first output <code class="docutils literal notranslate"><span class="pre">.pdb</span></code> files for the segments, qmmolecules and classical segments in order to check the mapping. We will need to copy the input from the <code class="docutils literal notranslate"><span class="pre">VOTCA</span></code> installation path to our local copy.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>!cp &quot;$VOTCASHARE/xtp/xml/mapchecker.xml&quot; OPTIONFILES/
</pre></div>
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">${VOTCASHARE}</span></code> environmental variable is set to the path that you provided during the <code class="docutils literal notranslate"><span class="pre">VOTCA</span></code> <a class="reference external" href="https://github.com/votca/votca/blob/master/share/doc/INSTALL.md">installation</a>, by the default is set to <code class="docutils literal notranslate"><span class="pre">/usr/local/votca</span></code>.</p>
<p>We need to update the <code class="docutils literal notranslate"><span class="pre">mapchecker</span></code> options with the file containing the definition of the system. For doing, so we will use the python module <code class="docutils literal notranslate"><span class="pre">xml_editor</span></code> that we have imported above. The first argument is the name of the calculator (i.e. <code class="docutils literal notranslate"><span class="pre">mapchecker</span></code>), the seconds argument is the name of the option to change and the third one, the value to use.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>edit_calculator(&quot;mapchecker&quot;, &quot;map_file&quot;, &quot;system.xml&quot;)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The option &#39;map_file&#39; on file &#39;OPTIONFILES/mapchecker.xml&#39; has been set to &#39;system.xml&#39;
</pre></div></div>
</div>
<p>In the <a class="reference external" href="https://votca.github.io/mapchecker.html">mapchecker section of the manual</a> you can find a table with the <code class="docutils literal notranslate"><span class="pre">mapchecker</span></code> input variables and their corresponding defaults. Finally, the following command run the check</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>!xtp_run -e mapchecker -o OPTIONFILES/mapchecker.xml -f state.hdf5
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
==================================================
========   VOTCA (http://www.votca.org)   ========
==================================================

please submit bugs to https://github.com/votca/xtp/issues

xtp_run, version 2021-dev gitid: cd0a3e5 (compiled Sep 11 2020, 03:39:46)
votca_csg, version 2021-dev gitid: cd0a3e5 (compiled Sep 11 2020, 03:39:29)
votca_tools, version 2021-dev gitid: cd0a3e5 (compiled Sep 11 2020, 03:39:26)

Initializing calculator
... mapchecker
1 frames in statefile, Ids are: 10000
Starting at frame 10000
Evaluating frame 10000
Import MD Topology (i.e. frame 10000) from state.hdf5
....
... mapchecker
Writing segments to md_segments_step_10000.pdb
Writing qmmolecules to qm_segments_n_step_10000.pdb
Writing polarsegments to mp_segments_e_step_10000.pdb
Writing polarsegments to mp_segments_h_step_10000.pdb

Changes have not been written to state file.
</pre></div></div>
</div>
</div>
<div class="section" id="Neighborlist-Calculation">
<h2>Neighborlist Calculation<a class="headerlink" href="#Neighborlist-Calculation" title="Permalink to this headline">¶</a></h2>
<p>The following step is to determine the neighbouring pairs for exciton transport.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>!cp &quot;$VOTCASHARE/xtp/xml/neighborlist.xml&quot; OPTIONFILES/
</pre></div>
</div>
</div>
<p>We will use a cutoff of 1.5,</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>constant = &quot;&quot;&quot;&lt;constant help=&quot;cutoff for all other types of pairs&quot;&gt;1.5&lt;/constant&gt;&quot;&quot;&quot;
add_section(&quot;neighborlist&quot;, constant)
!xtp_run -e neighborlist -o OPTIONFILES/neighborlist.xml -f state.hdf5
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
==================================================
========   VOTCA (http://www.votca.org)   ========
==================================================

please submit bugs to https://github.com/votca/xtp/issues

xtp_run, version 2021-dev gitid: cd0a3e5 (compiled Sep 11 2020, 03:39:46)
votca_csg, version 2021-dev gitid: cd0a3e5 (compiled Sep 11 2020, 03:39:29)
votca_tools, version 2021-dev gitid: cd0a3e5 (compiled Sep 11 2020, 03:39:26)

Initializing calculator
... neighborlist
1 frames in statefile, Ids are: 10000
Starting at frame 10000
Evaluating frame 10000
Import MD Topology (i.e. frame 10000) from state.hdf5
....
... neighborlist  Using 1 threads
Evaluating 1000 segments for neighborlist.
 ... ... Evaluating
0%   10   20   30   40   50   60   70   80   90   100%
|----|----|----|----|----|----|----|----|----|----|
***************************************************

 ... ... Created 90067 direct pairs.
Wrote MD topology (step = 10000, time = 0) to state.hdf5
... .
</pre></div></div>
</div>
</div>
<div class="section" id="Read-reorganization-energies">
<h2>Read reorganization energies<a class="headerlink" href="#Read-reorganization-energies" title="Permalink to this headline">¶</a></h2>
<p>In this step we will read the in site reorganization energies and store them in the <code class="docutils literal notranslate"><span class="pre">state.hdf5</span></code> file. We just need to copy the input file and execute the calculation</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>!cp &quot;$VOTCASHARE/xtp/xml/einternal.xml&quot; OPTIONFILES/
!xtp_run -e einternal -o OPTIONFILES/einternal.xml -f state.hdf5
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
==================================================
========   VOTCA (http://www.votca.org)   ========
==================================================

please submit bugs to https://github.com/votca/xtp/issues

xtp_run, version 2021-dev gitid: cd0a3e5 (compiled Sep 11 2020, 03:39:46)
votca_csg, version 2021-dev gitid: cd0a3e5 (compiled Sep 11 2020, 03:39:29)
votca_tools, version 2021-dev gitid: cd0a3e5 (compiled Sep 11 2020, 03:39:26)

Initializing calculator
... einternal
1 frames in statefile, Ids are: 10000
Starting at frame 10000
Evaluating frame 10000
Import MD Topology (i.e. frame 10000) from state.hdf5
....
... einternal
... ... Site, reorg. energies from system.xml.

... ... Read in site, reorg. energies for 1000 segments.
Wrote MD topology (step = 10000, time = 0) to state.hdf5
... .
</pre></div></div>
</div>
</div>
<div class="section" id="Compute-site-energy">
<h2>Compute site energy<a class="headerlink" href="#Compute-site-energy" title="Permalink to this headline">¶</a></h2>
<p>In this step we will perform some <em>QMMM</em> calculations to compute the site energies. The <code class="docutils literal notranslate"><span class="pre">qmmm_mm.xml</span></code> file contains some predefined settings to perform the <em>MM</em> calculations. Let us first copy these settings into the state file,</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>!cp qmmm_mm.xml OPTIONFILES
!xtp_parallel -e qmmm -o OPTIONFILES/qmmm_mm.xml -f state.hdf5 -j &quot;write&quot;
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
 This is a XTP app
==================================================
========   VOTCA (http://www.votca.org)   ========
==================================================

please submit bugs to https://github.com/votca/xtp/issues

xtp_parallel, version 2021-dev gitid: cd0a3e5 (compiled Sep 11 2020, 03:39:46)
votca_csg, version 2021-dev gitid: cd0a3e5 (compiled Sep 11 2020, 03:39:29)
votca_tools, version 2021-dev gitid: cd0a3e5 (compiled Sep 11 2020, 03:39:26)

Initializing calculator
... qmmm
... ... Initialized with 1 threads.

... ... Using 1 openmp threads for 1x1=1 total threads.
1 frames in statefile, Ids are: 10000
Starting at frame 10000
Evaluating frame 10000
Import MD Topology (i.e. frame 10000) from state.hdf5
....
... qmmm
... ... Writing job file qmmm_mm_jobs.xml
... ... In total 3001 jobs
Changes have not been written to state file.
</pre></div></div>
</div>
<p>The previous command generates a <code class="docutils literal notranslate"><span class="pre">qmmm_mm_jobs.xml</span></code> containing 3000 <em>MM</em> jobs to compute, if you examine that file, it should look something like:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;jobs&gt;</span>
        <span class="nt">&lt;job&gt;</span>
                <span class="nt">&lt;id&gt;</span>0<span class="nt">&lt;/id&gt;</span>
                <span class="nt">&lt;tag&gt;</span>thiophene_0:n<span class="nt">&lt;/tag&gt;</span>
                <span class="nt">&lt;input&gt;</span>
                        <span class="nt">&lt;site_energies&gt;</span>0:n<span class="nt">&lt;/site_energies&gt;</span>
                        <span class="nt">&lt;regions&gt;</span>
                                <span class="nt">&lt;region&gt;</span>
                                        <span class="nt">&lt;id&gt;</span>0<span class="nt">&lt;/id&gt;</span>
                                        <span class="nt">&lt;segments&gt;</span>0:n<span class="nt">&lt;/segments&gt;</span>
                                <span class="nt">&lt;/region&gt;</span>
                        <span class="nt">&lt;/regions&gt;</span>
                <span class="nt">&lt;/input&gt;</span>
                <span class="nt">&lt;status&gt;</span>AVAILABLE<span class="nt">&lt;/status&gt;</span>
        <span class="nt">&lt;/job&gt;</span>
</pre></div>
</div>
<p>Let us run just the first 4 jobs by settings all jobs <code class="docutils literal notranslate"><span class="pre">status</span></code> to <code class="docutils literal notranslate"><span class="pre">COMPLETE</span></code> except for the first four. This can be easily done with <a class="reference external" href="https://www.gnu.org/software/sed/manual/sed.html">sed</a> as follows,</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>!sed -i &quot;s/AVAILABLE/COMPLETE/g&quot; qmmm_mm_jobs.xml
!sed -i &#39;0,/COMPLETE/s/COMPLETE/AVAILABLE/&#39; qmmm_mm_jobs.xml
!sed -i &#39;0,/COMPLETE/s/COMPLETE/AVAILABLE/&#39; qmmm_mm_jobs.xml
!sed -i &#39;0,/COMPLETE/s/COMPLETE/AVAILABLE/&#39; qmmm_mm_jobs.xml
!sed -i &#39;0,/COMPLETE/s/COMPLETE/AVAILABLE/&#39; qmmm_mm_jobs.xml
</pre></div>
</div>
</div>
<p>Now we can run the jobs and save the results in the state file</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>!xtp_parallel -e qmmm -o OPTIONFILES/qmmm_mm.xml -f state.hdf5 -j &quot;run&quot;
!xtp_parallel -e qmmm -o OPTIONFILES/qmmm_mm.xml -f state.hdf5 -j &quot;read&quot;
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
 This is a XTP app
==================================================
========   VOTCA (http://www.votca.org)   ========
==================================================

please submit bugs to https://github.com/votca/xtp/issues

xtp_parallel, version 2021-dev gitid: cd0a3e5 (compiled Sep 11 2020, 03:39:46)
votca_csg, version 2021-dev gitid: cd0a3e5 (compiled Sep 11 2020, 03:39:29)
votca_tools, version 2021-dev gitid: cd0a3e5 (compiled Sep 11 2020, 03:39:26)

Initializing calculator
... qmmm
... ... Initialized with 1 threads.

... ... Using 1 openmp threads for 1x1=1 total threads.
1 frames in statefile, Ids are: 10000
Starting at frame 10000
Evaluating frame 10000
Import MD Topology (i.e. frame 10000) from state.hdf5
....
... qmmm
MST ERR Job file = &#39;qmmm_mm_jobs.xml&#39;, cache size =  8
MST ERR Initialize jobs from qmmm_mm_jobs.xml
MST ERR Registered 3000 jobs.
T00 ERR ... Requesting next job
T00 ERR ... Assign jobs from stack
T00 ERR ... Next job: ID = 0=&gt; [ 0%]
T00 ERR ...  Regions created
T00 ERR ... Id: 0 type: polar size: 109 charge[e]= -2.40363e-14
T00 ERR ... Id: 1 type: static size: 220 charge[e]= -4.86833e-14
T00 ERR ... 2020-9-11 3:44:0 Writing jobtopology to MMMM/frame_10000/job_0_thiophene_0:n/regions.pdb
T00 ERR ... 2020-9-11 3:44:0 Only 1 scf region is used. The remaining regions are static. So no inter regions scf is required.
T00 ERR ... 2020-9-11 3:44:0 --Inter Region SCF Iteration 1 of 1
T00 ERR ... 2020-9-11 3:44:0 Evaluating polar 0
T00 ERR ... 2020-9-11 3:44:0 Evaluating interaction between polar 0 and static 1
T00 ERR ... 2020-9-11 3:44:0 Starting Solving for classical polarization with 2943 degrees of freedom.
T00 ERR ... 2020-9-11 3:44:0 CG: #iterations: 9, estimated error: 5.8912e-06
T00 ERR ...   Total static energy [hrt]= -0.1317875845
T00 ERR ...   Total polar energy [hrt]= -0.04919654338
T00 ERR ...  Total energy [hrt]= -0.1809841279
T00 ERR ... 2020-9-11 3:44:0 Evaluating static 1
T00 ERR ... 2020-9-11 3:44:0 Writing checkpoint to checkpoint_iter_1.hdf5
T00 ERR ... Reporting job results

T00 ERR ... Requesting next job
T00 ERR ... Next job: ID = 1
T00 ERR ...  Regions created
T00 ERR ... Id: 0 type: polar size: 109 charge[e]= -1
T00 ERR ... Id: 1 type: static size: 220 charge[e]= -4.868327963e-14
T00 ERR ... 2020-9-11 3:44:0 Writing jobtopology to MMMM/frame_10000/job_1_thiophene_0:e/regions.pdb
T00 ERR ... 2020-9-11 3:44:0 Only 1 scf region is used. The remaining regions are static. So no inter regions scf is required.
T00 ERR ... 2020-9-11 3:44:0 --Inter Region SCF Iteration 1 of 1
T00 ERR ... 2020-9-11 3:44:0 Evaluating polar 0
T00 ERR ... 2020-9-11 3:44:0 Evaluating interaction between polar 0 and static 1
T00 ERR ... 2020-9-11 3:44:1 Starting Solving for classical polarization with 2943 degrees of freedom.
T00 ERR ... 2020-9-11 3:44:1 CG: #iterations: 9, estimated error: 7.290261819e-06
T00 ERR ...   Total static energy [hrt]= -0.1308082539
T00 ERR ...   Total polar energy [hrt]= -0.07598511534
T00 ERR ...  Total energy [hrt]= -0.2067933693
T00 ERR ... 2020-9-11 3:44:1 Evaluating static 1
T00 ERR ... 2020-9-11 3:44:1 Writing checkpoint to checkpoint_iter_1.hdf5
T00 ERR ... Reporting job results

T00 ERR ... Requesting next job
T00 ERR ... Next job: ID = 2
T00 ERR ...  Regions created
T00 ERR ... Id: 0 type: polar size: 109 charge[e]= 1
T00 ERR ... Id: 1 type: static size: 220 charge[e]= -4.868327963e-14
T00 ERR ... 2020-9-11 3:44:1 Writing jobtopology to MMMM/frame_10000/job_2_thiophene_0:h/regions.pdb
T00 ERR ... 2020-9-11 3:44:1 Only 1 scf region is used. The remaining regions are static. So no inter regions scf is required.
T00 ERR ... 2020-9-11 3:44:1 --Inter Region SCF Iteration 1 of 1
T00 ERR ... 2020-9-11 3:44:1 Evaluating polar 0
T00 ERR ... 2020-9-11 3:44:1 Evaluating interaction between polar 0 and static 1
T00 ERR ... 2020-9-11 3:44:1 Starting Solving for classical polarization with 2943 degrees of freedom.
T00 ERR ... 2020-9-11 3:44:2 CG: #iterations: 9, estimated error: 6.815230208e-06
T00 ERR ...   Total static energy [hrt]= -0.1321768235
T00 ERR ...   Total polar energy [hrt]= -0.07922942047
T00 ERR ...  Total energy [hrt]= -0.2114062439
T00 ERR ... 2020-9-11 3:44:2 Evaluating static 1
T00 ERR ... 2020-9-11 3:44:2 Writing checkpoint to checkpoint_iter_1.hdf5
T00 ERR ... Reporting job results

T00 ERR ... Requesting next job
T00 ERR ... Next job: ID = 3
T00 ERR ...  Regions created
T00 ERR ... Id: 0 type: polar size: 104 charge[e]= -2.292610546e-14
T00 ERR ... Id: 1 type: static size: 222 charge[e]= -4.912736884e-14
T00 ERR ... 2020-9-11 3:44:2 Writing jobtopology to MMMM/frame_10000/job_3_thiophene_1:n/regions.pdb
T00 ERR ... 2020-9-11 3:44:2 Only 1 scf region is used. The remaining regions are static. So no inter regions scf is required.
T00 ERR ... 2020-9-11 3:44:2 --Inter Region SCF Iteration 1 of 1
T00 ERR ... 2020-9-11 3:44:2 Evaluating polar 0
T00 ERR ... 2020-9-11 3:44:2 Evaluating interaction between polar 0 and static 1
T00 ERR ... 2020-9-11 3:44:2 Starting Solving for classical polarization with 2808 degrees of freedom.
T00 ERR ... 2020-9-11 3:44:3 CG: #iterations: 9, estimated error: 5.656501514e-06
T00 ERR ...   Total static energy [hrt]= -0.1295146321
T00 ERR ...   Total polar energy [hrt]= -0.04409049212
T00 ERR ...  Total energy [hrt]= -0.1736051242
T00 ERR ... 2020-9-11 3:44:3 Evaluating static 1
T00 ERR ... 2020-9-11 3:44:3 Writing checkpoint to checkpoint_iter_1.hdf5
T00 ERR ... Reporting job results

T00 ERR ... Requesting next job
T00 ERR ... Assign jobs from stack
T00 ERR ... Sync did not yield any new jobs.
T00 ERR ... Next job: ID = - (none available)
MST ERR Assign jobs from stack
Changes have not been written to state file.
 This is a XTP app
==================================================
========   VOTCA (http://www.votca.org)   ========
==================================================

please submit bugs to https://github.com/votca/xtp/issues

xtp_parallel, version 2021-dev gitid: cd0a3e5 (compiled Sep 11 2020, 03:39:46)
votca_csg, version 2021-dev gitid: cd0a3e5 (compiled Sep 11 2020, 03:39:29)
votca_tools, version 2021-dev gitid: cd0a3e5 (compiled Sep 11 2020, 03:39:26)

Initializing calculator
... qmmm
... ... Initialized with 1 threads.

... ... Using 1 openmp threads for 1x1=1 total threads.
1 frames in statefile, Ids are: 10000
Starting at frame 10000
Evaluating frame 10000
Import MD Topology (i.e. frame 10000) from state.hdf5
....
... qmmm
Found 1 states of type e
Found 1 states of type h
Found 2 states of type n
2996 incomplete jobs found.

Wrote MD topology (step = 10000, time = 0) to state.hdf5
... .
</pre></div></div>
</div>
</div>
<div class="section" id="Site-energy-and-pair-energy-analysis">
<h2>Site energy and pair energy analysis<a class="headerlink" href="#Site-energy-and-pair-energy-analysis" title="Permalink to this headline">¶</a></h2>
<p>In this step we generate an histogram and compute the correlation function of site energies and pair energy differences.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>!cp &quot;$VOTCASHARE/xtp/xml/eanalyze.xml&quot; OPTIONFILES/
!xtp_run -e eanalyze -o OPTIONFILES/eanalyze.xml -f state.hdf5
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
==================================================
========   VOTCA (http://www.votca.org)   ========
==================================================

please submit bugs to https://github.com/votca/xtp/issues

xtp_run, version 2021-dev gitid: cd0a3e5 (compiled Sep 11 2020, 03:39:46)
votca_csg, version 2021-dev gitid: cd0a3e5 (compiled Sep 11 2020, 03:39:29)
votca_tools, version 2021-dev gitid: cd0a3e5 (compiled Sep 11 2020, 03:39:26)

Initializing calculator
... eanalyze
1 frames in statefile, Ids are: 10000
Starting at frame 10000
Evaluating frame 10000
Import MD Topology (i.e. frame 10000) from state.hdf5
....
... eanalyze
... ... Short-listed 1000 segments (pattern=&#39;*&#39;)
... ... ... NOTE Statistics of site energies and spatial correlations thereof are based on the short-listed segments only.
... ... ...      Statistics of site-energy differences operate on the full list.
... ... excited state e
... ... excited state h
... ... excited state s
... ... excited state t
Changes have not been written to state file.
</pre></div></div>
</div>
<p>You should now see a set of files prefixed with <code class="docutils literal notranslate"><span class="pre">eanalyze</span></code> containing the histrogram and correlation functions.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>!ls eanalyze*
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
eanalyze.pairhist_e.out  eanalyze.pairlist_s.out  eanalyze.sitehist_e.out
eanalyze.pairhist_h.out  eanalyze.pairlist_t.out  eanalyze.sitehist_h.out
eanalyze.pairhist_s.out  eanalyze.sitecorr_e.out  eanalyze.sitehist_s.out
eanalyze.pairhist_t.out  eanalyze.sitecorr_h.out  eanalyze.sitehist_t.out
eanalyze.pairlist_e.out  eanalyze.sitecorr_s.out
eanalyze.pairlist_h.out  eanalyze.sitecorr_t.out
</pre></div></div>
</div>
</div>
<div class="section" id="QM-energy-calculation">
<h2>QM energy calculation<a class="headerlink" href="#QM-energy-calculation" title="Permalink to this headline">¶</a></h2>
<p>Our next task is to perform the qm calculations for each segment that we have stored in the hdf5 file. The calculations take place in 3 stages: write the jobs to a file, perform the computation and finally save the results to the state file. We will first copy the input into our local folder</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>!cp &quot;$VOTCASHARE/xtp/xml/eqm.xml&quot; OPTIONFILES/
</pre></div>
</div>
</div>
<p>Now we set the GWBSE mode to <code class="docutils literal notranslate"><span class="pre">G0W0</span></code>, the <code class="docutils literal notranslate"><span class="pre">ranges</span></code> to <code class="docutils literal notranslate"><span class="pre">full</span></code> and the <code class="docutils literal notranslate"><span class="pre">basisset</span></code> and <code class="docutils literal notranslate"><span class="pre">auxbasisset</span></code> to <code class="docutils literal notranslate"><span class="pre">def2-svp</span></code> and <code class="docutils literal notranslate"><span class="pre">aux-def2-svp</span></code>. For more information, check the <a class="reference external" href="https://votca.github.io/eqm.html">eqm calculator options</a>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>edit_calculator(&quot;eqm&quot;, &quot;gwbse_options.gwbse.ranges&quot;, &quot;full&quot;)
edit_calculator(&quot;eqm&quot;, &quot;gwbse_options.gwbse.mode&quot;, &quot;G0W0&quot;)
edit_calculator(&quot;eqm&quot;, &quot;gwbse_options.gwbse.qp_solver&quot;, &quot;fixedpoint&quot;)
edit_calculator(&quot;eqm&quot;, &quot;gwbse_options.gwbse.qp_grid_steps&quot;, &quot;100&quot;)
edit_calculator(&quot;eqm&quot;, &quot;gwbse_options.gwbse.qp_grid_spacing&quot;, &quot;0.01&quot;)
edit_calculator(&quot;eqm&quot;, &quot;gwbse_options.gwbse.exctotal&quot;, &quot;10&quot;)
edit_calculator(&quot;eqm&quot;, &quot;map_file&quot;, &quot;system.xml&quot;)
edit_calculator(&quot;eqm&quot;, &quot;basisset&quot;, &quot;3-21G&quot;)
edit_calculator(&quot;eqm&quot;, &quot;auxbasisset&quot;, &quot;aux-def2-svp&quot;)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The option &#39;gwbse_options.gwbse.ranges&#39; on file &#39;OPTIONFILES/eqm.xml&#39; has been set to &#39;full&#39;
The option &#39;gwbse_options.gwbse.mode&#39; on file &#39;OPTIONFILES/eqm.xml&#39; has been set to &#39;G0W0&#39;
The option &#39;gwbse_options.gwbse.qp_solver&#39; on file &#39;OPTIONFILES/eqm.xml&#39; has been set to &#39;fixedpoint&#39;
The option &#39;gwbse_options.gwbse.qp_grid_steps&#39; on file &#39;OPTIONFILES/eqm.xml&#39; has been set to &#39;100&#39;
The option &#39;gwbse_options.gwbse.qp_grid_spacing&#39; on file &#39;OPTIONFILES/eqm.xml&#39; has been set to &#39;0.01&#39;
The option &#39;gwbse_options.gwbse.exctotal&#39; on file &#39;OPTIONFILES/eqm.xml&#39; has been set to &#39;10&#39;
The option &#39;map_file&#39; on file &#39;OPTIONFILES/eqm.xml&#39; has been set to &#39;system.xml&#39;
The option &#39;basisset&#39; on file &#39;OPTIONFILES/eqm.xml&#39; has been set to &#39;3-21G&#39;
The option &#39;auxbasisset&#39; on file &#39;OPTIONFILES/eqm.xml&#39; has been set to &#39;aux-def2-svp&#39;
</pre></div></div>
</div>
<p>For the sake of computational time let just compute the <code class="docutils literal notranslate"><span class="pre">gw</span></code> approximation and the <code class="docutils literal notranslate"><span class="pre">singlet</span></code>. You can also request the <code class="docutils literal notranslate"><span class="pre">triplet</span></code> or <code class="docutils literal notranslate"><span class="pre">all</span></code>, see the <a class="reference external" href="https://votca.github.io/eqm.html">gwbse sectionfor the eqm calculator</a>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>edit_calculator(&quot;eqm&quot;, &quot;gwbse_options.gwbse.tasks&quot;, &quot;gw,singlets&quot;)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The option &#39;gwbse_options.gwbse.tasks&#39; on file &#39;OPTIONFILES/eqm.xml&#39; has been set to &#39;gw,singlets&#39;
</pre></div></div>
</div>
<p>First we will write the job in a file and enable only the first 2 jobs</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>!xtp_parallel -e eqm -o OPTIONFILES/eqm.xml -f state.hdf5 -s 0 -j &quot;write&quot;
!sed -i &quot;s/AVAILABLE/COMPLETE/g&quot; eqm.jobs
!sed -i &#39;0,/COMPLETE/s/COMPLETE/AVAILABLE/&#39; eqm.jobs
!sed -i &#39;0,/COMPLETE/s/COMPLETE/AVAILABLE/&#39; eqm.jobs
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
 This is a XTP app
==================================================
========   VOTCA (http://www.votca.org)   ========
==================================================

please submit bugs to https://github.com/votca/xtp/issues

xtp_parallel, version 2021-dev gitid: cd0a3e5 (compiled Sep 11 2020, 03:39:46)
votca_csg, version 2021-dev gitid: cd0a3e5 (compiled Sep 11 2020, 03:39:29)
votca_tools, version 2021-dev gitid: cd0a3e5 (compiled Sep 11 2020, 03:39:26)

Initializing calculator
... eqm
... ... Initialized with 1 threads.

... ... Using 1 openmp threads for 1x1=1 total threads.
1 frames in statefile, Ids are: 10000
Starting at frame 10000
Evaluating frame 10000
Import MD Topology (i.e. frame 10000) from state.hdf5
....
... eqm
... ... Writing job file: eqm.jobs1000 jobs
Changes have not been written to state file.
</pre></div></div>
</div>
<p>Now, let run these 2 jobs</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>!xtp_parallel -e eqm -o OPTIONFILES/eqm.xml -f state.hdf5 -s 0 -j run -c 1 -p 4
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
 This is a XTP app
==================================================
========   VOTCA (http://www.votca.org)   ========
==================================================

please submit bugs to https://github.com/votca/xtp/issues

xtp_parallel, version 2021-dev gitid: cd0a3e5 (compiled Sep 11 2020, 03:39:46)
votca_csg, version 2021-dev gitid: cd0a3e5 (compiled Sep 11 2020, 03:39:29)
votca_tools, version 2021-dev gitid: cd0a3e5 (compiled Sep 11 2020, 03:39:26)

Initializing calculator
... eqm
... ... Initialized with 1 threads.

... ... Using 4 openmp threads for 1x4=4 total threads.
1 frames in statefile, Ids are: 10000
Starting at frame 10000
Evaluating frame 10000
Import MD Topology (i.e. frame 10000) from state.hdf5
....
... eqm
MST ERR Job file = &#39;eqm.jobs&#39;, cache size =  1
MST ERR Initialize jobs from eqm.jobs
MST ERR Registered 1000 jobs.
T00 ERR ... Requesting next job
T00 ERR ... Assign jobs from stack
T00 ERR ... Next job: ID = 0=&gt; [ 0%]
T00 ERR ... 2020-9-11 3:44:15 Evaluating site 0
T00 ERR ... Running DFT
T00 ERR ... Running GWBSE
T00 ERR ... Running ESPFIT
T00 ERR ... ===== Running on 4 threads =====
T00 ERR ... 2020-9-11 3:44:25 Calculated Densities at Numerical Grid, Number of electrons is 6.74118e-08
T00 ERR ... 2020-9-11 3:44:25 Calculating ESP at CHELPG grid points
T00 ERR ... 2020-9-11 3:44:28 Netcharge constrained to 0
T00 ERR ...  Sum of fitted charges: -8.95117e-16
T00 ERR ...  RMSE of fit:  0.00256657
T00 ERR ...  RRMSE of fit: 0.239719
T00 ERR ... El Dipole from fitted charges [e*bohr]:
                 dx = -0.6798 dy = +0.1553 dz = -0.2849 |d|^2 = +0.5674
T00 ERR ... El Dipole from exact qm density [e*bohr]:
                 dx = -0.7021 dy = +0.1605 dz = -0.2942 |d|^2 = +0.6052
T00 ERR ... Written charges to MP_FILES/frame_10000/n2s1/thiophene_0_n2s1.mps
T00 ERR ... 2020-9-11 3:44:28 Finished evaluating site 0
T00 ERR ... Saving data to molecule_0.orb
T00 ERR ... Reporting job results

T00 ERR ... Requesting next job
T00 ERR ... Assign jobs from stack
T00 ERR ... Next job: ID = 1
T00 ERR ... 2020-9-11 3:44:28 Evaluating site 1
T00 ERR ... Running DFT
T00 ERR ... Running GWBSE
T00 ERR ... Running ESPFIT
T00 ERR ... ===== Running on 4 threads =====
T00 ERR ... 2020-9-11 3:44:38 Calculated Densities at Numerical Grid, Number of electrons is -2.83827e-08
T00 ERR ... 2020-9-11 3:44:38 Calculating ESP at CHELPG grid points
T00 ERR ... 2020-9-11 3:44:41 Netcharge constrained to 0
T00 ERR ...  Sum of fitted charges: 6.52256e-16
T00 ERR ...  RMSE of fit:  0.00254444
T00 ERR ...  RRMSE of fit: 0.237898
T00 ERR ... El Dipole from fitted charges [e*bohr]:
                 dx = +0.1910 dy = +0.6923 dz = -0.2258 |d|^2 = +0.5668
T00 ERR ... El Dipole from exact qm density [e*bohr]:
                 dx = +0.1974 dy = +0.7154 dz = -0.2334 |d|^2 = +0.6053
T00 ERR ... Written charges to MP_FILES/frame_10000/n2s1/thiophene_1_n2s1.mps
T00 ERR ... 2020-9-11 3:44:41 Finished evaluating site 1
T00 ERR ... Saving data to molecule_1.orb
T00 ERR ... Reporting job results

T00 ERR ... Requesting next job
T00 ERR ... Assign jobs from stack
T00 ERR ... Sync did not yield any new jobs.
T00 ERR ... Next job: ID = - (none available)
MST ERR Assign jobs from stack
Changes have not been written to state file.
</pre></div></div>
</div>
</div>
<div class="section" id="QM-calculation-for-pairs">
<h2>QM calculation for pairs<a class="headerlink" href="#QM-calculation-for-pairs" title="Permalink to this headline">¶</a></h2>
<p>In the following step we will run QM calculations for each pair in the hdf5 file. As the calculations on the previous step, we will first write the jobs in a file, then run them and finally store the results in the state file. First, we need to copy the input to our local folder</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>!cp &quot;$VOTCASHARE/xtp/xml/iqm.xml&quot; OPTIONFILES/
</pre></div>
</div>
</div>
<p>As in the previous section, we set the GWBSE mode to <code class="docutils literal notranslate"><span class="pre">G0W0</span></code>and the <code class="docutils literal notranslate"><span class="pre">ranges</span></code> to <code class="docutils literal notranslate"><span class="pre">full</span></code>, but we compute only the <code class="docutils literal notranslate"><span class="pre">gw</span></code> approximation. We are also going to compute a single excited state. For more information, check the <a class="reference external" href="https://votca.github.io/iqm.html">iqm calculator options</a>. We also want to compute the <code class="docutils literal notranslate"><span class="pre">singlet</span></code> couplings.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>edit_calculator(&quot;iqm&quot;, &quot;states&quot;, &quot;1&quot;)
edit_calculator(&quot;iqm&quot;, &quot;map_file&quot;, &quot;system.xml&quot;)
edit_calculator(&quot;iqm&quot;, &quot;gwbse_options.gwbse.ranges&quot;, &quot;full&quot;)
edit_calculator(&quot;iqm&quot;, &quot;gwbse_options.gwbse.tasks&quot;, &quot;gw&quot;)
edit_calculator(&quot;iqm&quot;, &quot;gwbse_options.gwbse.qp_solver&quot;, &quot;fixedpoint&quot;)
edit_calculator(&quot;iqm&quot;, &quot;gwbse_options.gwbse.qp_grid_steps&quot;, &quot;100&quot;)
edit_calculator(&quot;iqm&quot;, &quot;gwbse_options.gwbse.qp_grid_spacing&quot;, &quot;0.01&quot;)
edit_calculator(&quot;iqm&quot;, &quot;bsecoupling.spin&quot;, &quot;singlet&quot;)
edit_calculator(&quot;iqm&quot;, &quot;basisset&quot;, &quot;3-21G&quot;)
edit_calculator(&quot;iqm&quot;, &quot;auxbasisset&quot;, &quot;aux-def2-svp&quot;)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The option &#39;states&#39; on file &#39;OPTIONFILES/iqm.xml&#39; has been set to &#39;1&#39;
The option &#39;map_file&#39; on file &#39;OPTIONFILES/iqm.xml&#39; has been set to &#39;system.xml&#39;
The option &#39;gwbse_options.gwbse.ranges&#39; on file &#39;OPTIONFILES/iqm.xml&#39; has been set to &#39;full&#39;
The option &#39;gwbse_options.gwbse.tasks&#39; on file &#39;OPTIONFILES/iqm.xml&#39; has been set to &#39;gw&#39;
The option &#39;gwbse_options.gwbse.qp_solver&#39; on file &#39;OPTIONFILES/iqm.xml&#39; has been set to &#39;fixedpoint&#39;
The option &#39;gwbse_options.gwbse.qp_grid_steps&#39; on file &#39;OPTIONFILES/iqm.xml&#39; has been set to &#39;100&#39;
The option &#39;gwbse_options.gwbse.qp_grid_spacing&#39; on file &#39;OPTIONFILES/iqm.xml&#39; has been set to &#39;0.01&#39;
The option &#39;bsecoupling.spin&#39; on file &#39;OPTIONFILES/iqm.xml&#39; has been set to &#39;singlet&#39;
The option &#39;basisset&#39; on file &#39;OPTIONFILES/iqm.xml&#39; has been set to &#39;3-21G&#39;
The option &#39;auxbasisset&#39; on file &#39;OPTIONFILES/iqm.xml&#39; has been set to &#39;aux-def2-svp&#39;
</pre></div></div>
</div>
<p>Before running the calculations, we need to specify in the <code class="docutils literal notranslate"><span class="pre">iqm</span></code> input which states to read into the jobfile for each segment type. The following <em>XML</em> snippet needs to be added</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>readjobfile = &quot;&quot;&quot;
&lt;readjobfile help=&quot;which states to read into the jobfile for each segment type&quot;&gt;
     &lt;singlet&gt;thiophene:s1&lt;/singlet&gt;
     &lt;triplet&gt;thiophene:t1&lt;/triplet&gt;
     &lt;electron&gt;thiophene:e1&lt;/electron&gt;
     &lt;hole&gt;thiophene:h1&lt;/hole&gt;
&lt;/readjobfile&gt;
&quot;&quot;&quot;
</pre></div>
</div>
</div>
<p>The following function add the <code class="docutils literal notranslate"><span class="pre">readjobfile</span></code> section,</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>add_section(&quot;iqm&quot;, readjobfile)
</pre></div>
</div>
</div>
<p>Now, let’s write the jobs to the file</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>!xtp_parallel -e iqm -o OPTIONFILES/iqm.xml -f state.hdf5 -s 0 -j &quot;write&quot;
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
 This is a XTP app
==================================================
========   VOTCA (http://www.votca.org)   ========
==================================================

please submit bugs to https://github.com/votca/xtp/issues

xtp_parallel, version 2021-dev gitid: cd0a3e5 (compiled Sep 11 2020, 03:39:46)
votca_csg, version 2021-dev gitid: cd0a3e5 (compiled Sep 11 2020, 03:39:29)
votca_tools, version 2021-dev gitid: cd0a3e5 (compiled Sep 11 2020, 03:39:26)

Initializing calculator
... iqm
... ... Initialized with 1 threads.

... ... Using 1 openmp threads for 1x1=1 total threads.
1 frames in statefile, Ids are: 10000
Starting at frame 10000
Evaluating frame 10000
Import MD Topology (i.e. frame 10000) from state.hdf5
....
... iqm
... ... Writing job file iqm.jobs
... ... In total 90067 jobs
Changes have not been written to state file.
</pre></div></div>
</div>
<p>From the jobs that we just write down, let’s make available only the first job</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>!sed -i &quot;s/AVAILABLE/COMPLETE/g&quot; iqm.jobs
!sed -i &#39;0,/COMPLETE/s/COMPLETE/AVAILABLE/&#39; iqm.jobs
</pre></div>
</div>
</div>
<p>Now we can run and store the jobs results</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>!xtp_parallel -e iqm -o OPTIONFILES/iqm.xml -f state.hdf5 -s 0 -j run -c 1 -p 4
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
 This is a XTP app
==================================================
========   VOTCA (http://www.votca.org)   ========
==================================================

please submit bugs to https://github.com/votca/xtp/issues

xtp_parallel, version 2021-dev gitid: cd0a3e5 (compiled Sep 11 2020, 03:39:46)
votca_csg, version 2021-dev gitid: cd0a3e5 (compiled Sep 11 2020, 03:39:29)
votca_tools, version 2021-dev gitid: cd0a3e5 (compiled Sep 11 2020, 03:39:26)

Initializing calculator
... iqm
... ... Initialized with 1 threads.

... ... Using 4 openmp threads for 1x4=4 total threads.
1 frames in statefile, Ids are: 10000
Starting at frame 10000
Evaluating frame 10000
Import MD Topology (i.e. frame 10000) from state.hdf5
....
... iqm
MST ERR Job file = &#39;iqm.jobs&#39;, cache size =  1
MST ERR Initialize jobs from iqm.jobs
MST ERR Registered 90067 jobs.
T00 ERR ... Requesting next job
T00 ERR ... Assign jobs from stack
T00 ERR ... Next job: ID = 0=&gt; [ 0%]
T00 ERR ... 2020-9-11 3:44:58 Evaluating pair 0 [0:1] out of 90067
T00 ERR ... Guess requested, reading molecular orbitals
T00 ERR ... Reading MoleculeA from OR_FILES/molecules/frame_10000/molecule_0.orb
T00 ERR ... Reading MoleculeB from OR_FILES/molecules/frame_10000/molecule_1.orb
T00 ERR ... Running DFT
T00 ERR ... Calculating electronic couplings
T00 ERR ... Levels:Basis A[2:57] B[2:57]
T00 ERR ... Done with electronic couplings
T00 ERR ... Running GWBSE
T00 ERR ... Running BSECoupling
T00 ERR ... 2020-9-11 3:45:35 Finished evaluating pair 0:1
T00 ERR ... Orb file is not saved according to options
T00 ERR ... Reporting job results

T00 ERR ... Requesting next job
T00 ERR ... Assign jobs from stack
T00 ERR ... Sync did not yield any new jobs.
T00 ERR ... Next job: ID = - (none available)
MST ERR Assign jobs from stack
Changes have not been written to state file.
</pre></div></div>
</div>
<p>Finally, we read the results into the state</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>!xtp_parallel -e iqm -o OPTIONFILES/iqm.xml -f state.hdf5 -j &quot;read&quot;
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
 This is a XTP app
==================================================
========   VOTCA (http://www.votca.org)   ========
==================================================

please submit bugs to https://github.com/votca/xtp/issues

xtp_parallel, version 2021-dev gitid: cd0a3e5 (compiled Sep 11 2020, 03:39:46)
votca_csg, version 2021-dev gitid: cd0a3e5 (compiled Sep 11 2020, 03:39:29)
votca_tools, version 2021-dev gitid: cd0a3e5 (compiled Sep 11 2020, 03:39:26)

Initializing calculator
... iqm
... ... Initialized with 1 threads.

... ... Using 1 openmp threads for 1x1=1 total threads.
1 frames in statefile, Ids are: 10000
Starting at frame 10000
Evaluating frame 10000
Import MD Topology (i.e. frame 10000) from state.hdf5
....
... iqm
Wrote MD topology (step = 10000, time = 0) to state.hdf5
... .
</pre></div></div>
</div>
</div>
<div class="section" id="QMMM-Calculations">
<h2>QMMM Calculations<a class="headerlink" href="#QMMM-Calculations" title="Permalink to this headline">¶</a></h2>
<p>We will run the <em>QMMM</em> calculations we will use the pregenerated <code class="docutils literal notranslate"><span class="pre">qmmm.jobs</span></code> file in the current work directory, so we cana directly run the calculations</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>!cp qmmm.xml OPTIONFILES
!xtp_parallel -e qmmm -o OPTIONFILES/qmmm.xml -f state.hdf5 -j run -p 4
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
 This is a XTP app
==================================================
========   VOTCA (http://www.votca.org)   ========
==================================================

please submit bugs to https://github.com/votca/xtp/issues

xtp_parallel, version 2021-dev gitid: cd0a3e5 (compiled Sep 11 2020, 03:39:46)
votca_csg, version 2021-dev gitid: cd0a3e5 (compiled Sep 11 2020, 03:39:29)
votca_tools, version 2021-dev gitid: cd0a3e5 (compiled Sep 11 2020, 03:39:26)

Initializing calculator
... qmmm
... ... Initialized with 1 threads.

... ... Using 4 openmp threads for 1x4=4 total threads.
1 frames in statefile, Ids are: 10000
Starting at frame 10000
Evaluating frame 10000
Import MD Topology (i.e. frame 10000) from state.hdf5
....
... qmmm
MST ERR Job file = &#39;qmmm.jobs&#39;, cache size =  8
MST ERR Initialize jobs from qmmm.jobs
MST ERR Registered 2 jobs.
T00 ERR ... Requesting next job
T00 ERR ... Assign jobs from stack
T00 ERR ... Sync did not yield any new jobs.
T00 ERR ... Next job: ID = - (none available)
MST ERR Assign jobs from stack
Changes have not been written to state file.
</pre></div></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="LAMMPS_KMC.html" class="btn btn-neutral float-right" title="Kinect Monte Carlo Simulations Using LAMMPS" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="QMMM_GROMACS.html" class="btn btn-neutral float-left" title="QMMM workflow using GROMACS and VOTCA-XTP" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, VOTCA Development Team

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>