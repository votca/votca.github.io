{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# QMMM workflow using GROMACS and VOTCA-XTP"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## What is this tutorial about\n",
    "In this tutorial, we will learn how to set and perform excited state calculation using the Votca XTP library. We will use methane as our QM region."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Requirements\n",
    "* You will need to install **VOTCA** using the instructions described [here](https://github.com/votca/votca/blob/master/share/doc/INSTALL.rst)\n",
    "* Once the installation is completed you need to activate the VOTCA enviroment by running the `VOTCARC.bash` script that has been installed at the bin subfolder for the path that you have provided for the installation step above"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Interacting with the XTP command line interface\n",
    "The XTP package offers the following command line interface that the user can interact with:\n",
    "* [xtp_map](https://www.votca.org/xtp/xtp_map.html)\n",
    "* [xtp_parallel](https://www.votca.org/xtp/xtp_parallel.html)\n",
    "* [xtp_run](https://www.votca.org/xtp/xtp_run.html)\n",
    "* [xtp_tools](https://www.votca.org/xtp/xtp_tools.html)\n",
    "\n",
    "Run the following command to view the help message of `xtp_tools`:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2021-07-07T16:40:59.288471Z",
     "iopub.status.busy": "2021-07-07T16:40:59.287944Z",
     "iopub.status.idle": "2021-07-07T16:41:00.003072Z",
     "shell.execute_reply": "2021-07-07T16:41:00.002381Z"
    }
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "==================================================\r\n",
      "========   VOTCA (http://www.votca.org)   ========\r\n",
      "==================================================\r\n",
      "\r\n",
      "please submit bugs to https://github.com/votca/xtp/issues\r\n",
      "\r\n",
      "xtp_tools, version 2022-dev gitid: 60fc73d (compiled Jul  7 2021, 16:29:22)\r\n",
      "votca_csg, version 2022-dev gitid: 60fc73d (compiled Jul  7 2021, 16:11:42)\r\n",
      "votca_tools, version 2022-dev gitid: 60fc73d (compiled Jul  7 2021, 16:08:43)\r\n",
      "\r\n",
      "Runs excitation/charge transport tools\r\n",
      "\r\n",
      "\r\n",
      "\r\n",
      "Allowed options:\r\n",
      "  -h [ --help ]                 display this help and exit\r\n",
      "  --verbose                     be loud and noisy\r\n",
      "  --verbose1                    be very loud and noisy\r\n",
      "  -v [ --verbose2 ]             be extremly loud and noisy\r\n",
      "  -o [ --options ] arg          Tool options\r\n",
      "  -t [ --nthreads ] arg (=1)    number of threads to create\r\n",
      "  -e [ --execute ] arg        Name of Tool to run\r\n",
      "  -l [ --list ]               Lists all available Tools\r\n",
      "  -d [ --description ] arg    Short description of a Tools\r\n",
      "  -c [ --cmdoptions ] arg     Modify options via command line by e.g. '-c \r\n",
      "                              xmltag.subtag=value'. Use whitespace to separate \r\n",
      "                              multiple options\r\n",
      "  -p [ --printoptions ] arg   Prints xml options of a Tool\r\n",
      "\r\n"
     ]
    }
   ],
   "source": [
    "!xtp_tools -h"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Note\n",
    "> * In Jupyter the `!` symbol means: *run the following command as a standard unix command*\n",
    "> * In Jupyter the command `%env` set an environmental variable"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Setting the environment\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Create a folder to store the input `Options` for XTP"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2021-07-07T16:41:00.010157Z",
     "iopub.status.busy": "2021-07-07T16:41:00.007256Z",
     "iopub.status.idle": "2021-07-07T16:41:00.669553Z",
     "shell.execute_reply": "2021-07-07T16:41:00.670072Z"
    }
   },
   "outputs": [],
   "source": [
    "!mkdir -p OPTIONFILES"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Remove previous hdf5 file"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2021-07-07T16:41:00.676922Z",
     "iopub.status.busy": "2021-07-07T16:41:00.674138Z",
     "iopub.status.idle": "2021-07-07T16:41:01.344575Z",
     "shell.execute_reply": "2021-07-07T16:41:01.344999Z"
    }
   },
   "outputs": [],
   "source": [
    "!rm -f state.hdf5"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Import an small python module to edit xml files"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2021-07-07T16:41:01.350265Z",
     "iopub.status.busy": "2021-07-07T16:41:01.348666Z",
     "iopub.status.idle": "2021-07-07T16:41:01.357016Z",
     "shell.execute_reply": "2021-07-07T16:41:01.356128Z"
    }
   },
   "outputs": [],
   "source": [
    "from xml_editor import add_section, edit_calculator\n",
    "import os"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Generate the topology from the Gromacs file"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "runs the mapping from MD coordinates to segments and creates an [hdf5 file](https://www.hdfgroup.org/solutions/hdf5/). You can explore the generated `state.hdf5` file with e.g. hdf5itebrowser. In Python, you can use the [h5py library](https://www.h5py.org/)."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2021-07-07T16:41:01.365342Z",
     "iopub.status.busy": "2021-07-07T16:41:01.362390Z",
     "iopub.status.idle": "2021-07-07T16:41:03.445828Z",
     "shell.execute_reply": "2021-07-07T16:41:03.445098Z"
    }
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "==================================================\r\n",
      "========   VOTCA (http://www.votca.org)   ========\r\n",
      "==================================================\r\n",
      "\r\n",
      "please submit bugs to https://github.com/votca/xtp/issues\r\n",
      "\r\n",
      "xtp_map, version 2022-dev gitid: 60fc73d (compiled Jul  7 2021, 16:29:22)\r\n",
      "votca_csg, version 2022-dev gitid: 60fc73d (compiled Jul  7 2021, 16:11:42)\r\n",
      "votca_tools, version 2022-dev gitid: 60fc73d (compiled Jul  7 2021, 16:08:43)\r\n",
      "\r\n",
      "Reading file MD_FILES/topol.tpr, VERSION 5.1.1 (single precision)\r\n",
      "Note: file tpx version 103, software tpx version 116\r\n",
      "Creating statefile state.hdf5\r\n",
      "Frame with id 0 was not in statefile state.hdf5 ,adding it now.\r\n",
      "Wrote MD topology (step = 0, time = 0) to state.hdf5\r\n",
      "... . \r\n"
     ]
    }
   ],
   "source": [
    "!xtp_map -t MD_FILES/topol.tpr -c MD_FILES/conf.gro -s system.xml -f state.hdf5"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "##  Check the mapping\n",
    "\n",
    "Let us first output `.pdb` files for the segments, qmmolecules and classical segments in order to check the mapping. We will need to copy the input from the `VOTCA` installation path to our local copy."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2021-07-07T16:41:03.454754Z",
     "iopub.status.busy": "2021-07-07T16:41:03.453884Z",
     "iopub.status.idle": "2021-07-07T16:41:04.117090Z",
     "shell.execute_reply": "2021-07-07T16:41:04.116298Z"
    }
   },
   "outputs": [],
   "source": [
    "!cp \"$VOTCASHARE/xtp/xml/mapchecker.xml\" OPTIONFILES/"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "The `${VOTCASHARE}` environmental variable is set to the path that you provided during the `VOTCA` [installation](https://github.com/votca/votca/blob/master/share/doc/INSTALL.rst), by the default is set to `/usr/local/votca`.\n",
    "\n",
    "We need to update the `mapchecker` options with the file containing the definition of the system. For doing, so we will use the python module `xml_editor` that we have imported above. The first argument is the name of the calculator (i.e. `mapchecker`), the seconds argument is the name of the option to change and the third one, the value to use."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2021-07-07T16:41:04.122513Z",
     "iopub.status.busy": "2021-07-07T16:41:04.121186Z",
     "iopub.status.idle": "2021-07-07T16:41:04.126353Z",
     "shell.execute_reply": "2021-07-07T16:41:04.125901Z"
    }
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "The option 'map_file' on file 'OPTIONFILES/mapchecker.xml' has been set to 'system.xml'\n"
     ]
    }
   ],
   "source": [
    "edit_calculator(\"mapchecker\", \"map_file\", \"system.xml\")"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "In the [mapchecker section of the manual](https://votca.github.io/xtp/mapchecker.html) you can find a table with the `mapchecker` input variables and their corresponding defaults. Finally, the following command run the check"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2021-07-07T16:41:04.130498Z",
     "iopub.status.busy": "2021-07-07T16:41:04.129940Z",
     "iopub.status.idle": "2021-07-07T16:41:06.334869Z",
     "shell.execute_reply": "2021-07-07T16:41:06.334036Z"
    }
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "==================================================\r\n",
      "========   VOTCA (http://www.votca.org)   ========\r\n",
      "==================================================\r\n",
      "\r\n",
      "please submit bugs to https://github.com/votca/xtp/issues\r\n",
      "\r\n",
      "xtp_run, version 2022-dev gitid: 60fc73d (compiled Jul  7 2021, 16:29:22)\r\n",
      "votca_csg, version 2022-dev gitid: 60fc73d (compiled Jul  7 2021, 16:11:42)\r\n",
      "votca_tools, version 2022-dev gitid: 60fc73d (compiled Jul  7 2021, 16:08:43)\r\n",
      "\r\n",
      "Initializing calculator\r\n",
      "... mapchecker\r\n",
      "1 frames in statefile, Ids are: 0 \r\n",
      "Starting at frame 0\r\n",
      "Evaluating frame 0\r\n",
      "Import MD Topology (i.e. frame 0) from state.hdf5\r\n",
      ".... \r\n",
      "... mapchecker\r\n",
      " Using 1 threads\r\n",
      "Writing segments to md_segments step__0.pdb\r\n",
      "Writing qmmolecules to qm_segments_n step__0.pdb\r\n",
      "Writing polarsegments to mp_segments_e step__0.pdb\r\n",
      "Writing polarsegments to mp_segments_h step__0.pdb\r\n",
      "Changes have not been written to state file.\r\n"
     ]
    }
   ],
   "source": [
    "!xtp_run -e mapchecker -o OPTIONFILES/mapchecker.xml -f state.hdf5"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Neighborlist Calculation"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "The following step is to determine the neighbouring pairs for exciton transport. We will need first to get a copy of the input "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2021-07-07T16:41:06.343047Z",
     "iopub.status.busy": "2021-07-07T16:41:06.340107Z",
     "iopub.status.idle": "2021-07-07T16:41:06.999985Z",
     "shell.execute_reply": "2021-07-07T16:41:07.000416Z"
    }
   },
   "outputs": [],
   "source": [
    "cp \"$VOTCASHARE/xtp/xml/neighborlist.xml\" OPTIONFILES/"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Then we will use `segmentname` method to select the cutoff and set the *exciton_cutoff* for the pairs to 0.5 nanometers. See the [neighborlist options](https://www.votca.org/xtp/neighborlist.html) for further information. "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2021-07-07T16:41:07.006711Z",
     "iopub.status.busy": "2021-07-07T16:41:07.005127Z",
     "iopub.status.idle": "2021-07-07T16:41:07.009630Z",
     "shell.execute_reply": "2021-07-07T16:41:07.010019Z"
    }
   },
   "outputs": [],
   "source": [
    "exciton_cutoff = \"\"\"\n",
    "<exciton_cutoff>0.5</exciton_cutoff>\n",
    "\"\"\"\n",
    "segments = \"\"\"\n",
    "<segments>\n",
    "  <type>Methane Methane</type>\n",
    "  <cutoff>1</cutoff>\n",
    "</segments>\n",
    "\"\"\"\n",
    "constant = \"\"\"<constant help=\"cutoff for all other types of pairs\">0.6</constant>\"\"\"\n",
    "cutoff_type = \"\"\"<cutoff_type>segmentname</cutoff_type>\"\"\"\n",
    "\n",
    "add_section(\"neighborlist\", cutoff_type)\n",
    "add_section(\"neighborlist\", exciton_cutoff)\n",
    "add_section(\"neighborlist\", segments)\n",
    "add_section(\"neighborlist\", constant)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Finally, we can run the calculation using 4 threads"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2021-07-07T16:41:07.016634Z",
     "iopub.status.busy": "2021-07-07T16:41:07.013198Z",
     "iopub.status.idle": "2021-07-07T16:41:10.280184Z",
     "shell.execute_reply": "2021-07-07T16:41:10.279472Z"
    }
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "==================================================\r\n",
      "========   VOTCA (http://www.votca.org)   ========\r\n",
      "==================================================\r\n",
      "\r\n",
      "please submit bugs to https://github.com/votca/xtp/issues\r\n",
      "\r\n",
      "xtp_run, version 2022-dev gitid: 60fc73d (compiled Jul  7 2021, 16:29:22)\r\n",
      "votca_csg, version 2022-dev gitid: 60fc73d (compiled Jul  7 2021, 16:11:42)\r\n",
      "votca_tools, version 2022-dev gitid: 60fc73d (compiled Jul  7 2021, 16:08:43)\r\n",
      "\r\n",
      "Initializing calculator\r\n",
      "... neighborlist\r\n",
      "1 frames in statefile, Ids are: 0 \r\n",
      "Starting at frame 0\r\n",
      "Evaluating frame 0\r\n",
      "Import MD Topology (i.e. frame 0) from state.hdf5\r\n",
      ".... \r\n",
      "... neighborlist\r\n",
      " Using 1 threads\r\n",
      "Evaluating 1000 segments for neighborlist. \r\n",
      "The following segments are used in the neigborlist creation\r\n",
      "\t Methane\r\n",
      " ... ... Evaluating \r\n",
      "0%   10   20   30   40   50   60   70   80   90   100%\r\n",
      "|----|----|----|----|----|----|----|----|----|----|\r\n",
      "***************************************************\r\n",
      "\r\n",
      " ... ... Created 76140 direct pairs.Wrote MD topology (step = 0, time = 0) to state.hdf5\r\n",
      "... . \r\n"
     ]
    }
   ],
   "source": [
    "!xtp_run -e neighborlist -o OPTIONFILES/neighborlist.xml -f state.hdf5"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Read reorganization energies\n",
    "In this step we will read the in site reorganization energies and store them in the `state.hdf5` file. We just need to copy the input file and execute the calculation"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2021-07-07T16:41:10.285826Z",
     "iopub.status.busy": "2021-07-07T16:41:10.285254Z",
     "iopub.status.idle": "2021-07-07T16:41:13.895769Z",
     "shell.execute_reply": "2021-07-07T16:41:13.896184Z"
    }
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "==================================================\r\n",
      "========   VOTCA (http://www.votca.org)   ========\r\n",
      "==================================================\r\n",
      "\r\n",
      "please submit bugs to https://github.com/votca/xtp/issues\r\n",
      "\r\n",
      "xtp_run, version 2022-dev gitid: 60fc73d (compiled Jul  7 2021, 16:29:22)\r\n",
      "votca_csg, version 2022-dev gitid: 60fc73d (compiled Jul  7 2021, 16:11:42)\r\n",
      "votca_tools, version 2022-dev gitid: 60fc73d (compiled Jul  7 2021, 16:08:43)\r\n",
      "\r\n",
      "Initializing calculator\r\n",
      "... einternal\r\n",
      "1 frames in statefile, Ids are: 0 \r\n",
      "Starting at frame 0\r\n",
      "Evaluating frame 0\r\n",
      "Import MD Topology (i.e. frame 0) from state.hdf5\r\n",
      ".... \r\n",
      "... einternal\r\n",
      " Using 1 threads\r\n",
      "... ... Site, reorg. energies from system.xml.\r\n",
      "\r\n",
      "... ... Read in site, reorg. energies for 1000 segments. Wrote MD topology (step = 0, time = 0) to state.hdf5\r\n",
      "... . \r\n"
     ]
    }
   ],
   "source": [
    "!cp \"$VOTCASHARE/xtp/xml/einternal.xml\" OPTIONFILES/\n",
    "!xtp_run -e einternal -o OPTIONFILES/einternal.xml -f state.hdf5"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Compute site energy\n",
    "In this step we will perform some *QMMM* calculations to compute the site energies. The `qmmm_mm.xml` file contains some predefined settings to perform the *MM* calculations. Let us first copy these settings into the state file,"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2021-07-07T16:41:13.906204Z",
     "iopub.status.busy": "2021-07-07T16:41:13.905348Z",
     "iopub.status.idle": "2021-07-07T16:41:16.392452Z",
     "shell.execute_reply": "2021-07-07T16:41:16.392905Z"
    }
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "==================================================\r\n",
      "========   VOTCA (http://www.votca.org)   ========\r\n",
      "==================================================\r\n",
      "\r\n",
      "please submit bugs to https://github.com/votca/xtp/issues\r\n",
      "\r\n",
      "xtp_parallel, version 2022-dev gitid: 60fc73d (compiled Jul  7 2021, 16:29:22)\r\n",
      "votca_csg, version 2022-dev gitid: 60fc73d (compiled Jul  7 2021, 16:11:42)\r\n",
      "votca_tools, version 2022-dev gitid: 60fc73d (compiled Jul  7 2021, 16:08:43)\r\n",
      "\r\n",
      "Initializing calculator\r\n",
      "... qmmm\r\n",
      "\r\n",
      "... ... Initialized with 1 threads.\r\n",
      "\r\n",
      "... ... Using 1 openmp threads for 1x1=1 total threads.\r\n",
      "1 frames in statefile, Ids are: 0 \r\n",
      "Starting at frame 0\r\n",
      "Evaluating frame 0\r\n",
      "Import MD Topology (i.e. frame 0) from state.hdf5\r\n",
      ".... \r\n",
      "... qmmm \r\n",
      "... ... Writing job file qmmm_mm_jobs.xml\r\n",
      "... ... In total 4001 jobs\r\n",
      "Changes have not been written to state file.\r\n"
     ]
    }
   ],
   "source": [
    "!cp qmmm_mm.xml OPTIONFILES\n",
    "!xtp_parallel -e qmmm -o OPTIONFILES/qmmm_mm.xml -f state.hdf5 -j \"write\""
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "The previous command generates a `qmmm_mm_jobs.xml` containing 4000 *MM* jobs to compute, if you examine that file, it should look something like"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "```xml\n",
    "<jobs>\n",
    "  <job>\n",
    "    <id>0</id>\n",
    "    <tag>Methane_0:n</tag>\n",
    "    <input>\n",
    "      <site_energies>0:n</site_energies>\n",
    "      <regions>\n",
    "        <region>\n",
    "          <id>0</id>\n",
    "          <segments>0:n</segments>\n",
    "        </region>\n",
    "      </regions>\n",
    "    </input>\n",
    "    <status>AVAILABLE</status>\n",
    "  </job>    \n",
    "...\n",
    "```"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Let us run just the first 4 jobs by settings all jobs `status` to `COMPLETE` except for the first four. This can be easily done with [sed](https://www.gnu.org/software/sed/manual/sed.html) as follows,"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2021-07-07T16:41:16.400236Z",
     "iopub.status.busy": "2021-07-07T16:41:16.399536Z",
     "iopub.status.idle": "2021-07-07T16:41:19.758592Z",
     "shell.execute_reply": "2021-07-07T16:41:19.757779Z"
    }
   },
   "outputs": [],
   "source": [
    "!sed -i \"s/AVAILABLE/COMPLETE/g\" qmmm_mm_jobs.xml\n",
    "!sed -i '0,/COMPLETE/s/COMPLETE/AVAILABLE/' qmmm_mm_jobs.xml\n",
    "!sed -i '0,/COMPLETE/s/COMPLETE/AVAILABLE/' qmmm_mm_jobs.xml\n",
    "!sed -i '0,/COMPLETE/s/COMPLETE/AVAILABLE/' qmmm_mm_jobs.xml\n",
    "!sed -i '0,/COMPLETE/s/COMPLETE/AVAILABLE/' qmmm_mm_jobs.xml"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Now we can run the jobs and save the results in the state file"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2021-07-07T16:41:19.768240Z",
     "iopub.status.busy": "2021-07-07T16:41:19.763484Z",
     "iopub.status.idle": "2021-07-07T16:41:26.734935Z",
     "shell.execute_reply": "2021-07-07T16:41:26.735486Z"
    }
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "==================================================\r\n",
      "========   VOTCA (http://www.votca.org)   ========\r\n",
      "==================================================\r\n",
      "\r\n",
      "please submit bugs to https://github.com/votca/xtp/issues\r\n",
      "\r\n",
      "xtp_parallel, version 2022-dev gitid: 60fc73d (compiled Jul  7 2021, 16:29:22)\r\n",
      "votca_csg, version 2022-dev gitid: 60fc73d (compiled Jul  7 2021, 16:11:42)\r\n",
      "votca_tools, version 2022-dev gitid: 60fc73d (compiled Jul  7 2021, 16:08:43)\r\n",
      "\r\n",
      "Initializing calculator\r\n",
      "... qmmm\r\n",
      "\r\n",
      "... ... Initialized with 1 threads.\r\n",
      "\r\n",
      "... ... Using 2 openmp threads for 1x2=2 total threads.\r\n",
      "1 frames in statefile, Ids are: 0 \r\n",
      "Starting at frame 0\r\n",
      "Evaluating frame 0\r\n",
      "Import MD Topology (i.e. frame 0) from state.hdf5\r\n",
      ".... \r\n",
      "... qmmm \r\n",
      "MST ERR Job file = 'qmmm_mm_jobs.xml', cache size =  8\r\n",
      "MST ERR Initialize jobs from qmmm_mm_jobs.xml\r\n",
      "MST ERR Registered 4000 jobs.\r\n",
      "T00 ERR ... Requesting next job\r\n",
      "T00 ERR ... Assign jobs from stack\r\n",
      "T00 ERR ... Next job: ID = 0=> [ 0%] \r\n",
      "T00 ERR ...  Regions created\r\n",
      "T00 ERR ... Id: 0 type: polar size: 17 charge[e]= -9.29812e-16\r\n",
      "T00 ERR ... Id: 1 type: static size: 254 charge[e]= -1.4086e-14\r\n",
      "T00 ERR ... 2021-7-7 16:41:22 Writing jobtopology to MMMM/frame_0/job_0_Methane_0:n/regions.pdb\r\n",
      "T00 ERR ... 2021-7-7 16:41:22 Only 1 scf region is used. The remaining regions are static. So no inter regions scf is required. \r\n",
      "T00 ERR ... 2021-7-7 16:41:22 --Inter Region SCF Iteration 1 of 1\r\n",
      "T00 ERR ... 2021-7-7 16:41:22 Evaluating polar 0\r\n",
      "T00 ERR ... 2021-7-7 16:41:22 Evaluating interaction between polar 0 and static 1\r\n",
      "T00 ERR ... 2021-7-7 16:41:22 Starting Solving for classical polarization with 255 degrees of freedom.\r\n",
      "T00 ERR ... 2021-7-7 16:41:22 CG: #iterations: 7, estimated error: 4.15528e-06\r\n",
      "T00 ERR ...   Total static energy [hrt]= 8.121948104e-05\r\n",
      "T00 ERR ...   Total polar energy [hrt]= -0.0001235439304\r\n",
      "T00 ERR ...  Total energy [hrt]= -4.232444937e-05\r\n",
      "T00 ERR ... 2021-7-7 16:41:22 Evaluating static 1\r\n",
      "T00 ERR ... 2021-7-7 16:41:22 Writing checkpoint to checkpoint_iter_1.hdf5\r\n",
      "T00 ERR ... Reporting job results\r\n",
      "\r\n",
      "T00 ERR ... Requesting next job\r\n",
      "T00 ERR ... Next job: ID = 1\r\n",
      "T00 ERR ...  Regions created\r\n",
      "T00 ERR ... Id: 0 type: polar size: 17 charge[e]= -1\r\n",
      "T00 ERR ... Id: 1 type: static size: 254 charge[e]= -1.408595462e-14\r\n",
      "T00 ERR ... 2021-7-7 16:41:22 Writing jobtopology to MMMM/frame_0/job_1_Methane_0:e/regions.pdb\r\n",
      "T00 ERR ... 2021-7-7 16:41:22 Only 1 scf region is used. The remaining regions are static. So no inter regions scf is required. \r\n",
      "T00 ERR ... 2021-7-7 16:41:22 --Inter Region SCF Iteration 1 of 1\r\n",
      "T00 ERR ... 2021-7-7 16:41:22 Evaluating polar 0\r\n",
      "T00 ERR ... 2021-7-7 16:41:22 Evaluating interaction between polar 0 and static 1\r\n",
      "T00 ERR ... 2021-7-7 16:41:22 Starting Solving for classical polarization with 255 degrees of freedom.\r\n",
      "T00 ERR ... 2021-7-7 16:41:22 CG: #iterations: 27, estimated error: 5.956397132e-06\r\n",
      "T00 ERR ...   Total static energy [hrt]= -0.0009055590147\r\n",
      "T00 ERR ...   Total polar energy [hrt]= -0.03058901395\r\n",
      "T00 ERR ...  Total energy [hrt]= -0.03149457297\r\n",
      "T00 ERR ... 2021-7-7 16:41:22 Evaluating static 1\r\n",
      "T00 ERR ... 2021-7-7 16:41:22 Writing checkpoint to checkpoint_iter_1.hdf5\r\n",
      "T00 ERR ... Reporting job results\r\n",
      "\r\n",
      "T00 ERR ... Requesting next job\r\n",
      "T00 ERR ... Next job: ID = 2\r\n",
      "T00 ERR ...  Regions created\r\n",
      "T00 ERR ... Id: 0 type: polar size: 17 charge[e]= 1\r\n",
      "T00 ERR ... Id: 1 type: static size: 254 charge[e]= -1.408595462e-14\r\n",
      "T00 ERR ... 2021-7-7 16:41:22 Writing jobtopology to MMMM/frame_0/job_2_Methane_0:h/regions.pdb\r\n",
      "T00 ERR ... 2021-7-7 16:41:22 Only 1 scf region is used. The remaining regions are static. So no inter regions scf is required. \r\n",
      "T00 ERR ... 2021-7-7 16:41:22 --Inter Region SCF Iteration 1 of 1\r\n",
      "T00 ERR ... 2021-7-7 16:41:22 Evaluating polar 0\r\n",
      "T00 ERR ... 2021-7-7 16:41:22 Evaluating interaction between polar 0 and static 1\r\n",
      "T00 ERR ... 2021-7-7 16:41:22 Starting Solving for classical polarization with 255 degrees of freedom.\r\n",
      "T00 ERR ... 2021-7-7 16:41:22 CG: #iterations: 7, estimated error: 3.581023691e-06\r\n",
      "T00 ERR ...   Total static energy [hrt]= 0.001994038371\r\n",
      "T00 ERR ...   Total polar energy [hrt]= -0.02768723938\r\n",
      "T00 ERR ...  Total energy [hrt]= -0.02569320101\r\n",
      "T00 ERR ... 2021-7-7 16:41:22 Evaluating static 1\r\n",
      "T00 ERR ... 2021-7-7 16:41:22 Writing checkpoint to checkpoint_iter_1.hdf5\r\n",
      "T00 ERR ... Reporting job results\r\n",
      "\r\n",
      "T00 ERR ... Requesting next job\r\n",
      "T00 ERR ... Next job: ID = 3\r\n",
      "T00 ERR ...  Regions created\r\n",
      "T00 ERR ... Id: 0 type: polar size: 17 charge[e]= -7.632783294e-16\r\n",
      "T00 ERR ... Id: 1 type: static size: 254 charge[e]= -1.408595462e-14\r\n",
      "T00 ERR ... 2021-7-7 16:41:22 Writing jobtopology to MMMM/frame_0/job_3_Methane_0:s1/regions.pdb\r\n",
      "T00 ERR ... 2021-7-7 16:41:22 Only 1 scf region is used. The remaining regions are static. So no inter regions scf is required. \r\n",
      "T00 ERR ... 2021-7-7 16:41:22 --Inter Region SCF Iteration 1 of 1\r\n",
      "T00 ERR ... 2021-7-7 16:41:22 Evaluating polar 0\r\n",
      "T00 ERR ... 2021-7-7 16:41:22 Evaluating interaction between polar 0 and static 1\r\n",
      "T00 ERR ... 2021-7-7 16:41:22 Starting Solving for classical polarization with 255 degrees of freedom.\r\n",
      "T00 ERR ... 2021-7-7 16:41:22 CG: #iterations: 7, estimated error: 5.171454294e-06\r\n",
      "T00 ERR ...   Total static energy [hrt]= 0.0002401293715\r\n",
      "T00 ERR ...   Total polar energy [hrt]= -0.0004782854375\r\n",
      "T00 ERR ...  Total energy [hrt]= -0.000238156066\r\n",
      "T00 ERR ... 2021-7-7 16:41:22 Evaluating static 1\r\n",
      "T00 ERR ... 2021-7-7 16:41:22 Writing checkpoint to checkpoint_iter_1.hdf5\r\n",
      "T00 ERR ... Reporting job results\r\n",
      "\r\n",
      "T00 ERR ... Requesting next job\r\n",
      "T00 ERR ... Assign jobs from stack\r\n",
      "T00 ERR ... Sync did not yield any new jobs.\r\n",
      "T00 ERR ... Next job: ID = - (none available)\r\n",
      "MST ERR Assign jobs from stack\r\n",
      "Changes have not been written to state file.\r\n",
      "==================================================\r\n",
      "========   VOTCA (http://www.votca.org)   ========\r\n",
      "==================================================\r\n",
      "\r\n",
      "please submit bugs to https://github.com/votca/xtp/issues\r\n",
      "\r\n",
      "xtp_parallel, version 2022-dev gitid: 60fc73d (compiled Jul  7 2021, 16:29:22)\r\n",
      "votca_csg, version 2022-dev gitid: 60fc73d (compiled Jul  7 2021, 16:11:42)\r\n",
      "votca_tools, version 2022-dev gitid: 60fc73d (compiled Jul  7 2021, 16:08:43)\r\n",
      "\r\n",
      "Initializing calculator\r\n",
      "... qmmm\r\n",
      "\r\n",
      "... ... Initialized with 1 threads.\r\n",
      "\r\n",
      "... ... Using 1 openmp threads for 1x1=1 total threads.\r\n",
      "1 frames in statefile, Ids are: 0 \r\n",
      "Starting at frame 0\r\n",
      "Evaluating frame 0\r\n",
      "Import MD Topology (i.e. frame 0) from state.hdf5\r\n",
      ".... \r\n",
      "... qmmm \r\n",
      "Found 1 states of type e\r\n",
      "Found 1 states of type h\r\n",
      "Found 1 states of type s\r\n",
      "Found 1 states of type n\r\n",
      "3996 incomplete jobs found.\r\n",
      "\r\n",
      "Wrote MD topology (step = 0, time = 0) to state.hdf5\r\n",
      "... . \r\n"
     ]
    }
   ],
   "source": [
    "!xtp_parallel -e qmmm -o OPTIONFILES/qmmm_mm.xml -f state.hdf5 -x 2 -j \"run\"\n",
    "!xtp_parallel -e qmmm -o OPTIONFILES/qmmm_mm.xml -f state.hdf5 -j \"read\""
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Site energy and pair energy analysis\n",
    "In this step we generate an histogram and compute the correlation function of site energies and pair energy differences."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2021-07-07T16:41:26.742981Z",
     "iopub.status.busy": "2021-07-07T16:41:26.740258Z",
     "iopub.status.idle": "2021-07-07T16:41:29.987302Z",
     "shell.execute_reply": "2021-07-07T16:41:29.984531Z"
    }
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "==================================================\r\n",
      "========   VOTCA (http://www.votca.org)   ========\r\n",
      "==================================================\r\n",
      "\r\n",
      "please submit bugs to https://github.com/votca/xtp/issues\r\n",
      "\r\n",
      "xtp_run, version 2022-dev gitid: 60fc73d (compiled Jul  7 2021, 16:29:22)\r\n",
      "votca_csg, version 2022-dev gitid: 60fc73d (compiled Jul  7 2021, 16:11:42)\r\n",
      "votca_tools, version 2022-dev gitid: 60fc73d (compiled Jul  7 2021, 16:08:43)\r\n",
      "\r\n",
      "Initializing calculator\r\n",
      "... eanalyze\r\n",
      "1 frames in statefile, Ids are: 0 \r\n",
      "Starting at frame 0\r\n",
      "Evaluating frame 0\r\n",
      "Import MD Topology (i.e. frame 0) from state.hdf5\r\n",
      ".... \r\n",
      "... eanalyze\r\n",
      " Using 1 threads\r\n",
      "... ... Short-listed 1000 segments (pattern='*')\r\n",
      "... ... ... NOTE Statistics of site energies and spatial correlations thereof are based on the short-listed segments only. \r\n",
      "... ... ...      Statistics of site-energy differences operate on the full list.\r\n",
      "... ... excited state e\r\n",
      "... ... excited state h\r\n",
      "... ... excited state s\r\n",
      "... ... excited state tChanges have not been written to state file.\r\n"
     ]
    }
   ],
   "source": [
    "!cp \"$VOTCASHARE/xtp/xml/eanalyze.xml\" OPTIONFILES/\n",
    "!xtp_run -e eanalyze -o OPTIONFILES/eanalyze.xml -f state.hdf5"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "You should now see a set of files prefixed with `eanalyze` containing the histrogram and correlation functions."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2021-07-07T16:41:29.991775Z",
     "iopub.status.busy": "2021-07-07T16:41:29.991225Z",
     "iopub.status.idle": "2021-07-07T16:41:30.655930Z",
     "shell.execute_reply": "2021-07-07T16:41:30.656451Z"
    }
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "eanalyze.pairhist_e.out  eanalyze.pairlist_s.out  eanalyze.sitehist_e.out\r\n",
      "eanalyze.pairhist_h.out  eanalyze.pairlist_t.out  eanalyze.sitehist_h.out\r\n",
      "eanalyze.pairhist_s.out  eanalyze.sitecorr_e.out  eanalyze.sitehist_s.out\r\n",
      "eanalyze.pairhist_t.out  eanalyze.sitecorr_h.out  eanalyze.sitehist_t.out\r\n",
      "eanalyze.pairlist_e.out  eanalyze.sitecorr_s.out\r\n",
      "eanalyze.pairlist_h.out  eanalyze.sitecorr_t.out\r\n"
     ]
    }
   ],
   "source": [
    "!ls eanalyze*"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## QM energy calculation\n",
    "Our next task is to perform the qm calculations for each segment that we have stored in the hdf5 file. The calculations take place in 3 stages: write the jobs to a file, perform the computation and finally save the results to the state file. We will first copy the input into our local folder"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2021-07-07T16:41:30.661031Z",
     "iopub.status.busy": "2021-07-07T16:41:30.660453Z",
     "iopub.status.idle": "2021-07-07T16:41:31.343018Z",
     "shell.execute_reply": "2021-07-07T16:41:31.342465Z"
    }
   },
   "outputs": [],
   "source": [
    "!cp \"$VOTCASHARE/xtp/xml/eqm.xml\" OPTIONFILES/"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Now we set the GWBSE mode to `G0W0`,  the `ranges` to `full` and the `basisset` and `auxbasisset` to `3-21G` and `aux-def2-svp`. For more information, check the [eqm calculator options](https://votca.github.io/xtp/eqm.html)."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2021-07-07T16:41:31.349086Z",
     "iopub.status.busy": "2021-07-07T16:41:31.347689Z",
     "iopub.status.idle": "2021-07-07T16:41:31.362176Z",
     "shell.execute_reply": "2021-07-07T16:41:31.361767Z"
    }
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "The option 'gwbse_options.gwbse.ranges' on file 'OPTIONFILES/eqm.xml' has been set to 'full'\n",
      "The option 'gwbse_options.gwbse.mode' on file 'OPTIONFILES/eqm.xml' has been set to 'G0W0'\n",
      "The option 'gwbse_options.gwbse.qp_solver' on file 'OPTIONFILES/eqm.xml' has been set to 'fixedpoint'\n",
      "The option 'gwbse_options.gwbse.qp_grid_steps' on file 'OPTIONFILES/eqm.xml' has been set to '100'\n",
      "The option 'gwbse_options.gwbse.qp_grid_spacing' on file 'OPTIONFILES/eqm.xml' has been set to '0.01'\n",
      "The option 'gwbse_options.gwbse.exctotal' on file 'OPTIONFILES/eqm.xml' has been set to '10'\n",
      "The option 'map_file' on file 'OPTIONFILES/eqm.xml' has been set to 'system.xml'\n",
      "The option 'basisset' on file 'OPTIONFILES/eqm.xml' has been set to '3-21G'\n",
      "The option 'auxbasisset' on file 'OPTIONFILES/eqm.xml' has been set to 'aux-def2-svp'\n"
     ]
    }
   ],
   "source": [
    "edit_calculator(\"eqm\", \"gwbse_options.gwbse.ranges\", \"full\")\n",
    "edit_calculator(\"eqm\", \"gwbse_options.gwbse.mode\", \"G0W0\")\n",
    "edit_calculator(\"eqm\", \"gwbse_options.gwbse.qp_solver\", \"fixedpoint\")\n",
    "edit_calculator(\"eqm\", \"gwbse_options.gwbse.qp_grid_steps\", \"100\")\n",
    "edit_calculator(\"eqm\", \"gwbse_options.gwbse.qp_grid_spacing\", \"0.01\")\n",
    "edit_calculator(\"eqm\", \"gwbse_options.gwbse.exctotal\", \"10\")\n",
    "edit_calculator(\"eqm\", \"map_file\", \"system.xml\")\n",
    "edit_calculator(\"eqm\", \"basisset\", \"3-21G\")\n",
    "edit_calculator(\"eqm\", \"auxbasisset\", \"aux-def2-svp\")"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "For the sake of computational time let just compute the `gw` approximation and the `singlet`. You can also request the `triplet` or `all`,  see the [gwbse sectionfor the eqm calculator](https://www.votca.org/xtp/eqm.html)."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2021-07-07T16:41:31.366227Z",
     "iopub.status.busy": "2021-07-07T16:41:31.365540Z",
     "iopub.status.idle": "2021-07-07T16:41:31.369801Z",
     "shell.execute_reply": "2021-07-07T16:41:31.369242Z"
    }
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "The option 'gwbse_options.gwbse.tasks' on file 'OPTIONFILES/eqm.xml' has been set to 'gw,singlets'\n"
     ]
    }
   ],
   "source": [
    "edit_calculator(\"eqm\", \"gwbse_options.gwbse.tasks\", \"gw,singlets\")"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "First we will write the job in a file and enable only the first 2,"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2021-07-07T16:41:31.375511Z",
     "iopub.status.busy": "2021-07-07T16:41:31.374930Z",
     "iopub.status.idle": "2021-07-07T16:41:35.106717Z",
     "shell.execute_reply": "2021-07-07T16:41:35.106020Z"
    }
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "==================================================\r\n",
      "========   VOTCA (http://www.votca.org)   ========\r\n",
      "==================================================\r\n",
      "\r\n",
      "please submit bugs to https://github.com/votca/xtp/issues\r\n",
      "\r\n",
      "xtp_parallel, version 2022-dev gitid: 60fc73d (compiled Jul  7 2021, 16:29:22)\r\n",
      "votca_csg, version 2022-dev gitid: 60fc73d (compiled Jul  7 2021, 16:11:42)\r\n",
      "votca_tools, version 2022-dev gitid: 60fc73d (compiled Jul  7 2021, 16:08:43)\r\n",
      "\r\n",
      "Initializing calculator\r\n",
      "... eqm\r\n",
      "\r\n",
      "... ... Initialized with 1 threads.\r\n",
      "\r\n",
      "... ... Using 1 openmp threads for 1x1=1 total threads.\r\n",
      "1 frames in statefile, Ids are: 0 \r\n",
      "Starting at frame 0\r\n",
      "Evaluating frame 0\r\n",
      "Import MD Topology (i.e. frame 0) from state.hdf5\r\n",
      ".... \r\n",
      "... eqm \r\n",
      "... ... Writing job file: eqm.jobs with 1000 jobs\r\n",
      "Changes have not been written to state file.\r\n"
     ]
    }
   ],
   "source": [
    "!xtp_parallel -e eqm -o OPTIONFILES/eqm.xml -f state.hdf5 -s 0 -j \"write\"\n",
    "!sed -i \"s/AVAILABLE/COMPLETE/g\" eqm.jobs\n",
    "!sed -i '0,/COMPLETE/s/COMPLETE/AVAILABLE/' eqm.jobs\n",
    "!sed -i '0,/COMPLETE/s/COMPLETE/AVAILABLE/' eqm.jobs\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Now, let run these 2 jobs"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 22,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2021-07-07T16:41:35.113864Z",
     "iopub.status.busy": "2021-07-07T16:41:35.110958Z",
     "iopub.status.idle": "2021-07-07T16:41:44.493548Z",
     "shell.execute_reply": "2021-07-07T16:41:44.492989Z"
    }
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "==================================================\r\n",
      "========   VOTCA (http://www.votca.org)   ========\r\n",
      "==================================================\r\n",
      "\r\n",
      "please submit bugs to https://github.com/votca/xtp/issues\r\n",
      "\r\n",
      "xtp_parallel, version 2022-dev gitid: 60fc73d (compiled Jul  7 2021, 16:29:22)\r\n",
      "votca_csg, version 2022-dev gitid: 60fc73d (compiled Jul  7 2021, 16:11:42)\r\n",
      "votca_tools, version 2022-dev gitid: 60fc73d (compiled Jul  7 2021, 16:08:43)\r\n",
      "\r\n",
      "Initializing calculator\r\n",
      "... eqm\r\n",
      "\r\n",
      "... ... Initialized with 1 threads.\r\n",
      "\r\n",
      "... ... Using 2 openmp threads for 1x2=2 total threads.\r\n",
      "1 frames in statefile, Ids are: 0 \r\n",
      "Starting at frame 0\r\n",
      "Evaluating frame 0\r\n",
      "Import MD Topology (i.e. frame 0) from state.hdf5\r\n",
      ".... \r\n",
      "... eqm \r\n",
      "MST ERR Job file = 'eqm.jobs', cache size =  1\r\n",
      "MST ERR Initialize jobs from eqm.jobs\r\n",
      "MST ERR Registered 1000 jobs.\r\n",
      "T00 ERR ... Requesting next job\r\n",
      "T00 ERR ... Assign jobs from stack\r\n",
      "T00 ERR ... Next job: ID = 0=> [ 0%] \r\n",
      "T00 ERR ... 2021-7-7 16:41:36 Evaluating site 0\r\n",
      "T00 ERR ... Running DFT\r\n",
      "T00 ERR ... Running GWBSE\r\n",
      "T00 ERR ... Running ESPFIT\r\n",
      "T00 ERR ... ===== Running on 2 threads ===== \r\n",
      "T00 ERR ... 2021-7-7 16:41:39 Calculated Densities at Numerical Grid, Number of electrons is -2.98617e-08\r\n",
      "T00 ERR ... 2021-7-7 16:41:39 Calculating ESP at CHELPG grid points\r\n",
      "T00 ERR ... 2021-7-7 16:41:40 Netcharge constrained to 0\r\n",
      "T00 ERR ...  Sum of fitted charges: 5.55112e-17\r\n",
      "T00 ERR ...  RMSE of fit:  0.00115775\r\n",
      "T00 ERR ...  RRMSE of fit: 0.0674742\r\n",
      "T00 ERR ... El Dipole from fitted charges [e*bohr]:\r\n",
      "\t\t dx = +0.4972 dy = -0.5156 dz = +0.4029 |d|^2 = +0.6755\r\n",
      "T00 ERR ... El Dipole from exact qm density [e*bohr]:\r\n",
      "\t\t dx = +0.5081 dy = -0.5279 dz = +0.4124 |d|^2 = +0.7070\r\n",
      "T00 ERR ... Written charges to MP_FILES/frame_0/n2s1/Methane_0_n2s1.mps\r\n",
      "T00 ERR ... 2021-7-7 16:41:40 Finished evaluating site 0\r\n",
      "T00 ERR ... Saving data to molecule_0.orb\r\n",
      "T00 ERR ... Reporting job results\r\n",
      "\r\n",
      "T00 ERR ... Requesting next job\r\n",
      "T00 ERR ... Assign jobs from stack\r\n",
      "T00 ERR ... Next job: ID = 1\r\n",
      "T00 ERR ... 2021-7-7 16:41:40 Evaluating site 1\r\n",
      "T00 ERR ... Running DFT\r\n",
      "T00 ERR ... Running GWBSE\r\n",
      "T00 ERR ... Running ESPFIT\r\n",
      "T00 ERR ... ===== Running on 2 threads ===== \r\n",
      "T00 ERR ... 2021-7-7 16:41:42 Calculated Densities at Numerical Grid, Number of electrons is 2.26321e-08\r\n",
      "T00 ERR ... 2021-7-7 16:41:42 Calculating ESP at CHELPG grid points\r\n",
      "T00 ERR ... 2021-7-7 16:41:44 Netcharge constrained to 0\r\n",
      "T00 ERR ...  Sum of fitted charges: -1.66533e-16\r\n",
      "T00 ERR ...  RMSE of fit:  0.00113805\r\n",
      "T00 ERR ...  RRMSE of fit: 0.0638578\r\n",
      "T00 ERR ... El Dipole from fitted charges [e*bohr]:\r\n",
      "\t\t dx = -0.5616 dy = -0.1876 dz = -0.6117 |d|^2 = +0.7247\r\n",
      "T00 ERR ... El Dipole from exact qm density [e*bohr]:\r\n",
      "\t\t dx = -0.5744 dy = -0.1917 dz = -0.6258 |d|^2 = +0.7584\r\n",
      "T00 ERR ... Written charges to MP_FILES/frame_0/n2s1/Methane_1_n2s1.mps\r\n",
      "T00 ERR ... 2021-7-7 16:41:44 Finished evaluating site 1\r\n",
      "T00 ERR ... Saving data to molecule_1.orb\r\n",
      "T00 ERR ... Reporting job results\r\n",
      "\r\n",
      "T00 ERR ... Requesting next job\r\n",
      "T00 ERR ... Assign jobs from stack\r\n",
      "T00 ERR ... Sync did not yield any new jobs.\r\n",
      "T00 ERR ... Next job: ID = - (none available)\r\n",
      "MST ERR Assign jobs from stack\r\n",
      "Changes have not been written to state file.\r\n"
     ]
    }
   ],
   "source": [
    "!xtp_parallel -e eqm -o OPTIONFILES/eqm.xml -f state.hdf5 -x 2 -s 0 -j run -q 1"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## QM calculation for pairs\n",
    "In the following step we will run QM calculations for each pair in the hdf5 file. As the calculations on the previous step, we will first write the jobs in a file, then run them and finally store the results in the state file. First, we need to copy the input to our local folder"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 23,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2021-07-07T16:41:44.500701Z",
     "iopub.status.busy": "2021-07-07T16:41:44.497299Z",
     "iopub.status.idle": "2021-07-07T16:41:45.154686Z",
     "shell.execute_reply": "2021-07-07T16:41:45.155142Z"
    }
   },
   "outputs": [],
   "source": [
    "!cp \"$VOTCASHARE/xtp/xml/iqm.xml\" OPTIONFILES/"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "As in the previous section, we set the GWBSE mode to `G0W0`, the `ranges` to `full` and the `basisset` and `auxbasisset` to `3-21G` and `aux-def2-svp`. But we compute only the `gw` approximation. We are also going to compute a single excited state. For more information, check the [iqm calculator options](https://www.votca.org/xtp/iqm.html). We also want to compute the `singlet` couplings. "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 24,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2021-07-07T16:41:45.162311Z",
     "iopub.status.busy": "2021-07-07T16:41:45.161699Z",
     "iopub.status.idle": "2021-07-07T16:41:45.181487Z",
     "shell.execute_reply": "2021-07-07T16:41:45.180997Z"
    }
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "The option 'states' on file 'OPTIONFILES/iqm.xml' has been set to '1'\n",
      "The option 'map_file' on file 'OPTIONFILES/iqm.xml' has been set to 'system.xml'\n",
      "The option 'gwbse_options.gwbse.ranges' on file 'OPTIONFILES/iqm.xml' has been set to 'full'\n",
      "The option 'gwbse_options.gwbse.tasks' on file 'OPTIONFILES/iqm.xml' has been set to 'gw'\n",
      "The option 'gwbse_options.gwbse.qp_solver' on file 'OPTIONFILES/iqm.xml' has been set to 'fixedpoint'\n",
      "The option 'gwbse_options.gwbse.qp_grid_steps' on file 'OPTIONFILES/iqm.xml' has been set to '100'\n",
      "The option 'gwbse_options.gwbse.qp_grid_spacing' on file 'OPTIONFILES/iqm.xml' has been set to '0.01'\n",
      "The option 'gwbse_options.gwbse.exctotal' on file 'OPTIONFILES/iqm.xml' has been set to '10'\n",
      "The option 'bsecoupling.spin' on file 'OPTIONFILES/iqm.xml' has been set to 'singlet'\n",
      "The option 'basisset' on file 'OPTIONFILES/iqm.xml' has been set to '3-21G'\n",
      "The option 'auxbasisset' on file 'OPTIONFILES/iqm.xml' has been set to 'aux-def2-svp'\n"
     ]
    }
   ],
   "source": [
    "edit_calculator(\"iqm\", \"states\", \"1\")\n",
    "edit_calculator(\"iqm\", \"map_file\", \"system.xml\")\n",
    "edit_calculator(\"iqm\", \"gwbse_options.gwbse.ranges\", \"full\")\n",
    "edit_calculator(\"iqm\", \"gwbse_options.gwbse.tasks\", \"gw\")\n",
    "edit_calculator(\"iqm\", \"gwbse_options.gwbse.qp_solver\", \"fixedpoint\")\n",
    "edit_calculator(\"iqm\", \"gwbse_options.gwbse.qp_grid_steps\", \"100\")\n",
    "edit_calculator(\"iqm\", \"gwbse_options.gwbse.qp_grid_spacing\", \"0.01\")\n",
    "edit_calculator(\"iqm\", \"gwbse_options.gwbse.exctotal\", \"10\")\n",
    "edit_calculator(\"iqm\", \"bsecoupling.spin\", \"singlet\")\n",
    "edit_calculator(\"iqm\", \"basisset\", \"3-21G\")\n",
    "edit_calculator(\"iqm\", \"auxbasisset\", \"aux-def2-svp\")"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Before running the calculations, we need to specify in the `iqm` input which states to read into the jobfile for each segment type. The following *XML* snippet needs to be added"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 25,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2021-07-07T16:41:45.185499Z",
     "iopub.status.busy": "2021-07-07T16:41:45.184492Z",
     "iopub.status.idle": "2021-07-07T16:41:45.186941Z",
     "shell.execute_reply": "2021-07-07T16:41:45.186371Z"
    }
   },
   "outputs": [],
   "source": [
    "readjobfile = \"\"\"\n",
    "<readjobfile help=\"which states to read into the jobfile for each segment type\">\n",
    "     <singlet>Methane:s1</singlet>\n",
    "     <triplet>Methane:t1</triplet>\n",
    "     <electron>Methane:e1</electron>\n",
    "     <hole>Methane:h1</hole>\n",
    "</readjobfile>\n",
    "\"\"\""
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "The following code add the `readjobfile` section,"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 26,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2021-07-07T16:41:45.191041Z",
     "iopub.status.busy": "2021-07-07T16:41:45.189964Z",
     "iopub.status.idle": "2021-07-07T16:41:45.193349Z",
     "shell.execute_reply": "2021-07-07T16:41:45.192905Z"
    }
   },
   "outputs": [],
   "source": [
    "add_section(\"iqm\", readjobfile)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Now, let's write the jobs to the file"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 27,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2021-07-07T16:41:45.197713Z",
     "iopub.status.busy": "2021-07-07T16:41:45.196991Z",
     "iopub.status.idle": "2021-07-07T16:41:48.240991Z",
     "shell.execute_reply": "2021-07-07T16:41:48.241481Z"
    }
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "==================================================\r\n",
      "========   VOTCA (http://www.votca.org)   ========\r\n",
      "==================================================\r\n",
      "\r\n",
      "please submit bugs to https://github.com/votca/xtp/issues\r\n",
      "\r\n",
      "xtp_parallel, version 2022-dev gitid: 60fc73d (compiled Jul  7 2021, 16:29:22)\r\n",
      "votca_csg, version 2022-dev gitid: 60fc73d (compiled Jul  7 2021, 16:11:42)\r\n",
      "votca_tools, version 2022-dev gitid: 60fc73d (compiled Jul  7 2021, 16:08:43)\r\n",
      "\r\n",
      "Initializing calculator\r\n",
      "... iqm\r\n",
      "\r\n",
      "... ... Initialized with 1 threads.\r\n",
      "\r\n",
      "... ... Using 1 openmp threads for 1x1=1 total threads.\r\n",
      "1 frames in statefile, Ids are: 0 \r\n",
      "Starting at frame 0\r\n",
      "Evaluating frame 0\r\n",
      "Import MD Topology (i.e. frame 0) from state.hdf5\r\n",
      ".... \r\n",
      "... iqm \r\n",
      "... ... Writing job file iqm.jobs\r\n",
      "... ... In total 76140 jobs\r\n",
      "Changes have not been written to state file.\r\n"
     ]
    }
   ],
   "source": [
    "!xtp_parallel -e iqm -o OPTIONFILES/iqm.xml -f state.hdf5 -s 0 -j \"write\""
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "From the jobs that we just write down, let's make available only the first job"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 28,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2021-07-07T16:41:48.248300Z",
     "iopub.status.busy": "2021-07-07T16:41:48.245717Z",
     "iopub.status.idle": "2021-07-07T16:41:49.875143Z",
     "shell.execute_reply": "2021-07-07T16:41:49.874646Z"
    }
   },
   "outputs": [],
   "source": [
    "!sed -i \"s/AVAILABLE/COMPLETE/g\" iqm.jobs\n",
    "!sed -i '0,/COMPLETE/s/COMPLETE/AVAILABLE/' iqm.jobs"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Now we can run and store the jobs results"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 29,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2021-07-07T16:41:49.880713Z",
     "iopub.status.busy": "2021-07-07T16:41:49.880182Z",
     "iopub.status.idle": "2021-07-07T16:42:11.132567Z",
     "shell.execute_reply": "2021-07-07T16:42:11.132071Z"
    }
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "==================================================\r\n",
      "========   VOTCA (http://www.votca.org)   ========\r\n",
      "==================================================\r\n",
      "\r\n",
      "please submit bugs to https://github.com/votca/xtp/issues\r\n",
      "\r\n",
      "xtp_parallel, version 2022-dev gitid: 60fc73d (compiled Jul  7 2021, 16:29:22)\r\n",
      "votca_csg, version 2022-dev gitid: 60fc73d (compiled Jul  7 2021, 16:11:42)\r\n",
      "votca_tools, version 2022-dev gitid: 60fc73d (compiled Jul  7 2021, 16:08:43)\r\n",
      "\r\n",
      "Initializing calculator\r\n",
      "... iqm\r\n",
      "\r\n",
      "... ... Initialized with 1 threads.\r\n",
      "\r\n",
      "... ... Using 2 openmp threads for 1x2=2 total threads.\r\n",
      "1 frames in statefile, Ids are: 0 \r\n",
      "Starting at frame 0\r\n",
      "Evaluating frame 0\r\n",
      "Import MD Topology (i.e. frame 0) from state.hdf5\r\n",
      ".... \r\n",
      "... iqm \r\n",
      "MST ERR Job file = 'iqm.jobs', cache size =  1\r\n",
      "MST ERR Initialize jobs from iqm.jobs\r\n",
      "MST ERR Registered 76140 jobs.\r\n",
      "T00 ERR ... Requesting next job\r\n",
      "T00 ERR ... Assign jobs from stack\r\n",
      "T00 ERR ... Next job: ID = 0=> [ 0%] \r\n",
      "T00 ERR ... 2021-7-7 16:41:59 Evaluating pair 0 [0:1] out of 76140\r\n",
      "T00 ERR ... Guess requested, reading molecular orbitals\r\n",
      "T00 ERR ... Reading MoleculeA from OR_FILES/molecules/frame_0/molecule_0.orb\r\n",
      "T00 ERR ... Reading MoleculeB from OR_FILES/molecules/frame_0/molecule_1.orb\r\n",
      "T00 ERR ... Running DFT\r\n",
      "T00 ERR ... Calculating electronic couplings\r\n",
      "T00 ERR ... ======WARNING=======\r\n",
      " Coordinates of monomer and dimer atoms do not agree\r\n",
      "T00 ERR ... Levels:Basis A[2:17] B[2:17]\r\n",
      "T00 ERR ... Done with electronic couplings\r\n",
      "T00 ERR ... Running GWBSE\r\n",
      "T00 ERR ... Running BSECoupling\r\n",
      "T00 ERR ... 2021-7-7 16:42:1 Finished evaluating pair 0:1\r\n",
      "T00 ERR ... Orb file is not saved according to options \r\n",
      "T00 ERR ... Reporting job results\r\n",
      "\r\n",
      "T00 ERR ... Requesting next job\r\n",
      "T00 ERR ... Assign jobs from stack\r\n",
      "T00 ERR ... Sync did not yield any new jobs.\r\n",
      "T00 ERR ... Next job: ID = - (none available)\r\n",
      "MST ERR Assign jobs from stack\r\n",
      "Changes have not been written to state file.\r\n"
     ]
    }
   ],
   "source": [
    "!xtp_parallel -e iqm -o OPTIONFILES/iqm.xml -f state.hdf5 -x 2 -s 0 -j run -q 1"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Finally, we read the results into the state"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 30,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2021-07-07T16:42:11.139378Z",
     "iopub.status.busy": "2021-07-07T16:42:11.136908Z",
     "iopub.status.idle": "2021-07-07T16:42:15.813871Z",
     "shell.execute_reply": "2021-07-07T16:42:15.813315Z"
    }
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "==================================================\r\n",
      "========   VOTCA (http://www.votca.org)   ========\r\n",
      "==================================================\r\n",
      "\r\n",
      "please submit bugs to https://github.com/votca/xtp/issues\r\n",
      "\r\n",
      "xtp_parallel, version 2022-dev gitid: 60fc73d (compiled Jul  7 2021, 16:29:22)\r\n",
      "votca_csg, version 2022-dev gitid: 60fc73d (compiled Jul  7 2021, 16:11:42)\r\n",
      "votca_tools, version 2022-dev gitid: 60fc73d (compiled Jul  7 2021, 16:08:43)\r\n",
      "\r\n",
      "Initializing calculator\r\n",
      "... iqm\r\n",
      "\r\n",
      "... ... Initialized with 1 threads.\r\n",
      "\r\n",
      "... ... Using 1 openmp threads for 1x1=1 total threads.\r\n",
      "1 frames in statefile, Ids are: 0 \r\n",
      "Starting at frame 0\r\n",
      "Evaluating frame 0\r\n",
      "Import MD Topology (i.e. frame 0) from state.hdf5\r\n",
      ".... \r\n",
      "... iqm \r\n",
      " ERROR    Pairs [total:updated(e,h,s,t)] 76140:(1,1,1,0) Incomplete jobs: 76139\r\n",
      "\r\n",
      "Wrote MD topology (step = 0, time = 0) to state.hdf5\r\n",
      "... . \r\n"
     ]
    }
   ],
   "source": [
    "!xtp_parallel -e iqm -o OPTIONFILES/iqm.xml -f state.hdf5 -j \"read\""
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Coupling\n",
    "We can now compute the classical coupling of transition in the aformentioned three stages,"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 31,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2021-07-07T16:42:15.820268Z",
     "iopub.status.busy": "2021-07-07T16:42:15.817783Z",
     "iopub.status.idle": "2021-07-07T16:42:16.478656Z",
     "shell.execute_reply": "2021-07-07T16:42:16.478092Z"
    }
   },
   "outputs": [],
   "source": [
    "!cp \"${VOTCASHARE}/xtp/xml/iexcitoncl.xml\" OPTIONFILES"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "We need to change in the `iexcitoncl` input the name `map_file` option and add the state. check all the available of the [iexcitoncl calculator](https://www.votca.org/xtp/iexcitoncl.html)."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 32,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2021-07-07T16:42:16.483641Z",
     "iopub.status.busy": "2021-07-07T16:42:16.482417Z",
     "iopub.status.idle": "2021-07-07T16:42:16.487608Z",
     "shell.execute_reply": "2021-07-07T16:42:16.487221Z"
    }
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "The option 'map_file' on file 'OPTIONFILES/iexcitoncl.xml' has been set to 'system.xml'\n"
     ]
    }
   ],
   "source": [
    "edit_calculator(\"iexcitoncl\", \"map_file\", \"system.xml\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 33,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2021-07-07T16:42:16.491781Z",
     "iopub.status.busy": "2021-07-07T16:42:16.490855Z",
     "iopub.status.idle": "2021-07-07T16:42:16.495112Z",
     "shell.execute_reply": "2021-07-07T16:42:16.494665Z"
    }
   },
   "outputs": [],
   "source": [
    "state = \"<states>Methane:n2s1</states>\"\n",
    "add_section(\"iexcitoncl\", state)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 34,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2021-07-07T16:42:16.501513Z",
     "iopub.status.busy": "2021-07-07T16:42:16.500957Z",
     "iopub.status.idle": "2021-07-07T16:42:18.159396Z",
     "shell.execute_reply": "2021-07-07T16:42:18.158871Z"
    }
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "==================================================\r\n",
      "========   VOTCA (http://www.votca.org)   ========\r\n",
      "==================================================\r\n",
      "\r\n",
      "please submit bugs to https://github.com/votca/xtp/issues\r\n",
      "\r\n",
      "xtp_parallel, version 2022-dev gitid: 60fc73d (compiled Jul  7 2021, 16:29:22)\r\n",
      "votca_csg, version 2022-dev gitid: 60fc73d (compiled Jul  7 2021, 16:11:42)\r\n",
      "votca_tools, version 2022-dev gitid: 60fc73d (compiled Jul  7 2021, 16:08:43)\r\n",
      "\r\n",
      "Initializing calculator\r\n",
      "... iexcitoncl\r\n",
      "\r\n",
      "... ... Initialized with 1 threads.\r\n",
      "\r\n",
      "... ... Using 1 openmp threads for 1x1=1 total threads.\r\n",
      "1 frames in statefile, Ids are: 0 \r\n",
      "Starting at frame 0\r\n",
      "Evaluating frame 0\r\n",
      "Import MD Topology (i.e. frame 0) from state.hdf5\r\n",
      ".... \r\n",
      "... iexcitoncl \r\n",
      "... ... Writing job file exciton.jobs\r\n",
      "... ... In total 0 jobs\r\n",
      "Changes have not been written to state file.\r\n"
     ]
    }
   ],
   "source": [
    "!xtp_parallel -e iexcitoncl -o OPTIONFILES/iexcitoncl.xml -f state.hdf5 -j \"write\""
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 35,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2021-07-07T16:42:18.166581Z",
     "iopub.status.busy": "2021-07-07T16:42:18.163527Z",
     "iopub.status.idle": "2021-07-07T16:42:18.831337Z",
     "shell.execute_reply": "2021-07-07T16:42:18.831864Z"
    }
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      " MD_FILES\t\t   eanalyze.pairlist_s.out   iqm.jobs~\r\n",
      " MMMM\t\t\t   eanalyze.pairlist_t.out  'md_segments step__0.pdb'\r\n",
      " MP_FILES\t\t   eanalyze.sitecorr_e.out  'mp_segments_e step__0.pdb'\r\n",
      " OPTIONFILES\t\t   eanalyze.sitecorr_h.out  'mp_segments_h step__0.pdb'\r\n",
      " OR_FILES\t\t   eanalyze.sitecorr_s.out  'qm_segments_n step__0.pdb'\r\n",
      " QC_FILES\t\t   eanalyze.sitecorr_t.out   qmmm.xml\r\n",
      " QMMM_GROMACS.ipynb\t   eanalyze.sitehist_e.out   qmmm_mm.xml\r\n",
      " __pycache__\t\t   eanalyze.sitehist_h.out   qmmm_mm_jobs.xml\r\n",
      " eanalyze.pairhist_e.out   eanalyze.sitehist_s.out   qmmm_mm_jobs.xml~\r\n",
      " eanalyze.pairhist_h.out   eanalyze.sitehist_t.out   state.hdf5\r\n",
      " eanalyze.pairhist_s.out   eqm.jobs\t\t     system.xml\r\n",
      " eanalyze.pairhist_t.out   eqm.jobs~\t\t     xml_editor.py\r\n",
      " eanalyze.pairlist_e.out   exciton.jobs\r\n",
      " eanalyze.pairlist_h.out   iqm.jobs\r\n"
     ]
    }
   ],
   "source": [
    "!ls\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Now we can run and save the jobs. For demo purposes we will run only the first job"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 36,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2021-07-07T16:42:18.840754Z",
     "iopub.status.busy": "2021-07-07T16:42:18.837920Z",
     "iopub.status.idle": "2021-07-07T16:42:21.912599Z",
     "shell.execute_reply": "2021-07-07T16:42:21.912156Z"
    }
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "==================================================\r\n",
      "========   VOTCA (http://www.votca.org)   ========\r\n",
      "==================================================\r\n",
      "\r\n",
      "please submit bugs to https://github.com/votca/xtp/issues\r\n",
      "\r\n",
      "xtp_parallel, version 2022-dev gitid: 60fc73d (compiled Jul  7 2021, 16:29:22)\r\n",
      "votca_csg, version 2022-dev gitid: 60fc73d (compiled Jul  7 2021, 16:11:42)\r\n",
      "votca_tools, version 2022-dev gitid: 60fc73d (compiled Jul  7 2021, 16:08:43)\r\n",
      "\r\n",
      "Initializing calculator\r\n",
      "... iexcitoncl\r\n",
      "\r\n",
      "... ... Initialized with 1 threads.\r\n",
      "\r\n",
      "... ... Using 1 openmp threads for 1x1=1 total threads.\r\n",
      "1 frames in statefile, Ids are: 0 \r\n",
      "Starting at frame 0\r\n",
      "Evaluating frame 0\r\n",
      "Import MD Topology (i.e. frame 0) from state.hdf5\r\n",
      ".... \r\n",
      "... iexcitoncl \r\n",
      "MST ERR Job file = 'exciton.jobs', cache size =  8\r\n",
      "MST ERR Initialize jobs from exciton.jobs\r\n",
      "MST ERR Registered 0 jobs.\r\n",
      "T00 ERR ... Requesting next job\r\n",
      "T00 ERR ... Next job: ID = - (none available)\r\n",
      "MST ERR Assign jobs from stack\r\n",
      "Changes have not been written to state file.\r\n"
     ]
    }
   ],
   "source": [
    "!sed -i \"s/AVAILABLE/COMPLETE/g\" exciton.jobs\n",
    "!sed -i '0,/COMPLETE/s/COMPLETE/AVAILABLE/' exciton.jobs\n",
    "!xtp_parallel -e iexcitoncl -o OPTIONFILES/iexcitoncl.xml -f state.hdf5"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 37,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2021-07-07T16:42:21.916707Z",
     "iopub.status.busy": "2021-07-07T16:42:21.916202Z",
     "iopub.status.idle": "2021-07-07T16:42:21.919968Z",
     "shell.execute_reply": "2021-07-07T16:42:21.919466Z"
    }
   },
   "outputs": [],
   "source": [
    "#!xtp_parallel -e iexcitoncl -o OPTIONFILES/iexcitoncl.xml -f state.hdf5 -j \"read\""
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Coupling analysis\n",
    "Using the coupling computed in the previous steps, we will generate an histogram for the squared couplings in logarithmic scale,"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 38,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2021-07-07T16:42:21.927316Z",
     "iopub.status.busy": "2021-07-07T16:42:21.926732Z",
     "iopub.status.idle": "2021-07-07T16:42:24.313887Z",
     "shell.execute_reply": "2021-07-07T16:42:24.314732Z"
    }
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "The option 'states' on file 'OPTIONFILES/ianalyze.xml' has been set to 'e,h,s'\n",
      "==================================================\r\n",
      "========   VOTCA (http://www.votca.org)   ========\r\n",
      "==================================================\r\n",
      "\r\n",
      "please submit bugs to https://github.com/votca/xtp/issues\r\n",
      "\r\n",
      "xtp_run, version 2022-dev gitid: 60fc73d (compiled Jul  7 2021, 16:29:22)\r\n",
      "votca_csg, version 2022-dev gitid: 60fc73d (compiled Jul  7 2021, 16:11:42)\r\n",
      "votca_tools, version 2022-dev gitid: 60fc73d (compiled Jul  7 2021, 16:08:43)\r\n",
      "\r\n",
      "Initializing calculator\r\n",
      "... ianalyze\r\n",
      "1 frames in statefile, Ids are: 0 \r\n",
      "Starting at frame 0\r\n",
      "Evaluating frame 0\r\n",
      "Import MD Topology (i.e. frame 0) from state.hdf5\r\n",
      ".... \r\n",
      "... ianalyze\r\n",
      " Using 1 threads\r\n",
      "Calculating for state e now.\r\n",
      "Calculating for state h now.\r\n",
      "Calculating for state s now.\r\n",
      "Changes have not been written to state file.\r\n"
     ]
    }
   ],
   "source": [
    "!cp \"${VOTCASHARE}/xtp/xml/ianalyze.xml\" OPTIONFILES\n",
    "edit_calculator(\"ianalyze\", \"states\", \"e,h,s\")\n",
    "!xtp_run -e ianalyze -o OPTIONFILES/ianalyze.xml -f state.hdf5"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## QMMM calculations"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 39,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2021-07-07T16:42:24.319612Z",
     "iopub.status.busy": "2021-07-07T16:42:24.319157Z",
     "iopub.status.idle": "2021-07-07T16:42:26.808162Z",
     "shell.execute_reply": "2021-07-07T16:42:26.807423Z"
    }
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "==================================================\r\n",
      "========   VOTCA (http://www.votca.org)   ========\r\n",
      "==================================================\r\n",
      "\r\n",
      "please submit bugs to https://github.com/votca/xtp/issues\r\n",
      "\r\n",
      "xtp_parallel, version 2022-dev gitid: 60fc73d (compiled Jul  7 2021, 16:29:22)\r\n",
      "votca_csg, version 2022-dev gitid: 60fc73d (compiled Jul  7 2021, 16:11:42)\r\n",
      "votca_tools, version 2022-dev gitid: 60fc73d (compiled Jul  7 2021, 16:08:43)\r\n",
      "\r\n",
      "Initializing calculator\r\n",
      "... qmmm\r\n",
      "\r\n",
      "... ... Initialized with 1 threads.\r\n",
      "\r\n",
      "... ... Using 1 openmp threads for 1x1=1 total threads.\r\n",
      "1 frames in statefile, Ids are: 0 \r\n",
      "Starting at frame 0\r\n",
      "Evaluating frame 0\r\n",
      "Import MD Topology (i.e. frame 0) from state.hdf5\r\n",
      ".... \r\n",
      "... qmmm \r\n",
      "... ... Writing job file qmmm_jobs.xml\r\n",
      "... ... In total 3001 jobs\r\n",
      "Changes have not been written to state file.\r\n"
     ]
    }
   ],
   "source": [
    "!cp qmmm.xml OPTIONFILES/\n",
    "!xtp_parallel -e qmmm -o OPTIONFILES/qmmm.xml -f state.hdf5 -j \"write\""
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Lets run just the first job"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 40,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2021-07-07T16:42:26.816567Z",
     "iopub.status.busy": "2021-07-07T16:42:26.814233Z",
     "iopub.status.idle": "2021-07-07T16:42:49.403916Z",
     "shell.execute_reply": "2021-07-07T16:42:49.403484Z"
    }
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "==================================================\r\n",
      "========   VOTCA (http://www.votca.org)   ========\r\n",
      "==================================================\r\n",
      "\r\n",
      "please submit bugs to https://github.com/votca/xtp/issues\r\n",
      "\r\n",
      "xtp_parallel, version 2022-dev gitid: 60fc73d (compiled Jul  7 2021, 16:29:22)\r\n",
      "votca_csg, version 2022-dev gitid: 60fc73d (compiled Jul  7 2021, 16:11:42)\r\n",
      "votca_tools, version 2022-dev gitid: 60fc73d (compiled Jul  7 2021, 16:08:43)\r\n",
      "\r\n",
      "Initializing calculator\r\n",
      "... qmmm\r\n",
      "\r\n",
      "... ... Initialized with 1 threads.\r\n",
      "\r\n",
      "... ... Using 2 openmp threads for 1x2=2 total threads.\r\n",
      "1 frames in statefile, Ids are: 0 \r\n",
      "Starting at frame 0\r\n",
      "Evaluating frame 0\r\n",
      "Import MD Topology (i.e. frame 0) from state.hdf5\r\n",
      ".... \r\n",
      "... qmmm \r\n",
      "MST ERR Job file = 'qmmm_jobs.xml', cache size =  8\r\n",
      "MST ERR Initialize jobs from qmmm_jobs.xml\r\n",
      "MST ERR Registered 3000 jobs.\r\n",
      "T00 ERR ... Requesting next job\r\n",
      "T00 ERR ... Assign jobs from stack\r\n",
      "T00 ERR ... Next job: ID = 0=> [ 0%] \r\n",
      "T00 ERR ...  Regions created\r\n",
      "T00 ERR ... Id: 0 type: qm size: 1 charge[e]= 12\r\n",
      "T00 ERR ... Id: 1 type: polar size: 92 charge[e]= -5.09315e-15\r\n",
      "T00 ERR ... Id: 2 type: static size: 178 charge[e]= -9.86711e-15\r\n",
      "T00 ERR ... 2021-7-7 16:42:30 Writing jobtopology to QMMM/frame_0/job_0_Methane_0:n/regions.pdb\r\n",
      "T00 ERR ... 2021-7-7 16:42:30 --Inter Region SCF Iteration 1 of 50\r\n",
      "T00 ERR ... 2021-7-7 16:42:30 Evaluating qm 0\r\n",
      "T00 ERR ... 2021-7-7 16:42:30 Evaluating interaction between qm 0 and polar 1\r\n",
      "T00 ERR ... 2021-7-7 16:42:30 Evaluating interaction between qm 0 and static 2\r\n",
      "T00 ERR ... Running DFT calculation\r\n",
      "T00 ERR ... 2021-7-7 16:42:30 Using 2 threads\r\n",
      "T00 ERR ... 2021-7-7 16:42:30 Using native Eigen implementation, no BLAS overload \r\n",
      "T00 ERR ...  Molecule Coordinates [A] \r\n",
      "T00 ERR ...   C   +30.3000 +1.2704 +5.5205\r\n",
      "T00 ERR ...   H   +31.2392 +1.4802 +6.0301\r\n",
      "T00 ERR ...   H   +30.4910 +0.6554 +4.6433\r\n",
      "T00 ERR ...   H   +29.8500 +2.2100 +5.2100\r\n",
      "T00 ERR ...   H   +29.6200 +0.7500 +6.2000\r\n",
      "T00 ERR ... 2021-7-7 16:42:30 Loaded DFT Basis Set def2-svp with 34 functions\r\n",
      "T00 ERR ... 2021-7-7 16:42:30 Loaded AUX Basis Set aux-def2-svp with 104 functions\r\n",
      "T00 ERR ... 2021-7-7 16:42:30 Total number of electrons: 10\r\n",
      "T00 ERR ... 2021-7-7 16:42:30 Smallest value of AOOverlap matrix is 0.013882\r\n",
      "T00 ERR ... 2021-7-7 16:42:30 Removed 0 basisfunction from inverse overlap matrix\r\n",
      "T00 ERR ... 2021-7-7 16:42:30 Convergence Options:\r\n",
      "T00 ERR ... \t\t Delta E [Ha]: 1e-07\r\n",
      "T00 ERR ... \t\t DIIS max error: 1e-07\r\n",
      "T00 ERR ... \t\t DIIS histlength: 20\r\n",
      "T00 ERR ... \t\t ADIIS start: 0.8\r\n",
      "T00 ERR ... \t\t DIIS start: 0.002\r\n",
      "T00 ERR ... \t\t Deleting oldest element from DIIS hist\r\n",
      "T00 ERR ... \t\t Levelshift[Ha]: 0\r\n",
      "T00 ERR ... \t\t Levelshift end: 0.2\r\n",
      "T00 ERR ... \t\t Mixing Parameter alpha: 0.7\r\n",
      "T00 ERR ... 2021-7-7 16:42:31 Setup invariant parts of Electron Repulsion integrals \r\n",
      "T00 ERR ... 2021-7-7 16:42:31 Constructed independent particle hamiltonian \r\n",
      "T00 ERR ... 2021-7-7 16:42:31 Nuclear Repulsion Energy is 13.4434088\r\n",
      "T00 ERR ... 2021-7-7 16:42:31 Using hybrid functional with alpha=0.25\r\n",
      "T00 ERR ... 2021-7-7 16:42:31 Setup numerical integration grid medium for vxc functional XC_HYB_GGA_XC_PBEH\r\n",
      "T00 ERR ... 2021-7-7 16:42:31 Setup Initial Guess using: atom\r\n",
      "T00 ERR ... 2021-7-7 16:42:31 Calculating atom density for C\r\n",
      "T00 ERR ... 2021-7-7 16:42:32 Calculating atom density for H\r\n",
      "T00 ERR ... 2021-7-7 16:42:32 STARTING SCF cycle\r\n",
      "T00 ERR ...  --------------------------------------------------------------------------\r\n",
      "T00 ERR ... \r\n",
      "T00 ERR ... 2021-7-7 16:42:32 Iteration 1 of 100\r\n",
      "T00 ERR ... 2021-7-7 16:42:32 Total Energy -40.3175266147\r\n",
      "T00 ERR ... 2021-7-7 16:42:32 DIIs error 0.224238142655\r\n",
      "T00 ERR ... 2021-7-7 16:42:32 Delta Etot 0\r\n",
      "T00 ERR ... \r\n",
      "T00 ERR ... 2021-7-7 16:42:32 Iteration 2 of 100\r\n",
      "T00 ERR ... 2021-7-7 16:42:32 Total Energy -40.3646246494\r\n",
      "T00 ERR ... 2021-7-7 16:42:32 DIIs error 0.133949212263\r\n",
      "T00 ERR ... 2021-7-7 16:42:32 Delta Etot -0.0470980347028\r\n",
      "T00 ERR ... \r\n",
      "T00 ERR ... 2021-7-7 16:42:32 Iteration 3 of 100\r\n",
      "T00 ERR ... 2021-7-7 16:42:32 Total Energy -40.3861419652\r\n",
      "T00 ERR ... 2021-7-7 16:42:32 DIIs error 0.083885259682\r\n",
      "T00 ERR ... 2021-7-7 16:42:32 Delta Etot -0.0215173157917\r\n",
      "T00 ERR ... \r\n",
      "T00 ERR ... 2021-7-7 16:42:32 Iteration 4 of 100\r\n",
      "T00 ERR ... 2021-7-7 16:42:33 Total Energy -40.4270638078\r\n",
      "T00 ERR ... 2021-7-7 16:42:33 DIIs error 0.0278301961309\r\n",
      "T00 ERR ... 2021-7-7 16:42:33 Delta Etot -0.0409218426033\r\n",
      "T00 ERR ... \r\n",
      "T00 ERR ... 2021-7-7 16:42:33 Iteration 5 of 100\r\n",
      "T00 ERR ... 2021-7-7 16:42:33 Total Energy -40.4267021802\r\n",
      "T00 ERR ... 2021-7-7 16:42:33 DIIs error 0.0303659025127\r\n",
      "T00 ERR ... 2021-7-7 16:42:33 Delta Etot 0.00036162757263\r\n",
      "T00 ERR ... \r\n",
      "T00 ERR ... 2021-7-7 16:42:33 Iteration 6 of 100\r\n",
      "T00 ERR ... 2021-7-7 16:42:33 Total Energy -40.4297536212\r\n",
      "T00 ERR ... 2021-7-7 16:42:33 DIIs error 0.000897437785984\r\n",
      "T00 ERR ... 2021-7-7 16:42:33 Delta Etot -0.00305144098555\r\n",
      "T00 ERR ... \r\n",
      "T00 ERR ... 2021-7-7 16:42:33 Iteration 7 of 100\r\n",
      "T00 ERR ... 2021-7-7 16:42:33 Total Energy -40.4297563742\r\n",
      "T00 ERR ... 2021-7-7 16:42:33 DIIs error 4.04107900599e-05\r\n",
      "T00 ERR ... 2021-7-7 16:42:33 Delta Etot -2.75302277686e-06\r\n",
      "T00 ERR ... \r\n",
      "T00 ERR ... 2021-7-7 16:42:33 Iteration 8 of 100\r\n",
      "T00 ERR ... 2021-7-7 16:42:33 Total Energy -40.4297563834\r\n",
      "T00 ERR ... 2021-7-7 16:42:33 DIIs error 8.23131970754e-06\r\n",
      "T00 ERR ... 2021-7-7 16:42:33 Delta Etot -9.1893497256e-09\r\n",
      "T00 ERR ... \r\n",
      "T00 ERR ... 2021-7-7 16:42:33 Iteration 9 of 100\r\n",
      "T00 ERR ... 2021-7-7 16:42:33 Total Energy -40.4297563835\r\n",
      "T00 ERR ... 2021-7-7 16:42:33 DIIs error 4.08253482139e-06\r\n",
      "T00 ERR ... 2021-7-7 16:42:33 Delta Etot -3.43618467014e-11\r\n",
      "T00 ERR ... \r\n",
      "T00 ERR ... 2021-7-7 16:42:33 Iteration 10 of 100\r\n",
      "T00 ERR ... 2021-7-7 16:42:33 Total Energy -40.4297563835\r\n",
      "T00 ERR ... 2021-7-7 16:42:33 DIIs error 6.38744322323e-07\r\n",
      "T00 ERR ... 2021-7-7 16:42:33 Delta Etot -6.7835514983e-11\r\n",
      "T00 ERR ... \r\n",
      "T00 ERR ... 2021-7-7 16:42:33 Iteration 11 of 100\r\n",
      "T00 ERR ... 2021-7-7 16:42:33 Total Energy -40.4297563835\r\n",
      "T00 ERR ... 2021-7-7 16:42:33 DIIs error 1.33562411065e-07\r\n",
      "T00 ERR ... 2021-7-7 16:42:33 Delta Etot -1.79767312147e-12\r\n",
      "T00 ERR ... \r\n",
      "T00 ERR ... 2021-7-7 16:42:33 Iteration 12 of 100\r\n",
      "T00 ERR ... 2021-7-7 16:42:34 Total Energy -40.4297563835\r\n",
      "T00 ERR ... 2021-7-7 16:42:34 DIIs error 1.42058457629e-08\r\n",
      "T00 ERR ... 2021-7-7 16:42:34 Delta Etot 1.42108547152e-14\r\n",
      "T00 ERR ... 2021-7-7 16:42:34 Total Energy has converged to 1.42108547e-14[Ha] after 12 iterations. DIIS error is converged up to 1.42058458e-08\r\n",
      "T00 ERR ... 2021-7-7 16:42:34 Final Single Point Energy -40.4297563835 Ha\r\n",
      "T00 ERR ... 2021-7-7 16:42:34 Final Local Exc contribution -5.19306055877 Ha\r\n",
      "T00 ERR ... 2021-7-7 16:42:34 Final Non Local Ex contribution -1.64329348955 Ha\r\n",
      "T00 ERR ...   Orbital energies: \r\n",
      "T00 ERR ...   index occupation energy(Hartree) \r\n",
      "T00 ERR ...      0      2   -10.2165825580\r\n",
      "T00 ERR ...      1      2   -0.7051538099\r\n",
      "T00 ERR ...      2      2   -0.4018655177\r\n",
      "T00 ERR ...      3      2   -0.4013152488\r\n",
      "T00 ERR ...      4      2   -0.4005290808\r\n",
      "T00 ERR ...      5      0   +0.0869454515\r\n",
      "T00 ERR ...      6      0   +0.1577220452\r\n",
      "T00 ERR ...      7      0   +0.1583754148\r\n",
      "T00 ERR ...      8      0   +0.1586072653\r\n",
      "T00 ERR ...      9      0   +0.4330895464\r\n",
      "T00 ERR ...     10      0   +0.4343457422\r\n",
      "T00 ERR ...     11      0   +0.4353142300\r\n",
      "T00 ERR ...     12      0   +0.6744613199\r\n",
      "T00 ERR ...     13      0   +0.7036149201\r\n",
      "T00 ERR ...     14      0   +0.7050390821\r\n",
      "T00 ERR ...     15      0   +0.7055645853\r\n",
      "T00 ERR ...     16      0   +0.8003683168\r\n",
      "T00 ERR ...     17      0   +1.0999968983\r\n",
      "T00 ERR ...     18      0   +1.1004647832\r\n",
      "T00 ERR ...     19      0   +1.5442530974\r\n",
      "T00 ERR ...     20      0   +1.5467099741\r\n",
      "T00 ERR ...     21      0   +1.5491455648\r\n",
      "T00 ERR ...     22      0   +1.7736313505\r\n",
      "T00 ERR ...     23      0   +1.7786531819\r\n",
      "T00 ERR ...     24      0   +1.7825616834\r\n",
      "T00 ERR ...     25      0   +2.1474447362\r\n",
      "T00 ERR ...     26      0   +2.1539279433\r\n",
      "T00 ERR ...     27      0   +2.1588781249\r\n",
      "T00 ERR ...     28      0   +2.5467729745\r\n",
      "T00 ERR ...     29      0   +2.5472286013\r\n",
      "T00 ERR ...     30      0   +2.6351386507\r\n",
      "T00 ERR ...     31      0   +2.9321712153\r\n",
      "T00 ERR ...     32      0   +2.9387931850\r\n",
      "T00 ERR ...     33      0   +2.9434654773\r\n",
      "T00 ERR ... 2021-7-7 16:42:34 Electric Dipole is[e*bohr]:\r\n",
      "\t\t dx=0.000670950176565\r\n",
      "\t\t dy=0.00319235427258\r\n",
      "\t\t dz=-0.0010540451651\r\n",
      "T00 ERR ... Writing result to votca.orb\r\n",
      "T00 ERR ... 2021-7-7 16:42:34 DFT calculation took 3.100892722 seconds.\r\n",
      "T00 ERR ... QM energy[Hrt]: -40.42975638 \r\n",
      "T00 ERR ... 2021-7-7 16:42:34 Evaluating polar 1\r\n",
      "T00 ERR ... 2021-7-7 16:42:34 Evaluating interaction between polar 1 and qm 0\r\n",
      "T00 ERR ... 2021-7-7 16:42:34 Evaluating interaction between polar 1 and static 2\r\n",
      "T00 ERR ... 2021-7-7 16:42:34 Starting Solving for classical polarization with 1380 degrees of freedom.\r\n",
      "T00 ERR ... 2021-7-7 16:42:34 CG: #iterations: 7, estimated error: 5.51846081349e-06\r\n",
      "T00 ERR ...   Total static energy [hrt]= 0.0009102654542\r\n",
      "T00 ERR ...   Total polar energy [hrt]= -0.0006231010355\r\n",
      "T00 ERR ...  Total energy [hrt]= 0.0002871644187\r\n",
      "T00 ERR ... 2021-7-7 16:42:34 Evaluating static 2\r\n",
      "T00 ERR ... 2021-7-7 16:42:34 Writing checkpoint to checkpoint_iter_1.hdf5\r\n",
      "T00 ERR ...  Region:qm 0 is not converged deltaE=-40.42975638 RMS Dmat=0.08135717715 MaxDmat=2.078140844\r\n",
      "T00 ERR ... 2021-7-7 16:42:34 Region:polar 1 is not converged deltaE=0.0002871644187\r\n",
      "T00 ERR ... 2021-7-7 16:42:34 --Total Energy all regions -40.42946922\r\n",
      "T00 ERR ... 2021-7-7 16:42:34 --Inter Region SCF Iteration 2 of 50\r\n",
      "T00 ERR ... 2021-7-7 16:42:34 Evaluating qm 0\r\n",
      "T00 ERR ... 2021-7-7 16:42:34 Evaluating interaction between qm 0 and polar 1\r\n",
      "T00 ERR ... 2021-7-7 16:42:34 Evaluating interaction between qm 0 and static 2\r\n",
      "T00 ERR ... Running DFT calculation\r\n",
      "T00 ERR ... 2021-7-7 16:42:34 Using 2 threads\r\n",
      "T00 ERR ... 2021-7-7 16:42:34 Using native Eigen implementation, no BLAS overload \r\n",
      "T00 ERR ...  Molecule Coordinates [A] \r\n",
      "T00 ERR ...   C   +30.3000 +1.2704 +5.5205\r\n",
      "T00 ERR ...   H   +31.2392 +1.4802 +6.0301\r\n",
      "T00 ERR ...   H   +30.4910 +0.6554 +4.6433\r\n",
      "T00 ERR ...   H   +29.8500 +2.2100 +5.2100\r\n",
      "T00 ERR ...   H   +29.6200 +0.7500 +6.2000\r\n",
      "T00 ERR ... 2021-7-7 16:42:34 Loaded DFT Basis Set def2-svp with 34 functions\r\n",
      "T00 ERR ... 2021-7-7 16:42:34 Loaded AUX Basis Set aux-def2-svp with 104 functions\r\n",
      "T00 ERR ... 2021-7-7 16:42:34 Total number of electrons: 10\r\n",
      "T00 ERR ... 2021-7-7 16:42:34 Smallest value of AOOverlap matrix is 0.01388201597\r\n",
      "T00 ERR ... 2021-7-7 16:42:34 Removed 0 basisfunction from inverse overlap matrix\r\n",
      "T00 ERR ... 2021-7-7 16:42:34 Convergence Options:\r\n",
      "T00 ERR ... \t\t Delta E [Ha]: 1e-07\r\n",
      "T00 ERR ... \t\t DIIS max error: 1e-07\r\n",
      "T00 ERR ... \t\t DIIS histlength: 20\r\n",
      "T00 ERR ... \t\t ADIIS start: 0.8\r\n",
      "T00 ERR ... \t\t DIIS start: 0.002\r\n",
      "T00 ERR ... \t\t Deleting oldest element from DIIS hist\r\n",
      "T00 ERR ... \t\t Levelshift[Ha]: 0\r\n",
      "T00 ERR ... \t\t Levelshift end: 0.2\r\n",
      "T00 ERR ... \t\t Mixing Parameter alpha: 0.7\r\n",
      "T00 ERR ... 2021-7-7 16:42:34 Setup invariant parts of Electron Repulsion integrals \r\n",
      "T00 ERR ... 2021-7-7 16:42:34 Constructed independent particle hamiltonian \r\n",
      "T00 ERR ... 2021-7-7 16:42:34 Nuclear Repulsion Energy is 13.4434088\r\n",
      "T00 ERR ... 2021-7-7 16:42:34 Using hybrid functional with alpha=0.25\r\n",
      "T00 ERR ... 2021-7-7 16:42:34 Setup numerical integration grid medium for vxc functional XC_HYB_GGA_XC_PBEH\r\n",
      "T00 ERR ... 2021-7-7 16:42:34 Setup Initial Guess using: atom\r\n",
      "T00 ERR ... 2021-7-7 16:42:34 Calculating atom density for C\r\n",
      "T00 ERR ... 2021-7-7 16:42:36 Calculating atom density for H\r\n",
      "T00 ERR ... 2021-7-7 16:42:36 STARTING SCF cycle\r\n",
      "T00 ERR ...  --------------------------------------------------------------------------\r\n",
      "T00 ERR ... \r\n",
      "T00 ERR ... 2021-7-7 16:42:36 Iteration 1 of 100\r\n",
      "T00 ERR ... 2021-7-7 16:42:36 Total Energy -40.3175266147\r\n",
      "T00 ERR ... 2021-7-7 16:42:36 DIIs error 0.224238142655\r\n",
      "T00 ERR ... 2021-7-7 16:42:36 Delta Etot 0\r\n",
      "T00 ERR ... \r\n",
      "T00 ERR ... 2021-7-7 16:42:36 Iteration 2 of 100\r\n",
      "T00 ERR ... 2021-7-7 16:42:36 Total Energy -40.3646246494\r\n",
      "T00 ERR ... 2021-7-7 16:42:36 DIIs error 0.133949212263\r\n",
      "T00 ERR ... 2021-7-7 16:42:36 Delta Etot -0.0470980347027\r\n",
      "T00 ERR ... \r\n",
      "T00 ERR ... 2021-7-7 16:42:36 Iteration 3 of 100\r\n",
      "T00 ERR ... 2021-7-7 16:42:36 Total Energy -40.3861419652\r\n",
      "T00 ERR ... 2021-7-7 16:42:36 DIIs error 0.083885259682\r\n",
      "T00 ERR ... 2021-7-7 16:42:36 Delta Etot -0.0215173157916\r\n",
      "T00 ERR ... \r\n",
      "T00 ERR ... 2021-7-7 16:42:36 Iteration 4 of 100\r\n",
      "T00 ERR ... 2021-7-7 16:42:36 Total Energy -40.4270638078\r\n",
      "T00 ERR ... 2021-7-7 16:42:36 DIIs error 0.0278301961309\r\n",
      "T00 ERR ... 2021-7-7 16:42:36 Delta Etot -0.0409218426033\r\n",
      "T00 ERR ... \r\n",
      "T00 ERR ... 2021-7-7 16:42:36 Iteration 5 of 100\r\n",
      "T00 ERR ... 2021-7-7 16:42:37 Total Energy -40.4267021802\r\n",
      "T00 ERR ... 2021-7-7 16:42:37 DIIs error 0.0303659025127\r\n",
      "T00 ERR ... 2021-7-7 16:42:37 Delta Etot 0.000361627572666\r\n",
      "T00 ERR ... \r\n",
      "T00 ERR ... 2021-7-7 16:42:37 Iteration 6 of 100\r\n",
      "T00 ERR ... 2021-7-7 16:42:37 Total Energy -40.4297536212\r\n",
      "T00 ERR ... 2021-7-7 16:42:37 DIIs error 0.000897437786056\r\n",
      "T00 ERR ... 2021-7-7 16:42:37 Delta Etot -0.00305144098555\r\n",
      "T00 ERR ... \r\n",
      "T00 ERR ... 2021-7-7 16:42:37 Iteration 7 of 100\r\n",
      "T00 ERR ... 2021-7-7 16:42:37 Total Energy -40.4297563742\r\n",
      "T00 ERR ... 2021-7-7 16:42:37 DIIs error 4.04107900598e-05\r\n",
      "T00 ERR ... 2021-7-7 16:42:37 Delta Etot -2.75302278396e-06\r\n",
      "T00 ERR ... \r\n",
      "T00 ERR ... 2021-7-7 16:42:37 Iteration 8 of 100\r\n",
      "T00 ERR ... 2021-7-7 16:42:37 Total Energy -40.4297563834\r\n",
      "T00 ERR ... 2021-7-7 16:42:37 DIIs error 8.23131970465e-06\r\n",
      "T00 ERR ... 2021-7-7 16:42:37 Delta Etot -9.1893497256e-09\r\n",
      "T00 ERR ... \r\n",
      "T00 ERR ... 2021-7-7 16:42:37 Iteration 9 of 100\r\n",
      "T00 ERR ... 2021-7-7 16:42:37 Total Energy -40.4297563835\r\n",
      "T00 ERR ... 2021-7-7 16:42:37 DIIs error 4.08253481868e-06\r\n",
      "T00 ERR ... 2021-7-7 16:42:37 Delta Etot -3.44329009749e-11\r\n",
      "T00 ERR ... \r\n",
      "T00 ERR ... 2021-7-7 16:42:37 Iteration 10 of 100\r\n",
      "T00 ERR ... 2021-7-7 16:42:37 Total Energy -40.4297563835\r\n",
      "T00 ERR ... 2021-7-7 16:42:37 DIIs error 6.3874432087e-07\r\n",
      "T00 ERR ... 2021-7-7 16:42:37 Delta Etot -6.77715661368e-11\r\n",
      "T00 ERR ... \r\n",
      "T00 ERR ... 2021-7-7 16:42:37 Iteration 11 of 100\r\n",
      "T00 ERR ... 2021-7-7 16:42:37 Total Energy -40.4297563835\r\n",
      "T00 ERR ... 2021-7-7 16:42:37 DIIs error 1.33562402914e-07\r\n",
      "T00 ERR ... 2021-7-7 16:42:37 Delta Etot -1.81188397619e-12\r\n",
      "T00 ERR ... \r\n",
      "T00 ERR ... 2021-7-7 16:42:37 Iteration 12 of 100\r\n",
      "T00 ERR ... 2021-7-7 16:42:38 Total Energy -40.4297563835\r\n",
      "T00 ERR ... 2021-7-7 16:42:38 DIIs error 1.42058342427e-08\r\n",
      "T00 ERR ... 2021-7-7 16:42:38 Delta Etot 4.97379915032e-14\r\n",
      "T00 ERR ... 2021-7-7 16:42:38 Total Energy has converged to 4.97379915e-14[Ha] after 12 iterations. DIIS error is converged up to 1.42058342e-08\r\n",
      "T00 ERR ... 2021-7-7 16:42:38 Final Single Point Energy -40.4297563835 Ha\r\n",
      "T00 ERR ... 2021-7-7 16:42:38 Final Local Exc contribution -5.19306055877 Ha\r\n",
      "T00 ERR ... 2021-7-7 16:42:38 Final Non Local Ex contribution -1.64329348955 Ha\r\n",
      "T00 ERR ...   Orbital energies: \r\n",
      "T00 ERR ...   index occupation energy(Hartree) \r\n",
      "T00 ERR ...      0      2   -10.2165825580\r\n",
      "T00 ERR ...      1      2   -0.7051538099\r\n",
      "T00 ERR ...      2      2   -0.4018655177\r\n",
      "T00 ERR ...      3      2   -0.4013152488\r\n",
      "T00 ERR ...      4      2   -0.4005290808\r\n",
      "T00 ERR ...      5      0   +0.0869454515\r\n",
      "T00 ERR ...      6      0   +0.1577220452\r\n",
      "T00 ERR ...      7      0   +0.1583754148\r\n",
      "T00 ERR ...      8      0   +0.1586072653\r\n",
      "T00 ERR ...      9      0   +0.4330895464\r\n",
      "T00 ERR ...     10      0   +0.4343457422\r\n",
      "T00 ERR ...     11      0   +0.4353142300\r\n",
      "T00 ERR ...     12      0   +0.6744613199\r\n",
      "T00 ERR ...     13      0   +0.7036149201\r\n",
      "T00 ERR ...     14      0   +0.7050390821\r\n",
      "T00 ERR ...     15      0   +0.7055645853\r\n",
      "T00 ERR ...     16      0   +0.8003683168\r\n",
      "T00 ERR ...     17      0   +1.0999968983\r\n",
      "T00 ERR ...     18      0   +1.1004647832\r\n",
      "T00 ERR ...     19      0   +1.5442530974\r\n",
      "T00 ERR ...     20      0   +1.5467099741\r\n",
      "T00 ERR ...     21      0   +1.5491455648\r\n",
      "T00 ERR ...     22      0   +1.7736313505\r\n",
      "T00 ERR ...     23      0   +1.7786531819\r\n",
      "T00 ERR ...     24      0   +1.7825616834\r\n",
      "T00 ERR ...     25      0   +2.1474447362\r\n",
      "T00 ERR ...     26      0   +2.1539279433\r\n",
      "T00 ERR ...     27      0   +2.1588781249\r\n",
      "T00 ERR ...     28      0   +2.5467729745\r\n",
      "T00 ERR ...     29      0   +2.5472286013\r\n",
      "T00 ERR ...     30      0   +2.6351386507\r\n",
      "T00 ERR ...     31      0   +2.9321712153\r\n",
      "T00 ERR ...     32      0   +2.9387931850\r\n",
      "T00 ERR ...     33      0   +2.9434654773\r\n",
      "T00 ERR ... 2021-7-7 16:42:38 Electric Dipole is[e*bohr]:\r\n",
      "\t\t dx=0.000670950176566\r\n",
      "\t\t dy=0.00319235427258\r\n",
      "\t\t dz=-0.0010540451651\r\n",
      "T00 ERR ... Writing result to votca.orb\r\n",
      "T00 ERR ... 2021-7-7 16:42:38 DFT calculation took 3.150536066 seconds.\r\n",
      "T00 ERR ... QM energy[Hrt]: -40.42975638 \r\n",
      "T00 ERR ... 2021-7-7 16:42:38 Evaluating polar 1\r\n",
      "T00 ERR ... 2021-7-7 16:42:38 Evaluating interaction between polar 1 and qm 0\r\n",
      "T00 ERR ... 2021-7-7 16:42:38 Evaluating interaction between polar 1 and static 2\r\n",
      "T00 ERR ... 2021-7-7 16:42:38 Starting Solving for classical polarization with 1380 degrees of freedom.\r\n",
      "T00 ERR ... 2021-7-7 16:42:38 CG: #iterations: 0, estimated error: 5.51846078175e-06\r\n",
      "T00 ERR ...   Total static energy [hrt]= 0.0009102654542\r\n",
      "T00 ERR ...   Total polar energy [hrt]= -0.0006231010355\r\n",
      "T00 ERR ...  Total energy [hrt]= 0.0002871644187\r\n",
      "T00 ERR ... 2021-7-7 16:42:38 Evaluating static 2\r\n",
      "T00 ERR ... 2021-7-7 16:42:38 Writing checkpoint to checkpoint_iter_2.hdf5\r\n",
      "T00 ERR ...  Region:qm 0 is converged deltaE=5.684341886e-14 RMS Dmat=1.915753782e-15 MaxDmat=1.71559815e-14\r\n",
      "T00 ERR ... 2021-7-7 16:42:38 Region:polar 1 is converged deltaE=0\r\n",
      "T00 ERR ... 2021-7-7 16:42:38 --Total Energy all regions -40.42946922\r\n",
      "T00 ERR ... 2021-7-7 16:42:38 Job converged after 2 iterations.\r\n",
      "T00 ERR ... Reporting job results\r\n",
      "\r\n",
      "T00 ERR ... Requesting next job\r\n",
      "T00 ERR ... Next job: ID = 1\r\n",
      "T00 ERR ... Initial state: s1\r\n",
      "T00 ERR ... Using overlap filter with threshold 0.8\r\n",
      "T00 ERR ...  Regions created\r\n",
      "T00 ERR ... Id: 0 type: qm size: 1 charge[e]= 0\r\n",
      "T00 ERR ... Id: 1 type: polar size: 92 charge[e]= -5.093148125e-15\r\n",
      "T00 ERR ... Id: 2 type: static size: 178 charge[e]= -9.867107131e-15\r\n",
      "T00 ERR ... 2021-7-7 16:42:38 Writing jobtopology to QMMM/frame_0/job_1_Methane_0:s1/regions.pdb\r\n",
      "T00 ERR ... 2021-7-7 16:42:38 --Inter Region SCF Iteration 1 of 50\r\n",
      "T00 ERR ... 2021-7-7 16:42:38 Evaluating qm 0\r\n",
      "T00 ERR ... 2021-7-7 16:42:38 Evaluating interaction between qm 0 and polar 1\r\n",
      "T00 ERR ... 2021-7-7 16:42:38 Evaluating interaction between qm 0 and static 2\r\n",
      "T00 ERR ... Running DFT calculation\r\n",
      "T00 ERR ... 2021-7-7 16:42:38 Using 2 threads\r\n",
      "T00 ERR ... 2021-7-7 16:42:38 Using native Eigen implementation, no BLAS overload \r\n",
      "T00 ERR ...  Molecule Coordinates [A] \r\n",
      "T00 ERR ...   C   +30.3000 +1.2704 +5.5205\r\n",
      "T00 ERR ...   H   +31.2392 +1.4802 +6.0301\r\n",
      "T00 ERR ...   H   +30.4910 +0.6554 +4.6433\r\n",
      "T00 ERR ...   H   +29.8500 +2.2100 +5.2100\r\n",
      "T00 ERR ...   H   +29.6200 +0.7500 +6.2000\r\n",
      "T00 ERR ... 2021-7-7 16:42:38 Loaded DFT Basis Set def2-svp with 34 functions\r\n",
      "T00 ERR ... 2021-7-7 16:42:38 Loaded AUX Basis Set aux-def2-svp with 104 functions\r\n",
      "T00 ERR ... 2021-7-7 16:42:38 Total number of electrons: 10\r\n",
      "T00 ERR ... 2021-7-7 16:42:38 Smallest value of AOOverlap matrix is 0.01388201597\r\n",
      "T00 ERR ... 2021-7-7 16:42:38 Removed 0 basisfunction from inverse overlap matrix\r\n",
      "T00 ERR ... 2021-7-7 16:42:38 Convergence Options:\r\n",
      "T00 ERR ... \t\t Delta E [Ha]: 1e-07\r\n",
      "T00 ERR ... \t\t DIIS max error: 1e-07\r\n",
      "T00 ERR ... \t\t DIIS histlength: 20\r\n",
      "T00 ERR ... \t\t ADIIS start: 0.8\r\n",
      "T00 ERR ... \t\t DIIS start: 0.002\r\n",
      "T00 ERR ... \t\t Deleting oldest element from DIIS hist\r\n",
      "T00 ERR ... \t\t Levelshift[Ha]: 0\r\n",
      "T00 ERR ... \t\t Levelshift end: 0.2\r\n",
      "T00 ERR ... \t\t Mixing Parameter alpha: 0.7\r\n",
      "T00 ERR ... 2021-7-7 16:42:38 Setup invariant parts of Electron Repulsion integrals \r\n",
      "T00 ERR ... 2021-7-7 16:42:38 Constructed independent particle hamiltonian \r\n",
      "T00 ERR ... 2021-7-7 16:42:38 Nuclear Repulsion Energy is 13.4434088\r\n",
      "T00 ERR ... 2021-7-7 16:42:38 Using hybrid functional with alpha=0.25\r\n",
      "T00 ERR ... 2021-7-7 16:42:38 Setup numerical integration grid medium for vxc functional XC_HYB_GGA_XC_PBEH\r\n",
      "T00 ERR ... 2021-7-7 16:42:38 Setup Initial Guess using: atom\r\n",
      "T00 ERR ... 2021-7-7 16:42:38 Calculating atom density for C\r\n",
      "T00 ERR ... 2021-7-7 16:42:40 Calculating atom density for H\r\n",
      "T00 ERR ... 2021-7-7 16:42:40 STARTING SCF cycle\r\n",
      "T00 ERR ...  --------------------------------------------------------------------------\r\n",
      "T00 ERR ... \r\n",
      "T00 ERR ... 2021-7-7 16:42:40 Iteration 1 of 100\r\n",
      "T00 ERR ... 2021-7-7 16:42:40 Total Energy -40.3175266147\r\n",
      "T00 ERR ... 2021-7-7 16:42:40 DIIs error 0.224238142655\r\n",
      "T00 ERR ... 2021-7-7 16:42:40 Delta Etot 0\r\n",
      "T00 ERR ... \r\n",
      "T00 ERR ... 2021-7-7 16:42:40 Iteration 2 of 100\r\n",
      "T00 ERR ... 2021-7-7 16:42:40 Total Energy -40.3646246494\r\n",
      "T00 ERR ... 2021-7-7 16:42:40 DIIs error 0.133949212263\r\n",
      "T00 ERR ... 2021-7-7 16:42:40 Delta Etot -0.0470980347028\r\n",
      "T00 ERR ... \r\n",
      "T00 ERR ... 2021-7-7 16:42:40 Iteration 3 of 100\r\n",
      "T00 ERR ... 2021-7-7 16:42:40 Total Energy -40.3861419652\r\n",
      "T00 ERR ... 2021-7-7 16:42:40 DIIs error 0.083885259682\r\n",
      "T00 ERR ... 2021-7-7 16:42:40 Delta Etot -0.0215173157917\r\n",
      "T00 ERR ... \r\n",
      "T00 ERR ... 2021-7-7 16:42:40 Iteration 4 of 100\r\n",
      "T00 ERR ... 2021-7-7 16:42:41 Total Energy -40.4270638078\r\n",
      "T00 ERR ... 2021-7-7 16:42:41 DIIs error 0.0278301961309\r\n",
      "T00 ERR ... 2021-7-7 16:42:41 Delta Etot -0.0409218426033\r\n",
      "T00 ERR ... \r\n",
      "T00 ERR ... 2021-7-7 16:42:41 Iteration 5 of 100\r\n",
      "T00 ERR ... 2021-7-7 16:42:41 Total Energy -40.4267021802\r\n",
      "T00 ERR ... 2021-7-7 16:42:41 DIIs error 0.0303659025127\r\n",
      "T00 ERR ... 2021-7-7 16:42:41 Delta Etot 0.00036162757263\r\n",
      "T00 ERR ... \r\n",
      "T00 ERR ... 2021-7-7 16:42:41 Iteration 6 of 100\r\n",
      "T00 ERR ... 2021-7-7 16:42:41 Total Energy -40.4297536212\r\n",
      "T00 ERR ... 2021-7-7 16:42:41 DIIs error 0.000897437785993\r\n",
      "T00 ERR ... 2021-7-7 16:42:41 Delta Etot -0.00305144098553\r\n",
      "T00 ERR ... \r\n",
      "T00 ERR ... 2021-7-7 16:42:41 Iteration 7 of 100\r\n",
      "T00 ERR ... 2021-7-7 16:42:41 Total Energy -40.4297563742\r\n",
      "T00 ERR ... 2021-7-7 16:42:41 DIIs error 4.04107900604e-05\r\n",
      "T00 ERR ... 2021-7-7 16:42:41 Delta Etot -2.75302281949e-06\r\n",
      "T00 ERR ... \r\n",
      "T00 ERR ... 2021-7-7 16:42:41 Iteration 8 of 100\r\n",
      "T00 ERR ... 2021-7-7 16:42:41 Total Energy -40.4297563834\r\n",
      "T00 ERR ... 2021-7-7 16:42:41 DIIs error 8.23131970843e-06\r\n",
      "T00 ERR ... 2021-7-7 16:42:41 Delta Etot -9.18926446047e-09\r\n",
      "T00 ERR ... \r\n",
      "T00 ERR ... 2021-7-7 16:42:41 Iteration 9 of 100\r\n",
      "T00 ERR ... 2021-7-7 16:42:41 Total Energy -40.4297563835\r\n",
      "T00 ERR ... 2021-7-7 16:42:41 DIIs error 4.08253482307e-06\r\n",
      "T00 ERR ... 2021-7-7 16:42:41 Delta Etot -3.4454217257e-11\r\n",
      "T00 ERR ... \r\n",
      "T00 ERR ... 2021-7-7 16:42:41 Iteration 10 of 100\r\n",
      "T00 ERR ... 2021-7-7 16:42:41 Total Energy -40.4297563835\r\n",
      "T00 ERR ... 2021-7-7 16:42:41 DIIs error 6.38744321807e-07\r\n",
      "T00 ERR ... 2021-7-7 16:42:41 Delta Etot -6.77431444274e-11\r\n",
      "T00 ERR ... \r\n",
      "T00 ERR ... 2021-7-7 16:42:41 Iteration 11 of 100\r\n",
      "T00 ERR ... 2021-7-7 16:42:41 Total Energy -40.4297563835\r\n",
      "T00 ERR ... 2021-7-7 16:42:41 DIIs error 1.33562411075e-07\r\n",
      "T00 ERR ... 2021-7-7 16:42:41 Delta Etot -1.84741111298e-12\r\n",
      "T00 ERR ... \r\n",
      "T00 ERR ... 2021-7-7 16:42:41 Iteration 12 of 100\r\n",
      "T00 ERR ... 2021-7-7 16:42:42 Total Energy -40.4297563835\r\n",
      "T00 ERR ... 2021-7-7 16:42:42 DIIs error 1.42058472045e-08\r\n",
      "T00 ERR ... 2021-7-7 16:42:42 Delta Etot 1.42108547152e-14\r\n",
      "T00 ERR ... 2021-7-7 16:42:42 Total Energy has converged to 1.42108547e-14[Ha] after 12 iterations. DIIS error is converged up to 1.42058472e-08\r\n",
      "T00 ERR ... 2021-7-7 16:42:42 Final Single Point Energy -40.4297563835 Ha\r\n",
      "T00 ERR ... 2021-7-7 16:42:42 Final Local Exc contribution -5.19306055877 Ha\r\n",
      "T00 ERR ... 2021-7-7 16:42:42 Final Non Local Ex contribution -1.64329348955 Ha\r\n",
      "T00 ERR ...   Orbital energies: \r\n",
      "T00 ERR ...   index occupation energy(Hartree) \r\n",
      "T00 ERR ...      0      2   -10.2165825580\r\n",
      "T00 ERR ...      1      2   -0.7051538099\r\n",
      "T00 ERR ...      2      2   -0.4018655177\r\n",
      "T00 ERR ...      3      2   -0.4013152488\r\n",
      "T00 ERR ...      4      2   -0.4005290808\r\n",
      "T00 ERR ...      5      0   +0.0869454515\r\n",
      "T00 ERR ...      6      0   +0.1577220452\r\n",
      "T00 ERR ...      7      0   +0.1583754148\r\n",
      "T00 ERR ...      8      0   +0.1586072653\r\n",
      "T00 ERR ...      9      0   +0.4330895464\r\n",
      "T00 ERR ...     10      0   +0.4343457422\r\n",
      "T00 ERR ...     11      0   +0.4353142300\r\n",
      "T00 ERR ...     12      0   +0.6744613199\r\n",
      "T00 ERR ...     13      0   +0.7036149201\r\n",
      "T00 ERR ...     14      0   +0.7050390821\r\n",
      "T00 ERR ...     15      0   +0.7055645853\r\n",
      "T00 ERR ...     16      0   +0.8003683168\r\n",
      "T00 ERR ...     17      0   +1.0999968983\r\n",
      "T00 ERR ...     18      0   +1.1004647832\r\n",
      "T00 ERR ...     19      0   +1.5442530974\r\n",
      "T00 ERR ...     20      0   +1.5467099741\r\n",
      "T00 ERR ...     21      0   +1.5491455648\r\n",
      "T00 ERR ...     22      0   +1.7736313505\r\n",
      "T00 ERR ...     23      0   +1.7786531819\r\n",
      "T00 ERR ...     24      0   +1.7825616834\r\n",
      "T00 ERR ...     25      0   +2.1474447362\r\n",
      "T00 ERR ...     26      0   +2.1539279433\r\n",
      "T00 ERR ...     27      0   +2.1588781249\r\n",
      "T00 ERR ...     28      0   +2.5467729745\r\n",
      "T00 ERR ...     29      0   +2.5472286013\r\n",
      "T00 ERR ...     30      0   +2.6351386507\r\n",
      "T00 ERR ...     31      0   +2.9321712153\r\n",
      "T00 ERR ...     32      0   +2.9387931850\r\n",
      "T00 ERR ...     33      0   +2.9434654773\r\n",
      "T00 ERR ... 2021-7-7 16:42:42 Electric Dipole is[e*bohr]:\r\n",
      "\t\t dx=0.000670950176561\r\n",
      "\t\t dy=0.00319235427258\r\n",
      "\t\t dz=-0.0010540451651\r\n",
      "T00 ERR ... Writing result to votca.orb\r\n",
      "T00 ERR ... 2021-7-7 16:42:42 DFT calculation took 3.179923111 seconds.\r\n",
      "T00 ERR ... QM energy[Hrt]: -40.42975638 \r\n",
      "T00 ERR ... 2021-7-7 16:42:42 RPA level range [0:33]\r\n",
      "T00 ERR ... 2021-7-7 16:42:42 GW  level range [0:13]\r\n",
      "T00 ERR ... 2021-7-7 16:42:42 BSE level range occ[0:4]  virt[5:13]\r\n",
      "T00 ERR ...  BSE type: full\r\n",
      "T00 ERR ... 2021-7-7 16:42:42 BSE Hamiltonian has size 90x90\r\n",
      "T00 ERR ...  BSE without Hqp offdiagonal elements\r\n",
      "T00 ERR ...  Running GW as: evGW\r\n",
      "T00 ERR ...  g_sc_limit [Hartree]: 1e-05\r\n",
      "T00 ERR ...  gw_sc_limit [Hartree]: 1e-05\r\n",
      "T00 ERR ...  Tasks: \r\n",
      "T00 ERR ...  GW \r\n",
      "T00 ERR ...  singlets \r\n",
      "T00 ERR ...  Store: \r\n",
      "T00 ERR ...  GW \r\n",
      "T00 ERR ...  Sigma integration: ppm\r\n",
      "T00 ERR ...  eta: 0.001\r\n",
      "T00 ERR ...  Quadrature integration order : 12\r\n",
      "T00 ERR ...  Quadrature integration scheme : legendre\r\n",
      "T00 ERR ...  Alpha smoothing parameter : 0.001\r\n",
      "T00 ERR ...  QP solver: grid\r\n",
      "T00 ERR ...  QP grid steps: 1001\r\n",
      "T00 ERR ...  QP grid spacing: 0.001\r\n",
      "T00 ERR ...  evGW with Anderson update with history 20 using alpha 0.7\r\n",
      "T00 ERR ... 2021-7-7 16:42:42 Using 2 threads\r\n",
      "T00 ERR ... 2021-7-7 16:42:42 Using native Eigen implementation, no BLAS overload \r\n",
      "T00 ERR ... 2021-7-7 16:42:42 Molecule Coordinates [A] \r\n",
      "T00 ERR ...     0    C   30.3000 1.2704 5.5205\r\n",
      "T00 ERR ...     1    H   31.2392 1.4802 6.0301\r\n",
      "T00 ERR ...     2    H   30.4910 0.6554 4.6433\r\n",
      "T00 ERR ...     3    H   29.8500 2.2100 5.2100\r\n",
      "T00 ERR ...     4    H   29.6200 0.7500 6.2000\r\n",
      "T00 ERR ... 2021-7-7 16:42:42 DFT data was created by xtp\r\n",
      "T00 ERR ... 2021-7-7 16:42:42 Loaded DFT Basis Set def2-svp\r\n",
      "T00 ERR ... 2021-7-7 16:42:42 Filled DFT Basis of size 34\r\n",
      "T00 ERR ... 2021-7-7 16:42:42 Loaded Auxbasis Set aux-def2-svp\r\n",
      "T00 ERR ... 2021-7-7 16:42:42 Filled Auxbasis of size 104\r\n",
      "T00 ERR ... 2021-7-7 16:42:42 Calculating Mmn_beta (3-center-repulsion x orbitals)  \r\n",
      "T00 ERR ... 2021-7-7 16:42:42 Calculated Mmn_beta (3-center-repulsion x orbitals)  \r\n",
      "T00 ERR ... 2021-7-7 16:42:42 Integrating Vxc with functional XC_HYB_GGA_XC_PBEH\r\n",
      "T00 ERR ... 2021-7-7 16:42:42 Set hybrid exchange factor: 0.25\r\n",
      "T00 ERR ... 2021-7-7 16:42:42 Calculated exchange-correlation expectation values \r\n",
      "T00 ERR ... 2021-7-7 16:42:42 Calculated Hartree exchange contribution\r\n",
      "T00 ERR ... 2021-7-7 16:42:42 Scissor shifting DFT energies by: 0 Hrt\r\n",
      "T00 ERR ...   ====== Perturbative quasiparticle energies (Hartree) ====== \r\n",
      "T00 ERR ...    DeltaHLGap = +0.205493 Hartree\r\n",
      "T00 ERR ...   Level =    0 DFT = -10.2166 VXC = -1.6995 S-X = -2.6642 S-C = +0.3755 GWA = -10.8057\r\n",
      "T00 ERR ...   Level =    1 DFT = -0.7052 VXC = -0.4442 S-X = -0.6638 S-C = +0.0825 GWA = -0.8422\r\n",
      "T00 ERR ...   Level =    2 DFT = -0.4019 VXC = -0.3984 S-X = -0.5342 S-C = +0.0166 GWA = -0.5211\r\n",
      "T00 ERR ...   Level =    3 DFT = -0.4013 VXC = -0.3981 S-X = -0.5336 S-C = +0.0164 GWA = -0.5205\r\n",
      "T00 ERR ...   HOMO  =    4 DFT = -0.4005 VXC = -0.3984 S-X = -0.5340 S-C = +0.0165 GWA = -0.5196\r\n",
      "T00 ERR ...   LUMO  =    5 DFT = +0.0869 VXC = -0.1666 S-X = -0.0616 S-C = -0.0185 GWA = +0.1733\r\n",
      "T00 ERR ...   Level =    6 DFT = +0.1577 VXC = -0.2032 S-X = -0.0791 S-C = -0.0232 GWA = +0.2586\r\n",
      "T00 ERR ...   Level =    7 DFT = +0.1584 VXC = -0.2029 S-X = -0.0789 S-C = -0.0232 GWA = +0.2592\r\n",
      "T00 ERR ...   Level =    8 DFT = +0.1586 VXC = -0.2026 S-X = -0.0787 S-C = -0.0231 GWA = +0.2594\r\n",
      "T00 ERR ...   Level =    9 DFT = +0.4331 VXC = -0.2605 S-X = -0.0984 S-C = -0.0300 GWA = +0.5652\r\n",
      "T00 ERR ...   Level =   10 DFT = +0.4343 VXC = -0.2608 S-X = -0.0984 S-C = -0.0301 GWA = +0.5666\r\n",
      "T00 ERR ...   Level =   11 DFT = +0.4353 VXC = -0.2609 S-X = -0.0983 S-C = -0.0302 GWA = +0.5676\r\n",
      "T00 ERR ...   Level =   12 DFT = +0.6745 VXC = -0.3540 S-X = -0.1454 S-C = -0.0757 GWA = +0.8073\r\n",
      "T00 ERR ...   Level =   13 DFT = +0.7036 VXC = -0.3487 S-X = -0.1218 S-C = -0.0883 GWA = +0.8421\r\n",
      "T00 ERR ... 2021-7-7 16:42:42 Calculated offdiagonal part of Sigma  \r\n",
      "T00 ERR ... 2021-7-7 16:42:42 Full quasiparticle Hamiltonian  \r\n",
      "T00 ERR ...   ====== Diagonalized quasiparticle energies (Hartree) ====== \r\n",
      "T00 ERR ...   Level =    0 PQP = -10.805725 DQP = -10.805785 \r\n",
      "T00 ERR ...   Level =    1 PQP = -0.842238 DQP = -0.842345 \r\n",
      "T00 ERR ...   Level =    2 PQP = -0.521065 DQP = -0.521168 \r\n",
      "T00 ERR ...   Level =    3 PQP = -0.520475 DQP = -0.520596 \r\n",
      "T00 ERR ...   HOMO  =    4 PQP = -0.519632 DQP = -0.519730 \r\n",
      "T00 ERR ...   LUMO  =    5 PQP = +0.173335 DQP = +0.172153 \r\n",
      "T00 ERR ...   Level =    6 PQP = +0.258607 DQP = +0.256731 \r\n",
      "T00 ERR ...   Level =    7 PQP = +0.259219 DQP = +0.258879 \r\n",
      "T00 ERR ...   Level =    8 PQP = +0.259394 DQP = +0.259127 \r\n",
      "T00 ERR ...   Level =    9 PQP = +0.565174 DQP = +0.565576 \r\n",
      "T00 ERR ...   Level =   10 PQP = +0.566638 DQP = +0.567033 \r\n",
      "T00 ERR ...   Level =   11 PQP = +0.567637 DQP = +0.568037 \r\n",
      "T00 ERR ...   Level =   12 PQP = +0.807315 DQP = +0.808662 \r\n",
      "T00 ERR ...   Level =   13 PQP = +0.842094 DQP = +0.843705 \r\n",
      "T00 ERR ... 2021-7-7 16:42:42 Diagonalized QP Hamiltonian  \r\n",
      "T00 ERR ... 2021-7-7 16:42:42 GW calculation took 0.752299688 seconds.\r\n",
      "T00 ERR ... 2021-7-7 16:42:42 Setup Full singlet hamiltonian \r\n",
      "T00 ERR ... 2021-7-7 16:42:42 Davidson Solver using 2 threads.\r\n",
      "T00 ERR ... 2021-7-7 16:42:42 Tolerance : 0.0001\r\n",
      "T00 ERR ... 2021-7-7 16:42:42 DPR Correction\r\n",
      "T00 ERR ... 2021-7-7 16:42:42 Matrix size : 90x90\r\n",
      "T00 ERR ... 2021-7-7 16:42:42 iter\tSearch Space\tNorm\r\n",
      "T00 ERR ... 2021-7-7 16:42:42    0           10 \t 5.72e-02 \t  0.00% converged\r\n",
      "T00 ERR ... 2021-7-7 16:42:42    1           17 \t 2.83e-02 \t  0.00% converged\r\n",
      "T00 ERR ... 2021-7-7 16:42:42    2           24 \t 1.59e-02 \t  0.00% converged\r\n",
      "T00 ERR ... 2021-7-7 16:42:42    3           31 \t 2.92e-03 \t 60.00% converged\r\n",
      "T00 ERR ... 2021-7-7 16:42:42    4           35 \t 2.02e-04 \t 80.00% converged\r\n",
      "T00 ERR ... 2021-7-7 16:42:42    5           37 \t 4.41e-05 \t 100.00% converged\r\n",
      "T00 ERR ... 2021-7-7 16:42:42 Davidson converged after 5 iterations.\r\n",
      "T00 ERR ... 2021-7-7 16:42:42-----------------------------------\r\n",
      "T00 ERR ... 2021-7-7 16:42:42- Davidson ran for 0.009592997secs.\r\n",
      "T00 ERR ... 2021-7-7 16:42:42-----------------------------------\r\n",
      "T00 ERR ... 2021-7-7 16:42:42 Solved BSE for singlets \r\n",
      "T00 ERR ...   ====== singlet energies (eV) ====== \r\n",
      "T00 ERR ...   S =    1 Omega = +12.229015996661 eV  lamdba = +101.40 nm <FT> = +18.9971 <K_x> = +0.8671 <K_d> = -7.6352\r\n",
      "T00 ERR ...            TrDipole length gauge[e*bohr]  dx = +0.4627 dy = -0.6019 dz = +0.4783 |d|^2 = +0.8052 f = +0.2412\r\n",
      "T00 ERR ...            HOMO-0   -> LUMO+0    : 98.3%\r\n",
      "T00 ERR ... \r\n",
      "T00 ERR ...   S =    2 Omega = +12.246994778120 eV  lamdba = +101.25 nm <FT> = +19.0326 <K_x> = +0.8515 <K_d> = -7.6371\r\n",
      "T00 ERR ...            TrDipole length gauge[e*bohr]  dx = -0.7649 dy = -0.4730 dz = +0.1553 |d|^2 = +0.8328 f = +0.2499\r\n",
      "T00 ERR ...            HOMO-1   -> LUMO+0    : 96.5%\r\n",
      "T00 ERR ... \r\n",
      "T00 ERR ...   S =    3 Omega = +12.269249108459 eV  lamdba = +101.07 nm <FT> = +19.0374 <K_x> = +0.8713 <K_d> = -7.6395\r\n",
      "T00 ERR ...            TrDipole length gauge[e*bohr]  dx = +0.1500 dy = -0.4753 dz = -0.7571 |d|^2 = +0.8215 f = +0.2469\r\n",
      "T00 ERR ...            HOMO-2   -> LUMO+0    : 97.1%\r\n",
      "T00 ERR ... \r\n",
      "T00 ERR ...   S =    4 Omega = +13.869526255229 eV  lamdba = +89.40 nm <FT> = +21.3549 <K_x> = +0.2512 <K_d> = -7.7366\r\n",
      "T00 ERR ...            TrDipole length gauge[e*bohr]  dx = +0.0830 dy = -0.0228 dz = +0.0185 |d|^2 = +0.0078 f = +0.0026\r\n",
      "T00 ERR ...            HOMO-0   -> LUMO+1    : 67.2%\r\n",
      "T00 ERR ... \r\n",
      "T00 ERR ...   S =    5 Omega = +13.898103256572 eV  lamdba = +89.22 nm <FT> = +21.3778 <K_x> = +0.2469 <K_d> = -7.7266\r\n",
      "T00 ERR ...            TrDipole length gauge[e*bohr]  dx = +0.0133 dy = +0.0444 dz = +0.0585 |d|^2 = +0.0056 f = +0.0019\r\n",
      "T00 ERR ...            HOMO-2   -> LUMO+1    : 51.9%\r\n",
      "T00 ERR ... \r\n",
      "T00 ERR ... 2021-7-7 16:42:42 BSE calculation took 0.020723677 seconds.\r\n",
      "T00 ERR ... 2021-7-7 16:42:42 GWBSE calculation finished \r\n",
      "T00 ERR ... Filter overlap not used in first iteration as it needs a reference state\r\n",
      "T00 ERR ... No State found by tracker using last state: s1\r\n",
      "T00 ERR ... 2021-7-7 16:42:42 Evaluating polar 1\r\n",
      "T00 ERR ... 2021-7-7 16:42:42 Evaluating interaction between polar 1 and qm 0\r\n",
      "T00 ERR ... Next State is: s1\r\n",
      "T00 ERR ... 2021-7-7 16:42:43 Evaluating interaction between polar 1 and static 2\r\n",
      "T00 ERR ... 2021-7-7 16:42:43 Starting Solving for classical polarization with 1380 degrees of freedom.\r\n",
      "T00 ERR ... 2021-7-7 16:42:43 CG: #iterations: 7, estimated error: 4.9516998907e-06\r\n",
      "T00 ERR ...   Total static energy [hrt]= 0.0009102654542\r\n",
      "T00 ERR ...   Total polar energy [hrt]= -0.0002981816772\r\n",
      "T00 ERR ...  Total energy [hrt]= 0.000612083777\r\n",
      "T00 ERR ... 2021-7-7 16:42:43 Evaluating static 2\r\n",
      "T00 ERR ... 2021-7-7 16:42:43 Writing checkpoint to checkpoint_iter_1.hdf5\r\n",
      "T00 ERR ...  Region:qm 0 is not converged deltaE=-39.98034833 RMS Dmat=0.340480374 MaxDmat=7.081946901\r\n",
      "T00 ERR ... 2021-7-7 16:42:43 Region:polar 1 is not converged deltaE=0.000612083777\r\n",
      "T00 ERR ... 2021-7-7 16:42:43 --Total Energy all regions -39.97973625\r\n",
      "T00 ERR ... 2021-7-7 16:42:43 --Inter Region SCF Iteration 2 of 50\r\n",
      "T00 ERR ... 2021-7-7 16:42:43 Evaluating qm 0\r\n",
      "T00 ERR ... 2021-7-7 16:42:43 Evaluating interaction between qm 0 and polar 1\r\n",
      "T00 ERR ... 2021-7-7 16:42:43 Evaluating interaction between qm 0 and static 2\r\n",
      "T00 ERR ... Running DFT calculation\r\n",
      "T00 ERR ... 2021-7-7 16:42:43 Using 2 threads\r\n",
      "T00 ERR ... 2021-7-7 16:42:43 Using native Eigen implementation, no BLAS overload \r\n",
      "T00 ERR ...  Molecule Coordinates [A] \r\n",
      "T00 ERR ...   C   +30.3000 +1.2704 +5.5205\r\n",
      "T00 ERR ...   H   +31.2392 +1.4802 +6.0301\r\n",
      "T00 ERR ...   H   +30.4910 +0.6554 +4.6433\r\n",
      "T00 ERR ...   H   +29.8500 +2.2100 +5.2100\r\n",
      "T00 ERR ...   H   +29.6200 +0.7500 +6.2000\r\n",
      "T00 ERR ... 2021-7-7 16:42:43 Loaded DFT Basis Set def2-svp with 34 functions\r\n",
      "T00 ERR ... 2021-7-7 16:42:43 Loaded AUX Basis Set aux-def2-svp with 104 functions\r\n",
      "T00 ERR ... 2021-7-7 16:42:43 Total number of electrons: 10\r\n",
      "T00 ERR ... 2021-7-7 16:42:43 Smallest value of AOOverlap matrix is 0.01388201597\r\n",
      "T00 ERR ... 2021-7-7 16:42:43 Removed 0 basisfunction from inverse overlap matrix\r\n",
      "T00 ERR ... 2021-7-7 16:42:43 Convergence Options:\r\n",
      "T00 ERR ... \t\t Delta E [Ha]: 1e-07\r\n",
      "T00 ERR ... \t\t DIIS max error: 1e-07\r\n",
      "T00 ERR ... \t\t DIIS histlength: 20\r\n",
      "T00 ERR ... \t\t ADIIS start: 0.8\r\n",
      "T00 ERR ... \t\t DIIS start: 0.002\r\n",
      "T00 ERR ... \t\t Deleting oldest element from DIIS hist\r\n",
      "T00 ERR ... \t\t Levelshift[Ha]: 0\r\n",
      "T00 ERR ... \t\t Levelshift end: 0.2\r\n",
      "T00 ERR ... \t\t Mixing Parameter alpha: 0.7\r\n",
      "T00 ERR ... 2021-7-7 16:42:43 Setup invariant parts of Electron Repulsion integrals \r\n",
      "T00 ERR ... 2021-7-7 16:42:43 Constructed independent particle hamiltonian \r\n",
      "T00 ERR ... 2021-7-7 16:42:43 Nuclear Repulsion Energy is 13.4434088\r\n",
      "T00 ERR ... 2021-7-7 16:42:43 Using hybrid functional with alpha=0.25\r\n",
      "T00 ERR ... 2021-7-7 16:42:43 Setup numerical integration grid medium for vxc functional XC_HYB_GGA_XC_PBEH\r\n",
      "T00 ERR ... 2021-7-7 16:42:43 Setup Initial Guess using: atom\r\n",
      "T00 ERR ... 2021-7-7 16:42:43 Calculating atom density for C\r\n",
      "T00 ERR ... 2021-7-7 16:42:45 Calculating atom density for H\r\n",
      "T00 ERR ... 2021-7-7 16:42:45 STARTING SCF cycle\r\n",
      "T00 ERR ...  --------------------------------------------------------------------------\r\n",
      "T00 ERR ... \r\n",
      "T00 ERR ... 2021-7-7 16:42:45 Iteration 1 of 100\r\n",
      "T00 ERR ... 2021-7-7 16:42:45 Total Energy -40.3175266147\r\n",
      "T00 ERR ... 2021-7-7 16:42:45 DIIs error 0.224238142655\r\n",
      "T00 ERR ... 2021-7-7 16:42:45 Delta Etot 0\r\n",
      "T00 ERR ... \r\n",
      "T00 ERR ... 2021-7-7 16:42:45 Iteration 2 of 100\r\n",
      "T00 ERR ... 2021-7-7 16:42:45 Total Energy -40.3646246494\r\n",
      "T00 ERR ... 2021-7-7 16:42:45 DIIs error 0.133949212263\r\n",
      "T00 ERR ... 2021-7-7 16:42:45 Delta Etot -0.0470980347028\r\n",
      "T00 ERR ... \r\n",
      "T00 ERR ... 2021-7-7 16:42:45 Iteration 3 of 100\r\n",
      "T00 ERR ... 2021-7-7 16:42:45 Total Energy -40.3861419652\r\n",
      "T00 ERR ... 2021-7-7 16:42:45 DIIs error 0.083885259682\r\n",
      "T00 ERR ... 2021-7-7 16:42:45 Delta Etot -0.0215173157917\r\n",
      "T00 ERR ... \r\n",
      "T00 ERR ... 2021-7-7 16:42:45 Iteration 4 of 100\r\n",
      "T00 ERR ... 2021-7-7 16:42:45 Total Energy -40.4270638078\r\n",
      "T00 ERR ... 2021-7-7 16:42:45 DIIs error 0.0278301961309\r\n",
      "T00 ERR ... 2021-7-7 16:42:45 Delta Etot -0.0409218426033\r\n",
      "T00 ERR ... \r\n",
      "T00 ERR ... 2021-7-7 16:42:45 Iteration 5 of 100\r\n",
      "T00 ERR ... 2021-7-7 16:42:46 Total Energy -40.4267021802\r\n",
      "T00 ERR ... 2021-7-7 16:42:46 DIIs error 0.0303659025127\r\n",
      "T00 ERR ... 2021-7-7 16:42:46 Delta Etot 0.000361627572673\r\n",
      "T00 ERR ... \r\n",
      "T00 ERR ... 2021-7-7 16:42:46 Iteration 6 of 100\r\n",
      "T00 ERR ... 2021-7-7 16:42:46 Total Energy -40.4297536212\r\n",
      "T00 ERR ... 2021-7-7 16:42:46 DIIs error 0.000897437785931\r\n",
      "T00 ERR ... 2021-7-7 16:42:46 Delta Etot -0.00305144098556\r\n",
      "T00 ERR ... \r\n",
      "T00 ERR ... 2021-7-7 16:42:46 Iteration 7 of 100\r\n",
      "T00 ERR ... 2021-7-7 16:42:46 Total Energy -40.4297563742\r\n",
      "T00 ERR ... 2021-7-7 16:42:46 DIIs error 4.04107900601e-05\r\n",
      "T00 ERR ... 2021-7-7 16:42:46 Delta Etot -2.75302284791e-06\r\n",
      "T00 ERR ... \r\n",
      "T00 ERR ... 2021-7-7 16:42:46 Iteration 8 of 100\r\n",
      "T00 ERR ... 2021-7-7 16:42:46 Total Energy -40.4297563834\r\n",
      "T00 ERR ... 2021-7-7 16:42:46 DIIs error 8.23131971932e-06\r\n",
      "T00 ERR ... 2021-7-7 16:42:46 Delta Etot -9.18931419847e-09\r\n",
      "T00 ERR ... \r\n",
      "T00 ERR ... 2021-7-7 16:42:46 Iteration 9 of 100\r\n",
      "T00 ERR ... 2021-7-7 16:42:46 Total Energy -40.4297563835\r\n",
      "T00 ERR ... 2021-7-7 16:42:46 DIIs error 4.08253482126e-06\r\n",
      "T00 ERR ... 2021-7-7 16:42:46 Delta Etot -3.43476358466e-11\r\n",
      "T00 ERR ... \r\n",
      "T00 ERR ... 2021-7-7 16:42:46 Iteration 10 of 100\r\n",
      "T00 ERR ... 2021-7-7 16:42:46 Total Energy -40.4297563835\r\n",
      "T00 ERR ... 2021-7-7 16:42:46 DIIs error 6.38744316026e-07\r\n",
      "T00 ERR ... 2021-7-7 16:42:46 Delta Etot -6.77999878462e-11\r\n",
      "T00 ERR ... \r\n",
      "T00 ERR ... 2021-7-7 16:42:46 Iteration 11 of 100\r\n",
      "T00 ERR ... 2021-7-7 16:42:46 Total Energy -40.4297563835\r\n",
      "T00 ERR ... 2021-7-7 16:42:46 DIIs error 1.33562399804e-07\r\n",
      "T00 ERR ... 2021-7-7 16:42:46 Delta Etot -1.81188397619e-12\r\n",
      "T00 ERR ... \r\n",
      "T00 ERR ... 2021-7-7 16:42:46 Iteration 12 of 100\r\n",
      "T00 ERR ... 2021-7-7 16:42:47 Total Energy -40.4297563835\r\n",
      "T00 ERR ... 2021-7-7 16:42:47 DIIs error 1.42058525903e-08\r\n",
      "T00 ERR ... 2021-7-7 16:42:47 Delta Etot 3.5527136788e-14\r\n",
      "T00 ERR ... 2021-7-7 16:42:47 Total Energy has converged to 3.55271368e-14[Ha] after 12 iterations. DIIS error is converged up to 1.42058526e-08\r\n",
      "T00 ERR ... 2021-7-7 16:42:47 Final Single Point Energy -40.4297563835 Ha\r\n",
      "T00 ERR ... 2021-7-7 16:42:47 Final Local Exc contribution -5.19306055877 Ha\r\n",
      "T00 ERR ... 2021-7-7 16:42:47 Final Non Local Ex contribution -1.64329348955 Ha\r\n",
      "T00 ERR ...   Orbital energies: \r\n",
      "T00 ERR ...   index occupation energy(Hartree) \r\n",
      "T00 ERR ...      0      2   -10.2165825580\r\n",
      "T00 ERR ...      1      2   -0.7051538099\r\n",
      "T00 ERR ...      2      2   -0.4018655177\r\n",
      "T00 ERR ...      3      2   -0.4013152488\r\n",
      "T00 ERR ...      4      2   -0.4005290808\r\n",
      "T00 ERR ...      5      0   +0.0869454515\r\n",
      "T00 ERR ...      6      0   +0.1577220452\r\n",
      "T00 ERR ...      7      0   +0.1583754148\r\n",
      "T00 ERR ...      8      0   +0.1586072653\r\n",
      "T00 ERR ...      9      0   +0.4330895464\r\n",
      "T00 ERR ...     10      0   +0.4343457422\r\n",
      "T00 ERR ...     11      0   +0.4353142300\r\n",
      "T00 ERR ...     12      0   +0.6744613199\r\n",
      "T00 ERR ...     13      0   +0.7036149201\r\n",
      "T00 ERR ...     14      0   +0.7050390821\r\n",
      "T00 ERR ...     15      0   +0.7055645853\r\n",
      "T00 ERR ...     16      0   +0.8003683168\r\n",
      "T00 ERR ...     17      0   +1.0999968983\r\n",
      "T00 ERR ...     18      0   +1.1004647832\r\n",
      "T00 ERR ...     19      0   +1.5442530974\r\n",
      "T00 ERR ...     20      0   +1.5467099741\r\n",
      "T00 ERR ...     21      0   +1.5491455648\r\n",
      "T00 ERR ...     22      0   +1.7736313505\r\n",
      "T00 ERR ...     23      0   +1.7786531819\r\n",
      "T00 ERR ...     24      0   +1.7825616834\r\n",
      "T00 ERR ...     25      0   +2.1474447362\r\n",
      "T00 ERR ...     26      0   +2.1539279433\r\n",
      "T00 ERR ...     27      0   +2.1588781249\r\n",
      "T00 ERR ...     28      0   +2.5467729745\r\n",
      "T00 ERR ...     29      0   +2.5472286013\r\n",
      "T00 ERR ...     30      0   +2.6351386507\r\n",
      "T00 ERR ...     31      0   +2.9321712153\r\n",
      "T00 ERR ...     32      0   +2.9387931850\r\n",
      "T00 ERR ...     33      0   +2.9434654773\r\n",
      "T00 ERR ... 2021-7-7 16:42:47 Electric Dipole is[e*bohr]:\r\n",
      "\t\t dx=0.000670950176568\r\n",
      "\t\t dy=0.00319235427258\r\n",
      "\t\t dz=-0.0010540451651\r\n",
      "T00 ERR ... Writing result to votca.orb\r\n",
      "T00 ERR ... 2021-7-7 16:42:47 DFT calculation took 3.240504676 seconds.\r\n",
      "T00 ERR ... QM energy[Hrt]: -40.42975638 \r\n",
      "T00 ERR ... 2021-7-7 16:42:47 RPA level range [0:33]\r\n",
      "T00 ERR ... 2021-7-7 16:42:47 GW  level range [0:13]\r\n",
      "T00 ERR ... 2021-7-7 16:42:47 BSE level range occ[0:4]  virt[5:13]\r\n",
      "T00 ERR ...  BSE type: full\r\n",
      "T00 ERR ... 2021-7-7 16:42:47 BSE Hamiltonian has size 90x90\r\n",
      "T00 ERR ...  BSE without Hqp offdiagonal elements\r\n",
      "T00 ERR ...  Running GW as: evGW\r\n",
      "T00 ERR ...  g_sc_limit [Hartree]: 1e-05\r\n",
      "T00 ERR ...  gw_sc_limit [Hartree]: 1e-05\r\n",
      "T00 ERR ...  Tasks: \r\n",
      "T00 ERR ...  GW \r\n",
      "T00 ERR ...  singlets \r\n",
      "T00 ERR ...  Store: \r\n",
      "T00 ERR ...  GW \r\n",
      "T00 ERR ...  Sigma integration: ppm\r\n",
      "T00 ERR ...  eta: 0.001\r\n",
      "T00 ERR ...  Quadrature integration order : 12\r\n",
      "T00 ERR ...  Quadrature integration scheme : legendre\r\n",
      "T00 ERR ...  Alpha smoothing parameter : 0.001\r\n",
      "T00 ERR ...  QP solver: grid\r\n",
      "T00 ERR ...  QP grid steps: 1001\r\n",
      "T00 ERR ...  QP grid spacing: 0.001\r\n",
      "T00 ERR ...  evGW with Anderson update with history 20 using alpha 0.7\r\n",
      "T00 ERR ... 2021-7-7 16:42:47 Using 2 threads\r\n",
      "T00 ERR ... 2021-7-7 16:42:47 Using native Eigen implementation, no BLAS overload \r\n",
      "T00 ERR ... 2021-7-7 16:42:47 Molecule Coordinates [A] \r\n",
      "T00 ERR ...     0    C   30.3000 1.2704 5.5205\r\n",
      "T00 ERR ...     1    H   31.2392 1.4802 6.0301\r\n",
      "T00 ERR ...     2    H   30.4910 0.6554 4.6433\r\n",
      "T00 ERR ...     3    H   29.8500 2.2100 5.2100\r\n",
      "T00 ERR ...     4    H   29.6200 0.7500 6.2000\r\n",
      "T00 ERR ... 2021-7-7 16:42:47 DFT data was created by xtp\r\n",
      "T00 ERR ... 2021-7-7 16:42:47 Loaded DFT Basis Set def2-svp\r\n",
      "T00 ERR ... 2021-7-7 16:42:47 Filled DFT Basis of size 34\r\n",
      "T00 ERR ... 2021-7-7 16:42:47 Loaded Auxbasis Set aux-def2-svp\r\n",
      "T00 ERR ... 2021-7-7 16:42:47 Filled Auxbasis of size 104\r\n",
      "T00 ERR ... 2021-7-7 16:42:47 Calculating Mmn_beta (3-center-repulsion x orbitals)  \r\n",
      "T00 ERR ... 2021-7-7 16:42:47 Calculated Mmn_beta (3-center-repulsion x orbitals)  \r\n",
      "T00 ERR ... 2021-7-7 16:42:47 Integrating Vxc with functional XC_HYB_GGA_XC_PBEH\r\n",
      "T00 ERR ... 2021-7-7 16:42:47 Set hybrid exchange factor: 0.25\r\n",
      "T00 ERR ... 2021-7-7 16:42:47 Calculated exchange-correlation expectation values \r\n",
      "T00 ERR ... 2021-7-7 16:42:47 Calculated Hartree exchange contribution\r\n",
      "T00 ERR ... 2021-7-7 16:42:47 Scissor shifting DFT energies by: 0 Hrt\r\n",
      "T00 ERR ...   ====== Perturbative quasiparticle energies (Hartree) ====== \r\n",
      "T00 ERR ...    DeltaHLGap = +0.205493 Hartree\r\n",
      "T00 ERR ...   Level =    0 DFT = -10.2166 VXC = -1.6995 S-X = -2.6642 S-C = +0.3755 GWA = -10.8057\r\n",
      "T00 ERR ...   Level =    1 DFT = -0.7052 VXC = -0.4442 S-X = -0.6638 S-C = +0.0825 GWA = -0.8422\r\n",
      "T00 ERR ...   Level =    2 DFT = -0.4019 VXC = -0.3984 S-X = -0.5342 S-C = +0.0166 GWA = -0.5211\r\n",
      "T00 ERR ...   Level =    3 DFT = -0.4013 VXC = -0.3981 S-X = -0.5336 S-C = +0.0164 GWA = -0.5205\r\n",
      "T00 ERR ...   HOMO  =    4 DFT = -0.4005 VXC = -0.3984 S-X = -0.5340 S-C = +0.0165 GWA = -0.5196\r\n",
      "T00 ERR ...   LUMO  =    5 DFT = +0.0869 VXC = -0.1666 S-X = -0.0616 S-C = -0.0185 GWA = +0.1733\r\n",
      "T00 ERR ...   Level =    6 DFT = +0.1577 VXC = -0.2032 S-X = -0.0791 S-C = -0.0232 GWA = +0.2586\r\n",
      "T00 ERR ...   Level =    7 DFT = +0.1584 VXC = -0.2029 S-X = -0.0789 S-C = -0.0232 GWA = +0.2592\r\n",
      "T00 ERR ...   Level =    8 DFT = +0.1586 VXC = -0.2026 S-X = -0.0787 S-C = -0.0231 GWA = +0.2594\r\n",
      "T00 ERR ...   Level =    9 DFT = +0.4331 VXC = -0.2605 S-X = -0.0984 S-C = -0.0300 GWA = +0.5652\r\n",
      "T00 ERR ...   Level =   10 DFT = +0.4343 VXC = -0.2608 S-X = -0.0984 S-C = -0.0301 GWA = +0.5666\r\n",
      "T00 ERR ...   Level =   11 DFT = +0.4353 VXC = -0.2609 S-X = -0.0983 S-C = -0.0302 GWA = +0.5676\r\n",
      "T00 ERR ...   Level =   12 DFT = +0.6745 VXC = -0.3540 S-X = -0.1454 S-C = -0.0757 GWA = +0.8073\r\n",
      "T00 ERR ...   Level =   13 DFT = +0.7036 VXC = -0.3487 S-X = -0.1218 S-C = -0.0883 GWA = +0.8421\r\n",
      "T00 ERR ... 2021-7-7 16:42:47 Calculated offdiagonal part of Sigma  \r\n",
      "T00 ERR ... 2021-7-7 16:42:47 Full quasiparticle Hamiltonian  \r\n",
      "T00 ERR ...   ====== Diagonalized quasiparticle energies (Hartree) ====== \r\n",
      "T00 ERR ...   Level =    0 PQP = -10.805725 DQP = -10.805785 \r\n",
      "T00 ERR ...   Level =    1 PQP = -0.842238 DQP = -0.842345 \r\n",
      "T00 ERR ...   Level =    2 PQP = -0.521065 DQP = -0.521168 \r\n",
      "T00 ERR ...   Level =    3 PQP = -0.520475 DQP = -0.520596 \r\n",
      "T00 ERR ...   HOMO  =    4 PQP = -0.519632 DQP = -0.519730 \r\n",
      "T00 ERR ...   LUMO  =    5 PQP = +0.173335 DQP = +0.172153 \r\n",
      "T00 ERR ...   Level =    6 PQP = +0.258607 DQP = +0.256731 \r\n",
      "T00 ERR ...   Level =    7 PQP = +0.259219 DQP = +0.258879 \r\n",
      "T00 ERR ...   Level =    8 PQP = +0.259394 DQP = +0.259127 \r\n",
      "T00 ERR ...   Level =    9 PQP = +0.565174 DQP = +0.565576 \r\n",
      "T00 ERR ...   Level =   10 PQP = +0.566638 DQP = +0.567033 \r\n",
      "T00 ERR ...   Level =   11 PQP = +0.567637 DQP = +0.568037 \r\n",
      "T00 ERR ...   Level =   12 PQP = +0.807315 DQP = +0.808662 \r\n",
      "T00 ERR ...   Level =   13 PQP = +0.842094 DQP = +0.843705 \r\n",
      "T00 ERR ... 2021-7-7 16:42:47 Diagonalized QP Hamiltonian  \r\n",
      "T00 ERR ... 2021-7-7 16:42:47 GW calculation took 0.752406117 seconds.\r\n",
      "T00 ERR ... 2021-7-7 16:42:47 Setup Full singlet hamiltonian \r\n",
      "T00 ERR ... 2021-7-7 16:42:47 Davidson Solver using 2 threads.\r\n",
      "T00 ERR ... 2021-7-7 16:42:47 Tolerance : 0.0001\r\n",
      "T00 ERR ... 2021-7-7 16:42:47 DPR Correction\r\n",
      "T00 ERR ... 2021-7-7 16:42:47 Matrix size : 90x90\r\n",
      "T00 ERR ... 2021-7-7 16:42:47 iter\tSearch Space\tNorm\r\n",
      "T00 ERR ... 2021-7-7 16:42:47    0           10 \t 5.72e-02 \t  0.00% converged\r\n",
      "T00 ERR ... 2021-7-7 16:42:47    1           17 \t 2.83e-02 \t  0.00% converged\r\n",
      "T00 ERR ... 2021-7-7 16:42:47    2           24 \t 1.59e-02 \t  0.00% converged\r\n",
      "T00 ERR ... 2021-7-7 16:42:47    3           31 \t 2.92e-03 \t 60.00% converged\r\n",
      "T00 ERR ... 2021-7-7 16:42:47    4           35 \t 2.02e-04 \t 80.00% converged\r\n",
      "T00 ERR ... 2021-7-7 16:42:47    5           37 \t 4.41e-05 \t 100.00% converged\r\n",
      "T00 ERR ... 2021-7-7 16:42:47 Davidson converged after 5 iterations.\r\n",
      "T00 ERR ... 2021-7-7 16:42:47-----------------------------------\r\n",
      "T00 ERR ... 2021-7-7 16:42:47- Davidson ran for 0.009652592secs.\r\n",
      "T00 ERR ... 2021-7-7 16:42:47-----------------------------------\r\n",
      "T00 ERR ... 2021-7-7 16:42:47 Solved BSE for singlets \r\n",
      "T00 ERR ...   ====== singlet energies (eV) ====== \r\n",
      "T00 ERR ...   S =    1 Omega = +12.229015996661 eV  lamdba = +101.40 nm <FT> = +18.9971 <K_x> = +0.8671 <K_d> = -7.6352\r\n",
      "T00 ERR ...            TrDipole length gauge[e*bohr]  dx = +0.4627 dy = -0.6019 dz = +0.4783 |d|^2 = +0.8052 f = +0.2412\r\n",
      "T00 ERR ...            HOMO-0   -> LUMO+0    : 98.3%\r\n",
      "T00 ERR ... \r\n",
      "T00 ERR ...   S =    2 Omega = +12.246994778120 eV  lamdba = +101.25 nm <FT> = +19.0326 <K_x> = +0.8515 <K_d> = -7.6371\r\n",
      "T00 ERR ...            TrDipole length gauge[e*bohr]  dx = -0.7649 dy = -0.4730 dz = +0.1553 |d|^2 = +0.8328 f = +0.2499\r\n",
      "T00 ERR ...            HOMO-1   -> LUMO+0    : 96.5%\r\n",
      "T00 ERR ... \r\n",
      "T00 ERR ...   S =    3 Omega = +12.269249108459 eV  lamdba = +101.07 nm <FT> = +19.0374 <K_x> = +0.8713 <K_d> = -7.6395\r\n",
      "T00 ERR ...            TrDipole length gauge[e*bohr]  dx = +0.1500 dy = -0.4753 dz = -0.7571 |d|^2 = +0.8215 f = +0.2469\r\n",
      "T00 ERR ...            HOMO-2   -> LUMO+0    : 97.1%\r\n",
      "T00 ERR ... \r\n",
      "T00 ERR ...   S =    4 Omega = +13.869526255229 eV  lamdba = +89.40 nm <FT> = +21.3549 <K_x> = +0.2512 <K_d> = -7.7366\r\n",
      "T00 ERR ...            TrDipole length gauge[e*bohr]  dx = -0.0830 dy = +0.0228 dz = -0.0185 |d|^2 = +0.0078 f = +0.0026\r\n",
      "T00 ERR ...            HOMO-0   -> LUMO+1    : 67.2%\r\n",
      "T00 ERR ... \r\n",
      "T00 ERR ...   S =    5 Omega = +13.898103256572 eV  lamdba = +89.22 nm <FT> = +21.3778 <K_x> = +0.2469 <K_d> = -7.7266\r\n",
      "T00 ERR ...            TrDipole length gauge[e*bohr]  dx = -0.0133 dy = -0.0444 dz = -0.0585 |d|^2 = +0.0056 f = +0.0019\r\n",
      "T00 ERR ...            HOMO-2   -> LUMO+1    : 51.9%\r\n",
      "T00 ERR ... \r\n",
      "T00 ERR ... 2021-7-7 16:42:47 BSE calculation took 0.022008355 seconds.\r\n",
      "T00 ERR ... 2021-7-7 16:42:47 GWBSE calculation finished \r\n",
      "T00 ERR ... Next State is: s1\r\n",
      "T00 ERR ... 2021-7-7 16:42:47 Evaluating polar 1\r\n",
      "T00 ERR ... 2021-7-7 16:42:47 Evaluating interaction between polar 1 and qm 0\r\n",
      "T00 ERR ... Next State is: s1\r\n",
      "T00 ERR ... 2021-7-7 16:42:48 Evaluating interaction between polar 1 and static 2\r\n",
      "T00 ERR ... 2021-7-7 16:42:48 Starting Solving for classical polarization with 1380 degrees of freedom.\r\n",
      "T00 ERR ... 2021-7-7 16:42:48 CG: #iterations: 0, estimated error: 4.95169995709e-06\r\n",
      "T00 ERR ...   Total static energy [hrt]= 0.0009102654542\r\n",
      "T00 ERR ...   Total polar energy [hrt]= -0.0002981816772\r\n",
      "T00 ERR ...  Total energy [hrt]= 0.000612083777\r\n",
      "T00 ERR ... 2021-7-7 16:42:48 Evaluating static 2\r\n",
      "T00 ERR ... 2021-7-7 16:42:48 Writing checkpoint to checkpoint_iter_2.hdf5\r\n",
      "T00 ERR ...  Region:qm 0 is converged deltaE=1.421085472e-14 RMS Dmat=1.181628822e-13 MaxDmat=1.690203533e-12\r\n",
      "T00 ERR ... 2021-7-7 16:42:48 Region:polar 1 is converged deltaE=0\r\n",
      "T00 ERR ... 2021-7-7 16:42:48 --Total Energy all regions -39.97973625\r\n",
      "T00 ERR ... 2021-7-7 16:42:48 Job converged after 2 iterations.\r\n",
      "T00 ERR ... Next State is: s1\r\n",
      "T00 ERR ... Reporting job results\r\n",
      "\r\n",
      "T00 ERR ... Requesting next job\r\n",
      "T00 ERR ... Assign jobs from stack\r\n",
      "T00 ERR ... Sync did not yield any new jobs.\r\n",
      "T00 ERR ... Next job: ID = - (none available)\r\n",
      "MST ERR Assign jobs from stack\r\n",
      "Changes have not been written to state file.\r\n"
     ]
    }
   ],
   "source": [
    "!sed -i \"s/AVAILABLE/COMPLETE/g\" qmmm_jobs.xml                                                                                                                                                            \n",
    "!sed -i '0,/COMPLETE/s/COMPLETE/AVAILABLE/' qmmm_jobs.xml   \n",
    "!sed -i '0,/COMPLETE/s/COMPLETE/AVAILABLE/' qmmm_jobs.xml  \n",
    "!xtp_parallel -e qmmm -o OPTIONFILES/qmmm.xml -x 2 -f state.hdf5 -j run"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Finally, save the results"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 41,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2021-07-07T16:42:49.410498Z",
     "iopub.status.busy": "2021-07-07T16:42:49.408175Z",
     "iopub.status.idle": "2021-07-07T16:42:53.456634Z",
     "shell.execute_reply": "2021-07-07T16:42:53.456073Z"
    }
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "==================================================\r\n",
      "========   VOTCA (http://www.votca.org)   ========\r\n",
      "==================================================\r\n",
      "\r\n",
      "please submit bugs to https://github.com/votca/xtp/issues\r\n",
      "\r\n",
      "xtp_parallel, version 2022-dev gitid: 60fc73d (compiled Jul  7 2021, 16:29:22)\r\n",
      "votca_csg, version 2022-dev gitid: 60fc73d (compiled Jul  7 2021, 16:11:42)\r\n",
      "votca_tools, version 2022-dev gitid: 60fc73d (compiled Jul  7 2021, 16:08:43)\r\n",
      "\r\n",
      "Initializing calculator\r\n",
      "... qmmm\r\n",
      "\r\n",
      "... ... Initialized with 1 threads.\r\n",
      "\r\n",
      "... ... Using 1 openmp threads for 1x1=1 total threads.\r\n",
      "1 frames in statefile, Ids are: 0 \r\n",
      "Starting at frame 0\r\n",
      "Evaluating frame 0\r\n",
      "Import MD Topology (i.e. frame 0) from state.hdf5\r\n",
      ".... \r\n",
      "... qmmm \r\n",
      "Found 1 states of type s\r\n",
      "Found 1 states of type n\r\n",
      "2998 incomplete jobs found.\r\n",
      "\r\n",
      "Wrote MD topology (step = 0, time = 0) to state.hdf5\r\n",
      "... . \r\n"
     ]
    }
   ],
   "source": [
    "!xtp_parallel -e qmmm -o OPTIONFILES/qmmm.xml -f state.hdf5 -j \"read\""
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.9.5"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 4
}
