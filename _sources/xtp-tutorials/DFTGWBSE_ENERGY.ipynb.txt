{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# DFT + GWBSE Energy Calculation Using CH4"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Introduction"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "This tutorial explains how to perform calculation to predict electronic excitation using the **GWBSE** method. See [the GW Compendium: A Practical Guide to Theoretical Photoemission Spectroscopy](https://doi.org/10.3389/fchem.2019.00377), for an excellent introduction to the method."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Requirements\n",
    "* You will need to install **VOTCA** using the instructions described [here](https://github.com/votca/votca/blob/master/share/doc/INSTALL.rst)\n",
    "* Once the installation is completed you need to activate the VOTCA enviroment by running the `VOTCARC.bash` script that has been installed at the bin subfolder for the path that you have provided for the installation step above"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Interacting with the XTP command line interface\n",
    "To run a DFT-GWBSE calculation we will use the [xtp_tools](https://www.votca.org/xtp/xtp_tools_overview.html) calculator. Run the following command to view the help message of `xtp_tools`:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2021-12-14T05:34:56.177441Z",
     "iopub.status.busy": "2021-12-14T05:34:56.176892Z",
     "iopub.status.idle": "2021-12-14T05:34:56.352183Z",
     "shell.execute_reply": "2021-12-14T05:34:56.352554Z"
    }
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "==================================================\r\n",
      "========   VOTCA (http://www.votca.org)   ========\r\n",
      "==================================================\r\n",
      "\r\n",
      "please submit bugs to https://github.com/votca/xtp/issues\r\n",
      "\r\n",
      "xtp_tools, version 2022-dev gitid: 540916e (compiled Dec 14 2021, 05:28:20)\r\n",
      "votca_csg, version 2022-dev gitid: 540916e (compiled Dec 14 2021, 05:15:55)\r\n",
      "votca_tools, version 2022-dev gitid: 540916e (compiled Dec 14 2021, 05:13:51)\r\n",
      "\r\n",
      "Runs excitation/charge transport tools\r\n",
      "\r\n",
      "\r\n",
      "\r\n",
      "Allowed options:\r\n",
      "  -h [ --help ]                 display this help and exit\r\n",
      "  --verbose                     be loud and noisy\r\n",
      "  --verbose1                    be very loud and noisy\r\n",
      "  -v [ --verbose2 ]             be extremly loud and noisy\r\n",
      "  -o [ --options ] arg          Tool user options.\r\n",
      "  -t [ --nthreads ] arg (=1)    number of threads to create\r\n",
      "  -e [ --execute ] arg        Name of Tool to run\r\n",
      "  -l [ --list ]               Lists all available Tools\r\n",
      "  -d [ --description ] arg    Short description of a Tools\r\n",
      "  -c [ --cmdoptions ] arg     Modify options via command line by e.g. '-c \r\n",
      "                              xmltag.subtag=value'. Use whitespace to separate \r\n",
      "                              multiple options\r\n",
      "  -p [ --printoptions ] arg   Prints xml options of a Tool\r\n",
      "\r\n"
     ]
    }
   ],
   "source": [
    "!xtp_tools --help"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Note\n",
    "> * In Jupyter the `!` symbol means: *run the following command as a standard unix command*\n",
    "> * In Jupyter the command `%env` set an environmental variable"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Running a calculation with the default options\n",
    "To run a DFT-GWBSE calculation we just need to provide the path to the file in XYZ with the molecular coordinates. Check the [dftgwbse defaults](https://www.votca.org/xtp/dftgwbse.html) for further information."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2021-12-14T05:34:56.358927Z",
     "iopub.status.busy": "2021-12-14T05:34:56.356653Z",
     "iopub.status.idle": "2021-12-14T05:35:03.134508Z",
     "shell.execute_reply": "2021-12-14T05:35:03.135577Z"
    }
   },
   "outputs": [],
   "source": [
    "!xtp_tools -c job_name=methane -t 2 -e dftgwbse > dftgwbse.log"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "The previous command will run the DFT-GWBSE calculation using the aforementioned defaults and the results are store in the *Current Work Directory* in a file named `methane_summary.xml`. The `-c` option is important and we will come back to it later. It allows changing options form the command line."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Running a calculation using your own input file\n",
    "Let create a folder to store the input `options` for XTP and use the `-p` option to print an option file, specified by `-o`, with all the options so we can modify it afterwards"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2021-12-14T05:35:03.139933Z",
     "iopub.status.busy": "2021-12-14T05:35:03.139517Z",
     "iopub.status.idle": "2021-12-14T05:35:03.419592Z",
     "shell.execute_reply": "2021-12-14T05:35:03.420027Z"
    }
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Writing options for calculator dftgwbse to OPTIONFILES/dftgwbse.xml\r\n",
      "Done - stopping here\r\n"
     ]
    }
   ],
   "source": [
    "!mkdir -p OPTIONFILES\n",
    "!xtp_tools -p dftgwbse -o OPTIONFILES/dftgwbse.xml"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "You should have a *XML* file with the DFTWGSE options that looks like"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2021-12-14T05:35:03.425986Z",
     "iopub.status.busy": "2021-12-14T05:35:03.423719Z",
     "iopub.status.idle": "2021-12-14T05:35:03.538139Z",
     "shell.execute_reply": "2021-12-14T05:35:03.537612Z"
    }
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<options>\r\n",
      "<dftgwbse help=\"Compute electronic excitations using GW-BSE\">\r\n",
      "\t<job_name default=\"system\" help=\"Input file name without extension, also used for intermediate files\">system</job_name>\r\n",
      "\t<dftpackage help=\"options for dftpackages\">\r\n",
      "\t\t<name choices=\"xtp,orca\" default=\"xtp\" help=\"Name of the DFT package\">xtp</name>\r\n",
      "\t\t<charge choices=\"int\" default=\"0\" help=\"Molecular charge\">0</charge>\r\n",
      "\t\t<spin choices=\"int+\" default=\"1\" help=\"Molecular multiplicity\">1</spin>\r\n",
      "\t\t<basisset default=\"def2-tzvp\" help=\"Basis set for MOs\">def2-tzvp</basisset>\r\n",
      "\t\t<auxbasisset default=\"OPTIONAL\" help=\"Auxiliary basis set for RI\"/>\r\n",
      "\t\t<externalfield default=\"OPTIONAL\" help=\"Field given in x y z components\" unit=\"Hartree/bohr\"/>\r\n"
     ]
    }
   ],
   "source": [
    "!head -n 10 OPTIONFILES/dftgwbse.xml"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Some options are labelled as `OPTIONAL`, either fill them in or delete them if you do not want that functionality"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "We created a small options file"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2021-12-14T05:35:03.544318Z",
     "iopub.status.busy": "2021-12-14T05:35:03.542020Z",
     "iopub.status.idle": "2021-12-14T05:35:03.655116Z",
     "shell.execute_reply": "2021-12-14T05:35:03.655496Z"
    }
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<options>\r\n",
      "    <dftgwbse>\r\n",
      "        <job_name>methane</job_name>\r\n",
      "        <dftpackage>\r\n",
      "            <basisset>ubecppol</basisset>\r\n",
      "            <auxbasisset>aux-ubecppol</auxbasisset>\r\n",
      "        </dftpackage>\r\n",
      "    </dftgwbse>\r\n",
      "</options>\r\n"
     ]
    }
   ],
   "source": [
    "!cat dftgwbse2.xml"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2021-12-14T05:35:03.661783Z",
     "iopub.status.busy": "2021-12-14T05:35:03.659376Z",
     "iopub.status.idle": "2021-12-14T05:35:09.801600Z",
     "shell.execute_reply": "2021-12-14T05:35:09.801130Z"
    }
   },
   "outputs": [],
   "source": [
    "!xtp_tools -o dftgwbse2.xml -t 2 -e dftgwbse > dftgwbse2.log"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "XTP will automatically compare the default values with the user-provided and overwrites the defaults with the user input. Also, If I given property does not have a default value you can provide one using the XML file described above."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Partial Charges\n",
    "We can compute now the partial charges using the `CHELPG` method by default. For more information see the [partialcharges documentation](https://www.votca.org/xtp/partialcharges.html). Once again, we only need to provide the name of the system to compute, which in our case is `methane`."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2021-12-14T05:35:09.808828Z",
     "iopub.status.busy": "2021-12-14T05:35:09.805617Z",
     "iopub.status.idle": "2021-12-14T05:35:12.204515Z",
     "shell.execute_reply": "2021-12-14T05:35:12.204051Z"
    }
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "==================================================\r\n",
      "========   VOTCA (http://www.votca.org)   ========\r\n",
      "==================================================\r\n",
      "\r\n",
      "please submit bugs to https://github.com/votca/xtp/issues\r\n",
      "\r\n",
      "xtp_tools, version 2022-dev gitid: 540916e (compiled Dec 14 2021, 05:28:20)\r\n",
      "votca_csg, version 2022-dev gitid: 540916e (compiled Dec 14 2021, 05:15:55)\r\n",
      "votca_tools, version 2022-dev gitid: 540916e (compiled Dec 14 2021, 05:13:51)\r\n",
      "\r\n",
      "Initializing tool\r\n",
      "... partialcharges Evaluating tool\r\n",
      "... partialcharges  Using 1 threads\r\n",
      "... ...  Loading QM data from methane.orb\r\n",
      "... ... ===== Running on 1 threads ===== \r\n",
      "... ... 2021-12-14 5:35:10 Calculated Densities at Numerical Grid, Number of electrons is -2.37461e-08\r\n",
      "... ... 2021-12-14 5:35:10 Calculating ESP at CHELPG grid points\r\n",
      "... ... 2021-12-14 5:35:12 Netcharge constrained to 0\r\n",
      "... ...  Sum of fitted charges: 2.42167e-14\r\n",
      "... ...  RMSE of fit:  0.00221585\r\n",
      "... ...  RRMSE of fit: 0.107179\r\n",
      "... ... El Dipole from fitted charges [e*bohr]:\r\n",
      "\t\t dx = +0.7278 dy = -0.4713 dz = +0.4706 |d|^2 = +0.9733\r\n",
      "... ... El Dipole from exact qm density [e*bohr]:\r\n",
      "\t\t dx = +0.7620 dy = -0.4941 dz = +0.4932 |d|^2 = +1.0681\r\n",
      "... ... Written charges to methane.mps"
     ]
    }
   ],
   "source": [
    "!xtp_tools -c job_name=methane -e partialcharges"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Spectrum Calculation\n",
    "Finally, lets compute a convolution of the singlet spectrum using a gaussian function. For doing so, we will modify the default values for the [spectrum calculator](https://www.votca.org/xtp/spectrum.html) to compute the spectrum between 9 and 25 eV, using 1000 points in that energy range. We will use the `-c` option to modify the options accordingly. Instead we could have printed out an options file using the `xtp_tools -p spectrum` command and then modify the entries accordingly and then read them in using the `-o` option."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2021-12-14T05:35:12.210673Z",
     "iopub.status.busy": "2021-12-14T05:35:12.208299Z",
     "iopub.status.idle": "2021-12-14T05:35:12.387588Z",
     "shell.execute_reply": "2021-12-14T05:35:12.388350Z"
    }
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "==================================================\r\n",
      "========   VOTCA (http://www.votca.org)   ========\r\n",
      "==================================================\r\n",
      "\r\n",
      "please submit bugs to https://github.com/votca/xtp/issues\r\n",
      "\r\n",
      "xtp_tools, version 2022-dev gitid: 540916e (compiled Dec 14 2021, 05:28:20)\r\n",
      "votca_csg, version 2022-dev gitid: 540916e (compiled Dec 14 2021, 05:15:55)\r\n",
      "votca_tools, version 2022-dev gitid: 540916e (compiled Dec 14 2021, 05:13:51)\r\n",
      "\r\n",
      "Initializing tool\r\n",
      "... spectrum Evaluating tool\r\n",
      "... spectrum  Using 1 threads\r\n",
      "... ... Calculating absorption spectrum plot methane.orb\r\n",
      "... ...  Loading QM data from methane.orb\r\n",
      "... ...  Considering 10 excitation with max energy 14.6581 eV / min wave length 84.7405 nm\r\n",
      "... ...  Spectrum in energy range from  9 to 25 eV and with broadening of FWHM 0.2 eV written to file  methane_spectrum.dat"
     ]
    }
   ],
   "source": [
    "!xtp_tools -c job_name=methane lower=9 upper=25 points=1000 -e spectrum"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "The results are stored in the `methane_spectrum.dat` file."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## (Optional) Plot the spectrum"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "We will use [matplotlib](https://matplotlib.org/), [seaborn](https://seaborn.pydata.org/) and [pandas](https://pandas.pydata.org/) libraries to plot the spectrum. You can install it using [pip](https://pip.pypa.io/en/stable/) like"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2021-12-14T05:35:12.394180Z",
     "iopub.status.busy": "2021-12-14T05:35:12.391740Z",
     "iopub.status.idle": "2021-12-14T05:35:13.399022Z",
     "shell.execute_reply": "2021-12-14T05:35:13.399420Z"
    }
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Requirement already satisfied: seaborn in /usr/lib/python3.10/site-packages (0.11.1)\r\n",
      "Requirement already satisfied: numpy>=1.15 in /usr/lib64/python3.10/site-packages (from seaborn) (1.21.1)\r\n",
      "Requirement already satisfied: scipy>=1.0 in /usr/lib64/python3.10/site-packages (from seaborn) (1.7.0)\r\n",
      "Requirement already satisfied: pandas>=0.23 in /usr/lib64/python3.10/site-packages (from seaborn) (1.3.3)\r\n",
      "Requirement already satisfied: matplotlib>=2.2 in /usr/lib64/python3.10/site-packages (from seaborn) (3.5.0)\r\n",
      "Requirement already satisfied: pyparsing>=2.2.1 in /usr/lib/python3.10/site-packages (from matplotlib>=2.2->seaborn) (2.4.7)\r\n",
      "Requirement already satisfied: pillow>=6.2.0 in /usr/lib64/python3.10/site-packages (from matplotlib>=2.2->seaborn) (8.3.2)\r\n",
      "Requirement already satisfied: python-dateutil>=2.7 in /usr/lib/python3.10/site-packages (from matplotlib>=2.2->seaborn) (2.8.1)\r\n",
      "Requirement already satisfied: fonttools>=4.22.0 in /usr/lib/python3.10/site-packages (from matplotlib>=2.2->seaborn) (4.26.1)\r\n",
      "Requirement already satisfied: cycler>=0.10 in /usr/lib/python3.10/site-packages (from matplotlib>=2.2->seaborn) (0.10.0)\r\n",
      "Requirement already satisfied: kiwisolver>=1.0.1 in /usr/lib64/python3.10/site-packages (from matplotlib>=2.2->seaborn) (1.3.2)\r\n",
      "Requirement already satisfied: packaging>=20.0 in /usr/lib/python3.10/site-packages (from matplotlib>=2.2->seaborn) (21.0)\r\n",
      "Requirement already satisfied: six in /usr/lib/python3.10/site-packages (from cycler>=0.10->matplotlib>=2.2->seaborn) (1.16.0)\r\n",
      "Requirement already satisfied: pytz>=2017.3 in /usr/lib/python3.10/site-packages (from pandas>=0.23->seaborn) (2021.3)\r\n"
     ]
    }
   ],
   "source": [
    "!pip install seaborn --user"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2021-12-14T05:35:13.404168Z",
     "iopub.status.busy": "2021-12-14T05:35:13.403754Z",
     "iopub.status.idle": "2021-12-14T05:35:15.766128Z",
     "shell.execute_reply": "2021-12-14T05:35:15.765674Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[]"
      ]
     },
     "execution_count": 10,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 360x360 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "import pandas as pd \n",
    "import matplotlib.pyplot as plt\n",
    "import seaborn as sns\n",
    "columns = [\"E(eV)\", \"epsGaussian\",\"IM(eps)Gaussian\",  \"epsLorentz\",  \"Im(esp)Lorentz\"] \n",
    "df = pd.read_table(\"methane_spectrum.dat\", comment=\"#\", sep='\\s+',names=columns) \n",
    "sns.relplot(x=\"E(eV)\", y=\"epsGaussian\", ci=None, kind=\"line\", data=df) \n",
    "plt.plot()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.10.0"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 4
}
