{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# DFT + GWBSE Energy Calculation Using CH4"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Introduction"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "This tutorial explains how to perform calculation to predict electronic excitation using the **GWBSE** method. See [the GW Compendium: A Practical Guide to Theoretical Photoemission Spectroscopy](https://doi.org/10.3389/fchem.2019.00377), for an excellent introduction to the method."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Requirements\n",
    "* You will need to install **VOTCA** using the instructions described [here](https://github.com/votca/votca/blob/master/share/doc/INSTALL.rst)\n",
    "* Once the installation is completed you need to activate the VOTCA enviroment by running the `VOTCARC.bash` script that has been installed at the bin subfolder for the path that you have provided for the installation step above"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Interacting with the XTP command line interface\n",
    "To run a DFT-GWBSE calculation we will use the [xtp_tools](https://www.votca.org/xtp/xtp_tools_overview.html) calculator. Run the following command to view the help message of `xtp_tools`:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2021-11-26T15:35:52.153129Z",
     "iopub.status.busy": "2021-11-26T15:35:52.152158Z",
     "iopub.status.idle": "2021-11-26T15:35:52.337386Z",
     "shell.execute_reply": "2021-11-26T15:35:52.336507Z"
    }
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "==================================================\r\n",
      "========   VOTCA (http://www.votca.org)   ========\r\n",
      "==================================================\r\n",
      "\r\n",
      "please submit bugs to https://github.com/votca/xtp/issues\r\n",
      "\r\n",
      "xtp_tools, version 2022-dev gitid: 6d44eb6 (compiled Nov 26 2021, 15:27:44)\r\n",
      "votca_csg, version 2022-dev gitid: 6d44eb6 (compiled Nov 26 2021, 15:12:29)\r\n",
      "votca_tools, version 2022-dev gitid: 6d44eb6 (compiled Nov 26 2021, 15:09:39)\r\n",
      "\r\n",
      "Runs excitation/charge transport tools\r\n",
      "\r\n",
      "\r\n",
      "\r\n",
      "Allowed options:\r\n",
      "  -h [ --help ]                 display this help and exit\r\n",
      "  --verbose                     be loud and noisy\r\n",
      "  --verbose1                    be very loud and noisy\r\n",
      "  -v [ --verbose2 ]             be extremly loud and noisy\r\n",
      "  -o [ --options ] arg          Tool user options.\r\n",
      "  -t [ --nthreads ] arg (=1)    number of threads to create\r\n",
      "  -e [ --execute ] arg        Name of Tool to run\r\n",
      "  -l [ --list ]               Lists all available Tools\r\n",
      "  -d [ --description ] arg    Short description of a Tools\r\n",
      "  -c [ --cmdoptions ] arg     Modify options via command line by e.g. '-c \r\n",
      "                              xmltag.subtag=value'. Use whitespace to separate \r\n",
      "                              multiple options\r\n",
      "  -p [ --printoptions ] arg   Prints xml options of a Tool\r\n",
      "\r\n"
     ]
    }
   ],
   "source": [
    "!xtp_tools --help"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Note\n",
    "> * In Jupyter the `!` symbol means: *run the following command as a standard unix command*\n",
    "> * In Jupyter the command `%env` set an environmental variable"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Running a calculation with the default options\n",
    "To run a DFT-GWBSE calculation we just need to provide the path to the file in XYZ with the molecular coordinates. Check the [dftgwbse defaults](https://www.votca.org/xtp/dftgwbse.html) for further information."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2021-11-26T15:35:52.344659Z",
     "iopub.status.busy": "2021-11-26T15:35:52.341409Z",
     "iopub.status.idle": "2021-11-26T15:36:01.209558Z",
     "shell.execute_reply": "2021-11-26T15:36:01.209090Z"
    }
   },
   "outputs": [],
   "source": [
    "!xtp_tools -c job_name=methane -t 2 -e dftgwbse > dftgwbse.log"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "The previous command will run the DFT-GWBSE calculation using the aforementioned defaults and the results are store in the *Current Work Directory* in a file named `methane_summary.xml`. The `-c` option is important and we will come back to it later. It allows changing options form the command line."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Running a calculation using your own input file\n",
    "Let create a folder to store the input `options` for XTP and use the `-p` option to print an option file, specified by `-o`, with all the options so we can modify it afterwards"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2021-11-26T15:36:01.217433Z",
     "iopub.status.busy": "2021-11-26T15:36:01.213921Z",
     "iopub.status.idle": "2021-11-26T15:36:01.507322Z",
     "shell.execute_reply": "2021-11-26T15:36:01.506489Z"
    }
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Writing options for calculator dftgwbse to OPTIONFILES/dftgwbse.xml\r\n",
      "Done - stopping here\r\n"
     ]
    }
   ],
   "source": [
    "!mkdir -p OPTIONFILES\n",
    "!xtp_tools -p dftgwbse -o OPTIONFILES/dftgwbse.xml"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "You should have a *XML* file with the DFTWGSE options that looks like"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2021-11-26T15:36:01.516205Z",
     "iopub.status.busy": "2021-11-26T15:36:01.512778Z",
     "iopub.status.idle": "2021-11-26T15:36:01.627154Z",
     "shell.execute_reply": "2021-11-26T15:36:01.626680Z"
    }
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<options>\r\n",
      "<dftgwbse help=\"Compute electronic excitations using GW-BSE\">\r\n",
      "\t<job_name default=\"system\" help=\"Input file name without extension, also used for intermediate files\">system</job_name>\r\n",
      "\t<dftpackage help=\"options for dftpackages\">\r\n",
      "\t\t<name choices=\"xtp,orca\" default=\"xtp\" help=\"Name of the DFT package\">xtp</name>\r\n",
      "\t\t<charge choices=\"int\" default=\"0\" help=\"Molecular charge\">0</charge>\r\n",
      "\t\t<spin choices=\"int+\" default=\"1\" help=\"Molecular multiplicity\">1</spin>\r\n",
      "\t\t<basisset default=\"def2-tzvp\" help=\"Basis set for MOs\">def2-tzvp</basisset>\r\n",
      "\t\t<auxbasisset default=\"OPTIONAL\" help=\"Auxiliary basis set for RI\"/>\r\n",
      "\t\t<externalfield default=\"OPTIONAL\" help=\"Field given in x y z components\" unit=\"Hartree/bohr\"/>\r\n"
     ]
    }
   ],
   "source": [
    "!head -n 10 OPTIONFILES/dftgwbse.xml"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Some options are labelled as `OPTIONAL`, either fill them in or delete them if you do not want that functionality"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "We created a small options file"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2021-11-26T15:36:01.634111Z",
     "iopub.status.busy": "2021-11-26T15:36:01.630980Z",
     "iopub.status.idle": "2021-11-26T15:36:01.746044Z",
     "shell.execute_reply": "2021-11-26T15:36:01.744797Z"
    }
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<options>\r\n",
      "    <dftgwbse>\r\n",
      "        <job_name>methane</job_name>\r\n",
      "        <dftpackage>\r\n",
      "            <basisset>ubecppol</basisset>\r\n",
      "            <auxbasisset>aux-ubecppol</auxbasisset>\r\n",
      "        </dftpackage>\r\n",
      "    </dftgwbse>\r\n",
      "</options>\r\n"
     ]
    }
   ],
   "source": [
    "!cat dftgwbse2.xml"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2021-11-26T15:36:01.756000Z",
     "iopub.status.busy": "2021-11-26T15:36:01.752044Z",
     "iopub.status.idle": "2021-11-26T15:36:09.915224Z",
     "shell.execute_reply": "2021-11-26T15:36:09.915960Z"
    }
   },
   "outputs": [],
   "source": [
    "!xtp_tools -o dftgwbse2.xml -t 2 -e dftgwbse > dftgwbse2.log"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "XTP will automatically compare the default values with the user-provided and overwrites the defaults with the user input. Also, If I given property does not have a default value you can provide one using the XML file described above."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Partial Charges\n",
    "We can compute now the partial charges using the `CHELPG` method by default. For more information see the [partialcharges documentation](https://www.votca.org/xtp/partialcharges.html). Once again, we only need to provide the name of the system to compute, which in our case is `methane`."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2021-11-26T15:36:09.923119Z",
     "iopub.status.busy": "2021-11-26T15:36:09.920218Z",
     "iopub.status.idle": "2021-11-26T15:36:10.707722Z",
     "shell.execute_reply": "2021-11-26T15:36:10.707156Z"
    }
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "==================================================\r\n",
      "========   VOTCA (http://www.votca.org)   ========\r\n",
      "==================================================\r\n",
      "\r\n",
      "please submit bugs to https://github.com/votca/xtp/issues\r\n",
      "\r\n",
      "xtp_tools, version 2022-dev gitid: 6d44eb6 (compiled Nov 26 2021, 15:27:44)\r\n",
      "votca_csg, version 2022-dev gitid: 6d44eb6 (compiled Nov 26 2021, 15:12:29)\r\n",
      "votca_tools, version 2022-dev gitid: 6d44eb6 (compiled Nov 26 2021, 15:09:39)\r\n",
      "\r\n",
      "Initializing tool\r\n",
      "... partialcharges Evaluating tool\r\n",
      "... partialcharges  Using 1 threads\r\n",
      "... ...  Loading QM data from methane.orb\r\n",
      "... ... ===== Running on 1 threads ===== \r\n",
      "... ... 2021-11-26 15:36:10 Calculated Densities at Numerical Grid, Number of electrons is 1.7453e-07\r\n",
      "... ... 2021-11-26 15:36:10 Calculating ESP at CHELPG grid points\r\n",
      "... ... 2021-11-26 15:36:10 Netcharge constrained to 0\r\n",
      "... ...  Sum of fitted charges: 2.25544e-18\r\n",
      "... ...  RMSE of fit:  1.83363e-05\r\n",
      "... ...  RRMSE of fit: 0.999766\r\n",
      "... ... El Dipole from fitted charges [e*bohr]:\r\n",
      "\t\t dx = -0.0000 dy = -0.0000 dz = +0.0000 |d|^2 = +0.0000\r\n",
      "... ... El Dipole from exact qm density [e*bohr]:\r\n",
      "\t\t dx = +0.0015 dy = -0.0007 dz = +0.0011 |d|^2 = +0.0000\r\n",
      "... ... Written charges to methane.mps"
     ]
    }
   ],
   "source": [
    "!xtp_tools -c job_name=methane -e partialcharges"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Spectrum Calculation\n",
    "Finally, lets compute a convolution of the singlet spectrum using a gaussian function. For doing so, we will modify the default values for the [spectrum calculator](https://www.votca.org/xtp/spectrum.html) to compute the spectrum between 9 and 25 eV, using 1000 points in that energy range. We will use the `-c` option to modify the options accordingly. Instead we could have printed out an options file using the `xtp_tools -p spectrum` command and then modify the entries accordingly and then read them in using the `-o` option."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2021-11-26T15:36:10.714383Z",
     "iopub.status.busy": "2021-11-26T15:36:10.711721Z",
     "iopub.status.idle": "2021-11-26T15:36:10.901267Z",
     "shell.execute_reply": "2021-11-26T15:36:10.900831Z"
    }
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "==================================================\r\n",
      "========   VOTCA (http://www.votca.org)   ========\r\n",
      "==================================================\r\n",
      "\r\n",
      "please submit bugs to https://github.com/votca/xtp/issues\r\n",
      "\r\n",
      "xtp_tools, version 2022-dev gitid: 6d44eb6 (compiled Nov 26 2021, 15:27:44)\r\n",
      "votca_csg, version 2022-dev gitid: 6d44eb6 (compiled Nov 26 2021, 15:12:29)\r\n",
      "votca_tools, version 2022-dev gitid: 6d44eb6 (compiled Nov 26 2021, 15:09:39)\r\n",
      "\r\n",
      "Initializing tool\r\n",
      "... spectrum Evaluating tool\r\n",
      "... spectrum  Using 1 threads\r\n",
      "... ... Calculating absorption spectrum plot methane.orb\r\n",
      "... ...  Loading QM data from methane.orb\r\n",
      "... ...  Considering 10 excitation with max energy 20.1815 eV / min wave length 61.5297 nm\r\n",
      "... ...  Spectrum in energy range from  9 to 25 eV and with broadening of FWHM 0.2 eV written to file  methane_spectrum.dat"
     ]
    }
   ],
   "source": [
    "!xtp_tools -c job_name=methane lower=9 upper=25 points=1000 -e spectrum"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "The results are stored in the `methane_spectrum.dat` file."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## (Optional) Plot the spectrum"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "We will use [matplotlib](https://matplotlib.org/), [seaborn](https://seaborn.pydata.org/) and [pandas](https://pandas.pydata.org/) libraries to plot the spectrum. You can install it using [pip](https://pip.pypa.io/en/stable/) like"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2021-11-26T15:36:10.911352Z",
     "iopub.status.busy": "2021-11-26T15:36:10.908822Z",
     "iopub.status.idle": "2021-11-26T15:36:12.182034Z",
     "shell.execute_reply": "2021-11-26T15:36:12.181297Z"
    }
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Requirement already satisfied: seaborn in /usr/lib/python3.10/site-packages (0.11.1)\r\n",
      "Requirement already satisfied: numpy>=1.15 in /usr/lib64/python3.10/site-packages (from seaborn) (1.21.1)\r\n",
      "Requirement already satisfied: scipy>=1.0 in /usr/lib64/python3.10/site-packages (from seaborn) (1.7.0)\r\n",
      "Requirement already satisfied: pandas>=0.23 in /usr/lib64/python3.10/site-packages (from seaborn) (1.3.3)\r\n",
      "Requirement already satisfied: matplotlib>=2.2 in /usr/lib64/python3.10/site-packages (from seaborn) (3.5.0rc1)\r\n",
      "Requirement already satisfied: cycler>=0.10 in /usr/lib/python3.10/site-packages (from matplotlib>=2.2->seaborn) (0.10.0)\r\n",
      "Requirement already satisfied: fonttools>=4.22.0 in /usr/lib/python3.10/site-packages (from matplotlib>=2.2->seaborn) (4.26.1)\r\n",
      "Requirement already satisfied: pyparsing>=2.2.1 in /usr/lib/python3.10/site-packages (from matplotlib>=2.2->seaborn) (2.4.7)\r\n",
      "Requirement already satisfied: kiwisolver>=1.0.1 in /usr/lib64/python3.10/site-packages (from matplotlib>=2.2->seaborn) (1.3.2)\r\n",
      "Requirement already satisfied: pillow>=6.2.0 in /usr/lib64/python3.10/site-packages (from matplotlib>=2.2->seaborn) (8.3.2)\r\n",
      "Requirement already satisfied: packaging>=20.0 in /usr/lib/python3.10/site-packages (from matplotlib>=2.2->seaborn) (21.0)\r\n",
      "Requirement already satisfied: python-dateutil>=2.7 in /usr/lib/python3.10/site-packages (from matplotlib>=2.2->seaborn) (2.8.1)\r\n",
      "Requirement already satisfied: six in /usr/lib/python3.10/site-packages (from cycler>=0.10->matplotlib>=2.2->seaborn) (1.16.0)\r\n",
      "Requirement already satisfied: pytz>=2017.3 in /usr/lib/python3.10/site-packages (from pandas>=0.23->seaborn) (2021.3)\r\n"
     ]
    }
   ],
   "source": [
    "!pip install seaborn --user"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2021-11-26T15:36:12.189249Z",
     "iopub.status.busy": "2021-11-26T15:36:12.187856Z",
     "iopub.status.idle": "2021-11-26T15:36:15.276051Z",
     "shell.execute_reply": "2021-11-26T15:36:15.275575Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[]"
      ]
     },
     "execution_count": 10,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 360x360 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "import pandas as pd \n",
    "import matplotlib.pyplot as plt\n",
    "import seaborn as sns\n",
    "columns = [\"E(eV)\", \"epsGaussian\",\"IM(eps)Gaussian\",  \"epsLorentz\",  \"Im(esp)Lorentz\"] \n",
    "df = pd.read_table(\"methane_spectrum.dat\", comment=\"#\", sep='\\s+',names=columns) \n",
    "sns.relplot(x=\"E(eV)\", y=\"epsGaussian\", ci=None, kind=\"line\", data=df) \n",
    "plt.plot()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.10.0"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 4
}
