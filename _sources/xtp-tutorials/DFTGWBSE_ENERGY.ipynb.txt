{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# DFT + GWBSE Energy Calculation Using CH4"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Introduction"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "This tutorial explains how to perform calculation to predict electronic excitation using the **GWBSE** method. See [the GW Compendium: A Practical Guide to Theoretical Photoemission Spectroscopy](https://doi.org/10.3389/fchem.2019.00377), for an excellent introduction to the method."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Requirements\n",
    "* You will need to install **VOTCA** using the instructions described [here](https://github.com/votca/votca/blob/master/share/doc/INSTALL.rst)\n",
    "* Once the installation is completed you need to activate the VOTCA enviroment by running the `VOTCARC.bash` script that has been installed at the bin subfolder for the path that you have provided for the installation step above"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Interacting with the XTP command line interface\n",
    "To run a DFT-GWBSE calculation we will use the [xtp_tools](https://www.votca.org/xtp/xtp_tools_overview.html) calculator. Run the following command to view the help message of `xtp_tools`:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2023-01-06T14:16:32.561120Z",
     "iopub.status.busy": "2023-01-06T14:16:32.560806Z",
     "iopub.status.idle": "2023-01-06T14:16:32.707660Z",
     "shell.execute_reply": "2023-01-06T14:16:32.706639Z"
    }
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "==================================================\r\n",
      "========   VOTCA (http://www.votca.org)   ========\r\n",
      "==================================================\r\n",
      "\r\n",
      "please submit bugs to https://github.com/votca/xtp/issues\r\n",
      "\r\n",
      "xtp_tools, version 2023-dev gitid: 033afc4 (compiled Jan  6 2023, 14:09:02)\r\n",
      "votca_csg, version 2023-dev gitid: 033afc4 (compiled Jan  6 2023, 13:54:39)\r\n",
      "votca_tools, version 2023-dev gitid: 033afc4 (compiled Jan  6 2023, 13:52:04)\r\n",
      "\r\n",
      "Runs excitation/charge transport tools\r\n",
      "\r\n",
      "\r\n",
      "\r\n",
      "Allowed options:\r\n",
      "  -h [ --help ]                 display this help and exit\r\n",
      "  --verbose                     be loud and noisy\r\n",
      "  --verbose1                    be very loud and noisy\r\n",
      "  -v [ --verbose2 ]             be extremly loud and noisy\r\n",
      "  -o [ --options ] arg          Tool user options.\r\n",
      "  -t [ --nthreads ] arg (=1)    number of threads to create\r\n",
      "  -e [ --execute ] arg        Name of Tool to run\r\n",
      "  -l [ --list ]               Lists all available Tools\r\n",
      "  -d [ --description ] arg    Short description of a Tools\r\n",
      "  -c [ --cmdoptions ] arg     Modify options via command line by e.g. '-c \r\n",
      "                              xmltag.subtag=value'. Use whitespace to separate \r\n",
      "                              multiple options\r\n",
      "  -p [ --printoptions ] arg   Prints xml options of a Tool\r\n",
      "\r\n"
     ]
    }
   ],
   "source": [
    "!xtp_tools --help"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Note\n",
    "> * In Jupyter the `!` symbol means: *run the following command as a standard unix command*\n",
    "> * In Jupyter the command `%env` set an environmental variable"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Running a calculation with the default options\n",
    "To run a DFT-GWBSE calculation we just need to provide the path to the file in XYZ with the molecular coordinates. Check the [dftgwbse defaults](https://www.votca.org/xtp/dftgwbse.html) for further information."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2023-01-06T14:16:32.711404Z",
     "iopub.status.busy": "2023-01-06T14:16:32.710803Z",
     "iopub.status.idle": "2023-01-06T14:16:40.269130Z",
     "shell.execute_reply": "2023-01-06T14:16:40.268010Z"
    }
   },
   "outputs": [],
   "source": [
    "!xtp_tools -c job_name=methane -t 2 -e dftgwbse > dftgwbse.log"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "The previous command will run the DFT-GWBSE calculation using the aforementioned defaults and the results are store in the *Current Work Directory* in a file named `methane_summary.xml`. The `-c` option is important and we will come back to it later. It allows changing options form the command line."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Running a calculation using your own input file\n",
    "Let create a folder to store the input `options` for XTP and use the `-p` option to print an option file, specified by `-o`, with all the options so we can modify it afterwards"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2023-01-06T14:16:40.274817Z",
     "iopub.status.busy": "2023-01-06T14:16:40.273240Z",
     "iopub.status.idle": "2023-01-06T14:16:40.527635Z",
     "shell.execute_reply": "2023-01-06T14:16:40.526295Z"
    }
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Writing options for calculator dftgwbse to OPTIONFILES/dftgwbse.xml\r\n",
      "Done - stopping here\r\n"
     ]
    }
   ],
   "source": [
    "!mkdir -p OPTIONFILES\n",
    "!xtp_tools -p dftgwbse -o OPTIONFILES/dftgwbse.xml"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "You should have a *XML* file with the DFTWGSE options that looks like"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2023-01-06T14:16:40.531703Z",
     "iopub.status.busy": "2023-01-06T14:16:40.531194Z",
     "iopub.status.idle": "2023-01-06T14:16:40.644399Z",
     "shell.execute_reply": "2023-01-06T14:16:40.643276Z"
    }
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<options>\r\n",
      "<dftgwbse help=\"Compute electronic excitations using GW-BSE\">\r\n",
      "\t<job_name default=\"system\" help=\"Input file name without extension, also used for intermediate files\">system</job_name>\r\n",
      "\t<dftpackage help=\"options for dftpackages\">\r\n",
      "\t\t<name choices=\"xtp,orca\" default=\"xtp\" help=\"Name of the DFT package\">xtp</name>\r\n",
      "\t\t<charge choices=\"int\" default=\"0\" help=\"Molecular charge\">0</charge>\r\n",
      "\t\t<spin choices=\"int+\" default=\"1\" help=\"Molecular multiplicity\">1</spin>\r\n",
      "\t\t<basisset default=\"def2-tzvp\" help=\"Basis set for MOs\">def2-tzvp</basisset>\r\n",
      "\t\t<auxbasisset default=\"OPTIONAL\" help=\"Auxiliary basis set for RI\"/>\r\n",
      "\t\t<externalfield default=\"OPTIONAL\" help=\"Field given in x y z components\" unit=\"Hartree/bohr\"/>\r\n"
     ]
    }
   ],
   "source": [
    "!head -n 10 OPTIONFILES/dftgwbse.xml"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Some options are labelled as `OPTIONAL`, either fill them in or delete them if you do not want that functionality"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "We created a small options file"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2023-01-06T14:16:40.648320Z",
     "iopub.status.busy": "2023-01-06T14:16:40.647995Z",
     "iopub.status.idle": "2023-01-06T14:16:40.760285Z",
     "shell.execute_reply": "2023-01-06T14:16:40.759665Z"
    }
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<options>\r\n",
      "    <dftgwbse>\r\n",
      "        <job_name>methane</job_name>\r\n",
      "        <dftpackage>\r\n",
      "            <basisset>ubecppol</basisset>\r\n",
      "            <auxbasisset>aux-ubecppol</auxbasisset>\r\n",
      "        </dftpackage>\r\n",
      "    </dftgwbse>\r\n",
      "</options>\r\n"
     ]
    }
   ],
   "source": [
    "!cat dftgwbse2.xml"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2023-01-06T14:16:40.763702Z",
     "iopub.status.busy": "2023-01-06T14:16:40.763502Z",
     "iopub.status.idle": "2023-01-06T14:16:47.602619Z",
     "shell.execute_reply": "2023-01-06T14:16:47.601264Z"
    }
   },
   "outputs": [],
   "source": [
    "!xtp_tools -o dftgwbse2.xml -t 2 -e dftgwbse > dftgwbse2.log"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "XTP will automatically compare the default values with the user-provided and overwrites the defaults with the user input. Also, If I given property does not have a default value you can provide one using the XML file described above."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Partial Charges\n",
    "We can compute now the partial charges using the `CHELPG` method by default. For more information see the [partialcharges documentation](https://www.votca.org/xtp/partialcharges.html). Once again, we only need to provide the name of the system to compute, which in our case is `methane`."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2023-01-06T14:16:47.606798Z",
     "iopub.status.busy": "2023-01-06T14:16:47.606274Z",
     "iopub.status.idle": "2023-01-06T14:16:50.318695Z",
     "shell.execute_reply": "2023-01-06T14:16:50.318027Z"
    }
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "==================================================\r\n",
      "========   VOTCA (http://www.votca.org)   ========\r\n",
      "==================================================\r\n",
      "\r\n",
      "please submit bugs to https://github.com/votca/xtp/issues\r\n",
      "\r\n",
      "xtp_tools, version 2023-dev gitid: 033afc4 (compiled Jan  6 2023, 14:09:02)\r\n",
      "votca_csg, version 2023-dev gitid: 033afc4 (compiled Jan  6 2023, 13:54:39)\r\n",
      "votca_tools, version 2023-dev gitid: 033afc4 (compiled Jan  6 2023, 13:52:04)\r\n",
      "\r\n",
      "Initializing tool\r\n",
      "... partialcharges Evaluating tool\r\n",
      "... partialcharges  Using 1 threads\r\n",
      "... ...  Loading QM data from methane.orb\r\n",
      "... ... ===== Running on 1 threads ===== \r\n",
      "... ... 2023-1-6 14:16:47 Calculated Densities at Numerical Grid, Number of electrons is -2.37461e-08\r\n",
      "... ... 2023-1-6 14:16:47 Calculating ESP at CHELPG grid points\r\n",
      "... ... 2023-1-6 14:16:50 Netcharge constrained to 0\r\n",
      "... ...  Sum of fitted charges: 2.42306e-14\r\n",
      "... ...  RMSE of fit:  0.00221585\r\n",
      "... ...  RRMSE of fit: 0.107179\r\n",
      "... ... El Dipole from fitted charges [e*bohr]:\r\n",
      "\t\t dx = +0.7278 dy = -0.4713 dz = +0.4706 |d|^2 = +0.9733\r\n",
      "... ... El Dipole from exact qm density [e*bohr]:\r\n",
      "\t\t dx = +0.7620 dy = -0.4941 dz = +0.4932 |d|^2 = +1.0681\r\n",
      "... ... Written charges to methane.mps"
     ]
    }
   ],
   "source": [
    "!xtp_tools -c job_name=methane -e partialcharges"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Spectrum Calculation\n",
    "Finally, lets compute a convolution of the singlet spectrum using a gaussian function. For doing so, we will modify the default values for the [spectrum calculator](https://www.votca.org/xtp/spectrum.html) to compute the spectrum between 9 and 25 eV, using 1000 points in that energy range. We will use the `-c` option to modify the options accordingly. Instead we could have printed out an options file using the `xtp_tools -p spectrum` command and then modify the entries accordingly and then read them in using the `-o` option."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2023-01-06T14:16:50.323424Z",
     "iopub.status.busy": "2023-01-06T14:16:50.322139Z",
     "iopub.status.idle": "2023-01-06T14:16:50.477209Z",
     "shell.execute_reply": "2023-01-06T14:16:50.475425Z"
    }
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "==================================================\r\n",
      "========   VOTCA (http://www.votca.org)   ========\r\n",
      "==================================================\r\n",
      "\r\n",
      "please submit bugs to https://github.com/votca/xtp/issues\r\n",
      "\r\n",
      "xtp_tools, version 2023-dev gitid: 033afc4 (compiled Jan  6 2023, 14:09:02)\r\n",
      "votca_csg, version 2023-dev gitid: 033afc4 (compiled Jan  6 2023, 13:54:39)\r\n",
      "votca_tools, version 2023-dev gitid: 033afc4 (compiled Jan  6 2023, 13:52:04)\r\n",
      "\r\n",
      "Initializing tool\r\n",
      "... spectrum Evaluating tool\r\n",
      "... spectrum  Using 1 threads\r\n",
      "... ... Calculating absorption spectrum plot methane.orb\r\n",
      "... ...  Loading QM data from methane.orb\r\n",
      "... ...  Considering 10 excitation with max energy 14.6581 eV / min wave length 84.7405 nm\r\n",
      "... ...  Spectrum in energy range from  9 to 25 eV and with broadening of FWHM 0.2 eV written to file  methane_spectrum.dat"
     ]
    }
   ],
   "source": [
    "!xtp_tools -c job_name=methane lower=9 upper=25 points=1000 -e spectrum"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "The results are stored in the `methane_spectrum.dat` file."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## (Optional) Plot the spectrum"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "We will use [matplotlib](https://matplotlib.org/), [seaborn](https://seaborn.pydata.org/) and [pandas](https://pandas.pydata.org/) libraries to plot the spectrum. You can install it using [pip](https://pip.pypa.io/en/stable/) like"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2023-01-06T14:16:50.481918Z",
     "iopub.status.busy": "2023-01-06T14:16:50.480603Z",
     "iopub.status.idle": "2023-01-06T14:16:52.327874Z",
     "shell.execute_reply": "2023-01-06T14:16:52.326769Z"
    }
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Requirement already satisfied: seaborn in /usr/lib/python3.11/site-packages (0.11.2)\r\n",
      "Requirement already satisfied: numpy>=1.15 in /usr/lib64/python3.11/site-packages (from seaborn) (1.22.0)\r\n",
      "Requirement already satisfied: scipy>=1.0 in /usr/lib64/python3.11/site-packages (from seaborn) (1.8.1)\r\n",
      "Requirement already satisfied: pandas>=0.23 in /usr/lib64/python3.11/site-packages (from seaborn) (1.5.2)\r\n",
      "Requirement already satisfied: matplotlib>=2.2 in /usr/lib64/python3.11/site-packages (from seaborn) (3.6.2)\r\n",
      "Requirement already satisfied: contourpy>=1.0.1 in /usr/lib64/python3.11/site-packages (from matplotlib>=2.2->seaborn) (1.0.6)\r\n",
      "Requirement already satisfied: cycler>=0.10 in /usr/lib/python3.11/site-packages (from matplotlib>=2.2->seaborn) (0.11.0)\r\n",
      "Requirement already satisfied: fonttools>=4.22.0 in /usr/lib64/python3.11/site-packages (from matplotlib>=2.2->seaborn) (4.37.2)\r\n",
      "Requirement already satisfied: kiwisolver>=1.0.1 in /usr/lib64/python3.11/site-packages (from matplotlib>=2.2->seaborn) (1.4.4)\r\n",
      "Requirement already satisfied: packaging>=20.0 in /usr/lib/python3.11/site-packages (from matplotlib>=2.2->seaborn) (21.3)\r\n",
      "Requirement already satisfied: pillow>=6.2.0 in /usr/lib64/python3.11/site-packages (from matplotlib>=2.2->seaborn) (9.2.0)\r\n",
      "Requirement already satisfied: pyparsing>=2.2.1 in /usr/lib/python3.11/site-packages (from matplotlib>=2.2->seaborn) (3.0.9)\r\n",
      "Requirement already satisfied: python-dateutil>=2.7 in /usr/lib/python3.11/site-packages (from matplotlib>=2.2->seaborn) (2.8.2)\r\n",
      "Requirement already satisfied: pytz>=2020.1 in /usr/lib/python3.11/site-packages (from pandas>=0.23->seaborn) (2022.7)\r\n",
      "Requirement already satisfied: six>=1.5 in /usr/lib/python3.11/site-packages (from python-dateutil>=2.7->matplotlib>=2.2->seaborn) (1.16.0)\r\n"
     ]
    }
   ],
   "source": [
    "!pip install seaborn --user"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2023-01-06T14:16:52.331423Z",
     "iopub.status.busy": "2023-01-06T14:16:52.330946Z",
     "iopub.status.idle": "2023-01-06T14:16:54.610625Z",
     "shell.execute_reply": "2023-01-06T14:16:54.601374Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[]"
      ]
     },
     "execution_count": 10,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 360x360 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "import pandas as pd \n",
    "import matplotlib.pyplot as plt\n",
    "import seaborn as sns\n",
    "columns = [\"E(eV)\", \"epsGaussian\",\"IM(eps)Gaussian\",  \"epsLorentz\",  \"Im(esp)Lorentz\"] \n",
    "df = pd.read_table(\"methane_spectrum.dat\", comment=\"#\", sep='\\s+',names=columns) \n",
    "sns.relplot(x=\"E(eV)\", y=\"epsGaussian\", ci=None, kind=\"line\", data=df) \n",
    "plt.plot()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.11.1"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 4
}
