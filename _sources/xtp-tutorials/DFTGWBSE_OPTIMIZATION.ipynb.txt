{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## DFT + GWBSE Optimization Using CO"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Introduction\n",
    "This tutorial explains how to perform a molecular geometric optimization using the **GWBSE** method. See [the GW Compendium: A Practical Guide to Theoretical Photoemission Spectroscopy](https://doi.org/10.3389/fchem.2019.00377), for an excellent introduction to the method."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Requirements\n",
    "* You will need to install **VOTCA** using the instructions described [here](https://github.com/votca/votca/blob/master/share/doc/INSTALL.rst)\n",
    "* Once the installation is completed you need to activate the VOTCA enviroment by running the `VOTCARC.bash` script that has been installed at the bin subfolder for the path that you have provided for the installation step above"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Preparing the input\n",
    "To run a DFT-GWBSE calculation we will use the [xtp_tools](https://votca.github.io/xtp_tools.html) calculator. First, Let create a folder to store the input `options` for XTP and copy the defaults in there"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [],
   "source": [
    "!mkdir -p OPTIONFILES\n",
    "!cp $VOTCASHARE/xtp/xml/dftgwbse.xml OPTIONFILES"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "we can now change the calculator mode from single point energy calculation to optimization as follows,"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "The option 'optimize' on file 'OPTIONFILES/dftgwbse.xml' has been set to 'true'\n",
      "The option 'maxiter' on file 'OPTIONFILES/dftgwbse.xml' has been set to '1'\n",
      "The option 'energy' on file 'OPTIONFILES/dftgwbse.xml' has been set to '1.e-1'\n"
     ]
    }
   ],
   "source": [
    "from xml_editor import edit_calculator\n",
    "edit_calculator(\"dftgwbse\", \"optimize\", \"true\")\n",
    "edit_calculator(\"dftgwbse\", \"maxiter\", \"1\")\n",
    "edit_calculator(\"dftgwbse\", \"energy\", \"1.e-1\")\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "You can find all *dftgwbse* default options [here](https://votca.github.io/dftgwbse.html). You can for instance change the `basisset` and `auxbasisset` to `def2-svp` and `aux-def2-svp`, respectively."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "The option 'basisset' on file 'OPTIONFILES/dftgwbse.xml' has been set to '3-21G'\n",
      "The option 'auxbasisset' on file 'OPTIONFILES/dftgwbse.xml' has been set to 'aux-def2-svp'\n"
     ]
    }
   ],
   "source": [
    "edit_calculator(\"dftgwbse\", \"basisset\", \"3-21G\")\n",
    "edit_calculator(\"dftgwbse\", \"auxbasisset\", \"aux-def2-svp\")"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Finally, to run the calculation we just need the following command,"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Registered dftgwbse\r\n",
      "==================================================\r\n",
      "========   VOTCA (http://www.votca.org)   ========\r\n",
      "==================================================\r\n",
      "\r\n",
      "please submit bugs to https://github.com/votca/xtp/issues\r\n",
      "\r\n",
      "xtp_tools, version 2022-dev gitid: 4677503 (compiled Feb 23 2021, 15:48:49)\r\n",
      "votca_csg, version 2022-dev gitid: 4677503 (compiled Feb 23 2021, 15:31:49)\r\n",
      "votca_tools, version 2022-dev gitid: 4677503 (compiled Feb 23 2021, 15:28:54)\r\n",
      "\r\n",
      "Initializing tool\r\n",
      "... dftgwbse Evaluating tool\r\n",
      "... dftgwbse  Using 2 threads\r\n",
      "... ... Reading structure from CO.xyz\r\n",
      "... ... Requested geometry optimization of excited state s1\r\n",
      "... ... Initial state: s1\r\n",
      "... ... Using oscillator strength tracker with threshold 0.0001\r\n",
      "... ... Convergence of total energy: 0.100000 Hartree \r\n",
      "... ... Convergence of RMS Force:    0.000030 Hartree/Bohr \r\n",
      "... ... Convergence of Max Force:    0.000100 Hartree/Bohr \r\n",
      "... ... Convergence of RMS Step:     0.000600 Bohr \r\n",
      "... ... Convergence of Max Step:     0.001000 Bohr \r\n",
      "... ... Initial trust radius:        0.018897 Bohr\r\n",
      "... ... Next State is: s1\r\n",
      "... ... 2021-2-23 16:2:39 Using 2 threads\r\n",
      "... ... 2021-2-23 16:2:39 Using native Eigen implementation, no BLAS overload \r\n",
      "... ...  Molecule Coordinates [A] \r\n",
      "... ...   C   +0.0010 +0.0000 +0.0000\r\n",
      "... ...   O   +1.2000 +0.0000 +0.0000\r\n",
      "... ... 2021-2-23 16:2:39 Loaded DFT Basis Set 3-21G with 18 functions\r\n",
      "... ... 2021-2-23 16:2:39 Loaded AUX Basis Set aux-def2-svp with 96 functions\r\n",
      "... ... 2021-2-23 16:2:39 Total number of electrons: 14\r\n",
      "... ... 2021-2-23 16:2:39 Smallest value of AOOverlap matrix is 0.051195\r\n",
      "... ... 2021-2-23 16:2:39 Removed 0 basisfunction from inverse overlap matrix\r\n",
      "... ... 2021-2-23 16:2:39 Convergence Options:\r\n",
      "... ... \t\t Delta E [Ha]: 1e-07\r\n",
      "... ... \t\t DIIS max error: 1e-07\r\n",
      "... ... \t\t DIIS histlength: 20\r\n",
      "... ... \t\t ADIIS start: 0.8\r\n",
      "... ... \t\t DIIS start: 0.002\r\n",
      "... ... \t\t Deleting oldest element from DIIS hist\r\n",
      "... ... \t\t Levelshift[Ha]: 0\r\n",
      "... ... \t\t Levelshift end: 0.2\r\n",
      "... ... \t\t Mixing Parameter alpha: 0.7\r\n",
      "... ... 2021-2-23 16:2:39 Setup invariant parts of Electron Repulsion integrals \r\n",
      "... ... 2021-2-23 16:2:39 Constructed independent particle hamiltonian \r\n",
      "... ... 2021-2-23 16:2:39 Nuclear Repulsion Energy is 21.1847439\r\n",
      "... ... 2021-2-23 16:2:39 Using hybrid functional with alpha=0.25\r\n",
      "... ... 2021-2-23 16:2:39 Setup numerical integration grid medium for vxc functional XC_HYB_GGA_XC_PBEH\r\n",
      "... ... 2021-2-23 16:2:39 Setup Initial Guess using: atom\r\n",
      "... ... 2021-2-23 16:2:39 Calculating atom density for C\r\n",
      "... ... 2021-2-23 16:2:40 Calculating atom density for O\r\n",
      "... ... 2021-2-23 16:2:41 STARTING SCF cycle\r\n",
      "... ...  --------------------------------------------------------------------------\r\n",
      "... ... \r\n",
      "... ... 2021-2-23 16:2:41 Iteration 1 of 100\r\n",
      "... ... 2021-2-23 16:2:41 Total Energy -112.364694295\r\n",
      "... ... 2021-2-23 16:2:41 DIIs error 0.358958749787\r\n",
      "... ... 2021-2-23 16:2:41 Delta Etot 0\r\n",
      "... ... \r\n",
      "... ... 2021-2-23 16:2:41 Iteration 2 of 100\r\n",
      "... ... 2021-2-23 16:2:41 Total Energy -112.39958037\r\n",
      "... ... 2021-2-23 16:2:41 DIIs error 0.138444555234\r\n",
      "... ... 2021-2-23 16:2:41 Delta Etot -0.0348860748634\r\n",
      "... ... \r\n",
      "... ... 2021-2-23 16:2:41 Iteration 3 of 100\r\n",
      "... ... 2021-2-23 16:2:41 Total Energy -112.443974704\r\n",
      "... ... 2021-2-23 16:2:41 DIIs error 0.100121195784\r\n",
      "... ... 2021-2-23 16:2:41 Delta Etot -0.0443943339758\r\n",
      "... ... \r\n",
      "... ... 2021-2-23 16:2:41 Iteration 4 of 100\r\n",
      "... ... 2021-2-23 16:2:41 Total Energy -112.52508776\r\n",
      "... ... 2021-2-23 16:2:41 DIIs error 0.117934266239\r\n",
      "... ... 2021-2-23 16:2:41 Delta Etot -0.08111305541\r\n",
      "... ... \r\n",
      "... ... 2021-2-23 16:2:41 Iteration 5 of 100\r\n",
      "... ... 2021-2-23 16:2:41 Total Energy -112.509068708\r\n",
      "... ... 2021-2-23 16:2:41 DIIs error 0.164729478519\r\n",
      "... ... 2021-2-23 16:2:41 Delta Etot 0.0160190513304\r\n",
      "... ... \r\n",
      "... ... 2021-2-23 16:2:41 Iteration 6 of 100\r\n",
      "... ... 2021-2-23 16:2:41 Total Energy -112.544617812\r\n",
      "... ... 2021-2-23 16:2:41 DIIs error 0.0189987110762\r\n",
      "... ... 2021-2-23 16:2:41 Delta Etot -0.0355491031886\r\n",
      "... ... \r\n",
      "... ... 2021-2-23 16:2:41 Iteration 7 of 100\r\n",
      "... ... 2021-2-23 16:2:41 Total Energy -112.541886093\r\n",
      "... ... 2021-2-23 16:2:41 DIIs error 0.049182005391\r\n",
      "... ... 2021-2-23 16:2:41 Delta Etot 0.0027317183675\r\n",
      "... ... \r\n",
      "... ... 2021-2-23 16:2:41 Iteration 8 of 100\r\n",
      "... ... 2021-2-23 16:2:41 Total Energy -112.544883258\r\n",
      "... ... 2021-2-23 16:2:41 DIIs error 0.0140039721851\r\n",
      "... ... 2021-2-23 16:2:41 Delta Etot -0.00299716528241\r\n",
      "... ... \r\n",
      "... ... 2021-2-23 16:2:41 Iteration 9 of 100\r\n",
      "... ... 2021-2-23 16:2:42 Total Energy -112.545133533\r\n",
      "... ... 2021-2-23 16:2:42 DIIs error 0.0037796206707\r\n",
      "... ... 2021-2-23 16:2:42 Delta Etot -0.000250274150773\r\n",
      "... ... \r\n",
      "... ... 2021-2-23 16:2:42 Iteration 10 of 100\r\n",
      "... ... 2021-2-23 16:2:42 Total Energy -112.545113983\r\n",
      "... ... 2021-2-23 16:2:42 DIIs error 0.0053853722598\r\n",
      "... ... 2021-2-23 16:2:42 Delta Etot 1.9550104696e-05\r\n",
      "... ... \r\n",
      "... ... 2021-2-23 16:2:42 Iteration 11 of 100\r\n",
      "... ... 2021-2-23 16:2:42 Total Energy -112.545151787\r\n",
      "... ... 2021-2-23 16:2:42 DIIs error 0.000780748065248\r\n",
      "... ... 2021-2-23 16:2:42 Delta Etot -3.78048894873e-05\r\n",
      "... ... \r\n",
      "... ... 2021-2-23 16:2:42 Iteration 12 of 100\r\n",
      "... ... 2021-2-23 16:2:42 Total Energy -112.5451526\r\n",
      "... ... 2021-2-23 16:2:42 DIIs error 3.66786408589e-06\r\n",
      "... ... 2021-2-23 16:2:42 Delta Etot -8.12325325228e-07\r\n",
      "... ... \r\n",
      "... ... 2021-2-23 16:2:42 Iteration 13 of 100\r\n",
      "... ... 2021-2-23 16:2:42 Total Energy -112.5451526\r\n",
      "... ... 2021-2-23 16:2:42 DIIs error 1.13750058473e-07\r\n",
      "... ... 2021-2-23 16:2:42 Delta Etot -2.03641548069e-11\r\n",
      "... ... \r\n",
      "... ... 2021-2-23 16:2:42 Iteration 14 of 100\r\n",
      "... ... 2021-2-23 16:2:42 Total Energy -112.5451526\r\n",
      "... ... 2021-2-23 16:2:42 DIIs error 6.44911706252e-09\r\n",
      "... ... 2021-2-23 16:2:42 Delta Etot -4.26325641456e-14\r\n",
      "... ... 2021-2-23 16:2:42 Total Energy has converged to -4.26325641e-14[Ha] after 14 iterations. DIIS error is converged up to 6.44911706e-09\r\n",
      "... ... 2021-2-23 16:2:42 Final Single Point Energy -112.5451526 Ha\r\n",
      "... ... 2021-2-23 16:2:42 Final Local Exc contribution -10.3509474699 Ha\r\n",
      "... ... 2021-2-23 16:2:42 Final Non Local Ex contribution -3.29400255021 Ha\r\n",
      "... ...   Orbital energies: \r\n",
      "... ...   index occupation energy(Hartree) \r\n",
      "... ...      0      2   -19.2419944822\r\n",
      "... ...      1      2   -10.3166455939\r\n",
      "... ...      2      2   -1.1842207506\r\n",
      "... ...      3      2   -0.5763673198\r\n",
      "... ...      4      2   -0.4662566189\r\n",
      "... ...      5      2   -0.4662566189\r\n",
      "... ...      6      2   -0.3807869182\r\n",
      "... ...      7      0   -0.0340775619\r\n",
      "... ...      8      0   -0.0340775619\r\n",
      "... ...      9      0   +0.3139136679\r\n",
      "... ...     10      0   +0.7020229601\r\n",
      "... ...     11      0   +0.7020229601\r\n",
      "... ...     12      0   +0.7878578218\r\n",
      "... ...     13      0   +1.0531051427\r\n",
      "... ...     14      0   +1.4534308429\r\n",
      "... ...     15      0   +1.4534308429\r\n",
      "... ...     16      0   +1.5015681038\r\n",
      "... ...     17      0   +2.9080220709\r\n",
      "... ... 2021-2-23 16:2:42 Electric Dipole is[e*bohr]:\r\n",
      "\t\t dx=-0.0486864645033\r\n",
      "\t\t dy=-1.29537936111e-10\r\n",
      "\t\t dz=-1.29527488656e-10\r\n",
      "... ... Writing result to CO.orb\r\n",
      "... ... Parsing DFT data from CO.orb and CO.orb\r\n",
      "... ... QM energy[Hrt]: -112.54515260 \r\n",
      "... ... 2021-2-23 16:2:42 RPA level range [0:17]\r\n",
      "... ... 2021-2-23 16:2:42 GW  level range [0:17]\r\n",
      "... ... 2021-2-23 16:2:42 BSE level range occ[0:6]  virt[7:17]\r\n",
      "... ... 2021-2-23 16:2:42 BSE Hamiltonian has size 77x77\r\n",
      "... ...  BSE type: full\r\n",
      "... ...  BSE without Hqp offdiagonal elements\r\n",
      "... ...  Running GW as: evGW\r\n",
      "... ...  g_sc_limit [Hartree]: 1e-05\r\n",
      "... ...  gw_sc_limit [Hartree]: 1e-05\r\n",
      "... ...  Tasks: \r\n",
      "... ...  GW \r\n",
      "... ...  singlets \r\n",
      "... ...  Store: \r\n",
      "... ...  GW \r\n",
      "... ...  Sigma integration: ppm\r\n",
      "... ...  eta: 0.001\r\n",
      "... ...  Quadrature integration order : 12\r\n",
      "... ...  Quadrature integration scheme : legendre\r\n",
      "... ...  Alpha smoothing parameter : 0.001\r\n",
      "... ...  QP solver: grid\r\n",
      "... ...  QP grid steps: 1001\r\n",
      "... ...  QP grid spacing: 0.001\r\n",
      "... ...  evGW with Anderson update with history 20 using alpha 0.7\r\n",
      "... ... 2021-2-23 16:2:42 Using 2 threads\r\n",
      "... ... 2021-2-23 16:2:42 Using native Eigen implementation, no BLAS overload \r\n",
      "... ... 2021-2-23 16:2:42 Molecule Coordinates [A] \r\n",
      "... ...     0    C   0.0010 0.0000 0.0000\r\n",
      "... ...     1    O   1.2000 0.0000 0.0000\r\n",
      "... ... 2021-2-23 16:2:42 DFT data was created by xtp\r\n",
      "... ... 2021-2-23 16:2:42 Loaded DFT Basis Set 3-21G\r\n",
      "... ... 2021-2-23 16:2:42 Filled DFT Basis of size 18\r\n",
      "... ... 2021-2-23 16:2:42 Loaded Auxbasis Set aux-def2-svp\r\n",
      "... ... 2021-2-23 16:2:42 Filled Auxbasis of size 96\r\n",
      "... ... 2021-2-23 16:2:42 Calculating Mmn_beta (3-center-repulsion x orbitals)  \r\n",
      "... ... 2021-2-23 16:2:42 Calculated Mmn_beta (3-center-repulsion x orbitals)  \r\n",
      "... ... 2021-2-23 16:2:42 Integrating Vxc in VOTCA with functional XC_HYB_GGA_XC_PBEH\r\n",
      "... ... 2021-2-23 16:2:42 Set hybrid exchange factor: 0.25\r\n",
      "... ... 2021-2-23 16:2:42 Calculated exchange-correlation expectation values \r\n",
      "... ... 2021-2-23 16:2:42 Calculated Hartree exchange contribution\r\n",
      "... ... 2021-2-23 16:2:42 Scissor shifting DFT energies by: 0 Hrt\r\n",
      "... ...   ====== Perturbative quasiparticle energies (Hartree) ====== \r\n",
      "... ...    DeltaHLGap = +0.290091 Hartree\r\n",
      "... ...   Level =    0 DFT = -19.2420 VXC = -2.3112 S-X = -3.6465 S-C = +0.5605 GWA = -20.0168\r\n",
      "... ...   Level =    1 DFT = -10.3166 VXC = -1.7029 S-X = -2.6729 S-C = +0.2825 GWA = -11.0042\r\n",
      "... ...   Level =    2 DFT = -1.1842 VXC = -0.6137 S-X = -0.9172 S-C = +0.1554 GWA = -1.3324\r\n",
      "... ...   Level =    3 DFT = -0.5764 VXC = -0.5631 S-X = -0.7702 S-C = +0.0854 GWA = -0.6981\r\n",
      "... ...   Level =    4 DFT = -0.4663 VXC = -0.5082 S-X = -0.6427 S-C = +0.0198 GWA = -0.5809\r\n",
      "... ...   Level =    5 DFT = -0.4663 VXC = -0.5082 S-X = -0.6427 S-C = +0.0198 GWA = -0.5809\r\n",
      "... ...   HOMO  =    6 DFT = -0.3808 VXC = -0.4453 S-X = -0.5898 S-C = +0.0344 GWA = -0.4910\r\n",
      "... ...   LUMO  =    7 DFT = -0.0341 VXC = -0.4302 S-X = -0.2453 S-C = -0.0049 GWA = +0.1458\r\n",
      "... ...   Level =    8 DFT = -0.0341 VXC = -0.4302 S-X = -0.2453 S-C = -0.0049 GWA = +0.1458\r\n",
      "... ...   Level =    9 DFT = +0.3139 VXC = -0.3251 S-X = -0.1498 S-C = -0.0129 GWA = +0.4763\r\n",
      "... ...   Level =   10 DFT = +0.7020 VXC = -0.3344 S-X = -0.0932 S-C = -0.0696 GWA = +0.8736\r\n",
      "... ...   Level =   11 DFT = +0.7020 VXC = -0.3344 S-X = -0.0932 S-C = -0.0696 GWA = +0.8736\r\n",
      "... ...   Level =   12 DFT = +0.7879 VXC = -0.4744 S-X = -0.2017 S-C = -0.0616 GWA = +0.9989\r\n",
      "... ...   Level =   13 DFT = +1.0531 VXC = -0.4122 S-X = -0.1763 S-C = -0.0810 GWA = +1.2080\r\n",
      "... ...   Level =   14 DFT = +1.4534 VXC = -0.5240 S-X = -0.1916 S-C = -0.2308 GWA = +1.5550\r\n",
      "... ...   Level =   15 DFT = +1.4534 VXC = -0.5240 S-X = -0.1916 S-C = -0.2308 GWA = +1.5550\r\n",
      "... ...   Level =   16 DFT = +1.5016 VXC = -0.5043 S-X = -0.1976 S-C = -0.1214 GWA = +1.6868\r\n",
      "... ...   Level =   17 DFT = +2.9080 VXC = -0.5572 S-X = -0.2105 S-C = +0.0448 GWA = +3.2995\r\n",
      "... ... 2021-2-23 16:2:42 Calculated offdiagonal part of Sigma  \r\n",
      "... ... 2021-2-23 16:2:42 Full quasiparticle Hamiltonian  \r\n",
      "... ...   ====== Diagonalized quasiparticle energies (Hartree) ====== \r\n",
      "... ...   Level =    0 PQP = -20.016823 DQP = -20.017086 \r\n",
      "... ...   Level =    1 PQP = -11.004165 DQP = -11.004430 \r\n",
      "... ...   Level =    2 PQP = -1.332367 DQP = -1.333169 \r\n",
      "... ...   Level =    3 PQP = -0.698087 DQP = -0.698575 \r\n",
      "... ...   Level =    4 PQP = -0.580907 DQP = -0.585676 \r\n",
      "... ...   Level =    5 PQP = -0.580907 DQP = -0.585676 \r\n",
      "... ...   HOMO  =    6 PQP = -0.490952 DQP = -0.491293 \r\n",
      "... ...   LUMO  =    7 PQP = +0.145848 DQP = +0.144043 \r\n",
      "... ...   Level =    8 PQP = +0.145848 DQP = +0.144043 \r\n",
      "... ...   Level =    9 PQP = +0.476330 DQP = +0.473843 \r\n",
      "... ...   Level =   10 PQP = +0.873583 DQP = +0.873570 \r\n",
      "... ...   Level =   11 PQP = +0.873583 DQP = +0.873570 \r\n",
      "... ...   Level =   12 PQP = +0.998891 DQP = +0.996300 \r\n",
      "... ...   Level =   13 PQP = +1.207971 DQP = +1.209717 \r\n",
      "... ...   Level =   14 PQP = +1.554953 DQP = +1.561541 \r\n",
      "... ...   Level =   15 PQP = +1.554953 DQP = +1.561541 \r\n",
      "... ...   Level =   16 PQP = +1.686783 DQP = +1.679347 \r\n",
      "... ...   Level =   17 PQP = +3.299532 DQP = +3.312457 \r\n",
      "... ... 2021-2-23 16:2:42 Diagonalized QP Hamiltonian  \r\n",
      "... ... 2021-2-23 16:2:42 Setup Full singlet hamiltonian \r\n",
      "... ... 2021-2-23 16:2:42 Davidson Solver using 2 threads.\r\n",
      "... ... 2021-2-23 16:2:42 Tolerance : 0.0001\r\n",
      "... ... 2021-2-23 16:2:42 DPR Correction\r\n",
      "... ... 2021-2-23 16:2:42 Matrix size : 154x154\r\n",
      "... ... 2021-2-23 16:2:42 iter\tSearch Space\tNorm\r\n",
      "... ... 2021-2-23 16:2:42    0           10 \t 1.29e-01 \t  0.00% converged\r\n",
      "... ... 2021-2-23 16:2:42    1           17 \t 1.62e-02 \t  0.00% converged\r\n",
      "... ... 2021-2-23 16:2:42    2           24 \t 1.35e-03 \t 40.00% converged\r\n",
      "... ... 2021-2-23 16:2:43    3           29 \t 1.03e-04 \t 80.00% converged\r\n",
      "... ... 2021-2-23 16:2:43    4           31 \t 8.49e-05 \t 100.00% converged\r\n",
      "... ... 2021-2-23 16:2:43 Davidson converged after 4 iterations.\r\n",
      "... ... 2021-2-23 16:2:43-----------------------------------\r\n",
      "... ... 2021-2-23 16:2:43- Davidson ran for 0.011677431secs.\r\n",
      "... ... 2021-2-23 16:2:43-----------------------------------\r\n",
      "... ... 2021-2-23 16:2:43 Solved BSE for singlets \r\n",
      "... ...   ====== singlet energies (eV) ====== \r\n",
      "... ...   S =    1 Omega = +7.810277179381 eV  lamdba = +158.77 nm <FT> = +18.1946 <K_x> = +1.7240 <K_d> = -12.1084\r\n",
      "... ...            TrDipole length gauge[e*bohr]  dx = -0.0000 dy = -0.3344 dz = -0.3341 |d|^2 = +0.2235 f = +0.0428\r\n",
      "... ...            HOMO-0   -> LUMO+0    : 95.0%\r\n",
      "... ... \r\n",
      "... ...   S =    2 Omega = +7.810184465358 eV  lamdba = +158.77 nm <FT> = +18.1949 <K_x> = +1.7239 <K_d> = -12.1086\r\n",
      "... ...            TrDipole length gauge[e*bohr]  dx = +0.0000 dy = -0.3341 dz = +0.3344 |d|^2 = +0.2234 f = +0.0428\r\n",
      "... ...            HOMO-0   -> LUMO+1    : 95.0%\r\n",
      "... ... \r\n",
      "... ...   S =    3 Omega = +8.627511127033 eV  lamdba = +143.73 nm <FT> = +19.9580 <K_x> = +0.0000 <K_d> = -11.3306\r\n",
      "... ...            TrDipole length gauge[e*bohr]  dx = +0.0000 dy = -0.0000 dz = +0.0000 |d|^2 = +0.0000 f = +0.0000\r\n",
      "... ... \r\n",
      "... ...   S =    4 Omega = +9.230257898410 eV  lamdba = +134.34 nm <FT> = +19.8863 <K_x> = +1.4914 <K_d> = -12.1475\r\n",
      "... ...            TrDipole length gauge[e*bohr]  dx = -0.0000 dy = -0.0000 dz = +0.0000 |d|^2 = +0.0000 f = +0.0000\r\n",
      "... ... \r\n",
      "... ...   S =    5 Omega = +9.230248873728 eV  lamdba = +134.34 nm <FT> = +19.8863 <K_x> = +1.4914 <K_d> = -12.1474\r\n",
      "... ...            TrDipole length gauge[e*bohr]  dx = +0.0000 dy = -0.0000 dz = -0.0000 |d|^2 = +0.0000 f = +0.0000\r\n",
      "... ... \r\n",
      "... ... 2021-2-23 16:2:43 GWBSE calculation finished \r\n",
      "... ... Next State is: s1\r\n",
      "... ... 2021-2-23 16:2:43 Using 2 threads\r\n",
      "... ... 2021-2-23 16:2:43 Using native Eigen implementation, no BLAS overload \r\n",
      "... ...  Molecule Coordinates [A] \r\n",
      "... ...   C   -0.0010 +0.0000 +0.0000\r\n",
      "... ...   O   +1.2000 +0.0000 +0.0000\r\n",
      "... ... 2021-2-23 16:2:43 Loaded DFT Basis Set 3-21G with 18 functions\r\n",
      "... ... 2021-2-23 16:2:43 Loaded AUX Basis Set aux-def2-svp with 96 functions\r\n",
      "... ... 2021-2-23 16:2:43 Total number of electrons: 14\r\n",
      "... ... 2021-2-23 16:2:43 Smallest value of AOOverlap matrix is 0.0514048041452\r\n",
      "... ... 2021-2-23 16:2:43 Removed 0 basisfunction from inverse overlap matrix\r\n",
      "... ... 2021-2-23 16:2:43 Convergence Options:\r\n",
      "... ... \t\t Delta E [Ha]: 1e-07\r\n",
      "... ... \t\t DIIS max error: 1e-07\r\n",
      "... ... \t\t DIIS histlength: 20\r\n",
      "... ... \t\t ADIIS start: 0.8\r\n",
      "... ... \t\t DIIS start: 0.002\r\n",
      "... ... \t\t Deleting oldest element from DIIS hist\r\n",
      "... ... \t\t Levelshift[Ha]: 0\r\n",
      "... ... \t\t Levelshift end: 0.2\r\n",
      "... ... \t\t Mixing Parameter alpha: 0.7\r\n",
      "... ... 2021-2-23 16:2:43 Setup invariant parts of Electron Repulsion integrals \r\n",
      "... ... 2021-2-23 16:2:43 Constructed independent particle hamiltonian \r\n",
      "... ... 2021-2-23 16:2:43 Nuclear Repulsion Energy is 21.1494654\r\n",
      "... ... 2021-2-23 16:2:43 Using hybrid functional with alpha=0.25\r\n",
      "... ... 2021-2-23 16:2:43 Setup numerical integration grid medium for vxc functional XC_HYB_GGA_XC_PBEH\r\n",
      "... ... 2021-2-23 16:2:43 Setup Initial Guess using: atom\r\n",
      "... ... 2021-2-23 16:2:43 Calculating atom density for C\r\n",
      "... ... 2021-2-23 16:2:43 Calculating atom density for O\r\n",
      "... ... 2021-2-23 16:2:45 STARTING SCF cycle\r\n",
      "... ...  --------------------------------------------------------------------------\r\n",
      "... ... \r\n",
      "... ... 2021-2-23 16:2:45 Iteration 1 of 100\r\n",
      "... ... 2021-2-23 16:2:45 Total Energy -112.363348396\r\n",
      "... ... 2021-2-23 16:2:45 DIIs error 0.359689287921\r\n",
      "... ... 2021-2-23 16:2:45 Delta Etot 0\r\n",
      "... ... \r\n",
      "... ... 2021-2-23 16:2:45 Iteration 2 of 100\r\n",
      "... ... 2021-2-23 16:2:45 Total Energy -112.397941721\r\n",
      "... ... 2021-2-23 16:2:45 DIIs error 0.138198755706\r\n",
      "... ... 2021-2-23 16:2:45 Delta Etot -0.0345933248606\r\n",
      "... ... \r\n",
      "... ... 2021-2-23 16:2:45 Iteration 3 of 100\r\n",
      "... ... 2021-2-23 16:2:45 Total Energy -112.442727564\r\n",
      "... ... 2021-2-23 16:2:45 DIIs error 0.100161620444\r\n",
      "... ... 2021-2-23 16:2:45 Delta Etot -0.0447858432821\r\n",
      "... ... \r\n",
      "... ... 2021-2-23 16:2:45 Iteration 4 of 100\r\n",
      "... ... 2021-2-23 16:2:45 Total Energy -112.523762357\r\n",
      "... ... 2021-2-23 16:2:45 DIIs error 0.120929077753\r\n",
      "... ... 2021-2-23 16:2:45 Delta Etot -0.0810347930656\r\n",
      "... ... \r\n",
      "... ... 2021-2-23 16:2:45 Iteration 5 of 100\r\n",
      "... ... 2021-2-23 16:2:45 Total Energy -112.509203212\r\n",
      "... ... 2021-2-23 16:2:45 DIIs error 0.163624870648\r\n",
      "... ... 2021-2-23 16:2:45 Delta Etot 0.0145591452089\r\n",
      "... ... \r\n",
      "... ... 2021-2-23 16:2:45 Iteration 6 of 100\r\n",
      "... ... 2021-2-23 16:2:45 Total Energy -112.544385959\r\n",
      "... ... 2021-2-23 16:2:45 DIIs error 0.016969588\r\n",
      "... ... 2021-2-23 16:2:45 Delta Etot -0.0351827475892\r\n",
      "... ... \r\n",
      "... ... 2021-2-23 16:2:45 Iteration 7 of 100\r\n",
      "... ... 2021-2-23 16:2:45 Total Energy -112.542191136\r\n",
      "... ... 2021-2-23 16:2:45 DIIs error 0.0441033266955\r\n",
      "... ... 2021-2-23 16:2:45 Delta Etot 0.00219482317246\r\n",
      "... ... \r\n",
      "... ... 2021-2-23 16:2:45 Iteration 8 of 100\r\n",
      "... ... 2021-2-23 16:2:45 Total Energy -112.54460756\r\n",
      "... ... 2021-2-23 16:2:45 DIIs error 0.0124263066128\r\n",
      "... ... 2021-2-23 16:2:45 Delta Etot -0.00241642363922\r\n",
      "... ... \r\n",
      "... ... 2021-2-23 16:2:45 Iteration 9 of 100\r\n",
      "... ... 2021-2-23 16:2:45 Total Energy -112.544802837\r\n",
      "... ... 2021-2-23 16:2:45 DIIs error 0.00364634146349\r\n",
      "... ... 2021-2-23 16:2:45 Delta Etot -0.000195276703195\r\n",
      "... ... \r\n",
      "... ... 2021-2-23 16:2:45 Iteration 10 of 100\r\n",
      "... ... 2021-2-23 16:2:45 Total Energy -112.54479146\r\n",
      "... ... 2021-2-23 16:2:45 DIIs error 0.00467655634158\r\n",
      "... ... 2021-2-23 16:2:45 Delta Etot 1.13765575804e-05\r\n",
      "... ... \r\n",
      "... ... 2021-2-23 16:2:45 Iteration 11 of 100\r\n",
      "... ... 2021-2-23 16:2:45 Total Energy -112.54482026\r\n",
      "... ... 2021-2-23 16:2:45 DIIs error 0.000493992818543\r\n",
      "... ... 2021-2-23 16:2:45 Delta Etot -2.87995747499e-05\r\n",
      "... ... \r\n",
      "... ... 2021-2-23 16:2:45 Iteration 12 of 100\r\n",
      "... ... 2021-2-23 16:2:45 Total Energy -112.544820586\r\n",
      "... ... 2021-2-23 16:2:45 DIIs error 2.81009037356e-06\r\n",
      "... ... 2021-2-23 16:2:45 Delta Etot -3.26195731759e-07\r\n",
      "... ... \r\n",
      "... ... 2021-2-23 16:2:45 Iteration 13 of 100\r\n",
      "... ... 2021-2-23 16:2:45 Total Energy -112.544820586\r\n",
      "... ... 2021-2-23 16:2:45 DIIs error 3.15397683452e-08\r\n",
      "... ... 2021-2-23 16:2:45 Delta Etot -1.22923893286e-11\r\n",
      "... ... 2021-2-23 16:2:45 Total Energy has converged to -1.22923893e-11[Ha] after 13 iterations. DIIS error is converged up to 3.15397683e-08\r\n",
      "... ... 2021-2-23 16:2:45 Final Single Point Energy -112.544820586 Ha\r\n",
      "... ... 2021-2-23 16:2:45 Final Local Exc contribution -10.3496627823 Ha\r\n",
      "... ... 2021-2-23 16:2:45 Final Non Local Ex contribution -3.29348712222 Ha\r\n",
      "... ...   Orbital energies: \r\n",
      "... ...   index occupation energy(Hartree) \r\n",
      "... ...      0      2   -19.2419926213\r\n",
      "... ...      1      2   -10.3171703227\r\n",
      "... ...      2      2   -1.1830184049\r\n",
      "... ...      3      2   -0.5764080921\r\n",
      "... ...      4      2   -0.4655877128\r\n",
      "... ...      5      2   -0.4655877123\r\n",
      "... ...      6      2   -0.3809220001\r\n",
      "... ...      7      0   -0.0347928718\r\n",
      "... ...      8      0   -0.0347928716\r\n",
      "... ...      9      0   +0.3130644352\r\n",
      "... ...     10      0   +0.7020411087\r\n",
      "... ...     11      0   +0.7020411088\r\n",
      "... ...     12      0   +0.7858424713\r\n",
      "... ...     13      0   +1.0523479967\r\n",
      "... ...     14      0   +1.4533267351\r\n",
      "... ...     15      0   +1.4533267353\r\n",
      "... ...     16      0   +1.5025454589\r\n",
      "... ...     17      0   +2.9062516318\r\n",
      "... ... 2021-2-23 16:2:45 Electric Dipole is[e*bohr]:\r\n",
      "\t\t dx=-0.0508623561866\r\n",
      "\t\t dy=2.28277005501e-09\r\n",
      "\t\t dz=2.28278242133e-09\r\n",
      "... ... Writing result to CO.orb\r\n",
      "... ... Parsing DFT data from CO.orb and CO.orb\r\n",
      "... ... QM energy[Hrt]: -112.54482059 \r\n",
      "... ... 2021-2-23 16:2:45 RPA level range [0:17]\r\n",
      "... ... 2021-2-23 16:2:45 GW  level range [0:17]\r\n",
      "... ... 2021-2-23 16:2:45 BSE level range occ[0:6]  virt[7:17]\r\n",
      "... ... 2021-2-23 16:2:45 BSE Hamiltonian has size 77x77\r\n",
      "... ...  BSE type: full\r\n",
      "... ...  BSE without Hqp offdiagonal elements\r\n",
      "... ...  Running GW as: evGW\r\n",
      "... ...  g_sc_limit [Hartree]: 1e-05\r\n",
      "... ...  gw_sc_limit [Hartree]: 1e-05\r\n",
      "... ...  Tasks: \r\n",
      "... ...  GW \r\n",
      "... ...  singlets \r\n",
      "... ...  Store: \r\n",
      "... ...  GW \r\n",
      "... ...  Sigma integration: ppm\r\n",
      "... ...  eta: 0.001\r\n",
      "... ...  Quadrature integration order : 12\r\n",
      "... ...  Quadrature integration scheme : legendre\r\n",
      "... ...  Alpha smoothing parameter : 0.001\r\n",
      "... ...  QP solver: grid\r\n",
      "... ...  QP grid steps: 1001\r\n",
      "... ...  QP grid spacing: 0.001\r\n",
      "... ...  evGW with Anderson update with history 20 using alpha 0.7\r\n",
      "... ... 2021-2-23 16:2:45 Using 2 threads\r\n",
      "... ... 2021-2-23 16:2:45 Using native Eigen implementation, no BLAS overload \r\n",
      "... ... 2021-2-23 16:2:45 Molecule Coordinates [A] \r\n",
      "... ...     0    C   -0.0010 0.0000 0.0000\r\n",
      "... ...     1    O   1.2000 0.0000 0.0000\r\n",
      "... ... 2021-2-23 16:2:45 DFT data was created by xtp\r\n",
      "... ... 2021-2-23 16:2:45 Loaded DFT Basis Set 3-21G\r\n",
      "... ... 2021-2-23 16:2:45 Filled DFT Basis of size 18\r\n",
      "... ... 2021-2-23 16:2:45 Loaded Auxbasis Set aux-def2-svp\r\n",
      "... ... 2021-2-23 16:2:45 Filled Auxbasis of size 96\r\n",
      "... ... 2021-2-23 16:2:45 Calculating Mmn_beta (3-center-repulsion x orbitals)  \r\n",
      "... ... 2021-2-23 16:2:45 Calculated Mmn_beta (3-center-repulsion x orbitals)  \r\n",
      "... ... 2021-2-23 16:2:45 Integrating Vxc in VOTCA with functional XC_HYB_GGA_XC_PBEH\r\n",
      "... ... 2021-2-23 16:2:45 Set hybrid exchange factor: 0.25\r\n",
      "... ... 2021-2-23 16:2:45 Calculated exchange-correlation expectation values \r\n",
      "... ... 2021-2-23 16:2:45 Calculated Hartree exchange contribution\r\n",
      "... ... 2021-2-23 16:2:45 Scissor shifting DFT energies by: 0 Hrt\r\n",
      "... ...   ====== Perturbative quasiparticle energies (Hartree) ====== \r\n",
      "... ...    DeltaHLGap = +0.289998 Hartree\r\n",
      "... ...   Level =    0 DFT = -19.2420 VXC = -2.3112 S-X = -3.6464 S-C = +0.5608 GWA = -20.0165\r\n",
      "... ...   Level =    1 DFT = -10.3172 VXC = -1.7029 S-X = -2.6729 S-C = +0.2826 GWA = -11.0046\r\n",
      "... ...   Level =    2 DFT = -1.1830 VXC = -0.6133 S-X = -0.9167 S-C = +0.1553 GWA = -1.3310\r\n",
      "... ...   Level =    3 DFT = -0.5764 VXC = -0.5626 S-X = -0.7696 S-C = +0.0853 GWA = -0.6980\r\n",
      "... ...   Level =    4 DFT = -0.4656 VXC = -0.5081 S-X = -0.6424 S-C = +0.0198 GWA = -0.5801\r\n",
      "... ...   Level =    5 DFT = -0.4656 VXC = -0.5081 S-X = -0.6424 S-C = +0.0198 GWA = -0.5801\r\n",
      "... ...   HOMO  =    6 DFT = -0.3809 VXC = -0.4455 S-X = -0.5900 S-C = +0.0344 GWA = -0.4910\r\n",
      "... ...   LUMO  =    7 DFT = -0.0348 VXC = -0.4302 S-X = -0.2454 S-C = -0.0049 GWA = +0.1451\r\n",
      "... ...   Level =    8 DFT = -0.0348 VXC = -0.4302 S-X = -0.2454 S-C = -0.0049 GWA = +0.1451\r\n",
      "... ...   Level =    9 DFT = +0.3131 VXC = -0.3263 S-X = -0.1507 S-C = -0.0130 GWA = +0.4758\r\n",
      "... ...   Level =   10 DFT = +0.7020 VXC = -0.3343 S-X = -0.0931 S-C = -0.0698 GWA = +0.8735\r\n",
      "... ...   Level =   11 DFT = +0.7020 VXC = -0.3343 S-X = -0.0931 S-C = -0.0698 GWA = +0.8735\r\n",
      "... ...   Level =   12 DFT = +0.7858 VXC = -0.4740 S-X = -0.2015 S-C = -0.0614 GWA = +0.9969\r\n",
      "... ...   Level =   13 DFT = +1.0523 VXC = -0.4110 S-X = -0.1756 S-C = -0.0811 GWA = +1.2067\r\n",
      "... ...   Level =   14 DFT = +1.4533 VXC = -0.5240 S-X = -0.1917 S-C = -0.2321 GWA = +1.5535\r\n",
      "... ...   Level =   15 DFT = +1.4533 VXC = -0.5240 S-X = -0.1917 S-C = -0.2321 GWA = +1.5535\r\n",
      "... ...   Level =   16 DFT = +1.5025 VXC = -0.5044 S-X = -0.1976 S-C = -0.1226 GWA = +1.6867\r\n",
      "... ...   Level =   17 DFT = +2.9063 VXC = -0.5573 S-X = -0.2106 S-C = +0.0443 GWA = +3.2973\r\n",
      "... ... 2021-2-23 16:2:46 Calculated offdiagonal part of Sigma  \r\n",
      "... ... 2021-2-23 16:2:46 Full quasiparticle Hamiltonian  \r\n",
      "... ...   ====== Diagonalized quasiparticle energies (Hartree) ====== \r\n",
      "... ...   Level =    0 PQP = -20.016506 DQP = -20.016768 \r\n",
      "... ...   Level =    1 PQP = -11.004568 DQP = -11.004832 \r\n",
      "... ...   Level =    2 PQP = -1.331026 DQP = -1.331829 \r\n",
      "... ...   Level =    3 PQP = -0.697993 DQP = -0.698470 \r\n",
      "... ...   Level =    4 PQP = -0.580133 DQP = -0.585022 \r\n",
      "... ...   Level =    5 PQP = -0.580133 DQP = -0.585022 \r\n",
      "... ...   HOMO  =    6 PQP = -0.491028 DQP = -0.491359 \r\n",
      "... ...   LUMO  =    7 PQP = +0.145099 DQP = +0.143300 \r\n",
      "... ...   Level =    8 PQP = +0.145099 DQP = +0.143300 \r\n",
      "... ...   Level =    9 PQP = +0.475757 DQP = +0.473245 \r\n",
      "... ...   Level =   10 PQP = +0.873461 DQP = +0.873384 \r\n",
      "... ...   Level =   11 PQP = +0.873461 DQP = +0.873384 \r\n",
      "... ...   Level =   12 PQP = +0.996939 DQP = +0.994504 \r\n",
      "... ...   Level =   13 PQP = +1.206719 DQP = +1.208374 \r\n",
      "... ...   Level =   14 PQP = +1.553534 DQP = +1.560299 \r\n",
      "... ...   Level =   15 PQP = +1.553534 DQP = +1.560299 \r\n",
      "... ...   Level =   16 PQP = +1.686704 DQP = +1.679212 \r\n",
      "... ...   Level =   17 PQP = +3.297271 DQP = +3.310193 \r\n",
      "... ... 2021-2-23 16:2:46 Diagonalized QP Hamiltonian  \r\n",
      "... ... 2021-2-23 16:2:46 Setup Full singlet hamiltonian \r\n",
      "... ... 2021-2-23 16:2:46 Davidson Solver using 2 threads.\r\n",
      "... ... 2021-2-23 16:2:46 Tolerance : 0.0001\r\n",
      "... ... 2021-2-23 16:2:46 DPR Correction\r\n",
      "... ... 2021-2-23 16:2:46 Matrix size : 154x154\r\n",
      "... ... 2021-2-23 16:2:46 iter\tSearch Space\tNorm\r\n",
      "... ... 2021-2-23 16:2:46    0           10 \t 1.29e-01 \t  0.00% converged\r\n",
      "... ... 2021-2-23 16:2:46    1           17 \t 1.63e-02 \t  0.00% converged\r\n",
      "... ... 2021-2-23 16:2:46    2           24 \t 1.35e-03 \t 40.00% converged\r\n",
      "... ... 2021-2-23 16:2:46    3           29 \t 1.04e-04 \t 80.00% converged\r\n",
      "... ... 2021-2-23 16:2:46    4           31 \t 8.50e-05 \t 100.00% converged\r\n",
      "... ... 2021-2-23 16:2:46 Davidson converged after 4 iterations.\r\n",
      "... ... 2021-2-23 16:2:46-----------------------------------\r\n",
      "... ... 2021-2-23 16:2:46- Davidson ran for 0.01150603secs.\r\n",
      "... ... 2021-2-23 16:2:46-----------------------------------\r\n",
      "... ... 2021-2-23 16:2:46 Solved BSE for singlets \r\n",
      "... ...   ====== singlet energies (eV) ====== \r\n",
      "... ...   S =    1 Omega = +7.787913524188 eV  lamdba = +159.22 nm <FT> = +18.1750 <K_x> = +1.7187 <K_d> = -12.1059\r\n",
      "... ...            TrDipole length gauge[e*bohr]  dx = +0.0000 dy = +0.3329 dz = -0.3329 |d|^2 = +0.2217 f = +0.0423\r\n",
      "... ...            HOMO-0   -> LUMO+1    : 95.0%\r\n",
      "... ... \r\n",
      "... ...   S =    2 Omega = +7.787820077831 eV  lamdba = +159.22 nm <FT> = +18.1753 <K_x> = +1.7186 <K_d> = -12.1061\r\n",
      "... ...            TrDipole length gauge[e*bohr]  dx = +0.0000 dy = -0.3329 dz = -0.3329 |d|^2 = +0.2216 f = +0.0423\r\n",
      "... ...            HOMO-0   -> LUMO+0    : 95.0%\r\n",
      "... ... \r\n",
      "... ...   S =    3 Omega = +8.590135153836 eV  lamdba = +144.35 nm <FT> = +19.9162 <K_x> = +0.0000 <K_d> = -11.3262\r\n",
      "... ...            TrDipole length gauge[e*bohr]  dx = +0.0000 dy = -0.0000 dz = +0.0000 |d|^2 = +0.0000 f = +0.0000\r\n",
      "... ... \r\n",
      "... ...   S =    4 Omega = +9.193042119302 eV  lamdba = +134.88 nm <FT> = +19.8446 <K_x> = +1.4906 <K_d> = -12.1422\r\n",
      "... ...            TrDipole length gauge[e*bohr]  dx = +0.0000 dy = -0.0000 dz = +0.0000 |d|^2 = +0.0000 f = +0.0000\r\n",
      "... ... \r\n",
      "... ...   S =    5 Omega = +9.193032850553 eV  lamdba = +134.88 nm <FT> = +19.8446 <K_x> = +1.4906 <K_d> = -12.1421\r\n",
      "... ...            TrDipole length gauge[e*bohr]  dx = -0.0000 dy = +0.0000 dz = +0.0000 |d|^2 = +0.0000 f = +0.0000\r\n",
      "... ... \r\n",
      "... ... 2021-2-23 16:2:46 GWBSE calculation finished \r\n",
      "... ... Next State is: s1\r\n",
      "... ... 2021-2-23 16:2:46 Using 2 threads\r\n",
      "... ... 2021-2-23 16:2:46 Using native Eigen implementation, no BLAS overload \r\n",
      "... ...  Molecule Coordinates [A] \r\n",
      "... ...   C   +0.0000 +0.0010 +0.0000\r\n",
      "... ...   O   +1.2000 +0.0000 +0.0000\r\n",
      "... ... 2021-2-23 16:2:46 Loaded DFT Basis Set 3-21G with 18 functions\r\n",
      "... ... 2021-2-23 16:2:46 Loaded AUX Basis Set aux-def2-svp with 96 functions\r\n",
      "... ... 2021-2-23 16:2:46 Total number of electrons: 14\r\n",
      "... ... 2021-2-23 16:2:46 Smallest value of AOOverlap matrix is 0.0512998836453\r\n",
      "... ... 2021-2-23 16:2:46 Removed 0 basisfunction from inverse overlap matrix\r\n",
      "... ... 2021-2-23 16:2:46 Convergence Options:\r\n",
      "... ... \t\t Delta E [Ha]: 1e-07\r\n",
      "... ... \t\t DIIS max error: 1e-07\r\n",
      "... ... \t\t DIIS histlength: 20\r\n",
      "... ... \t\t ADIIS start: 0.8\r\n",
      "... ... \t\t DIIS start: 0.002\r\n",
      "... ... \t\t Deleting oldest element from DIIS hist\r\n",
      "... ... \t\t Levelshift[Ha]: 0\r\n",
      "... ... \t\t Levelshift end: 0.2\r\n",
      "... ... \t\t Mixing Parameter alpha: 0.7\r\n",
      "... ... 2021-2-23 16:2:46 Setup invariant parts of Electron Repulsion integrals \r\n",
      "... ... 2021-2-23 16:2:46 Constructed independent particle hamiltonian \r\n",
      "... ... 2021-2-23 16:2:46 Nuclear Repulsion Energy is 21.1670826\r\n",
      "... ... 2021-2-23 16:2:46 Using hybrid functional with alpha=0.25\r\n",
      "... ... 2021-2-23 16:2:46 Setup numerical integration grid medium for vxc functional XC_HYB_GGA_XC_PBEH\r\n",
      "... ... 2021-2-23 16:2:46 Setup Initial Guess using: atom\r\n",
      "... ... 2021-2-23 16:2:46 Calculating atom density for C\r\n",
      "... ... 2021-2-23 16:2:47 Calculating atom density for O\r\n",
      "... ... 2021-2-23 16:2:48 STARTING SCF cycle\r\n",
      "... ...  --------------------------------------------------------------------------\r\n",
      "... ... \r\n",
      "... ... 2021-2-23 16:2:48 Iteration 1 of 100\r\n",
      "... ... 2021-2-23 16:2:48 Total Energy -112.364024991\r\n",
      "... ... 2021-2-23 16:2:48 DIIs error 0.359321921435\r\n",
      "... ... 2021-2-23 16:2:48 Delta Etot 0\r\n",
      "... ... \r\n",
      "... ... 2021-2-23 16:2:48 Iteration 2 of 100\r\n",
      "... ... 2021-2-23 16:2:48 Total Energy -112.398765589\r\n",
      "... ... 2021-2-23 16:2:48 DIIs error 0.138321958878\r\n",
      "... ... 2021-2-23 16:2:48 Delta Etot -0.0347405978275\r\n",
      "... ... \r\n",
      "... ... 2021-2-23 16:2:48 Iteration 3 of 100\r\n",
      "... ... 2021-2-23 16:2:48 Total Energy -112.443354777\r\n",
      "... ... 2021-2-23 16:2:48 DIIs error 0.100141210607\r\n",
      "... ... 2021-2-23 16:2:48 Delta Etot -0.0445891879261\r\n",
      "... ... \r\n",
      "... ... 2021-2-23 16:2:48 Iteration 4 of 100\r\n",
      "... ... 2021-2-23 16:2:48 Total Energy -112.52443578\r\n",
      "... ... 2021-2-23 16:2:48 DIIs error 0.119415112975\r\n",
      "... ... 2021-2-23 16:2:48 Delta Etot -0.0810810031856\r\n",
      "... ... \r\n",
      "... ... 2021-2-23 16:2:48 Iteration 5 of 100\r\n",
      "... ... 2021-2-23 16:2:48 Total Energy -112.509129962\r\n",
      "... ... 2021-2-23 16:2:48 DIIs error 0.164194298053\r\n",
      "... ... 2021-2-23 16:2:48 Delta Etot 0.0153058178996\r\n",
      "... ... \r\n",
      "... ... 2021-2-23 16:2:48 Iteration 6 of 100\r\n",
      "... ... 2021-2-23 16:2:48 Total Energy -112.544503758\r\n",
      "... ... 2021-2-23 16:2:48 DIIs error 0.0180016177808\r\n",
      "... ... 2021-2-23 16:2:48 Delta Etot -0.0353737954826\r\n",
      "... ... \r\n",
      "... ... 2021-2-23 16:2:48 Iteration 7 of 100\r\n",
      "... ... 2021-2-23 16:2:48 Total Energy -112.542042408\r\n",
      "... ... 2021-2-23 16:2:48 DIIs error 0.0466922029926\r\n",
      "... ... 2021-2-23 16:2:48 Delta Etot 0.00246134968442\r\n",
      "... ... \r\n",
      "... ... 2021-2-23 16:2:48 Iteration 8 of 100\r\n",
      "... ... 2021-2-23 16:2:48 Total Energy -112.544746967\r\n",
      "... ... 2021-2-23 16:2:48 DIIs error 0.0132336170981\r\n",
      "... ... 2021-2-23 16:2:48 Delta Etot -0.00270455882422\r\n",
      "... ... \r\n",
      "... ... 2021-2-23 16:2:48 Iteration 9 of 100\r\n",
      "... ... 2021-2-23 16:2:48 Total Energy -112.544969614\r\n",
      "... ... 2021-2-23 16:2:48 DIIs error 0.00370924964201\r\n",
      "... ... 2021-2-23 16:2:48 Delta Etot -0.000222647272821\r\n",
      "... ... \r\n",
      "... ... 2021-2-23 16:2:48 Iteration 10 of 100\r\n",
      "... ... 2021-2-23 16:2:48 Total Energy -112.544954135\r\n",
      "... ... 2021-2-23 16:2:48 DIIs error 0.0050414641044\r\n",
      "... ... 2021-2-23 16:2:48 Delta Etot 1.54793134328e-05\r\n",
      "... ... \r\n",
      "... ... 2021-2-23 16:2:48 Iteration 11 of 100\r\n",
      "... ... 2021-2-23 16:2:48 Total Energy -112.544987426\r\n",
      "... ... 2021-2-23 16:2:48 DIIs error 0.000644432595826\r\n",
      "... ... 2021-2-23 16:2:48 Delta Etot -3.32915518158e-05\r\n",
      "... ... \r\n",
      "... ... 2021-2-23 16:2:48 Iteration 12 of 100\r\n",
      "... ... 2021-2-23 16:2:48 Total Energy -112.54498798\r\n",
      "... ... 2021-2-23 16:2:48 DIIs error 3.26552106881e-06\r\n",
      "... ... 2021-2-23 16:2:48 Delta Etot -5.54009389475e-07\r\n",
      "... ... \r\n",
      "... ... 2021-2-23 16:2:48 Iteration 13 of 100\r\n",
      "... ... 2021-2-23 16:2:48 Total Energy -112.54498798\r\n",
      "... ... 2021-2-23 16:2:48 DIIs error 7.54777556679e-08\r\n",
      "... ... 2021-2-23 16:2:48 Delta Etot -1.60582658282e-11\r\n",
      "... ... 2021-2-23 16:2:48 Total Energy has converged to -1.60582658e-11[Ha] after 13 iterations. DIIS error is converged up to 7.54777557e-08\r\n",
      "... ... 2021-2-23 16:2:48 Final Single Point Energy -112.54498798 Ha\r\n",
      "... ... 2021-2-23 16:2:48 Final Local Exc contribution -10.3503041024 Ha\r\n",
      "... ... 2021-2-23 16:2:48 Final Non Local Ex contribution -3.29374449897 Ha\r\n",
      "... ...   Orbital energies: \r\n",
      "... ...   index occupation energy(Hartree) \r\n",
      "... ...      0      2   -19.2419937513\r\n",
      "... ...      1      2   -10.3169082132\r\n",
      "... ...      2      2   -1.1836191105\r\n",
      "... ...      3      2   -0.5763876149\r\n",
      "... ...      4      2   -0.4659218191\r\n",
      "... ...      5      2   -0.4659218186\r\n",
      "... ...      6      2   -0.3808546905\r\n",
      "... ...      7      0   -0.0344357384\r\n",
      "... ...      8      0   -0.0344357382\r\n",
      "... ...      9      0   +0.3134901240\r\n",
      "... ...     10      0   +0.7020321485\r\n",
      "... ...     11      0   +0.7020321486\r\n",
      "... ...     12      0   +0.7868483051\r\n",
      "... ...     13      0   +1.0527231897\r\n",
      "... ...     14      0   +1.4533786266\r\n",
      "... ...     15      0   +1.4533786269\r\n",
      "... ...     16      0   +1.5020572717\r\n",
      "... ...     17      0   +2.9071371711\r\n",
      "... ... 2021-2-23 16:2:48 Electric Dipole is[e*bohr]:\r\n",
      "\t\t dx=-0.0497752031568\r\n",
      "\t\t dy=4.14706655723e-05\r\n",
      "\t\t dz=2.24004484723e-09\r\n",
      "... ... Writing result to CO.orb\r\n",
      "... ... Parsing DFT data from CO.orb and CO.orb\r\n",
      "... ... QM energy[Hrt]: -112.54498798 \r\n",
      "... ... 2021-2-23 16:2:48 RPA level range [0:17]\r\n",
      "... ... 2021-2-23 16:2:48 GW  level range [0:17]\r\n",
      "... ... 2021-2-23 16:2:48 BSE level range occ[0:6]  virt[7:17]\r\n",
      "... ... 2021-2-23 16:2:48 BSE Hamiltonian has size 77x77\r\n",
      "... ...  BSE type: full\r\n",
      "... ...  BSE without Hqp offdiagonal elements\r\n",
      "... ...  Running GW as: evGW\r\n",
      "... ...  g_sc_limit [Hartree]: 1e-05\r\n",
      "... ...  gw_sc_limit [Hartree]: 1e-05\r\n",
      "... ...  Tasks: \r\n",
      "... ...  GW \r\n",
      "... ...  singlets \r\n",
      "... ...  Store: \r\n",
      "... ...  GW \r\n",
      "... ...  Sigma integration: ppm\r\n",
      "... ...  eta: 0.001\r\n",
      "... ...  Quadrature integration order : 12\r\n",
      "... ...  Quadrature integration scheme : legendre\r\n",
      "... ...  Alpha smoothing parameter : 0.001\r\n",
      "... ...  QP solver: grid\r\n",
      "... ...  QP grid steps: 1001\r\n",
      "... ...  QP grid spacing: 0.001\r\n",
      "... ...  evGW with Anderson update with history 20 using alpha 0.7\r\n",
      "... ... 2021-2-23 16:2:48 Using 2 threads\r\n",
      "... ... 2021-2-23 16:2:48 Using native Eigen implementation, no BLAS overload \r\n",
      "... ... 2021-2-23 16:2:48 Molecule Coordinates [A] \r\n",
      "... ...     0    C   0.0000 0.0010 0.0000\r\n",
      "... ...     1    O   1.2000 0.0000 0.0000\r\n",
      "... ... 2021-2-23 16:2:48 DFT data was created by xtp\r\n",
      "... ... 2021-2-23 16:2:48 Loaded DFT Basis Set 3-21G\r\n",
      "... ... 2021-2-23 16:2:48 Filled DFT Basis of size 18\r\n",
      "... ... 2021-2-23 16:2:48 Loaded Auxbasis Set aux-def2-svp\r\n",
      "... ... 2021-2-23 16:2:48 Filled Auxbasis of size 96\r\n",
      "... ... 2021-2-23 16:2:48 Calculating Mmn_beta (3-center-repulsion x orbitals)  \r\n",
      "... ... 2021-2-23 16:2:48 Calculated Mmn_beta (3-center-repulsion x orbitals)  \r\n",
      "... ... 2021-2-23 16:2:48 Integrating Vxc in VOTCA with functional XC_HYB_GGA_XC_PBEH\r\n",
      "... ... 2021-2-23 16:2:48 Set hybrid exchange factor: 0.25\r\n",
      "... ... 2021-2-23 16:2:48 Calculated exchange-correlation expectation values \r\n",
      "... ... 2021-2-23 16:2:48 Calculated Hartree exchange contribution\r\n",
      "... ... 2021-2-23 16:2:48 Scissor shifting DFT energies by: 0 Hrt\r\n",
      "... ...   ====== Perturbative quasiparticle energies (Hartree) ====== \r\n",
      "... ...    DeltaHLGap = +0.290044 Hartree\r\n",
      "... ...   Level =    0 DFT = -19.2420 VXC = -2.3112 S-X = -3.6465 S-C = +0.5606 GWA = -20.0167\r\n",
      "... ...   Level =    1 DFT = -10.3169 VXC = -1.7029 S-X = -2.6729 S-C = +0.2825 GWA = -11.0044\r\n",
      "... ...   Level =    2 DFT = -1.1836 VXC = -0.6135 S-X = -0.9170 S-C = +0.1554 GWA = -1.3317\r\n",
      "... ...   Level =    3 DFT = -0.5764 VXC = -0.5629 S-X = -0.7699 S-C = +0.0854 GWA = -0.6980\r\n",
      "... ...   Level =    4 DFT = -0.4659 VXC = -0.5082 S-X = -0.6426 S-C = +0.0198 GWA = -0.5805\r\n",
      "... ...   Level =    5 DFT = -0.4659 VXC = -0.5082 S-X = -0.6426 S-C = +0.0198 GWA = -0.5805\r\n",
      "... ...   HOMO  =    6 DFT = -0.3809 VXC = -0.4454 S-X = -0.5899 S-C = +0.0344 GWA = -0.4910\r\n",
      "... ...   LUMO  =    7 DFT = -0.0344 VXC = -0.4302 S-X = -0.2454 S-C = -0.0049 GWA = +0.1455\r\n",
      "... ...   Level =    8 DFT = -0.0344 VXC = -0.4302 S-X = -0.2454 S-C = -0.0049 GWA = +0.1455\r\n",
      "... ...   Level =    9 DFT = +0.3135 VXC = -0.3257 S-X = -0.1502 S-C = -0.0129 GWA = +0.4760\r\n",
      "... ...   Level =   10 DFT = +0.7020 VXC = -0.3344 S-X = -0.0932 S-C = -0.0697 GWA = +0.8735\r\n",
      "... ...   Level =   11 DFT = +0.7020 VXC = -0.3344 S-X = -0.0932 S-C = -0.0697 GWA = +0.8735\r\n",
      "... ...   Level =   12 DFT = +0.7868 VXC = -0.4742 S-X = -0.2016 S-C = -0.0615 GWA = +0.9979\r\n",
      "... ...   Level =   13 DFT = +1.0527 VXC = -0.4116 S-X = -0.1759 S-C = -0.0810 GWA = +1.2073\r\n",
      "... ...   Level =   14 DFT = +1.4534 VXC = -0.5240 S-X = -0.1917 S-C = -0.2315 GWA = +1.5542\r\n",
      "... ...   Level =   15 DFT = +1.4534 VXC = -0.5240 S-X = -0.1917 S-C = -0.2315 GWA = +1.5542\r\n",
      "... ...   Level =   16 DFT = +1.5021 VXC = -0.5043 S-X = -0.1976 S-C = -0.1220 GWA = +1.6867\r\n",
      "... ...   Level =   17 DFT = +2.9071 VXC = -0.5572 S-X = -0.2105 S-C = +0.0445 GWA = +3.2983\r\n",
      "... ... 2021-2-23 16:2:49 Calculated offdiagonal part of Sigma  \r\n",
      "... ... 2021-2-23 16:2:49 Full quasiparticle Hamiltonian  \r\n",
      "... ...   ====== Diagonalized quasiparticle energies (Hartree) ====== \r\n",
      "... ...   Level =    0 PQP = -20.016664 DQP = -20.016926 \r\n",
      "... ...   Level =    1 PQP = -11.004366 DQP = -11.004631 \r\n",
      "... ...   Level =    2 PQP = -1.331695 DQP = -1.332497 \r\n",
      "... ...   Level =    3 PQP = -0.698040 DQP = -0.698522 \r\n",
      "... ...   Level =    4 PQP = -0.580520 DQP = -0.585349 \r\n",
      "... ...   Level =    5 PQP = -0.580520 DQP = -0.585349 \r\n",
      "... ...   HOMO  =    6 PQP = -0.490989 DQP = -0.491326 \r\n",
      "... ...   LUMO  =    7 PQP = +0.145473 DQP = +0.143671 \r\n",
      "... ...   Level =    8 PQP = +0.145473 DQP = +0.143671 \r\n",
      "... ...   Level =    9 PQP = +0.476044 DQP = +0.473544 \r\n",
      "... ...   Level =   10 PQP = +0.873522 DQP = +0.873477 \r\n",
      "... ...   Level =   11 PQP = +0.873522 DQP = +0.873477 \r\n",
      "... ...   Level =   12 PQP = +0.997914 DQP = +0.995402 \r\n",
      "... ...   Level =   13 PQP = +1.207342 DQP = +1.209038 \r\n",
      "... ...   Level =   14 PQP = +1.554224 DQP = +1.560900 \r\n",
      "... ...   Level =   15 PQP = +1.554224 DQP = +1.560900 \r\n",
      "... ...   Level =   16 PQP = +1.686736 DQP = +1.679245 \r\n",
      "... ...   Level =   17 PQP = +3.298307 DQP = +3.311262 \r\n",
      "... ... 2021-2-23 16:2:49 Diagonalized QP Hamiltonian  \r\n",
      "... ... 2021-2-23 16:2:49 Setup Full singlet hamiltonian \r\n",
      "... ... 2021-2-23 16:2:49 Davidson Solver using 2 threads.\r\n",
      "... ... 2021-2-23 16:2:49 Tolerance : 0.0001\r\n",
      "... ... 2021-2-23 16:2:49 DPR Correction\r\n",
      "... ... 2021-2-23 16:2:49 Matrix size : 154x154\r\n",
      "... ... 2021-2-23 16:2:49 iter\tSearch Space\tNorm\r\n",
      "... ... 2021-2-23 16:2:49    0           10 \t 1.29e-01 \t  0.00% converged\r\n",
      "... ... 2021-2-23 16:2:49    1           17 \t 1.63e-02 \t  0.00% converged\r\n",
      "... ... 2021-2-23 16:2:49    2           24 \t 1.35e-03 \t 20.00% converged\r\n",
      "... ... 2021-2-23 16:2:49    3           30 \t 2.72e-03 \t 60.00% converged\r\n",
      "... ... 2021-2-23 16:2:49    4           33 \t 2.50e-04 \t 80.00% converged\r\n",
      "... ... 2021-2-23 16:2:49    5           35 \t 5.74e-05 \t 100.00% converged\r\n",
      "... ... 2021-2-23 16:2:49 Davidson converged after 5 iterations.\r\n",
      "... ... 2021-2-23 16:2:49-----------------------------------\r\n",
      "... ... 2021-2-23 16:2:49- Davidson ran for 0.01498384secs.\r\n",
      "... ... 2021-2-23 16:2:49-----------------------------------\r\n",
      "... ... 2021-2-23 16:2:49 Solved BSE for singlets \r\n",
      "... ...   ====== singlet energies (eV) ====== \r\n",
      "... ...   S =    1 Omega = +7.799076387685 eV  lamdba = +158.99 nm <FT> = +18.1848 <K_x> = +1.7214 <K_d> = -12.1072\r\n",
      "... ...            TrDipole length gauge[e*bohr]  dx = -0.0003 dy = -0.3354 dz = +0.3317 |d|^2 = +0.2226 f = +0.0425\r\n",
      "... ...            HOMO-0   -> LUMO+1    : 94.7%\r\n",
      "... ... \r\n",
      "... ...   S =    2 Omega = +7.798981282539 eV  lamdba = +159.00 nm <FT> = +18.1850 <K_x> = +1.7212 <K_d> = -12.1073\r\n",
      "... ...            TrDipole length gauge[e*bohr]  dx = +0.0003 dy = +0.3317 dz = +0.3354 |d|^2 = +0.2225 f = +0.0425\r\n",
      "... ...            HOMO-0   -> LUMO+0    : 94.7%\r\n",
      "... ... \r\n",
      "... ...   S =    3 Omega = +8.608668508794 eV  lamdba = +144.04 nm <FT> = +19.9373 <K_x> = +0.0000 <K_d> = -11.3287\r\n",
      "... ...            TrDipole length gauge[e*bohr]  dx = -0.0000 dy = +0.0000 dz = -0.0000 |d|^2 = +0.0000 f = +0.0000\r\n",
      "... ... \r\n",
      "... ...   S =    4 Omega = +9.211628171313 eV  lamdba = +134.61 nm <FT> = +19.8654 <K_x> = +1.4910 <K_d> = -12.1448\r\n",
      "... ...            TrDipole length gauge[e*bohr]  dx = +0.0000 dy = -0.0000 dz = +0.0000 |d|^2 = +0.0000 f = +0.0000\r\n",
      "... ... \r\n",
      "... ...   S =    5 Omega = +13.884495355830 eV  lamdba = +89.31 nm <FT> = +24.0103 <K_x> = +3.1686 <K_d> = -13.2944\r\n",
      "... ...            TrDipole length gauge[e*bohr]  dx = -0.8277 dy = +0.0007 dz = +0.0000 |d|^2 = +0.6852 f = +0.2331\r\n",
      "... ... \r\n",
      "... ... 2021-2-23 16:2:49 GWBSE calculation finished \r\n",
      "... ... Next State is: s1\r\n",
      "... ... 2021-2-23 16:2:49 Using 2 threads\r\n",
      "... ... 2021-2-23 16:2:49 Using native Eigen implementation, no BLAS overload \r\n",
      "... ...  Molecule Coordinates [A] \r\n",
      "... ...   C   +0.0000 -0.0010 +0.0000\r\n",
      "... ...   O   +1.2000 +0.0000 +0.0000\r\n",
      "... ... 2021-2-23 16:2:49 Loaded DFT Basis Set 3-21G with 18 functions\r\n",
      "... ... 2021-2-23 16:2:49 Loaded AUX Basis Set aux-def2-svp with 96 functions\r\n",
      "... ... 2021-2-23 16:2:49 Total number of electrons: 14\r\n",
      "... ... 2021-2-23 16:2:49 Smallest value of AOOverlap matrix is 0.0512998836453\r\n",
      "... ... 2021-2-23 16:2:49 Removed 0 basisfunction from inverse overlap matrix\r\n",
      "... ... 2021-2-23 16:2:49 Convergence Options:\r\n",
      "... ... \t\t Delta E [Ha]: 1e-07\r\n",
      "... ... \t\t DIIS max error: 1e-07\r\n",
      "... ... \t\t DIIS histlength: 20\r\n",
      "... ... \t\t ADIIS start: 0.8\r\n",
      "... ... \t\t DIIS start: 0.002\r\n",
      "... ... \t\t Deleting oldest element from DIIS hist\r\n",
      "... ... \t\t Levelshift[Ha]: 0\r\n",
      "... ... \t\t Levelshift end: 0.2\r\n",
      "... ... \t\t Mixing Parameter alpha: 0.7\r\n",
      "... ... 2021-2-23 16:2:49 Setup invariant parts of Electron Repulsion integrals \r\n",
      "... ... 2021-2-23 16:2:49 Constructed independent particle hamiltonian \r\n",
      "... ... 2021-2-23 16:2:49 Nuclear Repulsion Energy is 21.1670826\r\n",
      "... ... 2021-2-23 16:2:49 Using hybrid functional with alpha=0.25\r\n",
      "... ... 2021-2-23 16:2:49 Setup numerical integration grid medium for vxc functional XC_HYB_GGA_XC_PBEH\r\n",
      "... ... 2021-2-23 16:2:49 Setup Initial Guess using: atom\r\n",
      "... ... 2021-2-23 16:2:49 Calculating atom density for C\r\n",
      "... ... 2021-2-23 16:2:50 Calculating atom density for O\r\n",
      "... ... 2021-2-23 16:2:51 STARTING SCF cycle\r\n",
      "... ...  --------------------------------------------------------------------------\r\n",
      "... ... \r\n",
      "... ... 2021-2-23 16:2:51 Iteration 1 of 100\r\n",
      "... ... 2021-2-23 16:2:51 Total Energy -112.364022374\r\n",
      "... ... 2021-2-23 16:2:51 DIIs error 0.359327786269\r\n",
      "... ... 2021-2-23 16:2:51 Delta Etot 0\r\n",
      "... ... \r\n",
      "... ... 2021-2-23 16:2:51 Iteration 2 of 100\r\n",
      "... ... 2021-2-23 16:2:51 Total Energy -112.398762253\r\n",
      "... ... 2021-2-23 16:2:51 DIIs error 0.138321286988\r\n",
      "... ... 2021-2-23 16:2:51 Delta Etot -0.0347398791082\r\n",
      "... ... \r\n",
      "... ... 2021-2-23 16:2:51 Iteration 3 of 100\r\n",
      "... ... 2021-2-23 16:2:51 Total Energy -112.443352396\r\n",
      "... ... 2021-2-23 16:2:51 DIIs error 0.100141324014\r\n",
      "... ... 2021-2-23 16:2:51 Delta Etot -0.0445901433858\r\n",
      "... ... \r\n",
      "... ... 2021-2-23 16:2:51 Iteration 4 of 100\r\n",
      "... ... 2021-2-23 16:2:51 Total Energy -112.524426015\r\n",
      "... ... 2021-2-23 16:2:51 DIIs error 0.11944025418\r\n",
      "... ... 2021-2-23 16:2:51 Delta Etot -0.08107361834\r\n",
      "... ... \r\n",
      "... ... 2021-2-23 16:2:51 Iteration 5 of 100\r\n",
      "... ... 2021-2-23 16:2:51 Total Energy -112.509144246\r\n",
      "... ... 2021-2-23 16:2:51 DIIs error 0.164162716018\r\n",
      "... ... 2021-2-23 16:2:51 Delta Etot 0.015281768816\r\n",
      "... ... \r\n",
      "... ... 2021-2-23 16:2:51 Iteration 6 of 100\r\n",
      "... ... 2021-2-23 16:2:51 Total Energy -112.544505272\r\n",
      "... ... 2021-2-23 16:2:51 DIIs error 0.0179720697713\r\n",
      "... ... 2021-2-23 16:2:51 Delta Etot -0.0353610267237\r\n",
      "... ... \r\n",
      "... ... 2021-2-23 16:2:51 Iteration 7 of 100\r\n",
      "... ... 2021-2-23 16:2:51 Total Energy -112.542052288\r\n",
      "... ... 2021-2-23 16:2:51 DIIs error 0.0466135795352\r\n",
      "... ... 2021-2-23 16:2:51 Delta Etot 0.00245298473072\r\n",
      "... ... \r\n",
      "... ... 2021-2-23 16:2:51 Iteration 8 of 100\r\n",
      "... ... 2021-2-23 16:2:51 Total Energy -112.544747847\r\n",
      "... ... 2021-2-23 16:2:51 DIIs error 0.013209026091\r\n",
      "... ... 2021-2-23 16:2:51 Delta Etot -0.00269555887168\r\n",
      "... ... \r\n",
      "... ... 2021-2-23 16:2:51 Iteration 9 of 100\r\n",
      "... ... 2021-2-23 16:2:51 Total Energy -112.544969634\r\n",
      "... ... 2021-2-23 16:2:51 DIIs error 0.003707246843\r\n",
      "... ... 2021-2-23 16:2:51 Delta Etot -0.000221787633748\r\n",
      "... ... \r\n",
      "... ... 2021-2-23 16:2:51 Iteration 10 of 100\r\n",
      "... ... 2021-2-23 16:2:51 Total Energy -112.544954284\r\n",
      "... ... 2021-2-23 16:2:51 DIIs error 0.00503033526247\r\n",
      "... ... 2021-2-23 16:2:51 Delta Etot 1.53503622755e-05\r\n",
      "... ... \r\n",
      "... ... 2021-2-23 16:2:51 Iteration 11 of 100\r\n",
      "... ... 2021-2-23 16:2:51 Total Energy -112.544987434\r\n",
      "... ... 2021-2-23 16:2:51 DIIs error 0.00063986151372\r\n",
      "... ... 2021-2-23 16:2:51 Delta Etot -3.31501184121e-05\r\n",
      "... ... \r\n",
      "... ... 2021-2-23 16:2:51 Iteration 12 of 100\r\n",
      "... ... 2021-2-23 16:2:51 Total Energy -112.54498798\r\n",
      "... ... 2021-2-23 16:2:51 DIIs error 3.2463448298e-06\r\n",
      "... ... 2021-2-23 16:2:51 Delta Etot -5.46206209151e-07\r\n",
      "... ... \r\n",
      "... ... 2021-2-23 16:2:51 Iteration 13 of 100\r\n",
      "... ... 2021-2-23 16:2:51 Total Energy -112.54498798\r\n",
      "... ... 2021-2-23 16:2:51 DIIs error 7.31518615771e-08\r\n",
      "... ... 2021-2-23 16:2:51 Delta Etot -1.60724766829e-11\r\n",
      "... ... 2021-2-23 16:2:51 Total Energy has converged to -1.60724767e-11[Ha] after 13 iterations. DIIS error is converged up to 7.31518616e-08\r\n",
      "... ... 2021-2-23 16:2:51 Final Single Point Energy -112.54498798 Ha\r\n",
      "... ... 2021-2-23 16:2:51 Final Local Exc contribution -10.3503041017 Ha\r\n",
      "... ... 2021-2-23 16:2:51 Final Non Local Ex contribution -3.29374449867 Ha\r\n",
      "... ...   Orbital energies: \r\n",
      "... ...   index occupation energy(Hartree) \r\n",
      "... ...      0      2   -19.2419937513\r\n",
      "... ...      1      2   -10.3169082130\r\n",
      "... ...      2      2   -1.1836191105\r\n",
      "... ...      3      2   -0.5763876149\r\n",
      "... ...      4      2   -0.4659218191\r\n",
      "... ...      5      2   -0.4659218186\r\n",
      "... ...      6      2   -0.3808546905\r\n",
      "... ...      7      0   -0.0344357384\r\n",
      "... ...      8      0   -0.0344357382\r\n",
      "... ...      9      0   +0.3134901240\r\n",
      "... ...     10      0   +0.7020321486\r\n",
      "... ...     11      0   +0.7020321487\r\n",
      "... ...     12      0   +0.7868483052\r\n",
      "... ...     13      0   +1.0527231897\r\n",
      "... ...     14      0   +1.4533786265\r\n",
      "... ...     15      0   +1.4533786268\r\n",
      "... ...     16      0   +1.5020572716\r\n",
      "... ...     17      0   +2.9071371711\r\n",
      "... ... 2021-2-23 16:2:51 Electric Dipole is[e*bohr]:\r\n",
      "\t\t dx=-0.0497752044756\r\n",
      "\t\t dy=-4.14661904958e-05\r\n",
      "\t\t dz=2.23617955348e-09\r\n",
      "... ... Writing result to CO.orb\r\n",
      "... ... Parsing DFT data from CO.orb and CO.orb\r\n",
      "... ... QM energy[Hrt]: -112.54498798 \r\n",
      "... ... 2021-2-23 16:2:51 RPA level range [0:17]\r\n",
      "... ... 2021-2-23 16:2:51 GW  level range [0:17]\r\n",
      "... ... 2021-2-23 16:2:51 BSE level range occ[0:6]  virt[7:17]\r\n",
      "... ... 2021-2-23 16:2:51 BSE Hamiltonian has size 77x77\r\n",
      "... ...  BSE type: full\r\n",
      "... ...  BSE without Hqp offdiagonal elements\r\n",
      "... ...  Running GW as: evGW\r\n",
      "... ...  g_sc_limit [Hartree]: 1e-05\r\n",
      "... ...  gw_sc_limit [Hartree]: 1e-05\r\n",
      "... ...  Tasks: \r\n",
      "... ...  GW \r\n",
      "... ...  singlets \r\n",
      "... ...  Store: \r\n",
      "... ...  GW \r\n",
      "... ...  Sigma integration: ppm\r\n",
      "... ...  eta: 0.001\r\n",
      "... ...  Quadrature integration order : 12\r\n",
      "... ...  Quadrature integration scheme : legendre\r\n",
      "... ...  Alpha smoothing parameter : 0.001\r\n",
      "... ...  QP solver: grid\r\n",
      "... ...  QP grid steps: 1001\r\n",
      "... ...  QP grid spacing: 0.001\r\n",
      "... ...  evGW with Anderson update with history 20 using alpha 0.7\r\n",
      "... ... 2021-2-23 16:2:51 Using 2 threads\r\n",
      "... ... 2021-2-23 16:2:51 Using native Eigen implementation, no BLAS overload \r\n",
      "... ... 2021-2-23 16:2:51 Molecule Coordinates [A] \r\n",
      "... ...     0    C   0.0000 -0.0010 0.0000\r\n",
      "... ...     1    O   1.2000 0.0000 0.0000\r\n",
      "... ... 2021-2-23 16:2:51 DFT data was created by xtp\r\n",
      "... ... 2021-2-23 16:2:51 Loaded DFT Basis Set 3-21G\r\n",
      "... ... 2021-2-23 16:2:51 Filled DFT Basis of size 18\r\n",
      "... ... 2021-2-23 16:2:51 Loaded Auxbasis Set aux-def2-svp\r\n",
      "... ... 2021-2-23 16:2:51 Filled Auxbasis of size 96\r\n",
      "... ... 2021-2-23 16:2:51 Calculating Mmn_beta (3-center-repulsion x orbitals)  \r\n",
      "... ... 2021-2-23 16:2:51 Calculated Mmn_beta (3-center-repulsion x orbitals)  \r\n",
      "... ... 2021-2-23 16:2:51 Integrating Vxc in VOTCA with functional XC_HYB_GGA_XC_PBEH\r\n",
      "... ... 2021-2-23 16:2:51 Set hybrid exchange factor: 0.25\r\n",
      "... ... 2021-2-23 16:2:51 Calculated exchange-correlation expectation values \r\n",
      "... ... 2021-2-23 16:2:51 Calculated Hartree exchange contribution\r\n",
      "... ... 2021-2-23 16:2:51 Scissor shifting DFT energies by: 0 Hrt\r\n",
      "... ...   ====== Perturbative quasiparticle energies (Hartree) ====== \r\n",
      "... ...    DeltaHLGap = +0.290044 Hartree\r\n",
      "... ...   Level =    0 DFT = -19.2420 VXC = -2.3112 S-X = -3.6465 S-C = +0.5606 GWA = -20.0167\r\n",
      "... ...   Level =    1 DFT = -10.3169 VXC = -1.7029 S-X = -2.6729 S-C = +0.2825 GWA = -11.0044\r\n",
      "... ...   Level =    2 DFT = -1.1836 VXC = -0.6135 S-X = -0.9170 S-C = +0.1554 GWA = -1.3317\r\n",
      "... ...   Level =    3 DFT = -0.5764 VXC = -0.5629 S-X = -0.7699 S-C = +0.0854 GWA = -0.6980\r\n",
      "... ...   Level =    4 DFT = -0.4659 VXC = -0.5082 S-X = -0.6426 S-C = +0.0198 GWA = -0.5805\r\n",
      "... ...   Level =    5 DFT = -0.4659 VXC = -0.5082 S-X = -0.6426 S-C = +0.0198 GWA = -0.5805\r\n",
      "... ...   HOMO  =    6 DFT = -0.3809 VXC = -0.4454 S-X = -0.5899 S-C = +0.0344 GWA = -0.4910\r\n",
      "... ...   LUMO  =    7 DFT = -0.0344 VXC = -0.4302 S-X = -0.2454 S-C = -0.0049 GWA = +0.1455\r\n",
      "... ...   Level =    8 DFT = -0.0344 VXC = -0.4302 S-X = -0.2454 S-C = -0.0049 GWA = +0.1455\r\n",
      "... ...   Level =    9 DFT = +0.3135 VXC = -0.3257 S-X = -0.1502 S-C = -0.0129 GWA = +0.4760\r\n",
      "... ...   Level =   10 DFT = +0.7020 VXC = -0.3344 S-X = -0.0932 S-C = -0.0697 GWA = +0.8735\r\n",
      "... ...   Level =   11 DFT = +0.7020 VXC = -0.3344 S-X = -0.0932 S-C = -0.0697 GWA = +0.8735\r\n",
      "... ...   Level =   12 DFT = +0.7868 VXC = -0.4742 S-X = -0.2016 S-C = -0.0615 GWA = +0.9979\r\n",
      "... ...   Level =   13 DFT = +1.0527 VXC = -0.4116 S-X = -0.1759 S-C = -0.0810 GWA = +1.2073\r\n",
      "... ...   Level =   14 DFT = +1.4534 VXC = -0.5240 S-X = -0.1917 S-C = -0.2315 GWA = +1.5542\r\n",
      "... ...   Level =   15 DFT = +1.4534 VXC = -0.5240 S-X = -0.1917 S-C = -0.2315 GWA = +1.5542\r\n",
      "... ...   Level =   16 DFT = +1.5021 VXC = -0.5043 S-X = -0.1976 S-C = -0.1220 GWA = +1.6867\r\n",
      "... ...   Level =   17 DFT = +2.9071 VXC = -0.5572 S-X = -0.2105 S-C = +0.0445 GWA = +3.2983\r\n",
      "... ... 2021-2-23 16:2:52 Calculated offdiagonal part of Sigma  \r\n",
      "... ... 2021-2-23 16:2:52 Full quasiparticle Hamiltonian  \r\n",
      "... ...   ====== Diagonalized quasiparticle energies (Hartree) ====== \r\n",
      "... ...   Level =    0 PQP = -20.016664 DQP = -20.016926 \r\n",
      "... ...   Level =    1 PQP = -11.004366 DQP = -11.004631 \r\n",
      "... ...   Level =    2 PQP = -1.331695 DQP = -1.332497 \r\n",
      "... ...   Level =    3 PQP = -0.698040 DQP = -0.698522 \r\n",
      "... ...   Level =    4 PQP = -0.580520 DQP = -0.585349 \r\n",
      "... ...   Level =    5 PQP = -0.580520 DQP = -0.585349 \r\n",
      "... ...   HOMO  =    6 PQP = -0.490989 DQP = -0.491326 \r\n",
      "... ...   LUMO  =    7 PQP = +0.145473 DQP = +0.143671 \r\n",
      "... ...   Level =    8 PQP = +0.145473 DQP = +0.143671 \r\n",
      "... ...   Level =    9 PQP = +0.476044 DQP = +0.473544 \r\n",
      "... ...   Level =   10 PQP = +0.873522 DQP = +0.873477 \r\n",
      "... ...   Level =   11 PQP = +0.873522 DQP = +0.873477 \r\n",
      "... ...   Level =   12 PQP = +0.997914 DQP = +0.995402 \r\n",
      "... ...   Level =   13 PQP = +1.207342 DQP = +1.209038 \r\n",
      "... ...   Level =   14 PQP = +1.554224 DQP = +1.560900 \r\n",
      "... ...   Level =   15 PQP = +1.554224 DQP = +1.560900 \r\n",
      "... ...   Level =   16 PQP = +1.686736 DQP = +1.679245 \r\n",
      "... ...   Level =   17 PQP = +3.298307 DQP = +3.311262 \r\n",
      "... ... 2021-2-23 16:2:52 Diagonalized QP Hamiltonian  \r\n",
      "... ... 2021-2-23 16:2:52 Setup Full singlet hamiltonian \r\n",
      "... ... 2021-2-23 16:2:52 Davidson Solver using 2 threads.\r\n",
      "... ... 2021-2-23 16:2:52 Tolerance : 0.0001\r\n",
      "... ... 2021-2-23 16:2:52 DPR Correction\r\n",
      "... ... 2021-2-23 16:2:52 Matrix size : 154x154\r\n",
      "... ... 2021-2-23 16:2:52 iter\tSearch Space\tNorm\r\n",
      "... ... 2021-2-23 16:2:52    0           10 \t 1.29e-01 \t  0.00% convergedan error occurred:\r\n",
      "Small generalized eigenvalue problem failed.\r\n"
     ]
    }
   ],
   "source": [
    "!xtp_tools -n CO -e dftgwbse -o OPTIONFILES/dftgwbse.xml -t 2"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Notice that we are using 4 threads. The results will be stored in a file named `CO_summary.xml` in the current work directory, together with the optimization step in `optimisation.trj` and the orbitals in [hdf5 format](https://www.hdfgroup.org/solutions/hdf5/) saved on `CO.orb`."
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.9.1"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 4
}
