{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## DFT + GWBSE Optimization Using CO"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Introduction\n",
    "This tutorial explains how to perform a molecular geometric optimization using the **GWBSE** method. See [the GW Compendium: A Practical Guide to Theoretical Photoemission Spectroscopy](https://doi.org/10.3389/fchem.2019.00377), for an excellent introduction to the method."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Requirements\n",
    "* You will need to install **VOTCA** using the instructions described [here](https://github.com/votca/votca/blob/master/share/doc/INSTALL.rst)\n",
    "* Once the installation is completed you need to activate the VOTCA enviroment by running the `VOTCARC.bash` script that has been installed at the bin subfolder for the path that you have provided for the installation step above"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Preparing the input\n",
    "To run a DFT-GWBSE calculation we will use the [xtp_tools](https://votca.github.io/xtp_tools.html) calculator. First, Let create a folder to store the input `options` for XTP and copy the defaults in there"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [],
   "source": [
    "!mkdir -p OPTIONFILES\n",
    "!cp $VOTCASHARE/xtp/xml/dftgwbse.xml OPTIONFILES"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "we can now change the calculator mode from single point energy calculation to optimization as follows,"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "The option 'optimize' on file 'OPTIONFILES/dftgwbse.xml' has been set to 'true'\n",
      "The option 'maxiter' on file 'OPTIONFILES/dftgwbse.xml' has been set to '1'\n",
      "The option 'energy' on file 'OPTIONFILES/dftgwbse.xml' has been set to '1.e-1'\n"
     ]
    }
   ],
   "source": [
    "from xml_editor import edit_calculator\n",
    "edit_calculator(\"dftgwbse\", \"optimize\", \"true\")\n",
    "edit_calculator(\"dftgwbse\", \"maxiter\", \"1\")\n",
    "edit_calculator(\"dftgwbse\", \"energy\", \"1.e-1\")\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "You can find all *dftgwbse* default options [here](https://votca.github.io/dftgwbse.html). You can for instance change the `basisset` and `auxbasisset` to `def2-svp` and `aux-def2-svp`, respectively."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "The option 'basisset' on file 'OPTIONFILES/dftgwbse.xml' has been set to '3-21G'\n",
      "The option 'auxbasisset' on file 'OPTIONFILES/dftgwbse.xml' has been set to 'aux-def2-svp'\n"
     ]
    }
   ],
   "source": [
    "edit_calculator(\"dftgwbse\", \"basisset\", \"3-21G\")\n",
    "edit_calculator(\"dftgwbse\", \"auxbasisset\", \"aux-def2-svp\")"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Finally, to run the calculation we just need the following command,"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Registered dftgwbse\r\n",
      "==================================================\r\n",
      "========   VOTCA (http://www.votca.org)   ========\r\n",
      "==================================================\r\n",
      "\r\n",
      "please submit bugs to https://github.com/votca/xtp/issues\r\n",
      "\r\n",
      "xtp_tools, version 2022-dev gitid: da54f15 (compiled Apr 26 2021, 15:46:51)\r\n",
      "votca_csg, version 2022-dev gitid: da54f15 (compiled Apr 26 2021, 15:32:33)\r\n",
      "votca_tools, version 2022-dev gitid: da54f15 (compiled Apr 26 2021, 15:30:05)\r\n",
      "\r\n",
      "Initializing tool\r\n",
      "... dftgwbse Evaluating tool\r\n",
      "... dftgwbse  Using 2 threads\r\n",
      "... ... Reading structure from CO.xyz\r\n",
      "... ... Requested geometry optimization of excited state s1\r\n",
      "... ... Initial state: s1\r\n",
      "... ... Using oscillator strength tracker with threshold 0.0001\r\n",
      "... ... Convergence of total energy: 0.100000 Hartree \r\n",
      "... ... Convergence of RMS Force:    0.000030 Hartree/Bohr \r\n",
      "... ... Convergence of Max Force:    0.000100 Hartree/Bohr \r\n",
      "... ... Convergence of RMS Step:     0.000600 Bohr \r\n",
      "... ... Convergence of Max Step:     0.001000 Bohr \r\n",
      "... ... Initial trust radius:        0.018897 Bohr\r\n",
      "... ... Next State is: s1\r\n",
      "... ... 2021-4-26 15:55:25 Using 2 threads\r\n",
      "... ... 2021-4-26 15:55:25 Using native Eigen implementation, no BLAS overload \r\n",
      "... ...  Molecule Coordinates [A] \r\n",
      "... ...   C   +0.0010 +0.0000 +0.0000\r\n",
      "... ...   O   +1.2000 +0.0000 +0.0000\r\n",
      "... ... 2021-4-26 15:55:25 Loaded DFT Basis Set 3-21G with 18 functions\r\n",
      "... ... 2021-4-26 15:55:25 Loaded AUX Basis Set aux-def2-svp with 96 functions\r\n",
      "... ... 2021-4-26 15:55:25 Total number of electrons: 14\r\n",
      "... ... 2021-4-26 15:55:25 Smallest value of AOOverlap matrix is 0.051195\r\n",
      "... ... 2021-4-26 15:55:25 Removed 0 basisfunction from inverse overlap matrix\r\n",
      "... ... 2021-4-26 15:55:25 Convergence Options:\r\n",
      "... ... \t\t Delta E [Ha]: 1e-07\r\n",
      "... ... \t\t DIIS max error: 1e-07\r\n",
      "... ... \t\t DIIS histlength: 20\r\n",
      "... ... \t\t ADIIS start: 0.8\r\n",
      "... ... \t\t DIIS start: 0.002\r\n",
      "... ... \t\t Deleting oldest element from DIIS hist\r\n",
      "... ... \t\t Levelshift[Ha]: 0\r\n",
      "... ... \t\t Levelshift end: 0.2\r\n",
      "... ... \t\t Mixing Parameter alpha: 0.7\r\n",
      "... ... 2021-4-26 15:55:25 Setup invariant parts of Electron Repulsion integrals \r\n",
      "... ... 2021-4-26 15:55:25 Constructed independent particle hamiltonian \r\n",
      "... ... 2021-4-26 15:55:25 Nuclear Repulsion Energy is 21.1847439\r\n",
      "... ... 2021-4-26 15:55:25 Using hybrid functional with alpha=0.25\r\n",
      "... ... 2021-4-26 15:55:25 Setup numerical integration grid medium for vxc functional XC_HYB_GGA_XC_PBEH\r\n",
      "... ... 2021-4-26 15:55:25 Setup Initial Guess using: atom\r\n",
      "... ... 2021-4-26 15:55:25 Calculating atom density for C\r\n",
      "... ... 2021-4-26 15:55:26 Calculating atom density for O\r\n",
      "... ... 2021-4-26 15:55:27 STARTING SCF cycle\r\n",
      "... ...  --------------------------------------------------------------------------\r\n",
      "... ... \r\n",
      "... ... 2021-4-26 15:55:27 Iteration 1 of 100\r\n",
      "... ... 2021-4-26 15:55:27 Total Energy -112.364694295\r\n",
      "... ... 2021-4-26 15:55:27 DIIs error 0.358958749787\r\n",
      "... ... 2021-4-26 15:55:27 Delta Etot 0\r\n",
      "... ... \r\n",
      "... ... 2021-4-26 15:55:27 Iteration 2 of 100\r\n",
      "... ... 2021-4-26 15:55:27 Total Energy -112.39958037\r\n",
      "... ... 2021-4-26 15:55:27 DIIs error 0.138444555234\r\n",
      "... ... 2021-4-26 15:55:27 Delta Etot -0.0348860748634\r\n",
      "... ... \r\n",
      "... ... 2021-4-26 15:55:27 Iteration 3 of 100\r\n",
      "... ... 2021-4-26 15:55:27 Total Energy -112.443974704\r\n",
      "... ... 2021-4-26 15:55:27 DIIs error 0.100121195784\r\n",
      "... ... 2021-4-26 15:55:27 Delta Etot -0.0443943339757\r\n",
      "... ... \r\n",
      "... ... 2021-4-26 15:55:27 Iteration 4 of 100\r\n",
      "... ... 2021-4-26 15:55:27 Total Energy -112.52508776\r\n",
      "... ... 2021-4-26 15:55:27 DIIs error 0.117934266239\r\n",
      "... ... 2021-4-26 15:55:27 Delta Etot -0.0811130554098\r\n",
      "... ... \r\n",
      "... ... 2021-4-26 15:55:27 Iteration 5 of 100\r\n",
      "... ... 2021-4-26 15:55:27 Total Energy -112.509068708\r\n",
      "... ... 2021-4-26 15:55:27 DIIs error 0.164729478518\r\n",
      "... ... 2021-4-26 15:55:27 Delta Etot 0.01601905133\r\n",
      "... ... \r\n",
      "... ... 2021-4-26 15:55:27 Iteration 6 of 100\r\n",
      "... ... 2021-4-26 15:55:27 Total Energy -112.544617812\r\n",
      "... ... 2021-4-26 15:55:27 DIIs error 0.0189987110757\r\n",
      "... ... 2021-4-26 15:55:27 Delta Etot -0.0355491031883\r\n",
      "... ... \r\n",
      "... ... 2021-4-26 15:55:27 Iteration 7 of 100\r\n",
      "... ... 2021-4-26 15:55:27 Total Energy -112.541886093\r\n",
      "... ... 2021-4-26 15:55:27 DIIs error 0.0491820053899\r\n",
      "... ... 2021-4-26 15:55:27 Delta Etot 0.00273171836696\r\n",
      "... ... \r\n",
      "... ... 2021-4-26 15:55:27 Iteration 8 of 100\r\n",
      "... ... 2021-4-26 15:55:27 Total Energy -112.544883258\r\n",
      "... ... 2021-4-26 15:55:27 DIIs error 0.0140039721803\r\n",
      "... ... 2021-4-26 15:55:27 Delta Etot -0.00299716528221\r\n",
      "... ... \r\n",
      "... ... 2021-4-26 15:55:27 Iteration 9 of 100\r\n",
      "... ... 2021-4-26 15:55:27 Total Energy -112.545133533\r\n",
      "... ... 2021-4-26 15:55:27 DIIs error 0.00377962067663\r\n",
      "... ... 2021-4-26 15:55:27 Delta Etot -0.000250274150346\r\n",
      "... ... \r\n",
      "... ... 2021-4-26 15:55:27 Iteration 10 of 100\r\n",
      "... ... 2021-4-26 15:55:27 Total Energy -112.545113983\r\n",
      "... ... 2021-4-26 15:55:27 DIIs error 0.00538537224466\r\n",
      "... ... 2021-4-26 15:55:27 Delta Etot 1.95501042839e-05\r\n",
      "... ... \r\n",
      "... ... 2021-4-26 15:55:27 Iteration 11 of 100\r\n",
      "... ... 2021-4-26 15:55:27 Total Energy -112.545151787\r\n",
      "... ... 2021-4-26 15:55:27 DIIs error 0.000780748036752\r\n",
      "... ... 2021-4-26 15:55:27 Delta Etot -3.78048893594e-05\r\n",
      "... ... \r\n",
      "... ... 2021-4-26 15:55:27 Iteration 12 of 100\r\n",
      "... ... 2021-4-26 15:55:27 Total Energy -112.5451526\r\n",
      "... ... 2021-4-26 15:55:27 DIIs error 3.66786405077e-06\r\n",
      "... ... 2021-4-26 15:55:27 Delta Etot -8.12325211541e-07\r\n",
      "... ... \r\n",
      "... ... 2021-4-26 15:55:27 Iteration 13 of 100\r\n",
      "... ... 2021-4-26 15:55:27 Total Energy -112.5451526\r\n",
      "... ... 2021-4-26 15:55:27 DIIs error 1.1375008345e-07\r\n",
      "... ... 2021-4-26 15:55:27 Delta Etot -2.04778416446e-11\r\n",
      "... ... \r\n",
      "... ... 2021-4-26 15:55:27 Iteration 14 of 100\r\n",
      "... ... 2021-4-26 15:55:27 Total Energy -112.5451526\r\n",
      "... ... 2021-4-26 15:55:27 DIIs error 6.4491250386e-09\r\n",
      "... ... 2021-4-26 15:55:27 Delta Etot -4.26325641456e-14\r\n",
      "... ... 2021-4-26 15:55:27 Total Energy has converged to -4.26325641e-14[Ha] after 14 iterations. DIIS error is converged up to 6.44912504e-09\r\n",
      "... ... 2021-4-26 15:55:27 Final Single Point Energy -112.5451526 Ha\r\n",
      "... ... 2021-4-26 15:55:27 Final Local Exc contribution -10.3509474699 Ha\r\n",
      "... ... 2021-4-26 15:55:27 Final Non Local Ex contribution -3.29400255021 Ha\r\n",
      "... ...   Orbital energies: \r\n",
      "... ...   index occupation energy(Hartree) \r\n",
      "... ...      0      2   -19.2419944822\r\n",
      "... ...      1      2   -10.3166455939\r\n",
      "... ...      2      2   -1.1842207506\r\n",
      "... ...      3      2   -0.5763673198\r\n",
      "... ...      4      2   -0.4662566189\r\n",
      "... ...      5      2   -0.4662566189\r\n",
      "... ...      6      2   -0.3807869182\r\n",
      "... ...      7      0   -0.0340775619\r\n",
      "... ...      8      0   -0.0340775619\r\n",
      "... ...      9      0   +0.3139136679\r\n",
      "... ...     10      0   +0.7020229601\r\n",
      "... ...     11      0   +0.7020229601\r\n",
      "... ...     12      0   +0.7878578218\r\n",
      "... ...     13      0   +1.0531051427\r\n",
      "... ...     14      0   +1.4534308429\r\n",
      "... ...     15      0   +1.4534308429\r\n",
      "... ...     16      0   +1.5015681038\r\n",
      "... ...     17      0   +2.9080220709\r\n",
      "... ... 2021-4-26 15:55:28 Electric Dipole is[e*bohr]:\r\n",
      "\t\t dx=-0.0486864645033\r\n",
      "\t\t dy=-1.29538677273e-10\r\n",
      "\t\t dz=-1.29525345601e-10\r\n",
      "... ... Writing result to CO.orb\r\n",
      "... ... Parsing DFT data from CO.orb and CO.orb\r\n",
      "... ... QM energy[Hrt]: -112.54515260 \r\n",
      "... ... 2021-4-26 15:55:28 RPA level range [0:17]\r\n",
      "... ... 2021-4-26 15:55:28 GW  level range [0:17]\r\n",
      "... ... 2021-4-26 15:55:28 BSE level range occ[0:6]  virt[7:17]\r\n",
      "... ... 2021-4-26 15:55:28 BSE Hamiltonian has size 77x77\r\n",
      "... ...  BSE type: full\r\n",
      "... ...  BSE without Hqp offdiagonal elements\r\n",
      "... ...  Running GW as: evGW\r\n",
      "... ...  g_sc_limit [Hartree]: 1e-05\r\n",
      "... ...  gw_sc_limit [Hartree]: 1e-05\r\n",
      "... ...  Tasks: \r\n",
      "... ...  GW \r\n",
      "... ...  singlets \r\n",
      "... ...  Store: \r\n",
      "... ...  GW \r\n",
      "... ...  Sigma integration: ppm\r\n",
      "... ...  eta: 0.001\r\n",
      "... ...  Quadrature integration order : 12\r\n",
      "... ...  Quadrature integration scheme : legendre\r\n",
      "... ...  Alpha smoothing parameter : 0.001\r\n",
      "... ...  QP solver: grid\r\n",
      "... ...  QP grid steps: 1001\r\n",
      "... ...  QP grid spacing: 0.001\r\n",
      "... ...  evGW with Anderson update with history 20 using alpha 0.7\r\n",
      "... ... 2021-4-26 15:55:28 Using 2 threads\r\n",
      "... ... 2021-4-26 15:55:28 Using native Eigen implementation, no BLAS overload \r\n",
      "... ... 2021-4-26 15:55:28 Molecule Coordinates [A] \r\n",
      "... ...     0    C   0.0010 0.0000 0.0000\r\n",
      "... ...     1    O   1.2000 0.0000 0.0000\r\n",
      "... ... 2021-4-26 15:55:28 DFT data was created by xtp\r\n",
      "... ... 2021-4-26 15:55:28 Loaded DFT Basis Set 3-21G\r\n",
      "... ... 2021-4-26 15:55:28 Filled DFT Basis of size 18\r\n",
      "... ... 2021-4-26 15:55:28 Loaded Auxbasis Set aux-def2-svp\r\n",
      "... ... 2021-4-26 15:55:28 Filled Auxbasis of size 96\r\n",
      "... ... 2021-4-26 15:55:28 Calculating Mmn_beta (3-center-repulsion x orbitals)  \r\n",
      "... ... 2021-4-26 15:55:28 Calculated Mmn_beta (3-center-repulsion x orbitals)  \r\n",
      "... ... 2021-4-26 15:55:28 Integrating Vxc in VOTCA with functional XC_HYB_GGA_XC_PBEH\r\n",
      "... ... 2021-4-26 15:55:28 Set hybrid exchange factor: 0.25\r\n",
      "... ... 2021-4-26 15:55:28 Calculated exchange-correlation expectation values \r\n",
      "... ... 2021-4-26 15:55:28 Calculated Hartree exchange contribution\r\n",
      "... ... 2021-4-26 15:55:28 Scissor shifting DFT energies by: 0 Hrt\r\n",
      "... ...   ====== Perturbative quasiparticle energies (Hartree) ====== \r\n",
      "... ...    DeltaHLGap = +0.290091 Hartree\r\n",
      "... ...   Level =    0 DFT = -19.2420 VXC = -2.3112 S-X = -3.6465 S-C = +0.5605 GWA = -20.0168\r\n",
      "... ...   Level =    1 DFT = -10.3166 VXC = -1.7029 S-X = -2.6729 S-C = +0.2825 GWA = -11.0042\r\n",
      "... ...   Level =    2 DFT = -1.1842 VXC = -0.6137 S-X = -0.9172 S-C = +0.1554 GWA = -1.3324\r\n",
      "... ...   Level =    3 DFT = -0.5764 VXC = -0.5631 S-X = -0.7702 S-C = +0.0854 GWA = -0.6981\r\n",
      "... ...   Level =    4 DFT = -0.4663 VXC = -0.5082 S-X = -0.6427 S-C = +0.0198 GWA = -0.5809\r\n",
      "... ...   Level =    5 DFT = -0.4663 VXC = -0.5082 S-X = -0.6427 S-C = +0.0198 GWA = -0.5809\r\n",
      "... ...   HOMO  =    6 DFT = -0.3808 VXC = -0.4453 S-X = -0.5898 S-C = +0.0344 GWA = -0.4910\r\n",
      "... ...   LUMO  =    7 DFT = -0.0341 VXC = -0.4302 S-X = -0.2453 S-C = -0.0049 GWA = +0.1458\r\n",
      "... ...   Level =    8 DFT = -0.0341 VXC = -0.4302 S-X = -0.2453 S-C = -0.0049 GWA = +0.1458\r\n",
      "... ...   Level =    9 DFT = +0.3139 VXC = -0.3251 S-X = -0.1498 S-C = -0.0129 GWA = +0.4763\r\n",
      "... ...   Level =   10 DFT = +0.7020 VXC = -0.3344 S-X = -0.0932 S-C = -0.0696 GWA = +0.8736\r\n",
      "... ...   Level =   11 DFT = +0.7020 VXC = -0.3344 S-X = -0.0932 S-C = -0.0696 GWA = +0.8736\r\n",
      "... ...   Level =   12 DFT = +0.7879 VXC = -0.4744 S-X = -0.2017 S-C = -0.0616 GWA = +0.9989\r\n",
      "... ...   Level =   13 DFT = +1.0531 VXC = -0.4122 S-X = -0.1763 S-C = -0.0810 GWA = +1.2080\r\n",
      "... ...   Level =   14 DFT = +1.4534 VXC = -0.5240 S-X = -0.1916 S-C = -0.2308 GWA = +1.5550\r\n",
      "... ...   Level =   15 DFT = +1.4534 VXC = -0.5240 S-X = -0.1916 S-C = -0.2308 GWA = +1.5550\r\n",
      "... ...   Level =   16 DFT = +1.5016 VXC = -0.5043 S-X = -0.1976 S-C = -0.1214 GWA = +1.6868\r\n",
      "... ...   Level =   17 DFT = +2.9080 VXC = -0.5572 S-X = -0.2105 S-C = +0.0448 GWA = +3.2995\r\n",
      "... ... 2021-4-26 15:55:28 Calculated offdiagonal part of Sigma  \r\n",
      "... ... 2021-4-26 15:55:28 Full quasiparticle Hamiltonian  \r\n",
      "... ...   ====== Diagonalized quasiparticle energies (Hartree) ====== \r\n",
      "... ...   Level =    0 PQP = -20.016823 DQP = -20.017086 \r\n",
      "... ...   Level =    1 PQP = -11.004165 DQP = -11.004430 \r\n",
      "... ...   Level =    2 PQP = -1.332367 DQP = -1.333169 \r\n",
      "... ...   Level =    3 PQP = -0.698087 DQP = -0.698575 \r\n",
      "... ...   Level =    4 PQP = -0.580907 DQP = -0.585676 \r\n",
      "... ...   Level =    5 PQP = -0.580907 DQP = -0.585676 \r\n",
      "... ...   HOMO  =    6 PQP = -0.490952 DQP = -0.491293 \r\n",
      "... ...   LUMO  =    7 PQP = +0.145848 DQP = +0.144043 \r\n",
      "... ...   Level =    8 PQP = +0.145848 DQP = +0.144043 \r\n",
      "... ...   Level =    9 PQP = +0.476330 DQP = +0.473843 \r\n",
      "... ...   Level =   10 PQP = +0.873583 DQP = +0.873570 \r\n",
      "... ...   Level =   11 PQP = +0.873583 DQP = +0.873570 \r\n",
      "... ...   Level =   12 PQP = +0.998891 DQP = +0.996300 \r\n",
      "... ...   Level =   13 PQP = +1.207971 DQP = +1.209717 \r\n",
      "... ...   Level =   14 PQP = +1.554953 DQP = +1.561541 \r\n",
      "... ...   Level =   15 PQP = +1.554953 DQP = +1.561541 \r\n",
      "... ...   Level =   16 PQP = +1.686783 DQP = +1.679347 \r\n",
      "... ...   Level =   17 PQP = +3.299532 DQP = +3.312457 \r\n",
      "... ... 2021-4-26 15:55:28 Diagonalized QP Hamiltonian  \r\n",
      "... ... 2021-4-26 15:55:28 Setup Full singlet hamiltonian \r\n",
      "... ... 2021-4-26 15:55:28 Davidson Solver using 2 threads.\r\n",
      "... ... 2021-4-26 15:55:28 Tolerance : 0.0001\r\n",
      "... ... 2021-4-26 15:55:28 DPR Correction\r\n",
      "... ... 2021-4-26 15:55:28 Matrix size : 154x154\r\n",
      "... ... 2021-4-26 15:55:28 iter\tSearch Space\tNorm\r\n",
      "... ... 2021-4-26 15:55:28    0           10 \t 1.29e-01 \t  0.00% convergedan error occurred:\r\n",
      "Small generalized eigenvalue problem failed.\r\n"
     ]
    }
   ],
   "source": [
    "!xtp_tools -n CO -e dftgwbse -o OPTIONFILES/dftgwbse.xml -t 2"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Notice that we are using 4 threads. The results will be stored in a file named `CO_summary.xml` in the current work directory, together with the optimization step in `optimisation.trj` and the orbitals in [hdf5 format](https://www.hdfgroup.org/solutions/hdf5/) saved on `CO.orb`."
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.9.2"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 4
}
