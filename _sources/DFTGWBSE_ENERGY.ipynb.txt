{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# DFT + GWBSE Energy Calculation Using CH4"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Introduction"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "This tutorial explains how to perform calculation to predict electronic excitation using the **GWBSE** method. See [the GW Compendium: A Practical Guide to Theoretical Photoemission Spectroscopy](https://doi.org/10.3389/fchem.2019.00377), for an excellent introduction to the method."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Requirements\n",
    "* You will need to install **VOTCA** using the instructions described [here](https://github.com/votca/votca/blob/master/share/doc/INSTALL.md)\n",
    "* Once the installation is completed you need to activate the VOTCA enviroment by running the `VOTCARC.bash` script that has been installed at the bin subfolder for the path that you have provided for the installation step above"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Interacting with the XTP command line interface\n",
    "To run a DFT-GWBSE calculation we will use the [xtp_tools](https://votca.github.io/xtp_tools.html) calculator. Run the following command to view the help message of `xtp_tools`:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "==================================================\r\n",
      "========   VOTCA (http://www.votca.org)   ========\r\n",
      "==================================================\r\n",
      "\r\n",
      "please submit bugs to https://github.com/votca/xtp/issues\r\n",
      "\r\n",
      "xtp_tools, version 2021-dev gitid: 915801d (compiled Sep 14 2020, 14:41:09)\r\n",
      "votca_csg, version 2021-dev gitid: 915801d (compiled Sep 14 2020, 14:40:46)\r\n",
      "votca_tools, version 2021-dev gitid: 915801d (compiled Sep 14 2020, 14:40:43)\r\n",
      "\r\n",
      "Runs excitation/charge transport tools\r\n",
      "\r\n",
      "\r\n",
      "\r\n",
      "Allowed options:\r\n",
      "  -h [ --help ]                 display this help and exit\r\n",
      "  --verbose                     be loud and noisy\r\n",
      "  --verbose1                    be very loud and noisy\r\n",
      "  -v [ --verbose2 ]             be extremly loud and noisy\r\n",
      "  -o [ --options ] arg          calculator options\r\n",
      "  -t [ --nthreads ] arg (=1)    number of threads to create\r\n",
      "\r\n",
      "Tools:\r\n",
      "  -e [ --execute ] arg        List of tools separated by ',' or ' '\r\n",
      "  -l [ --list ]               Lists all available tools\r\n",
      "  -d [ --description ] arg    Short description of a tool\r\n",
      "  -n [ --name ] arg           Name of the job to run\r\n",
      "\r\n"
     ]
    }
   ],
   "source": [
    "!xtp_tools --help"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Note\n",
    "> * In Jupyter the `!` symbol means: *run the following command as a standard unix command*\n",
    "> * In Jupyter the command `%env` set an environmental variable"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Running a calculation with the default options\n",
    "To run a DFT-GWBSE calculation we just need to provide the path to the file in XYZ with the molecular coordinates. Check the [dftgwbse defaults](https://votca.github.io/dftgwbse.html) for further information."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [],
   "source": [
    "!xtp_tools -n methane -t 2 -e dftgwbse > dftgwbse.log"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "The previous command will run the DFT-GWBSE calculation using the aforementioned defaults and the results are store in the *Current Work Directory* in a file named `methane_summary.xml`."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Running a calculation using your own input file\n",
    "Let create a folder to store the input `options` for XTP and copy the defaults in there"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [],
   "source": [
    "!mkdir -p OPTIONFILES\n",
    "!cp $VOTCASHARE/xtp/xml/dftgwbse.xml OPTIONFILES"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "You should have a *XML* file with the DFTWGSE options that looks like"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<?xml version=\"1.0\"?>\r\n",
      "<options>\r\n",
      "  <!-- xtp_tools -e dftgwbse options.xml -->\r\n",
      "  <dftgwbse help=\"Compute electronic excitations using GW-BSE\">\r\n",
      "    <optimize help=\"Perform a molecular geometry optimization\" default=\"false\" choices=\"bool\"/>\r\n",
      "    <basisset help=\"Basis set for MOs\" default=\"def2-tzvp\"/>\r\n",
      "    <auxbasisset help=\"Auxiliary basis set for RI\" default=\"aux-def2-tzvp\"/>\r\n",
      "    <functional help=\"Functional name(s) according to LIBXC\" default=\"XC_HYB_GGA_XC_PBEH\"/>\r\n",
      "    <dftpackage>\r\n",
      "      <package>\r\n"
     ]
    }
   ],
   "source": [
    "!head -n 10 OPTIONFILES/dftgwbse.xml"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "We will use the folling python snippet to change the `basisset` and the `auxbasisset`,"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "The option 'basisset' on file 'OPTIONFILES/dftgwbse.xml' has been set to 'ubecppol'\n",
      "The option 'auxbasisset' on file 'OPTIONFILES/dftgwbse.xml' has been set to 'aux-ubecppol'\n"
     ]
    }
   ],
   "source": [
    "from xml_editor import edit_calculator\n",
    "edit_calculator(\"dftgwbse\", \"basisset\", \"ubecppol\")\n",
    "edit_calculator(\"dftgwbse\", \"auxbasisset\", \"aux-ubecppol\")"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Now you can run the calculation using the `-o` command line argument, as follows"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [],
   "source": [
    "!xtp_tools -n methane -t 2 -e dftgwbse -o OPTIONFILES/dftgwbse.xml > dftgwbse.log"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Note\n",
    "Alternatively you could have create an empty `dftgwbse.xml` file and add the `basisset` and the `auxbasisset` by hand, as follows,"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "```xml\n",
    "<options>\n",
    "  \n",
    "  <dftgwbse help=\"Compute electronic excitations using GW-BSE\">\n",
    "    <basisset>ubecppol</basisset>\n",
    "    <auxbasisset>aux-ubecppol</auxbasisset>\n",
    "  </dftgwbse>\n",
    "\n",
    "</options>\n",
    "```"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "XTP will automatically compare the default values with the user-provided and overwrites the defaults with the user input. Also, If I given property does not have a default value you can provide one using the XML file described above."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Partial Charges\n",
    "We can compute now the partial charges using the `CHELPG` method by default. For more information see the [partialcharges documentation](https://votca.github.io/partialcharges.html). Once again, we only need to provide the name of the system to compute, which in our case is `methane`."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Registered partialcharges==================================================\r\n",
      "========   VOTCA (http://www.votca.org)   ========\r\n",
      "==================================================\r\n",
      "\r\n",
      "please submit bugs to https://github.com/votca/xtp/issues\r\n",
      "\r\n",
      "xtp_tools, version 2021-dev gitid: 915801d (compiled Sep 14 2020, 14:41:09)\r\n",
      "votca_csg, version 2021-dev gitid: 915801d (compiled Sep 14 2020, 14:40:46)\r\n",
      "votca_tools, version 2021-dev gitid: 915801d (compiled Sep 14 2020, 14:40:43)\r\n",
      "\r\n",
      "Initializing tool\r\n",
      "... partialcharges Evaluating tool\r\n",
      "... partialcharges \r\n",
      "... ...  Loading QM data from methane.orb\r\n",
      "... ... ===== Running on 1 threads ===== \r\n",
      "... ... 2020-9-14 14:49:51 Calculated Densities at Numerical Grid, Number of electrons is 2.3754e-08\r\n",
      "... ... 2020-9-14 14:49:51 Calculating ESP at CHELPG grid points\r\n",
      "... ... 2020-9-14 14:49:53 Netcharge constrained to 0\r\n",
      "... ...  Sum of fitted charges: -2.41994e-14\r\n",
      "... ...  RMSE of fit:  0.00221575\r\n",
      "... ...  RRMSE of fit: 0.107184\r\n",
      "... ... El Dipole from fitted charges [e*bohr]:\r\n",
      "\t\t dx = -0.7277 dy = +0.4714 dz = -0.4705 |d|^2 = +0.9731\r\n",
      "... ... El Dipole from exact qm density [e*bohr]:\r\n",
      "\t\t dx = -0.7619 dy = +0.4941 dz = -0.4931 |d|^2 = +1.0679\r\n",
      "... ... Written charges to methane.mps"
     ]
    }
   ],
   "source": [
    "!xtp_tools -n methane -e partialcharges"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Spectrum Calculation\n",
    "Finally, lets compute a convolution of the singlet spectrum using a gaussian function. For doing so, we will modify the default values for the [spectrum calculator](https://votca.github.io/spectrum.html) to compute the spectrum between 9 and 25 eV, using 1000 points in that energy range. We will first grap a copy of [spectrum calculator](https://votca.github.io/spectrum.html) and the modify its values as follows,"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "The option 'lower' on file 'OPTIONFILES/spectrum.xml' has been set to '9'\n",
      "The option 'upper' on file 'OPTIONFILES/spectrum.xml' has been set to '25'\n",
      "The option 'points' on file 'OPTIONFILES/spectrum.xml' has been set to '1000'\n"
     ]
    }
   ],
   "source": [
    "!cp $VOTCASHARE/xtp/xml/spectrum.xml OPTIONFILES\n",
    "edit_calculator(\"spectrum\", \"lower\", \"9\")\n",
    "edit_calculator(\"spectrum\", \"upper\", \"25\")\n",
    "edit_calculator(\"spectrum\", \"points\", \"1000\")"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Finally, we can invoke the calculator"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Registered spectrum==================================================\r\n",
      "========   VOTCA (http://www.votca.org)   ========\r\n",
      "==================================================\r\n",
      "\r\n",
      "please submit bugs to https://github.com/votca/xtp/issues\r\n",
      "\r\n",
      "xtp_tools, version 2021-dev gitid: 915801d (compiled Sep 14 2020, 14:41:09)\r\n",
      "votca_csg, version 2021-dev gitid: 915801d (compiled Sep 14 2020, 14:40:46)\r\n",
      "votca_tools, version 2021-dev gitid: 915801d (compiled Sep 14 2020, 14:40:43)\r\n",
      "\r\n",
      "Initializing tool\r\n",
      "... spectrum Evaluating tool\r\n",
      "... spectrum \r\n",
      "... ... Calculating absorption spectrum plot methane.orb\r\n",
      "... ...  Loading QM data from methane.orb\r\n",
      "... ...  Considering 5 excitation with max energy 13.8471 eV / min wave length 89.9395 nm\r\n",
      "... ...  Spectrum in energy range from  9 to 25 eV and with broadening of FWHM 0.2 eV written to file  methane_spectrum.dat"
     ]
    }
   ],
   "source": [
    "!xtp_tools -n methane -e spectrum -o OPTIONFILES/spectrum.xml"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "The results are stored in the `methane_spectrum.dat` file."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## (Optional) Plot the spectrum"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "We will use [matplotlib](https://matplotlib.org/), [seaborn](https://seaborn.pydata.org/) and [pandas](https://pandas.pydata.org/) libraries to plot the spectrum. You can install it using [pip](https://pip.pypa.io/en/stable/) like"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Requirement already satisfied: seaborn in /usr/lib/python3.8/site-packages (0.9.0)\r\n",
      "Requirement already satisfied: numpy>=1.9.3 in /usr/lib64/python3.8/site-packages (from seaborn) (1.18.4)\r\n",
      "Requirement already satisfied: scipy>=0.14.0 in /usr/lib64/python3.8/site-packages (from seaborn) (1.4.1)\r\n",
      "Requirement already satisfied: pandas>=0.15.2 in /usr/lib64/python3.8/site-packages (from seaborn) (0.25.3)\r\n",
      "Requirement already satisfied: matplotlib>=1.4.3 in /usr/lib64/python3.8/site-packages (from seaborn) (3.2.2)\r\n",
      "Requirement already satisfied: python-dateutil>=2.6.1 in /usr/lib/python3.8/site-packages (from pandas>=0.15.2->seaborn) (2.8.0)\r\n",
      "Requirement already satisfied: pytz>=2017.2 in /usr/lib/python3.8/site-packages (from pandas>=0.15.2->seaborn) (2020.1)\r\n",
      "Requirement already satisfied: cycler>=0.10 in /usr/lib/python3.8/site-packages (from matplotlib>=1.4.3->seaborn) (0.10.0)\r\n",
      "Requirement already satisfied: kiwisolver>=1.0.1 in /usr/lib64/python3.8/site-packages (from matplotlib>=1.4.3->seaborn) (1.2.0)\r\n",
      "Requirement already satisfied: pyparsing!=2.0.4,!=2.1.2,!=2.1.6,>=2.0.1 in /usr/lib/python3.8/site-packages (from matplotlib>=1.4.3->seaborn) (2.4.7)\r\n",
      "Requirement already satisfied: six>=1.5 in /usr/lib/python3.8/site-packages (from python-dateutil>=2.6.1->pandas>=0.15.2->seaborn) (1.14.0)\r\n"
     ]
    }
   ],
   "source": [
    "!pip install seaborn --user"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[]"
      ]
     },
     "execution_count": 11,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 360x360 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "import pandas as pd \n",
    "import matplotlib.pyplot as plt\n",
    "import seaborn as sns\n",
    "columns = [\"E(eV)\", \"epsGaussian\",\"IM(eps)Gaussian\",  \"epsLorentz\",  \"Im(esp)Lorentz\"] \n",
    "df = pd.read_table(\"methane_spectrum.dat\", comment=\"#\", sep='\\s+',names=columns) \n",
    "sns.relplot(x=\"E(eV)\", y=\"epsGaussian\", ci=None, kind=\"line\", data=df) \n",
    "plt.plot()"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.8.5"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 4
}
