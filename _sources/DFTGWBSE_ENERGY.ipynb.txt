{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# DFT + GWBSE Energy Calculation Using CH4"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Introduction"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "This tutorial explains how to perform calculation to predict electronic excitation using the **GWBSE** method. See [the GW Compendium: A Practical Guide to Theoretical Photoemission Spectroscopy](https://doi.org/10.3389/fchem.2019.00377), for an excellent introduction to the method."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Requirements\n",
    "* You will need to install **VOTCA** using the instructions described [here](https://github.com/votca/votca/blob/master/share/doc/INSTALL.md)\n",
    "* Once the installation is completed you need to activate the VOTCA enviroment by running the `VOTCARC.bash` script that has been installed at the bin subfolder for the path that you have provided for the installation step above"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Interacting with the XTP command line interface\n",
    "To run a DFT-GWBSE calculation we will use the [xtp_tools](https://votca.github.io/xtp_tools.html) calculator. Run the following command to view the help message of `xtp_tools`:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "==================================================\r\n",
      "========   VOTCA (http://www.votca.org)   ========\r\n",
      "==================================================\r\n",
      "\r\n",
      "please submit bugs to https://github.com/votca/xtp/issues\r\n",
      "\r\n",
      "xtp_tools, version 2021-dev gitid: 73d86fe (compiled Sep 14 2020, 16:49:51)\r\n",
      "votca_csg, version 2021-dev gitid: 73d86fe (compiled Sep 14 2020, 16:47:32)\r\n",
      "votca_tools, version 2021-dev gitid: 73d86fe (compiled Sep 14 2020, 16:47:29)\r\n",
      "\r\n",
      "Runs excitation/charge transport tools\r\n",
      "\r\n",
      "\r\n",
      "\r\n",
      "Allowed options:\r\n",
      "  -h [ --help ]                 display this help and exit\r\n",
      "  --verbose                     be loud and noisy\r\n",
      "  --verbose1                    be very loud and noisy\r\n",
      "  -v [ --verbose2 ]             be extremly loud and noisy\r\n",
      "  -o [ --options ] arg          calculator options\r\n",
      "  -t [ --nthreads ] arg (=1)    number of threads to create\r\n",
      "\r\n",
      "Tools:\r\n",
      "  -e [ --execute ] arg        List of tools separated by ',' or ' '\r\n",
      "  -l [ --list ]               Lists all available tools\r\n",
      "  -d [ --description ] arg    Short description of a tool\r\n",
      "  -n [ --name ] arg           Name of the job to run\r\n",
      "\r\n"
     ]
    }
   ],
   "source": [
    "!xtp_tools --help"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Note\n",
    "> * In Jupyter the `!` symbol means: *run the following command as a standard unix command*\n",
    "> * In Jupyter the command `%env` set an environmental variable"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Running a calculation with the default options\n",
    "To run a DFT-GWBSE calculation we just need to provide the path to the file in XYZ with the molecular coordinates. Check the [dftgwbse defaults](https://votca.github.io/dftgwbse.html) for further information."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [],
   "source": [
    "!xtp_tools -n methane -t 2 -e dftgwbse > dftgwbse.log"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "The previous command will run the DFT-GWBSE calculation using the aforementioned defaults and the results are store in the *Current Work Directory* in a file named `methane_summary.xml`."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Running a calculation using your own input file\n",
    "Let create a folder to store the input `options` for XTP and copy the defaults in there"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [],
   "source": [
    "!mkdir -p OPTIONFILES\n",
    "!cp $VOTCASHARE/xtp/xml/dftgwbse.xml OPTIONFILES"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "You should have a *XML* file with the DFTWGSE options that looks like"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<?xml version=\"1.0\"?>\r\n",
      "<options>\r\n",
      "  <!-- xtp_tools -e dftgwbse options.xml -->\r\n",
      "  <dftgwbse help=\"Compute electronic excitations using GW-BSE\">\r\n",
      "    <optimize help=\"Perform a molecular geometry optimization\" default=\"false\" choices=\"bool\"/>\r\n",
      "    <basisset help=\"Basis set for MOs\" default=\"def2-tzvp\"/>\r\n",
      "    <auxbasisset help=\"Auxiliary basis set for RI\" default=\"aux-def2-tzvp\"/>\r\n",
      "    <functional help=\"Functional name(s) according to LIBXC\" default=\"XC_HYB_GGA_XC_PBEH\"/>\r\n",
      "    <dftpackage>\r\n",
      "      <package>\r\n"
     ]
    }
   ],
   "source": [
    "!head -n 10 OPTIONFILES/dftgwbse.xml"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "We will use the folling python snippet to change the `basisset` and the `auxbasisset`,"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "The option 'basisset' on file 'OPTIONFILES/dftgwbse.xml' has been set to 'ubecppol'\n",
      "The option 'auxbasisset' on file 'OPTIONFILES/dftgwbse.xml' has been set to 'aux-ubecppol'\n"
     ]
    }
   ],
   "source": [
    "from xml_editor import edit_calculator\n",
    "edit_calculator(\"dftgwbse\", \"basisset\", \"ubecppol\")\n",
    "edit_calculator(\"dftgwbse\", \"auxbasisset\", \"aux-ubecppol\")"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Now you can run the calculation using the `-o` command line argument, as follows"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [],
   "source": [
    "!xtp_tools -n methane -t 2 -e dftgwbse -o OPTIONFILES/dftgwbse.xml > dftgwbse.log"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Note\n",
    "Alternatively you could have create an empty `dftgwbse.xml` file and add the `basisset` and the `auxbasisset` by hand, as follows,"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "```xml\n",
    "<options>\n",
    "  \n",
    "  <dftgwbse help=\"Compute electronic excitations using GW-BSE\">\n",
    "    <basisset>ubecppol</basisset>\n",
    "    <auxbasisset>aux-ubecppol</auxbasisset>\n",
    "  </dftgwbse>\n",
    "\n",
    "</options>\n",
    "```"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "XTP will automatically compare the default values with the user-provided and overwrites the defaults with the user input. Also, If I given property does not have a default value you can provide one using the XML file described above."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Partial Charges\n",
    "We can compute now the partial charges using the `CHELPG` method by default. For more information see the [partialcharges documentation](https://votca.github.io/partialcharges.html). Once again, we only need to provide the name of the system to compute, which in our case is `methane`."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Registered partialcharges==================================================\r\n",
      "========   VOTCA (http://www.votca.org)   ========\r\n",
      "==================================================\r\n",
      "\r\n",
      "please submit bugs to https://github.com/votca/xtp/issues\r\n",
      "\r\n",
      "xtp_tools, version 2021-dev gitid: 73d86fe (compiled Sep 14 2020, 16:49:51)\r\n",
      "votca_csg, version 2021-dev gitid: 73d86fe (compiled Sep 14 2020, 16:47:32)\r\n",
      "votca_tools, version 2021-dev gitid: 73d86fe (compiled Sep 14 2020, 16:47:29)\r\n",
      "\r\n",
      "Initializing tool\r\n",
      "... partialcharges Evaluating tool\r\n",
      "... partialcharges \r\n",
      "... ...  Loading QM data from methane.orb\r\n",
      "... ... ===== Running on 1 threads ===== \r\n",
      "... ... 2020-9-14 16:57:40 Calculated Densities at Numerical Grid, Number of electrons is 2.3768e-08\r\n",
      "... ... 2020-9-14 16:57:40 Calculating ESP at CHELPG grid points\r\n",
      "... ... 2020-9-14 16:57:45 Netcharge constrained to 0\r\n",
      "... ...  Sum of fitted charges: -2.41335e-14\r\n",
      "... ...  RMSE of fit:  0.00221575\r\n",
      "... ...  RRMSE of fit: 0.107178\r\n",
      "... ... El Dipole from fitted charges [e*bohr]:\r\n",
      "\t\t dx = -0.7281 dy = +0.4710 dz = -0.4704 |d|^2 = +0.9733\r\n",
      "... ... El Dipole from exact qm density [e*bohr]:\r\n",
      "\t\t dx = -0.7623 dy = +0.4937 dz = -0.4931 |d|^2 = +1.0680\r\n",
      "... ... Written charges to methane.mps"
     ]
    }
   ],
   "source": [
    "!xtp_tools -n methane -e partialcharges"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Spectrum Calculation\n",
    "Finally, lets compute a convolution of the singlet spectrum using a gaussian function. For doing so, we will modify the default values for the [spectrum calculator](https://votca.github.io/spectrum.html) to compute the spectrum between 9 and 25 eV, using 1000 points in that energy range. We will first grap a copy of [spectrum calculator](https://votca.github.io/spectrum.html) and the modify its values as follows,"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "The option 'lower' on file 'OPTIONFILES/spectrum.xml' has been set to '9'\n",
      "The option 'upper' on file 'OPTIONFILES/spectrum.xml' has been set to '25'\n",
      "The option 'points' on file 'OPTIONFILES/spectrum.xml' has been set to '1000'\n"
     ]
    }
   ],
   "source": [
    "!cp $VOTCASHARE/xtp/xml/spectrum.xml OPTIONFILES\n",
    "edit_calculator(\"spectrum\", \"lower\", \"9\")\n",
    "edit_calculator(\"spectrum\", \"upper\", \"25\")\n",
    "edit_calculator(\"spectrum\", \"points\", \"1000\")"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Finally, we can invoke the calculator"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Registered spectrum==================================================\r\n",
      "========   VOTCA (http://www.votca.org)   ========\r\n",
      "==================================================\r\n",
      "\r\n",
      "please submit bugs to https://github.com/votca/xtp/issues\r\n",
      "\r\n",
      "xtp_tools, version 2021-dev gitid: 73d86fe (compiled Sep 14 2020, 16:49:51)\r\n",
      "votca_csg, version 2021-dev gitid: 73d86fe (compiled Sep 14 2020, 16:47:32)\r\n",
      "votca_tools, version 2021-dev gitid: 73d86fe (compiled Sep 14 2020, 16:47:29)\r\n",
      "\r\n",
      "Initializing tool\r\n",
      "... spectrum Evaluating tool\r\n",
      "... spectrum \r\n",
      "... ... Calculating absorption spectrum plot methane.orb\r\n",
      "... ...  Loading QM data from methane.orb\r\n",
      "... ...  Considering 5 excitation with max energy 13.8471 eV / min wave length 89.9395 nm\r\n",
      "... ...  Spectrum in energy range from  9 to 25 eV and with broadening of FWHM 0.2 eV written to file  methane_spectrum.dat"
     ]
    }
   ],
   "source": [
    "!xtp_tools -n methane -e spectrum -o OPTIONFILES/spectrum.xml"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "The results are stored in the `methane_spectrum.dat` file."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## (Optional) Plot the spectrum"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "We will use [matplotlib](https://matplotlib.org/), [seaborn](https://seaborn.pydata.org/) and [pandas](https://pandas.pydata.org/) libraries to plot the spectrum. You can install it using [pip](https://pip.pypa.io/en/stable/) like"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Requirement already satisfied: seaborn in /usr/lib/python3.8/site-packages (0.9.0)\r\n",
      "Requirement already satisfied: numpy>=1.9.3 in /usr/lib64/python3.8/site-packages (from seaborn) (1.18.4)\r\n",
      "Requirement already satisfied: scipy>=0.14.0 in /usr/lib64/python3.8/site-packages (from seaborn) (1.4.1)\r\n",
      "Requirement already satisfied: pandas>=0.15.2 in /usr/lib64/python3.8/site-packages (from seaborn) (0.25.3)\r\n",
      "Requirement already satisfied: matplotlib>=1.4.3 in /usr/lib64/python3.8/site-packages (from seaborn) (3.2.2)\r\n",
      "Requirement already satisfied: python-dateutil>=2.6.1 in /usr/lib/python3.8/site-packages (from pandas>=0.15.2->seaborn) (2.8.0)\r\n",
      "Requirement already satisfied: pytz>=2017.2 in /usr/lib/python3.8/site-packages (from pandas>=0.15.2->seaborn) (2020.1)\r\n",
      "Requirement already satisfied: cycler>=0.10 in /usr/lib/python3.8/site-packages (from matplotlib>=1.4.3->seaborn) (0.10.0)\r\n",
      "Requirement already satisfied: kiwisolver>=1.0.1 in /usr/lib64/python3.8/site-packages (from matplotlib>=1.4.3->seaborn) (1.2.0)\r\n",
      "Requirement already satisfied: pyparsing!=2.0.4,!=2.1.2,!=2.1.6,>=2.0.1 in /usr/lib/python3.8/site-packages (from matplotlib>=1.4.3->seaborn) (2.4.7)\r\n",
      "Requirement already satisfied: six>=1.5 in /usr/lib/python3.8/site-packages (from python-dateutil>=2.6.1->pandas>=0.15.2->seaborn) (1.14.0)\r\n"
     ]
    }
   ],
   "source": [
    "!pip install seaborn --user"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[]"
      ]
     },
     "execution_count": 11,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 360x360 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "import pandas as pd \n",
    "import matplotlib.pyplot as plt\n",
    "import seaborn as sns\n",
    "columns = [\"E(eV)\", \"epsGaussian\",\"IM(eps)Gaussian\",  \"epsLorentz\",  \"Im(esp)Lorentz\"] \n",
    "df = pd.read_table(\"methane_spectrum.dat\", comment=\"#\", sep='\\s+',names=columns) \n",
    "sns.relplot(x=\"E(eV)\", y=\"epsGaussian\", ci=None, kind=\"line\", data=df) \n",
    "plt.plot()"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.8.5"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 4
}
