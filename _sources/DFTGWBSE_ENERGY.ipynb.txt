{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# DFT + GWBSE Energy Calculation Using CH4"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Introduction"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "This tutorial explains how to perform calculation to predict electronic excitation using the **GWBSE** method. See [the GW Compendium: A Practical Guide to Theoretical Photoemission Spectroscopy](https://doi.org/10.3389/fchem.2019.00377), for an excellent introduction to the method."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Requirements\n",
    "* You will need to install **VOTCA** using the instructions described [here](https://github.com/votca/votca/blob/master/share/doc/INSTALL.md)\n",
    "* Once the installation is completed you need to activate the VOTCA enviroment by running the `VOTCARC.bash` script that has been installed at the bin subfolder for the path that you have provided for the installation step above"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Interacting with the XTP command line interface\n",
    "To run a DFT-GWBSE calculation we will use the [xtp_tools](https://votca.github.io/xtp_tools.html) calculator. Run the following command to view the help message of `xtp_tools`:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "==================================================\r\n",
      "========   VOTCA (http://www.votca.org)   ========\r\n",
      "==================================================\r\n",
      "\r\n",
      "please submit bugs to https://github.com/votca/xtp/issues\r\n",
      "\r\n",
      "xtp_tools, version 2021-dev gitid: 5bd0511 (compiled Aug 18 2020, 15:16:14)\r\n",
      "votca_csg, version 2021-dev gitid: 5bd0511 (compiled Aug 18 2020, 15:02:00)\r\n",
      "votca_tools, version 2021-dev gitid: 5bd0511 (compiled Aug 18 2020, 14:59:08)\r\n",
      "\r\n",
      "Runs excitation/charge transport tools\r\n",
      "\r\n",
      "\r\n",
      "\r\n",
      "Allowed options:\r\n",
      "  -h [ --help ]                 display this help and exit\r\n",
      "  --verbose                     be loud and noisy\r\n",
      "  --verbose1                    be very loud and noisy\r\n",
      "  -v [ --verbose2 ]             be extremly loud and noisy\r\n",
      "  -o [ --options ] arg          calculator options\r\n",
      "  -t [ --nthreads ] arg (=1)    number of threads to create\r\n",
      "\r\n",
      "Tools:\r\n",
      "  -e [ --execute ] arg        List of tools separated by ',' or ' '\r\n",
      "  -l [ --list ]               Lists all available tools\r\n",
      "  -d [ --description ] arg    Short description of a tool\r\n",
      "  -n [ --name ] arg           Name of the job to run\r\n",
      "\r\n"
     ]
    }
   ],
   "source": [
    "!xtp_tools --help"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Note\n",
    "> * In Jupyter the `!` symbol means: *run the following command as a standard unix command*\n",
    "> * In Jupyter the command `%env` set an environmental variable"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Running a calculation with the default options\n",
    "To run a DFT-GWBSE calculation we just need to provide the path to the file in XYZ with the molecular coordinates. Check the [dftgwbse defaults](https://votca.github.io/dftgwbse.html) for further information."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [],
   "source": [
    "!xtp_tools -n methane -t 2 -e dftgwbse > dftgwbse.log"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "The previous command will run the DFT-GWBSE calculation using the aforementioned defaults and the results are store in the *Current Work Directory* in a file named `methane_summary.xml`."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Running a calculation using your own input file\n",
    "Let create a folder to store the input `options` for XTP and copy the defaults in there"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [],
   "source": [
    "!mkdir -p OPTIONFILES\n",
    "!cp $VOTCASHARE/xtp/xml/dftgwbse.xml OPTIONFILES"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "You should have a *XML* file with the DFTWGSE options that looks like"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<?xml version=\"1.0\"?>\r\n",
      "<options>\r\n",
      "  <!-- xtp_tools -e dftgwbse options.xml -->\r\n",
      "  <dftgwbse help=\"Compute electronic excitations using GW-BSE\">\r\n",
      "    <optimize help=\"Perform a molecular geometry optimization\" default=\"false\" choices=\"bool\"/>\r\n",
      "    <basisset help=\"Basis set for MOs\" default=\"def2-tzvp\"/>\r\n",
      "    <auxbasisset help=\"Auxiliary basis set for RI\" default=\"aux-def2-tzvp\"/>\r\n",
      "    <functional help=\"Functional name(s) according to LIBXC\" default=\"XC_HYB_GGA_XC_PBEH\"/>\r\n",
      "    <dftpackage>\r\n",
      "      <package>\r\n"
     ]
    }
   ],
   "source": [
    "!head -n 10 OPTIONFILES/dftgwbse.xml"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "We will use the folling python snippet to change the `basisset` and the `auxbasisset`,"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "The option 'basisset' on file 'OPTIONFILES/dftgwbse.xml' has been set to 'ubecppol'\n",
      "The option 'auxbasisset' on file 'OPTIONFILES/dftgwbse.xml' has been set to 'aux-ubecppol'\n"
     ]
    }
   ],
   "source": [
    "from xml_editor import edit_calculator\n",
    "edit_calculator(\"dftgwbse\", \"basisset\", \"ubecppol\")\n",
    "edit_calculator(\"dftgwbse\", \"auxbasisset\", \"aux-ubecppol\")"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Now you can run the calculation using the `-o` command line argument, as follows"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [],
   "source": [
    "!xtp_tools -n methane -t 2 -e dftgwbse -o OPTIONFILES/dftgwbse.xml > dftgwbse.log"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Note\n",
    "Alternatively you could have create an empty `dftgwbse.xml` file and add the `basisset` and the `auxbasisset` by hand, as follows,"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "```xml\n",
    "<options>\n",
    "  \n",
    "  <dftgwbse help=\"Compute electronic excitations using GW-BSE\">\n",
    "    <basisset>ubecppol</basisset>\n",
    "    <auxbasisset>aux-ubecppol</auxbasisset>\n",
    "  </dftgwbse>\n",
    "\n",
    "</options>\n",
    "```"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "XTP will automatically compare the default values with the user-provided and overwrites the defaults with the user input. Also, If I given property does not have a default value you can provide one using the XML file described above."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Partial Charges\n",
    "We can compute now the partial charges using the `CHELPG` method by default. For more information see the [partialcharges documentation](https://votca.github.io/partialcharges.html). Once again, we only need to provide the name of the system to compute, which in our case is `methane`."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Registered partialcharges==================================================\r\n",
      "========   VOTCA (http://www.votca.org)   ========\r\n",
      "==================================================\r\n",
      "\r\n",
      "please submit bugs to https://github.com/votca/xtp/issues\r\n",
      "\r\n",
      "xtp_tools, version 2021-dev gitid: 5bd0511 (compiled Aug 18 2020, 15:16:14)\r\n",
      "votca_csg, version 2021-dev gitid: 5bd0511 (compiled Aug 18 2020, 15:02:00)\r\n",
      "votca_tools, version 2021-dev gitid: 5bd0511 (compiled Aug 18 2020, 14:59:08)\r\n",
      "\r\n",
      "Initializing tool\r\n",
      "... partialcharges Evaluating tool\r\n",
      "... partialcharges \r\n",
      "... ...  Loading QM data from methane.orb\r\n",
      "... ... ===== Running on 1 threads ===== \r\n",
      "... ... 2020-8-18 15:29:8 Calculated Densities at Numerical Grid, Number of electrons is -2.37781e-08\r\n",
      "... ... 2020-8-18 15:29:8 Calculating ESP at CHELPG grid points\r\n",
      "... ... 2020-8-18 15:29:10 Netcharge constrained to 0\r\n",
      "... ...  Sum of fitted charges: 2.42584e-14\r\n",
      "... ...  RMSE of fit:  0.00221568\r\n",
      "... ...  RRMSE of fit: 0.107176\r\n",
      "... ... El Dipole from fitted charges [e*bohr]:\r\n",
      "\t\t dx = +0.7284 dy = -0.4706 dz = +0.4703 |d|^2 = +0.9732\r\n",
      "... ... El Dipole from exact qm density [e*bohr]:\r\n",
      "\t\t dx = +0.7626 dy = -0.4933 dz = +0.4930 |d|^2 = +1.0680\r\n",
      "... ... Written charges to methane.mps"
     ]
    }
   ],
   "source": [
    "!xtp_tools -n methane -e partialcharges"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Spectrum Calculation\n",
    "Finally, lets compute a convolution of the singlet spectrum using a gaussian function. For doing so, we will modify the default values for the [spectrum calculator](https://votca.github.io/spectrum.html) to compute the spectrum between 9 and 25 eV, using 1000 points in that energy range. We will first grap a copy of [spectrum calculator](https://votca.github.io/spectrum.html) and the modify its values as follows,"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "The option 'lower' on file 'OPTIONFILES/spectrum.xml' has been set to '9'\n",
      "The option 'upper' on file 'OPTIONFILES/spectrum.xml' has been set to '25'\n",
      "The option 'points' on file 'OPTIONFILES/spectrum.xml' has been set to '1000'\n"
     ]
    }
   ],
   "source": [
    "!cp $VOTCASHARE/xtp/xml/spectrum.xml OPTIONFILES\n",
    "edit_calculator(\"spectrum\", \"lower\", \"9\")\n",
    "edit_calculator(\"spectrum\", \"upper\", \"25\")\n",
    "edit_calculator(\"spectrum\", \"points\", \"1000\")"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Finally, we can invoke the calculator"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Registered spectrum==================================================\r\n",
      "========   VOTCA (http://www.votca.org)   ========\r\n",
      "==================================================\r\n",
      "\r\n",
      "please submit bugs to https://github.com/votca/xtp/issues\r\n",
      "\r\n",
      "xtp_tools, version 2021-dev gitid: 5bd0511 (compiled Aug 18 2020, 15:16:14)\r\n",
      "votca_csg, version 2021-dev gitid: 5bd0511 (compiled Aug 18 2020, 15:02:00)\r\n",
      "votca_tools, version 2021-dev gitid: 5bd0511 (compiled Aug 18 2020, 14:59:08)\r\n",
      "\r\n",
      "Initializing tool\r\n",
      "... spectrum Evaluating tool\r\n",
      "... spectrum \r\n",
      "... ... Calculating absorption spectrum plot methane.orb\r\n",
      "... ...  Loading QM data from methane.orb\r\n",
      "... ...  Considering 5 excitation with max energy 13.8471 eV / min wave length 89.9395 nm\r\n",
      "... ...  Spectrum in energy range from  9 to 25 eV and with broadening of FWHM 0.2 eV written to file  methane_spectrum.dat"
     ]
    }
   ],
   "source": [
    "!xtp_tools -n methane -e spectrum -o OPTIONFILES/spectrum.xml"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "The results are stored in the `methane_spectrum.dat` file."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## (Optional) Plot the spectrum"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "We will use [matplotlib](https://matplotlib.org/), [seaborn](https://seaborn.pydata.org/) and [pandas](https://pandas.pydata.org/) libraries to plot the spectrum. You can install it using [pip](https://pip.pypa.io/en/stable/) like"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Requirement already satisfied: seaborn in /usr/lib/python3.8/site-packages (0.9.0)\r\n",
      "Requirement already satisfied: numpy>=1.9.3 in /usr/lib64/python3.8/site-packages (from seaborn) (1.18.4)\r\n",
      "Requirement already satisfied: scipy>=0.14.0 in /usr/lib64/python3.8/site-packages (from seaborn) (1.4.1)\r\n",
      "Requirement already satisfied: pandas>=0.15.2 in /usr/lib64/python3.8/site-packages (from seaborn) (0.25.3)\r\n",
      "Requirement already satisfied: matplotlib>=1.4.3 in /usr/lib64/python3.8/site-packages (from seaborn) (3.2.2)\r\n",
      "Requirement already satisfied: python-dateutil>=2.6.1 in /usr/lib/python3.8/site-packages (from pandas>=0.15.2->seaborn) (2.8.0)\r\n",
      "Requirement already satisfied: pytz>=2017.2 in /usr/lib/python3.8/site-packages (from pandas>=0.15.2->seaborn) (2020.1)\r\n",
      "Requirement already satisfied: cycler>=0.10 in /usr/lib/python3.8/site-packages (from matplotlib>=1.4.3->seaborn) (0.10.0)\r\n",
      "Requirement already satisfied: kiwisolver>=1.0.1 in /usr/lib64/python3.8/site-packages (from matplotlib>=1.4.3->seaborn) (1.2.0)\r\n",
      "Requirement already satisfied: pyparsing!=2.0.4,!=2.1.2,!=2.1.6,>=2.0.1 in /usr/lib/python3.8/site-packages (from matplotlib>=1.4.3->seaborn) (2.4.7)\r\n",
      "Requirement already satisfied: six>=1.5 in /usr/lib/python3.8/site-packages (from python-dateutil>=2.6.1->pandas>=0.15.2->seaborn) (1.14.0)\r\n"
     ]
    }
   ],
   "source": [
    "!pip install seaborn --user"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[]"
      ]
     },
     "execution_count": 11,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 360x360 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "import pandas as pd \n",
    "import matplotlib.pyplot as plt\n",
    "import seaborn as sns\n",
    "columns = [\"E(eV)\", \"epsGaussian\",\"IM(eps)Gaussian\",  \"epsLorentz\",  \"Im(esp)Lorentz\"] \n",
    "df = pd.read_table(\"methane_spectrum.dat\", comment=\"#\", sep='\\s+',names=columns) \n",
    "sns.relplot(x=\"E(eV)\", y=\"epsGaussian\", ci=None, kind=\"line\", data=df) \n",
    "plt.plot()"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.8.5"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 4
}
