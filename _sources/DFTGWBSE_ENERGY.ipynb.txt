{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# DFT + GWBSE Energy Calculation Using CH4"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Introduction"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "This tutorial explains how to perform calculation to predict electronic excitation using the **GWBSE** method. See [the GW Compendium: A Practical Guide to Theoretical Photoemission Spectroscopy](https://doi.org/10.3389/fchem.2019.00377), for an excellent introduction to the method."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Requirements\n",
    "* You will need to install **VOTCA** using the instructions described [here](https://github.com/votca/votca/blob/master/share/doc/INSTALL.md)\n",
    "* Once the installation is completed you need to activate the VOTCA enviroment by running the `VOTCARC.bash` script that has been installed at the bin subfolder for the path that you have provided for the installation step above"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Interacting with the XTP command line interface\n",
    "To run a DFT-GWBSE calculation we will use the [xtp_tools](https://votca.github.io/xtp_tools.html) calculator. Run the following command to view the help message of `xtp_tools`:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "==================================================\r\n",
      "========   VOTCA (http://www.votca.org)   ========\r\n",
      "==================================================\r\n",
      "\r\n",
      "please submit bugs to https://github.com/votca/xtp/issues\r\n",
      "\r\n",
      "xtp_tools, version 2021-dev gitid: 2176df9 (compiled Aug 23 2020, 00:17:51)\r\n",
      "votca_csg, version 2021-dev gitid: 2176df9 (compiled Aug 23 2020, 00:17:31)\r\n",
      "votca_tools, version 2021-dev gitid: 2176df9 (compiled Aug 23 2020, 00:17:27)\r\n",
      "\r\n",
      "Runs excitation/charge transport tools\r\n",
      "\r\n",
      "\r\n",
      "\r\n",
      "Allowed options:\r\n",
      "  -h [ --help ]                 display this help and exit\r\n",
      "  --verbose                     be loud and noisy\r\n",
      "  --verbose1                    be very loud and noisy\r\n",
      "  -v [ --verbose2 ]             be extremly loud and noisy\r\n",
      "  -o [ --options ] arg          calculator options\r\n",
      "  -t [ --nthreads ] arg (=1)    number of threads to create\r\n",
      "\r\n",
      "Tools:\r\n",
      "  -e [ --execute ] arg        List of tools separated by ',' or ' '\r\n",
      "  -l [ --list ]               Lists all available tools\r\n",
      "  -d [ --description ] arg    Short description of a tool\r\n",
      "  -n [ --name ] arg           Name of the job to run\r\n",
      "\r\n"
     ]
    }
   ],
   "source": [
    "!xtp_tools --help"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Note\n",
    "> * In Jupyter the `!` symbol means: *run the following command as a standard unix command*\n",
    "> * In Jupyter the command `%env` set an environmental variable"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Running a calculation with the default options\n",
    "To run a DFT-GWBSE calculation we just need to provide the path to the file in XYZ with the molecular coordinates. Check the [dftgwbse defaults](https://votca.github.io/dftgwbse.html) for further information."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [],
   "source": [
    "!xtp_tools -n methane -t 2 -e dftgwbse > dftgwbse.log"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "The previous command will run the DFT-GWBSE calculation using the aforementioned defaults and the results are store in the *Current Work Directory* in a file named `methane_summary.xml`."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Running a calculation using your own input file\n",
    "Let create a folder to store the input `options` for XTP and copy the defaults in there"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [],
   "source": [
    "!mkdir -p OPTIONFILES\n",
    "!cp $VOTCASHARE/xtp/xml/dftgwbse.xml OPTIONFILES"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "You should have a *XML* file with the DFTWGSE options that looks like"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<?xml version=\"1.0\"?>\r\n",
      "<options>\r\n",
      "  <!-- xtp_tools -e dftgwbse options.xml -->\r\n",
      "  <dftgwbse help=\"Compute electronic excitations using GW-BSE\">\r\n",
      "    <optimize help=\"Perform a molecular geometry optimization\" default=\"false\" choices=\"bool\"/>\r\n",
      "    <basisset help=\"Basis set for MOs\" default=\"def2-tzvp\"/>\r\n",
      "    <auxbasisset help=\"Auxiliary basis set for RI\" default=\"aux-def2-tzvp\"/>\r\n",
      "    <functional help=\"Functional name(s) according to LIBXC\" default=\"XC_HYB_GGA_XC_PBEH\"/>\r\n",
      "    <dftpackage>\r\n",
      "      <package>\r\n"
     ]
    }
   ],
   "source": [
    "!head -n 10 OPTIONFILES/dftgwbse.xml"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "We will use the folling python snippet to change the `basisset` and the `auxbasisset`,"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "The option 'basisset' on file 'OPTIONFILES/dftgwbse.xml' has been set to 'ubecppol'\n",
      "The option 'auxbasisset' on file 'OPTIONFILES/dftgwbse.xml' has been set to 'aux-ubecppol'\n"
     ]
    }
   ],
   "source": [
    "from xml_editor import edit_calculator\n",
    "edit_calculator(\"dftgwbse\", \"basisset\", \"ubecppol\")\n",
    "edit_calculator(\"dftgwbse\", \"auxbasisset\", \"aux-ubecppol\")"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Now you can run the calculation using the `-o` command line argument, as follows"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [],
   "source": [
    "!xtp_tools -n methane -t 2 -e dftgwbse -o OPTIONFILES/dftgwbse.xml > dftgwbse.log"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Note\n",
    "Alternatively you could have create an empty `dftgwbse.xml` file and add the `basisset` and the `auxbasisset` by hand, as follows,"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "```xml\n",
    "<options>\n",
    "  \n",
    "  <dftgwbse help=\"Compute electronic excitations using GW-BSE\">\n",
    "    <basisset>ubecppol</basisset>\n",
    "    <auxbasisset>aux-ubecppol</auxbasisset>\n",
    "  </dftgwbse>\n",
    "\n",
    "</options>\n",
    "```"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "XTP will automatically compare the default values with the user-provided and overwrites the defaults with the user input. Also, If I given property does not have a default value you can provide one using the XML file described above."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Partial Charges\n",
    "We can compute now the partial charges using the `CHELPG` method by default. For more information see the [partialcharges documentation](https://votca.github.io/partialcharges.html). Once again, we only need to provide the name of the system to compute, which in our case is `methane`."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Registered partialcharges==================================================\r\n",
      "========   VOTCA (http://www.votca.org)   ========\r\n",
      "==================================================\r\n",
      "\r\n",
      "please submit bugs to https://github.com/votca/xtp/issues\r\n",
      "\r\n",
      "xtp_tools, version 2021-dev gitid: 2176df9 (compiled Aug 23 2020, 00:17:51)\r\n",
      "votca_csg, version 2021-dev gitid: 2176df9 (compiled Aug 23 2020, 00:17:31)\r\n",
      "votca_tools, version 2021-dev gitid: 2176df9 (compiled Aug 23 2020, 00:17:27)\r\n",
      "\r\n",
      "Initializing tool\r\n",
      "... partialcharges Evaluating tool\r\n",
      "... partialcharges \r\n",
      "... ...  Loading QM data from methane.orb\r\n",
      "... ... ===== Running on 1 threads ===== \r\n",
      "... ... 2020-8-23 0:25:57 Calculated Densities at Numerical Grid, Number of electrons is -2.37532e-08\r\n",
      "... ... 2020-8-23 0:25:57 Calculating ESP at CHELPG grid points\r\n",
      "... ... 2020-8-23 0:25:59 Netcharge constrained to 0\r\n",
      "... ...  Sum of fitted charges: 2.41751e-14\r\n",
      "... ...  RMSE of fit:  0.0022158\r\n",
      "... ...  RRMSE of fit: 0.107183\r\n",
      "... ... El Dipole from fitted charges [e*bohr]:\r\n",
      "\t\t dx = +0.7278 dy = -0.4712 dz = +0.4705 |d|^2 = +0.9732\r\n",
      "... ... El Dipole from exact qm density [e*bohr]:\r\n",
      "\t\t dx = +0.7620 dy = -0.4940 dz = +0.4932 |d|^2 = +1.0679\r\n",
      "... ... Written charges to methane.mps"
     ]
    }
   ],
   "source": [
    "!xtp_tools -n methane -e partialcharges"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Spectrum Calculation\n",
    "Finally, lets compute a convolution of the singlet spectrum using a gaussian function. For doing so, we will modify the default values for the [spectrum calculator](https://votca.github.io/spectrum.html) to compute the spectrum between 9 and 25 eV, using 1000 points in that energy range. We will first grap a copy of [spectrum calculator](https://votca.github.io/spectrum.html) and the modify its values as follows,"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "The option 'lower' on file 'OPTIONFILES/spectrum.xml' has been set to '9'\n",
      "The option 'upper' on file 'OPTIONFILES/spectrum.xml' has been set to '25'\n",
      "The option 'points' on file 'OPTIONFILES/spectrum.xml' has been set to '1000'\n"
     ]
    }
   ],
   "source": [
    "!cp $VOTCASHARE/xtp/xml/spectrum.xml OPTIONFILES\n",
    "edit_calculator(\"spectrum\", \"lower\", \"9\")\n",
    "edit_calculator(\"spectrum\", \"upper\", \"25\")\n",
    "edit_calculator(\"spectrum\", \"points\", \"1000\")"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Finally, we can invoke the calculator"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Registered spectrum==================================================\r\n",
      "========   VOTCA (http://www.votca.org)   ========\r\n",
      "==================================================\r\n",
      "\r\n",
      "please submit bugs to https://github.com/votca/xtp/issues\r\n",
      "\r\n",
      "xtp_tools, version 2021-dev gitid: 2176df9 (compiled Aug 23 2020, 00:17:51)\r\n",
      "votca_csg, version 2021-dev gitid: 2176df9 (compiled Aug 23 2020, 00:17:31)\r\n",
      "votca_tools, version 2021-dev gitid: 2176df9 (compiled Aug 23 2020, 00:17:27)\r\n",
      "\r\n",
      "Initializing tool\r\n",
      "... spectrum Evaluating tool\r\n",
      "... spectrum \r\n",
      "... ... Calculating absorption spectrum plot methane.orb\r\n",
      "... ...  Loading QM data from methane.orb\r\n",
      "... ...  Considering 5 excitation with max energy 13.8471 eV / min wave length 89.9395 nm\r\n",
      "... ...  Spectrum in energy range from  9 to 25 eV and with broadening of FWHM 0.2 eV written to file  methane_spectrum.dat"
     ]
    }
   ],
   "source": [
    "!xtp_tools -n methane -e spectrum -o OPTIONFILES/spectrum.xml"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "The results are stored in the `methane_spectrum.dat` file."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## (Optional) Plot the spectrum"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "We will use [matplotlib](https://matplotlib.org/), [seaborn](https://seaborn.pydata.org/) and [pandas](https://pandas.pydata.org/) libraries to plot the spectrum. You can install it using [pip](https://pip.pypa.io/en/stable/) like"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Requirement already satisfied: seaborn in /usr/lib/python3.8/site-packages (0.9.0)\r\n",
      "Requirement already satisfied: numpy>=1.9.3 in /usr/lib64/python3.8/site-packages (from seaborn) (1.18.4)\r\n",
      "Requirement already satisfied: scipy>=0.14.0 in /usr/lib64/python3.8/site-packages (from seaborn) (1.4.1)\r\n",
      "Requirement already satisfied: pandas>=0.15.2 in /usr/lib64/python3.8/site-packages (from seaborn) (0.25.3)\r\n",
      "Requirement already satisfied: matplotlib>=1.4.3 in /usr/lib64/python3.8/site-packages (from seaborn) (3.2.2)\r\n",
      "Requirement already satisfied: python-dateutil>=2.6.1 in /usr/lib/python3.8/site-packages (from pandas>=0.15.2->seaborn) (2.8.0)\r\n",
      "Requirement already satisfied: pytz>=2017.2 in /usr/lib/python3.8/site-packages (from pandas>=0.15.2->seaborn) (2020.1)\r\n",
      "Requirement already satisfied: cycler>=0.10 in /usr/lib/python3.8/site-packages (from matplotlib>=1.4.3->seaborn) (0.10.0)\r\n",
      "Requirement already satisfied: kiwisolver>=1.0.1 in /usr/lib64/python3.8/site-packages (from matplotlib>=1.4.3->seaborn) (1.2.0)\r\n",
      "Requirement already satisfied: pyparsing!=2.0.4,!=2.1.2,!=2.1.6,>=2.0.1 in /usr/lib/python3.8/site-packages (from matplotlib>=1.4.3->seaborn) (2.4.7)\r\n",
      "Requirement already satisfied: six>=1.5 in /usr/lib/python3.8/site-packages (from python-dateutil>=2.6.1->pandas>=0.15.2->seaborn) (1.14.0)\r\n"
     ]
    }
   ],
   "source": [
    "!pip install seaborn --user"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[]"
      ]
     },
     "execution_count": 11,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 360x360 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "import pandas as pd \n",
    "import matplotlib.pyplot as plt\n",
    "import seaborn as sns\n",
    "columns = [\"E(eV)\", \"epsGaussian\",\"IM(eps)Gaussian\",  \"epsLorentz\",  \"Im(esp)Lorentz\"] \n",
    "df = pd.read_table(\"methane_spectrum.dat\", comment=\"#\", sep='\\s+',names=columns) \n",
    "sns.relplot(x=\"E(eV)\", y=\"epsGaussian\", ci=None, kind=\"line\", data=df) \n",
    "plt.plot()"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.8.5"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 4
}
