{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# DFT + GWBSE Energy Calculation Using CH4"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Introduction"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "This tutorial explains how to perform calculation to predict electronic excitation using the **GWBSE** method. See [the GW Compendium: A Practical Guide to Theoretical Photoemission Spectroscopy](https://doi.org/10.3389/fchem.2019.00377), for an excellent introduction to the method."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Requirements\n",
    "* You will need to install **VOTCA** using the instructions described [here](https://github.com/votca/votca/blob/master/share/doc/INSTALL.md)\n",
    "* Once the installation is completed you need to activate the VOTCA enviroment by running the `VOTCARC.bash` script that has been installed at the bin subfolder for the path that you have provided for the installation step above"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Interacting with the XTP command line interface\n",
    "To run a DFT-GWBSE calculation we will use the [xtp_tools](https://votca.github.io/xtp_tools.html) calculator. Run the following command to view the help message of `xtp_tools`:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "==================================================\r\n",
      "========   VOTCA (http://www.votca.org)   ========\r\n",
      "==================================================\r\n",
      "\r\n",
      "please submit bugs to https://github.com/votca/xtp/issues\r\n",
      "\r\n",
      "xtp_tools, version 2021-dev gitid: 80cc8fd (compiled Aug  6 2020, 14:45:05)\r\n",
      "votca_csg, version 2021-dev gitid: 80cc8fd (compiled Aug  6 2020, 14:44:44)\r\n",
      "votca_tools, version 2021-dev gitid: 80cc8fd (compiled Aug  6 2020, 14:44:40)\r\n",
      "\r\n",
      "Runs excitation/charge transport tools\r\n",
      "\r\n",
      "\r\n",
      "\r\n",
      "Allowed options:\r\n",
      "  -h [ --help ]                 display this help and exit\r\n",
      "  --verbose                     be loud and noisy\r\n",
      "  --verbose1                    be very loud and noisy\r\n",
      "  -v [ --verbose2 ]             be extremly loud and noisy\r\n",
      "  -o [ --options ] arg          calculator options\r\n",
      "  -t [ --nthreads ] arg (=1)    number of threads to create\r\n",
      "\r\n",
      "Tools:\r\n",
      "  -e [ --execute ] arg        List of tools separated by ',' or ' '\r\n",
      "  -l [ --list ]               Lists all available tools\r\n",
      "  -d [ --description ] arg    Short description of a tool\r\n",
      "  -n [ --name ] arg           Name of the job to run\r\n",
      "\r\n"
     ]
    }
   ],
   "source": [
    "!xtp_tools --help"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Note\n",
    "> * In Jupyter the `!` symbol means: *run the following command as a standard unix command*\n",
    "> * In Jupyter the command `%env` set an environmental variable"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Running a calculation with the default options\n",
    "To run a DFT-GWBSE calculation we just need to provide the path to the file in XYZ with the molecular coordinates. Check the [dftgwbse defaults](https://votca.github.io/dftgwbse.html) for further information."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [],
   "source": [
    "!xtp_tools -n methane -t 2 -e dftgwbse > dftgwbse.log"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "The previous command will run the DFT-GWBSE calculation using the aforementioned defaults and the results are store in the *Current Work Directory* in a file named `methane_summary.xml`."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Running a calculation using your own input file\n",
    "Let create a folder to store the input `options` for XTP and copy the defaults in there"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [],
   "source": [
    "!mkdir -p OPTIONFILES\n",
    "!cp $VOTCASHARE/xtp/xml/dftgwbse.xml OPTIONFILES"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "You should have a *XML* file with the DFTWGSE options that looks like"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<?xml version=\"1.0\"?>\r\n",
      "<options>\r\n",
      "  <!-- xtp_tools -e dftgwbse options.xml -->\r\n",
      "  <dftgwbse help=\"Compute electronic excitations using GW-BSE\">\r\n",
      "    <optimize help=\"Perform a molecular geometry optimization\" default=\"false\" choices=\"bool\"/>\r\n",
      "    <basisset help=\"Basis set for MOs\" default=\"def2-tzvp\"/>\r\n",
      "    <auxbasisset help=\"Auxiliary basis set for RI\" default=\"aux-def2-tzvp\"/>\r\n",
      "    <functional help=\"Functional name(s) according to LIBXC\" default=\"XC_HYB_GGA_XC_PBEH\"/>\r\n",
      "    <dftpackage>\r\n",
      "      <package>\r\n"
     ]
    }
   ],
   "source": [
    "!head -n 10 OPTIONFILES/dftgwbse.xml"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "We will use the folling python snippet to change the `basisset` and the `auxbasisset`,"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "The option 'basisset' on file 'OPTIONFILES/dftgwbse.xml' has been set to 'ubecppol'\n",
      "The option 'auxbasisset' on file 'OPTIONFILES/dftgwbse.xml' has been set to 'aux-ubecppol'\n"
     ]
    }
   ],
   "source": [
    "from xml_editor import edit_calculator\n",
    "edit_calculator(\"dftgwbse\", \"basisset\", \"ubecppol\")\n",
    "edit_calculator(\"dftgwbse\", \"auxbasisset\", \"aux-ubecppol\")"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Now you can run the calculation using the `-o` command line argument, as follows"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [],
   "source": [
    "!xtp_tools -n methane -t 2 -e dftgwbse -o OPTIONFILES/dftgwbse.xml > dftgwbse.log"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Note\n",
    "Alternatively you could have create an empty `dftgwbse.xml` file and add the `basisset` and the `auxbasisset` by hand, as follows,"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "```xml\n",
    "<options>\n",
    "  \n",
    "  <dftgwbse help=\"Compute electronic excitations using GW-BSE\">\n",
    "    <basisset>ubecppol</basisset>\n",
    "    <auxbasisset>aux-ubecppol</auxbasisset>\n",
    "  </dftgwbse>\n",
    "\n",
    "</options>\n",
    "```"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "XTP will automatically compare the default values with the user-provided and overwrites the defaults with the user input. Also, If I given property does not have a default value you can provide one using the XML file described above."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Partial Charges\n",
    "We can compute now the partial charges using the `CHELPG` method by default. For more information see the [partialcharges documentation](https://votca.github.io/partialcharges.html). Once again, we only need to provide the name of the system to compute, which in our case is `methane`."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Registered partialcharges==================================================\r\n",
      "========   VOTCA (http://www.votca.org)   ========\r\n",
      "==================================================\r\n",
      "\r\n",
      "please submit bugs to https://github.com/votca/xtp/issues\r\n",
      "\r\n",
      "xtp_tools, version 2021-dev gitid: 80cc8fd (compiled Aug  6 2020, 14:45:05)\r\n",
      "votca_csg, version 2021-dev gitid: 80cc8fd (compiled Aug  6 2020, 14:44:44)\r\n",
      "votca_tools, version 2021-dev gitid: 80cc8fd (compiled Aug  6 2020, 14:44:40)\r\n",
      "\r\n",
      "Initializing tool\r\n",
      "... partialcharges Evaluating tool\r\n",
      "... partialcharges \r\n",
      "... ...  Loading QM data from methane.orb\r\n",
      "... ... ===== Running on 1 threads ===== \r\n",
      "... ... 2020-8-6 14:55:58 Calculated Densities at Numerical Grid, Number of electrons is 2.37612e-08\r\n",
      "... ... 2020-8-6 14:55:58 Calculating ESP at CHELPG grid points\r\n",
      "... ... 2020-8-6 14:56:0 Netcharge constrained to 0\r\n",
      "... ...  Sum of fitted charges: -2.41751e-14\r\n",
      "... ...  RMSE of fit:  0.0022158\r\n",
      "... ...  RRMSE of fit: 0.107183\r\n",
      "... ... El Dipole from fitted charges [e*bohr]:\r\n",
      "\t\t dx = -0.7279 dy = +0.4711 dz = -0.4705 |d|^2 = +0.9732\r\n",
      "... ... El Dipole from exact qm density [e*bohr]:\r\n",
      "\t\t dx = -0.7621 dy = +0.4939 dz = -0.4932 |d|^2 = +1.0680\r\n",
      "... ... Written charges to methane.mps"
     ]
    }
   ],
   "source": [
    "!xtp_tools -n methane -e partialcharges"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Spectrum Calculation\n",
    "Finally, lets compute a convolution of the singlet spectrum using a gaussian function. For doing so, we will modify the default values for the [spectrum calculator](https://votca.github.io/spectrum.html) to compute the spectrum between 9 and 25 eV, using 1000 points in that energy range. We will first grap a copy of [spectrum calculator](https://votca.github.io/spectrum.html) and the modify its values as follows,"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "The option 'lower' on file 'OPTIONFILES/spectrum.xml' has been set to '9'\n",
      "The option 'upper' on file 'OPTIONFILES/spectrum.xml' has been set to '25'\n",
      "The option 'points' on file 'OPTIONFILES/spectrum.xml' has been set to '1000'\n"
     ]
    }
   ],
   "source": [
    "!cp $VOTCASHARE/xtp/xml/spectrum.xml OPTIONFILES\n",
    "edit_calculator(\"spectrum\", \"lower\", \"9\")\n",
    "edit_calculator(\"spectrum\", \"upper\", \"25\")\n",
    "edit_calculator(\"spectrum\", \"points\", \"1000\")"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Finally, we can invoke the calculator"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Registered spectrum==================================================\r\n",
      "========   VOTCA (http://www.votca.org)   ========\r\n",
      "==================================================\r\n",
      "\r\n",
      "please submit bugs to https://github.com/votca/xtp/issues\r\n",
      "\r\n",
      "xtp_tools, version 2021-dev gitid: 80cc8fd (compiled Aug  6 2020, 14:45:05)\r\n",
      "votca_csg, version 2021-dev gitid: 80cc8fd (compiled Aug  6 2020, 14:44:44)\r\n",
      "votca_tools, version 2021-dev gitid: 80cc8fd (compiled Aug  6 2020, 14:44:40)\r\n",
      "\r\n",
      "Initializing tool\r\n",
      "... spectrum Evaluating tool\r\n",
      "... spectrum \r\n",
      "... ... Calculating absorption spectrum plot methane.orb\r\n",
      "... ...  Loading QM data from methane.orb\r\n",
      "... ...  Considering 5 excitation with max energy 13.8471 eV / min wave length 89.9395 nm\r\n",
      "... ...  Spectrum in energy range from  9 to 25 eV and with broadening of FWHM 0.2 eV written to file  methane_spectrum.dat"
     ]
    }
   ],
   "source": [
    "!xtp_tools -n methane -e spectrum -o OPTIONFILES/spectrum.xml"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "The results are stored in the `methane_spectrum.dat` file."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## (Optional) Plot the spectrum"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "We will use [matplotlib](https://matplotlib.org/), [seaborn](https://seaborn.pydata.org/) and [pandas](https://pandas.pydata.org/) libraries to plot the spectrum. You can install it using [pip](https://pip.pypa.io/en/stable/) like"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Requirement already satisfied: seaborn in /usr/lib/python3.8/site-packages (0.9.0)\r\n",
      "Requirement already satisfied: numpy>=1.9.3 in /usr/lib64/python3.8/site-packages (from seaborn) (1.18.4)\r\n",
      "Requirement already satisfied: scipy>=0.14.0 in /usr/lib64/python3.8/site-packages (from seaborn) (1.4.1)\r\n",
      "Requirement already satisfied: pandas>=0.15.2 in /usr/lib64/python3.8/site-packages (from seaborn) (0.25.3)\r\n",
      "Requirement already satisfied: matplotlib>=1.4.3 in /usr/lib64/python3.8/site-packages (from seaborn) (3.2.2)\r\n",
      "Requirement already satisfied: python-dateutil>=2.6.1 in /usr/lib/python3.8/site-packages (from pandas>=0.15.2->seaborn) (2.8.0)\r\n",
      "Requirement already satisfied: pytz>=2017.2 in /usr/lib/python3.8/site-packages (from pandas>=0.15.2->seaborn) (2020.1)\r\n",
      "Requirement already satisfied: cycler>=0.10 in /usr/lib/python3.8/site-packages (from matplotlib>=1.4.3->seaborn) (0.10.0)\r\n",
      "Requirement already satisfied: kiwisolver>=1.0.1 in /usr/lib64/python3.8/site-packages (from matplotlib>=1.4.3->seaborn) (1.2.0)\r\n",
      "Requirement already satisfied: pyparsing!=2.0.4,!=2.1.2,!=2.1.6,>=2.0.1 in /usr/lib/python3.8/site-packages (from matplotlib>=1.4.3->seaborn) (2.4.7)\r\n",
      "Requirement already satisfied: six>=1.5 in /usr/lib/python3.8/site-packages (from python-dateutil>=2.6.1->pandas>=0.15.2->seaborn) (1.14.0)\r\n"
     ]
    }
   ],
   "source": [
    "!pip install seaborn --user"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[]"
      ]
     },
     "execution_count": 11,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 360x360 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "import pandas as pd \n",
    "import matplotlib.pyplot as plt\n",
    "import seaborn as sns\n",
    "columns = [\"E(eV)\", \"epsGaussian\",\"IM(eps)Gaussian\",  \"epsLorentz\",  \"Im(esp)Lorentz\"] \n",
    "df = pd.read_table(\"methane_spectrum.dat\", comment=\"#\", sep='\\s+',names=columns) \n",
    "sns.relplot(x=\"E(eV)\", y=\"epsGaussian\", ci=None, kind=\"line\", data=df) \n",
    "plt.plot()"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.8.3"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 4
}
