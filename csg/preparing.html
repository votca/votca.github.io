<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Preparing coarse-grained runs &mdash; VOTCA 2025.1-dev documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/custom.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/documentation_options.js?v=ba612e73"></script>
        <script src="../_static/doctools.js?v=9bcbadda"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Methods" href="methods.html" />
    <link rel="prev" title="Input files" href="input_files.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html">
            
              <img src="../_static/customLogo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../INSTALL.html">Installation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Manuals</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">CSG Manual</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="theory.html">Theoretical background</a></li>
<li class="toctree-l2"><a class="reference internal" href="input_files.html">Input files</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Preparing coarse-grained runs</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#preliminary-note">Preliminary note</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#generating-a-topology-file-for-a-coarse-grained-run">Generating a topology file for a coarse-grained run</a></li>
<li class="toctree-l4"><a class="reference internal" href="#post-processing-of-the-potential">Post-processing of the potential</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#clipping-of-poorly-sampled-regions">Clipping of poorly sampled regions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#extrapolation">Extrapolation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="methods.html">Methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="advanced_topics.html">Advanced topics</a></li>
<li class="toctree-l2"><a class="reference internal" href="reference.html">Reference</a></li>
<li class="toctree-l2"><a class="reference internal" href="bibliography.html">Bibliography</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#citations">Citations</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#development">Development</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#copyright">Copyright</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../xtp/XTP-MANUAL.html">XTP Manual</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../xtp-tutorials/XTP-TUTORIAL.html">XTP Tutorials</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Development</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../DEVELOPERS_GUIDE.html">Developer and Contributor Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../VOTCA_LANGUAGE_GUIDE.html">VOTCA Internal Contributor Language Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Architecture.html">The architecture of VOTCA</a></li>
<li class="toctree-l1"><a class="reference internal" href="../xtp/Architecture.html">Architecture of votca-xtp</a></li>
<li class="toctree-l1"><a class="reference internal" href="../CODE_OF_CONDUCT.html">Code of Conduct</a></li>
<li class="toctree-l1"><a class="reference internal" href="../websiteAndDocumentation.html">Website and Documentation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Community</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://github.com/votca">GitHub</a></li>
<li class="toctree-l1"><a class="reference external" href="https://twitter.com/votca_software">Twitter</a></li>
<li class="toctree-l1"><a class="reference external" href="https://groups.google.com/g/votca">Forum</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">VOTCA</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">CSG Manual</a></li>
      <li class="breadcrumb-item active">Preparing coarse-grained runs</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/csg/preparing.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="preparing-coarse-grained-runs">
<span id="preparing"></span><h1>Preparing coarse-grained runs<a class="headerlink" href="#preparing-coarse-grained-runs" title="Link to this heading">¶</a></h1>
<section id="preliminary-note">
<h2>Preliminary note<a class="headerlink" href="#preliminary-note" title="Link to this heading">¶</a></h2>
<p>The coarse-grained run requires the molecule topology on the one hand
and suitable potentials on the other. In this chapter, the generation of
coarse-grained runs is described next, followed by a post-processing of
the potential.</p>
<p>If the potential is of such a form that it allows direct fitting of a
functional form, the section on post-processing can be skipped. Instead,
a program of choice should be used to fit a functional form to the
potential. Nevertheless, special attention should be paid to units
(angles, bond lengths). The resulting curve can then be specified in the
MD package used for simulation. However, most potentials don’t allow an
easy processing of this kind and tabulated potentials have to be used.</p>
<section id="generating-a-topology-file-for-a-coarse-grained-run">
<h3>Generating a topology file for a coarse-grained run<a class="headerlink" href="#generating-a-topology-file-for-a-coarse-grained-run" title="Link to this heading">¶</a></h3>
<p><strong>WARNING: This section describes experimental features. The exact names and options of the program might change in the near future. The section is specific to GROMACS support though a generalization for other MD packages is planned.</strong></p>
<p>The mapping definition is close to a topology needed for a coarse
grained run. To avoid redundant work, <code class="docutils literal notranslate"><span class="pre">csg_gmxtopol</span></code> can be used to automatically
generate a gromacs topology based on an atomistic reference system and a
mapping file.</p>
<p>At the current state, <code class="docutils literal notranslate"><span class="pre">csg_gmxtopol</span></code> can only generate the topology for the first
molecule in the system. If more molecule types are present, a special
tpr file has to be prepared. The program can be executed by</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>csg_gmxtopol<span class="w"> </span>--top<span class="w"> </span>topol.tpr<span class="w"> </span>--cg<span class="w"> </span>map.xml<span class="w"> </span>--out<span class="w"> </span>cgtop
</pre></div>
</div>
<p>which will create a file <code class="docutils literal notranslate"><span class="pre">cgtop.top</span></code>. This file includes the topology
for the first molecule including definitions for atoms, bonds, angles
and dihedrals. It can directly be used as a topology in GROMACS, however
the force field definitions (atom types, bond types, etc.) still have to
be added manually.</p>
</section>
<section id="post-processing-of-the-potential">
<span id="preparing-post-processing-of-the-potential"></span><h3>Post-processing of the potential<a class="headerlink" href="#post-processing-of-the-potential" title="Link to this heading">¶</a></h3>
<p>The post-processing roughly consists of the following steps (see further
explanations below):</p>
<ul class="simple">
<li><p>(manually) clipping poorly sampled (border) regions</p></li>
<li><p>resampling the potential in order to change the grid to the proper
format ()</p></li>
<li><p>extrapolation of the potential at the borders ( table extrapolate)</p></li>
<li><p>exporting the table to xvg ( convert_potential gromacs)</p></li>
</ul>
</section>
</section>
<section id="clipping-of-poorly-sampled-regions">
<h2>Clipping of poorly sampled regions<a class="headerlink" href="#clipping-of-poorly-sampled-regions" title="Link to this heading">¶</a></h2>
<p>Regions with an irregular distribution of samples should be deleted
first. This is simply done by editing the <code class="docutils literal notranslate"><span class="pre">.pot</span></code> file and by deleting
those values.</p>
<p>Alternatively, manually check the range where the potential still looks
good and is not to noisy and set the flags in the potential file of the
bad parts by hand to <code class="docutils literal notranslate"><span class="pre">o</span></code> (for <code class="docutils literal notranslate"><span class="pre">out</span> <span class="pre">of</span> <span class="pre">range</span></code>). Those values will
later be extrapolated and overwritten.</p>
</section>
<section id="extrapolation">
<h2>Extrapolation<a class="headerlink" href="#extrapolation" title="Link to this heading">¶</a></h2>
<p>After resampling, all values in the potential file that should be used
as a basis for extrapolation are marked with an <code class="docutils literal notranslate"><span class="pre">i</span></code>, while all values
that need extrapolation are marked by <code class="docutils literal notranslate"><span class="pre">o</span></code>. The command above now
extrapolates all <code class="docutils literal notranslate"><span class="pre">o</span></code> values from the <code class="docutils literal notranslate"><span class="pre">i</span></code> values in the file.
Available options include averaging over a certain number of points
(<code class="docutils literal notranslate"><span class="pre">avgpoints</span></code>), changing the functional form (<code class="docutils literal notranslate"><span class="pre">function</span></code>, default is
quadratic), extrapolating just the left or right region of the file
(<code class="docutils literal notranslate"><span class="pre">region</span></code>) and setting the curvature (<code class="docutils literal notranslate"><span class="pre">curvature</span></code>).</p>
<p>The output <code class="docutils literal notranslate"><span class="pre">table_extrapolate.pot</span></code> of the extrapolation step can now
be used for the coarse-grained run. If GROMACS is used as a molecule
dynamics package, the potential has to be converted and exported to a
suitable GROMACS format as described in the final step.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="input_files.html" class="btn btn-neutral float-left" title="Input files" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="methods.html" class="btn btn-neutral float-right" title="Methods" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, VOTCA Development Team.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>