<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Theoretical background &mdash; VOTCA 2025.1-dev documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/custom.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/documentation_options.js?v=ba612e73"></script>
        <script src="../_static/doctools.js?v=9bcbadda"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Input files" href="input_files.html" />
    <link rel="prev" title="Introduction" href="introduction.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html">
            
              <img src="../_static/customLogo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../INSTALL.html">Installation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Manuals</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">CSG Manual</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Theoretical background</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#mapping">Mapping</a></li>
<li class="toctree-l3"><a class="reference internal" href="#boltzmann-inversion">Boltzmann inversion</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#separation-of-bonded-and-non-bonded-degrees-of-freedom">Separation of bonded and non-bonded degrees of freedom</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#force-matching">Force Matching</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#three-body-stillinger-weber-interactions">Three-body Stillinger-Weber interactions</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="input_files.html">Input files</a></li>
<li class="toctree-l2"><a class="reference internal" href="preparing.html">Preparing coarse-grained runs</a></li>
<li class="toctree-l2"><a class="reference internal" href="methods.html">Methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="advanced_topics.html">Advanced topics</a></li>
<li class="toctree-l2"><a class="reference internal" href="reference.html">Reference</a></li>
<li class="toctree-l2"><a class="reference internal" href="bibliography.html">Bibliography</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#citations">Citations</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#development">Development</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#copyright">Copyright</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../xtp/XTP-MANUAL.html">XTP Manual</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../xtp-tutorials/XTP-TUTORIAL.html">XTP Tutorials</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Development</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../DEVELOPERS_GUIDE.html">Developer and Contributor Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../VOTCA_LANGUAGE_GUIDE.html">VOTCA Internal Contributor Language Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Architecture.html">The architecture of VOTCA</a></li>
<li class="toctree-l1"><a class="reference internal" href="../xtp/Architecture.html">Architecture of votca-xtp</a></li>
<li class="toctree-l1"><a class="reference internal" href="../CODE_OF_CONDUCT.html">Code of Conduct</a></li>
<li class="toctree-l1"><a class="reference internal" href="../websiteAndDocumentation.html">Website and Documentation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Community</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://github.com/votca">GitHub</a></li>
<li class="toctree-l1"><a class="reference external" href="https://twitter.com/votca_software">Twitter</a></li>
<li class="toctree-l1"><a class="reference external" href="https://groups.google.com/g/votca">Forum</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">VOTCA</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">CSG Manual</a></li>
      <li class="breadcrumb-item active">Theoretical background</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/csg/theory.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="theoretical-background">
<h1>Theoretical background<a class="headerlink" href="#theoretical-background" title="Link to this heading">¶</a></h1>
<section id="mapping">
<span id="theory-mapping"></span><h2>Mapping<a class="headerlink" href="#mapping" title="Link to this heading">¶</a></h2>
<p>The mapping is an operator that establishes a link between the atomistic
and coarse-grained representations of the system. An atomistic system is
described by specifying the values of the Cartesian coordinates and
momenta</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
\mathbf r^n &amp;= \{\mathbf r_1,\dots,\mathbf r_n\}, \\
\mathbf p^n &amp;= \{\mathbf p_1,\dots,\mathbf p_n\}.
\end{aligned}\end{split}\]</div>
<p>of the <span class="math notranslate nohighlight">\(n\)</span> atoms in the system. <a class="footnote-reference brackets" href="#id5" id="id1" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a> On a coarse-grained level,
the coordinates and momenta are specified by the positions and momenta
of CG sites</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
\mathbf R^N = \{\mathbf R_1,\dots,\mathbf R_N\}, \\
\mathbf P^N = \{\mathbf P_1,\dots,\mathbf P_N\}.
\end{aligned}\end{split}\]</div>
<p>Note that capitalized symbols are used for the CG sites while lower
case letters are used for the atomistic system.</p>
<p>The mapping operator <span class="math notranslate nohighlight">\({\mathbf c}_I\)</span> is defined by a matrix for each
bead <span class="math notranslate nohighlight">\(I\)</span> and links the two descriptions</p>
<div class="math notranslate nohighlight" id="theory-eq-mapping-scheme">
\[\begin{split}\begin{aligned}
 {\mathbf R}_I &amp;= \sum_{i=1}^{n}c_{Ii}\mathbf r_i, \\
 {\mathbf P}_I &amp;=
    M_I \dot{{\mathbf R}}_I =
    M_I \sum_{i=1}^{n}c_{Ii} \dot{{\mathbf r}}_i =
    M_I \sum_{i=1}^{n} \frac{ c_{Ii}} {m_i} {\mathbf p}_i .
\end{aligned}\end{split}\]</div>
<p>for all <span class="math notranslate nohighlight">\(I = 1,\dots,N\)</span>.</p>
<p>If an atomistic system is translated by a constant vector, the
corresponding coarse-grained system is also translated by the same
vector. This implies that, for all <span class="math notranslate nohighlight">\(I\)</span>,</p>
<div class="math notranslate nohighlight">
\[\sum_{i=1}^{n}c_{Ii}=1.\]</div>
<p>In some cases it is useful to define the CG mapping in such a way that
certain atoms belong to several CG beads at the same
time <a class="reference internal" href="bibliography.html#fritz-2009" id="id2"><span>[Fritz:2009]</span></a>. Following
ref. <a class="reference internal" href="bibliography.html#noid-2008-1" id="id3"><span>[Noid:2008.1]</span></a>, we define two sets of atoms for
each of the <span class="math notranslate nohighlight">\(N\)</span> CG beads. For each site <span class="math notranslate nohighlight">\(I\)</span>, a set of
<em>involved</em> atoms is defined as</p>
<div class="math notranslate nohighlight">
\[{\cal I}_I=\{i|c_{Ii}\ne0\}.\]</div>
<p>An atom <span class="math notranslate nohighlight">\(i\)</span> in the atomistic model is involved in a CG site, <em>I</em>,
if and only if this atom provides a nonzero contribution to the sum in
<a class="reference internal" href="#theory-eq-mapping-scheme"><span class="std std-ref">the equation above</span></a>.</p>
<p>A set of <em>specific</em> atoms is defined as</p>
<div class="math notranslate nohighlight">
\[{\cal S}_I=\{i|c_{Ii}\ne0 \text{ and } c_{Ji}=0 \text{ for all } J \ne I\}.\]</div>
<p>In other words, atom <span class="math notranslate nohighlight">\(i\)</span> is specific to site <span class="math notranslate nohighlight">\(I\)</span> if and
only if this atom is involved in site <span class="math notranslate nohighlight">\(I\)</span> and is not involved in
the definition of any other site.</p>
<p>The CG model will generate an equilibrium distribution of momenta that
is consistent with an underlying atomistic model if all the atoms are
<em>specific</em> and if the mass of the <span class="math notranslate nohighlight">\(I^\text{th}\)</span> CG site is given
by <a class="reference internal" href="bibliography.html#noid-2008-1" id="id4"><span>[Noid:2008.1]</span></a></p>
<div class="math notranslate nohighlight">
\[M_I= \left( \sum_{i \in {\cal I}_I}\frac{c_{Ii}^2}{m_i} \right)^{-1}.\]</div>
<p>If all atoms are specific and the center of mass of a bead is used for
mapping, then <span class="math notranslate nohighlight">\(c_{Ii} = \frac{m_i}{M_I}\)</span>, and the
condition is automatically satisfied.</p>
<p class="rubric">Footnotes</p>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="id5" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id1">1</a><span class="fn-bracket">]</span></span>
<p>In what follows we adopt notations of ref. <a class="reference internal" href="bibliography.html#noid-2008-1" id="id6"><span>[Noid:2008.1]</span></a>.</p>
</aside>
</aside>
</section>
<section id="boltzmann-inversion">
<h2>Boltzmann inversion<a class="headerlink" href="#boltzmann-inversion" title="Link to this heading">¶</a></h2>
<p>Boltzmann inversion is mostly used for <em>bonded</em> potentials, such as
bonds, angles, and torsions <a class="reference internal" href="bibliography.html#tschoep-1998" id="id7"><span>[Tschoep:1998]</span></a>. Boltzmann
inversion is structure-based and only requires positions of atoms.</p>
<p>The idea of Boltzmann inversion stems from the fact that in a canonical
ensemble <em>independent</em> degrees of freedom <span class="math notranslate nohighlight">\(q\)</span> obey the Boltzmann
distribution, i. e.</p>
<div class="math notranslate nohighlight">
\[P(q) = Z^{-1} \exp\left[ - \beta U(q) \right]~,
\label{eq:boltzmann}\]</div>
<p>where is a partition function, . Once <span class="math notranslate nohighlight">\(P(q)\)</span> is known, one can
obtain the coarse-grained potential, which in this case is a potential
of mean force, by inverting the probability distribution <span class="math notranslate nohighlight">\(P(q)\)</span> of
a variable <span class="math notranslate nohighlight">\(q\)</span>, which is either a bond length, bond angle, or
torsion angle</p>
<div class="math notranslate nohighlight">
\[U(q) = - k_\text{B} T \ln  P(q) ~.
\label{eq:inv_boltzmann}\]</div>
<p>The normalization factor <span class="math notranslate nohighlight">\(Z\)</span> is not important since it would only
enter the coarse-grained potential <span class="math notranslate nohighlight">\(U(q)\)</span> as an irrelevant
additive constant.</p>
<p>Note that the histograms for the bonds <span class="math notranslate nohighlight">\(H_r(r)\)</span>, angles
<span class="math notranslate nohighlight">\(H_\theta(\theta)\)</span>, and torsion angles <span class="math notranslate nohighlight">\(H_\varphi(\varphi)\)</span>
have to be rescaled in order to obtain the volume normalized
distribution functions <span class="math notranslate nohighlight">\(P_r(r)\)</span>, <span class="math notranslate nohighlight">\(P_\theta(\theta)\)</span>, and
<span class="math notranslate nohighlight">\(P_\varphi(\varphi)\)</span>, respectively,</p>
<div class="math notranslate nohighlight" id="theory-eq-boltzmann-norm">
\[\begin{aligned}
P_r(r) = \frac{H_r(r)}{4\pi r^2}~,\;
P_\theta(\theta) = \frac{H_\theta(\theta)}{\sin \theta}~,\;
P_\varphi(\varphi) = H_\varphi (\varphi)~,
\end{aligned}\]</div>
<p>where <span class="math notranslate nohighlight">\(r\)</span> is the bond length <span class="math notranslate nohighlight">\(r\)</span>, <span class="math notranslate nohighlight">\(\theta\)</span> is the
bond angle, and <span class="math notranslate nohighlight">\(\varphi\)</span> is the torsion angle. The bonded
coarse-grained potential can then be written as a sum of distribution
functions</p>
<div class="math notranslate nohighlight" id="theory-eq-boltzmann-pmf">
\[\begin{split}\begin{aligned}
    U({r}, \theta, \varphi) &amp;= U_r({r}) + U_{\theta}(\theta) + U_{\varphi}(\varphi)~, \\
    U_q({q}) &amp;= - k_\text{B} T \ln P_q( q ),\; q=r, \theta, \varphi~.
    \nonumber\end{aligned}\end{split}\]</div>
<p>On the technical side, the implementation of the Boltzmann inversion
method requires <em>smoothing</em> of <span class="math notranslate nohighlight">\(U(q)\)</span> to provide a continuous
force. Splines can be used for this purpose. Poorly and unsampled
regions, that is regions with high <span class="math notranslate nohighlight">\(U(q)\)</span>, shall be
<em>extrapolated</em>. Since the contribution of these regions to the canonical
density of states is small, the exact shape of the extrapolation is less
important.</p>
<p>Another crucial issue is the cross-correlation of the coarse-grained
degrees of freedom. Independence of the coarse-grained degrees of
freedom is the main assumption that allows factorization of the
probability distribution and the potential <a class="reference internal" href="#theory-eq-boltzmann-pmf"><span class="std std-ref">as in the above equation</span></a>.
Hence, one has to carefully check whether this assumption holds in
practice. This can be done by performing coarse-grained simulations and
comparing cross-correlations for all pairs of degrees of freedom in
atomistic and coarse-grained resolution, e. g. using a two-dimensional
histogram, analogous to a Ramachandran plot.  <a class="footnote-reference brackets" href="#id9" id="id8" role="doc-noteref"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></a></p>
<p class="rubric">Footnotes</p>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="id9" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id8">2</a><span class="fn-bracket">]</span></span>
<p>Checking the linear correlation coefficient does not guarantee
statistical independence of variables, for example
<span class="math notranslate nohighlight">\(c(x, x^2)=0\)</span> if <span class="math notranslate nohighlight">\(x\)</span> has a symmetric probability density
<span class="math notranslate nohighlight">\(P(x) = P(-x)\)</span>. This case is often encountered in systems used
for coarse-graining.</p>
</aside>
</aside>
<section id="separation-of-bonded-and-non-bonded-degrees-of-freedom">
<h3>Separation of bonded and non-bonded degrees of freedom<a class="headerlink" href="#separation-of-bonded-and-non-bonded-degrees-of-freedom" title="Link to this heading">¶</a></h3>
<p>When coarse-graining polymeric systems, it is convenient to treat bonded
and non-bonded interactions separately <a class="reference internal" href="bibliography.html#tschoep-1998" id="id10"><span>[Tschoep:1998]</span></a>.
In this case, sampling of the atomistic system shall be performed on a
special system where non-bonded interactions are artificially removed,
so that the non-bonded interactions in the reference system do not
contribute to the bonded interactions of the coarse-grained model.</p>
<p>This can be done by employing exclusion lists using with the option
<code class="docutils literal notranslate"><span class="pre">--excl</span></code>. This is described in detail in <span class="xref std std-ref">methods_exclusions</span>.</p>
<figure class="align-center" id="id16">
<img alt="../_images/excl.png" src="../_images/excl.png" />
<figcaption>
<p><span class="caption-number">Fig. 2 </span><span class="caption-text">Example of excluded interactions.</span><a class="headerlink" href="#id16" title="Link to this image">¶</a></p>
</figcaption>
</figure>
</section>
</section>
<section id="force-matching">
<h2>Force Matching<a class="headerlink" href="#force-matching" title="Link to this heading">¶</a></h2>
<p>Force matching (FM) is another approach to evaluate corse-grained
potentials [Ercolessi:1994,Izvekov:2005,Noid:2007]_. In
contrast to the structure-based approaches, its aim is not to reproduce
various distribution functions, but instead to match the multibody
potential of mean force as close as possible with a given set of
coarse-grained interactions.</p>
<p>The method works as follows. We first assume that the coarse-grained
force-field (and hence the forces) depends on <span class="math notranslate nohighlight">\(M\)</span> parameters
<span class="math notranslate nohighlight">\(g_1,...,g_M\)</span>. These parameters can be prefactors of analytical
functions, tabulated values of the interaction potentials, or
coefficients of splines used to describe these potentials.</p>
<p>In order to determine these parameters, the reference forces on
coarse-grained beads are calculated by summing up the forces on the
atoms</p>
<div class="math notranslate nohighlight">
\[{{{{\mathbf F}}}}_I^\text{ref} = \sum_{j \in {\cal S_I}} \frac{d_{Ii}}{c_{Ii}} {{{{\mathbf f}}}}_j({{{{\mathbf r}}}^n}),
  \label{eq:force_mapping}\]</div>
<p>where the sum is over all atoms of the CG site <em>I</em> (see
<a class="reference internal" href="#theory-mapping"><span class="std std-ref">Mapping</span></a>). The <span class="math notranslate nohighlight">\(d_{Ij}\)</span> coefficients can, in
principle, be chosen arbitrarily, provided that the condition
:math:` sum_{i=1}^{n}d_{Ii}=1` is
satisfied <a class="reference internal" href="bibliography.html#noid-2008-1" id="id11"><span>[Noid:2008.1]</span></a>. If mapping coefficients for
the forces are not provided, it is assumed that <span class="math notranslate nohighlight">\(d_{Ij} = c_{Ij}\)</span>
(see also <a class="reference internal" href="input_files.html#input-files"><span class="std std-ref">Input files</span></a>).</p>
<p>By calculating the reference forces for <span class="math notranslate nohighlight">\(L\)</span> snapshots we can write
down <span class="math notranslate nohighlight">\(N \times L\)</span> equations</p>
<div class="math notranslate nohighlight" id="theory-eq-fmatch1">
\[{{{{\mathbf F}}}}_{Il}^\text{cg}(g_1, \dots ,g_M)={{{\mathbf F}}}_{il}^\text{ref},\;
  I=1,\dots,N,\; l=1,\dots,L~.\]</div>
<p>Here <span class="math notranslate nohighlight">\({{{{\mathbf F}}}}_{Il}^\text{ref}\)</span> is the force on
the bead <span class="math notranslate nohighlight">\(I\)</span> and <span class="math notranslate nohighlight">\({{{{\mathbf F}}}}_{Il}^\text{cg} `
is the coarse-grained representation of this force. The index :math:`l\)</span>
enumerates snapshots picked for coarse-graining. By running the
simulations long enough one can always ensure that
<span class="math notranslate nohighlight">\(M &lt; N \times L\)</span>. In this case the set of equations
is overdetermined and can be solved in a least-squares manner.</p>
<p><span class="math notranslate nohighlight">\({\mathbf F}_{il}^\text{cg}\)</span> is, in principle, a non-linear function
of its parameters <span class="math notranslate nohighlight">\(\{g_i\}\)</span>. Therefore, it is useful to represent
the coarse-grained force-field in such a way that
<a class="reference internal" href="#theory-eq-fmatch1"><span class="std std-ref">equations</span></a> become linear functions of <span class="math notranslate nohighlight">\({g_i}\)</span>.
This can be done using splines to describe the functional form of the
forces <a class="reference internal" href="bibliography.html#izvekov-2005" id="id12"><span>[Izvekov:2005]</span></a>. Implementation details are
discussed in ref. <a class="reference internal" href="bibliography.html#ruehle-2009-a" id="id13"><span>[Ruehle:2009.a]</span></a>.</p>
<p>Note that an adequate sampling of the system requires a large number of
snapshots <span class="math notranslate nohighlight">\(L\)</span>. Hence, the applicability of the method is often
constrained by the amount of memory available. To remedy the situation,
one can split the trajectory into blocks, find the coarse-grained
potential for each block and then perform averaging over all blocks.</p>
<section id="three-body-stillinger-weber-interactions">
<span id="theory-fm-threebody"></span><h3>Three-body Stillinger-Weber interactions<a class="headerlink" href="#three-body-stillinger-weber-interactions" title="Link to this heading">¶</a></h3>
<p>In addition to non-bonded pair interactions, it is also possible to parametrize non-bonded
three-body interactions of the Stillinger Weber type <a class="reference internal" href="bibliography.html#stillinger-computer-1985" id="id14"><span>[stillinger_computer_1985]</span></a>:</p>
<div class="math notranslate nohighlight" id="theory-eq-sw1">
\[U = \sum_{I,J\neq I,K&gt;J}f^{\left(3b\right)}\left(\theta_{IJK}\right)\,\exp{\left(\frac{\gamma_{IJ}\sigma_{IJ}}{r_{IJ}-a_{IJ}\sigma_{IJ}} + \frac{\gamma_{IK}\sigma_{IK}}{r_{IK}-a_{IK}\sigma_{IK}}\right)},\]</div>
<p>where <span class="math notranslate nohighlight">\(I\)</span> is the index of the central bead of a triplet of a CG sites, and <span class="math notranslate nohighlight">\(J\)</span>
and <span class="math notranslate nohighlight">\(K\)</span> are the other two bead indices of a triplet of beads with an angular interaction
term <span class="math notranslate nohighlight">\(f^{\left(3b\right)}\left(\theta_{IJK}\right)\)</span> and two exponential terms,
<span class="math notranslate nohighlight">\(\exp\left(\frac{\gamma\sigma}{r-a\sigma}\right)\)</span>, which guarantee a smooth switching on of the
three-body forces at the cutoff distance. We do not limit ourselves to an analytic expression of
<span class="math notranslate nohighlight">\(f^{\left(3b\right)}\left(\theta_{IJK}\right)\)</span> as in the original SW potential, but allow for a flexible
angular dependence of <span class="math notranslate nohighlight">\(f^{\left(3b\right)}\left(\theta_{IJK}\right)\)</span>. This is done by using a cubic spline
representation of <span class="math notranslate nohighlight">\(f^{\left(3b\right)}\left(\theta\right)\)</span>. Treating the two exponential terms as
prefactors yields a linear dependence of the potential and thus the CG force <span class="math notranslate nohighlight">\({\mathbf F}_{Il}^\text{cg}\)</span> on
the <span class="math notranslate nohighlight">\(M\)</span> spline coefficients. Therefore, the remaining parameters <span class="math notranslate nohighlight">\(a_{IJ}\)</span>, <span class="math notranslate nohighlight">\(a_{IK}\)</span>
(three-body short-range cutoff), <span class="math notranslate nohighlight">\(\sigma_{IJ}\)</span>, <span class="math notranslate nohighlight">\(\sigma_{IK}\)</span>
(additional parameter, can be set to 1), <span class="math notranslate nohighlight">\(\gamma_{IJ}\)</span>, and <span class="math notranslate nohighlight">\(\gamma_{IK}\)</span> (steepness of switching),
have to be set before solving the set of
<a class="reference internal" href="#theory-eq-fmatch1"><span class="std std-ref">linear equations</span></a>. For a more detailed description,
we refer to ref. <a class="reference internal" href="bibliography.html#scherer-understanding-2018" id="id15"><span>[scherer_understanding_2018]</span></a>.</p>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="introduction.html" class="btn btn-neutral float-left" title="Introduction" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="input_files.html" class="btn btn-neutral float-right" title="Input files" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, VOTCA Development Team.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>